(function(global, factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        module.exports = global.document ? factory(global, true) : function(w) {
            if (!w.document) {
                throw new Error("jQuery requires a window with a document")
            }
            return factory(w)
        }
    } else {
        factory(global)
    }
})(typeof window !== "undefined" ? window : this, function(window, noGlobal) {
    var arr = [];
    var document = window.document;
    var slice = arr.slice;
    var concat = arr.concat;
    var push = arr.push;
    var indexOf = arr.indexOf;
    var class2type = {};
    var toString = class2type.toString;
    var hasOwn = class2type.hasOwnProperty;
    var support = {};
    var version = "2.2.4",
        jQuery = function(selector, context) {
            return new jQuery.fn.init(selector, context)
        },
        rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
        rmsPrefix = /^-ms-/,
        rdashAlpha = /-([\da-z])/gi,
        fcamelCase = function(all, letter) {
            return letter.toUpperCase()
        };
    jQuery.fn = jQuery.prototype = {
        jquery: version,
        constructor: jQuery,
        selector: "",
        length: 0,
        toArray: function() {
            return slice.call(this)
        },
        get: function(num) {
            return num != null ? num < 0 ? this[num + this.length] : this[num] : slice.call(this)
        },
        pushStack: function(elems) {
            var ret = jQuery.merge(this.constructor(), elems);
            ret.prevObject = this;
            ret.context = this.context;
            return ret
        },
        each: function(callback) {
            return jQuery.each(this, callback)
        },
        map: function(callback) {
            return this.pushStack(jQuery.map(this, function(elem, i) {
                return callback.call(elem, i, elem)
            }))
        },
        slice: function() {
            return this.pushStack(slice.apply(this, arguments))
        },
        first: function() {
            return this.eq(0)
        },
        last: function() {
            return this.eq(-1)
        },
        eq: function(i) {
            var len = this.length,
                j = +i + (i < 0 ? len : 0);
            return this.pushStack(j >= 0 && j < len ? [this[j]] : [])
        },
        end: function() {
            return this.prevObject || this.constructor()
        },
        push: push,
        sort: arr.sort,
        splice: arr.splice
    };
    jQuery.extend = jQuery.fn.extend = function() {
        var options, name, src, copy, copyIsArray, clone, target = arguments[0] || {},
            i = 1,
            length = arguments.length,
            deep = false;
        if (typeof target === "boolean") {
            deep = target;
            target = arguments[i] || {};
            i++
        }
        if (typeof target !== "object" && !jQuery.isFunction(target)) {
            target = {}
        }
        if (i === length) {
            target = this;
            i--
        }
        for (; i < length; i++) {
            if ((options = arguments[i]) != null) {
                for (name in options) {
                    src = target[name];
                    copy = options[name];
                    if (target === copy) {
                        continue
                    }
                    if (deep && copy && (jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)))) {
                        if (copyIsArray) {
                            copyIsArray = false;
                            clone = src && jQuery.isArray(src) ? src : []
                        } else {
                            clone = src && jQuery.isPlainObject(src) ? src : {}
                        }
                        target[name] = jQuery.extend(deep, clone, copy)
                    } else if (copy !== undefined) {
                        target[name] = copy
                    }
                }
            }
        }
        return target
    };
    jQuery.extend({
        expando: "jQuery" + (version + Math.random()).replace(/\D/g, ""),
        isReady: true,
        error: function(msg) {
            throw new Error(msg)
        },
        noop: function() {},
        isFunction: function(obj) {
            return jQuery.type(obj) === "function"
        },
        isArray: Array.isArray,
        isWindow: function(obj) {
            return obj != null && obj === obj.window
        },
        isNumeric: function(obj) {
            var realStringObj = obj && obj.toString();
            return !jQuery.isArray(obj) && realStringObj - parseFloat(realStringObj) + 1 >= 0
        },
        isPlainObject: function(obj) {
            var key;
            if (jQuery.type(obj) !== "object" || obj.nodeType || jQuery.isWindow(obj)) {
                return false
            }
            if (obj.constructor && !hasOwn.call(obj, "constructor") && !hasOwn.call(obj.constructor.prototype || {}, "isPrototypeOf")) {
                return false
            }
            for (key in obj) {}
            return key === undefined || hasOwn.call(obj, key)
        },
        isEmptyObject: function(obj) {
            var name;
            for (name in obj) {
                return false
            }
            return true
        },
        type: function(obj) {
            if (obj == null) {
                return obj + ""
            }
            return typeof obj === "object" || typeof obj === "function" ? class2type[toString.call(obj)] || "object" : typeof obj
        },
        globalEval: function(code) {
            var script, indirect = eval;
            code = jQuery.trim(code);
            if (code) {
                if (code.indexOf("use strict") === 1) {
                    script = document.createElement("script");
                    script.text = code;
                    document.head.appendChild(script).parentNode.removeChild(script)
                } else {
                    indirect(code)
                }
            }
        },
        camelCase: function(string) {
            return string.replace(rmsPrefix, "ms-").replace(rdashAlpha, fcamelCase)
        },
        nodeName: function(elem, name) {
            return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase()
        },
        each: function(obj, callback) {
            var length, i = 0;
            if (isArrayLike(obj)) {
                length = obj.length;
                for (; i < length; i++) {
                    if (callback.call(obj[i], i, obj[i]) === false) {
                        break
                    }
                }
            } else {
                for (i in obj) {
                    if (callback.call(obj[i], i, obj[i]) === false) {
                        break
                    }
                }
            }
            return obj
        },
        trim: function(text) {
            return text == null ? "" : (text + "").replace(rtrim, "")
        },
        makeArray: function(arr, results) {
            var ret = results || [];
            if (arr != null) {
                if (isArrayLike(Object(arr))) {
                    jQuery.merge(ret, typeof arr === "string" ? [arr] : arr)
                } else {
                    push.call(ret, arr)
                }
            }
            return ret
        },
        inArray: function(elem, arr, i) {
            return arr == null ? -1 : indexOf.call(arr, elem, i)
        },
        merge: function(first, second) {
            var len = +second.length,
                j = 0,
                i = first.length;
            for (; j < len; j++) {
                first[i++] = second[j]
            }
            first.length = i;
            return first
        },
        grep: function(elems, callback, invert) {
            var callbackInverse, matches = [],
                i = 0,
                length = elems.length,
                callbackExpect = !invert;
            for (; i < length; i++) {
                callbackInverse = !callback(elems[i], i);
                if (callbackInverse !== callbackExpect) {
                    matches.push(elems[i])
                }
            }
            return matches
        },
        map: function(elems, callback, arg) {
            var length, value, i = 0,
                ret = [];
            if (isArrayLike(elems)) {
                length = elems.length;
                for (; i < length; i++) {
                    value = callback(elems[i], i, arg);
                    if (value != null) {
                        ret.push(value)
                    }
                }
            } else {
                for (i in elems) {
                    value = callback(elems[i], i, arg);
                    if (value != null) {
                        ret.push(value)
                    }
                }
            }
            return concat.apply([], ret)
        },
        guid: 1,
        proxy: function(fn, context) {
            var tmp, args, proxy;
            if (typeof context === "string") {
                tmp = fn[context];
                context = fn;
                fn = tmp
            }
            if (!jQuery.isFunction(fn)) {
                return undefined
            }
            args = slice.call(arguments, 2);
            proxy = function() {
                return fn.apply(context || this, args.concat(slice.call(arguments)))
            };
            proxy.guid = fn.guid = fn.guid || jQuery.guid++;
            return proxy
        },
        now: Date.now,
        support: support
    });
    if (typeof Symbol === "function") {
        jQuery.fn[Symbol.iterator] = arr[Symbol.iterator]
    }
    jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function(i, name) {
        class2type["[object " + name + "]"] = name.toLowerCase()
    });

    function isArrayLike(obj) {
        var length = !!obj && "length" in obj && obj.length,
            type = jQuery.type(obj);
        if (type === "function" || jQuery.isWindow(obj)) {
            return false
        }
        return type === "array" || length === 0 || typeof length === "number" && length > 0 && length - 1 in obj
    }
    var Sizzle = function(window) {
        var i, support, Expr, getText, isXML, tokenize, compile, select, outermostContext, sortInput, hasDuplicate, setDocument, document, docElem, documentIsHTML, rbuggyQSA, rbuggyMatches, matches, contains, expando = "sizzle" + 1 * new Date,
            preferredDoc = window.document,
            dirruns = 0,
            done = 0,
            classCache = createCache(),
            tokenCache = createCache(),
            compilerCache = createCache(),
            sortOrder = function(a, b) {
                if (a === b) {
                    hasDuplicate = true
                }
                return 0
            },
            MAX_NEGATIVE = 1 << 31,
            hasOwn = {}.hasOwnProperty,
            arr = [],
            pop = arr.pop,
            push_native = arr.push,
            push = arr.push,
            slice = arr.slice,
            indexOf = function(list, elem) {
                var i = 0,
                    len = list.length;
                for (; i < len; i++) {
                    if (list[i] === elem) {
                        return i
                    }
                }
                return -1
            },
            booleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
            whitespace = "[\\x20\\t\\r\\n\\f]",
            identifier = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
            attributes = "\\[" + whitespace + "*(" + identifier + ")(?:" + whitespace + "*([*^$|!~]?=)" + whitespace + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" + whitespace + "*\\]",
            pseudos = ":(" + identifier + ")(?:\\((" + "('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" + "((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" + ".*" + ")\\)|)",
            rwhitespace = new RegExp(whitespace + "+", "g"),
            rtrim = new RegExp("^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" + whitespace + "+$", "g"),
            rcomma = new RegExp("^" + whitespace + "*," + whitespace + "*"),
            rcombinators = new RegExp("^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*"),
            rattributeQuotes = new RegExp("=" + whitespace + "*([^\\]'\"]*?)" + whitespace + "*\\]", "g"),
            rpseudo = new RegExp(pseudos),
            ridentifier = new RegExp("^" + identifier + "$"),
            matchExpr = {
                ID: new RegExp("^#(" + identifier + ")"),
                CLASS: new RegExp("^\\.(" + identifier + ")"),
                TAG: new RegExp("^(" + identifier + "|[*])"),
                ATTR: new RegExp("^" + attributes),
                PSEUDO: new RegExp("^" + pseudos),
                CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + whitespace + "*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace + "*(\\d+)|))" + whitespace + "*\\)|)", "i"),
                bool: new RegExp("^(?:" + booleans + ")$", "i"),
                needsContext: new RegExp("^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + whitespace + "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i")
            },
            rinputs = /^(?:input|select|textarea|button)$/i,
            rheader = /^h\d$/i,
            rnative = /^[^{]+\{\s*\[native \w/,
            rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
            rsibling = /[+~]/,
            rescape = /'|\\/g,
            runescape = new RegExp("\\\\([\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig"),
            funescape = function(_, escaped, escapedWhitespace) {
                var high = "0x" + escaped - 65536;
                return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320)
            },
            unloadHandler = function() {
                setDocument()
            };
        try {
            push.apply(arr = slice.call(preferredDoc.childNodes), preferredDoc.childNodes);
            arr[preferredDoc.childNodes.length].nodeType
        } catch (e) {
            push = {
                apply: arr.length ? function(target, els) {
                    push_native.apply(target, slice.call(els))
                } : function(target, els) {
                    var j = target.length,
                        i = 0;
                    while (target[j++] = els[i++]) {}
                    target.length = j - 1
                }
            }
        }

        function Sizzle(selector, context, results, seed) {
            var m, i, elem, nid, nidselect, match, groups, newSelector, newContext = context && context.ownerDocument,
                nodeType = context ? context.nodeType : 9;
            results = results || [];
            if (typeof selector !== "string" || !selector || nodeType !== 1 && nodeType !== 9 && nodeType !== 11) {
                return results
            }
            if (!seed) {
                if ((context ? context.ownerDocument || context : preferredDoc) !== document) {
                    setDocument(context)
                }
                context = context || document;
                if (documentIsHTML) {
                    if (nodeType !== 11 && (match = rquickExpr.exec(selector))) {
                        if (m = match[1]) {
                            if (nodeType === 9) {
                                if (elem = context.getElementById(m)) {
                                    if (elem.id === m) {
                                        results.push(elem);
                                        return results
                                    }
                                } else {
                                    return results
                                }
                            } else {
                                if (newContext && (elem = newContext.getElementById(m)) && contains(context, elem) && elem.id === m) {
                                    results.push(elem);
                                    return results
                                }
                            }
                        } else if (match[2]) {
                            push.apply(results, context.getElementsByTagName(selector));
                            return results
                        } else if ((m = match[3]) && support.getElementsByClassName && context.getElementsByClassName) {
                            push.apply(results, context.getElementsByClassName(m));
                            return results
                        }
                    }
                    if (support.qsa && !compilerCache[selector + " "] && (!rbuggyQSA || !rbuggyQSA.test(selector))) {
                        if (nodeType !== 1) {
                            newContext = context;
                            newSelector = selector
                        } else if (context.nodeName.toLowerCase() !== "object") {
                            if (nid = context.getAttribute("id")) {
                                nid = nid.replace(rescape, "\\$&")
                            } else {
                                context.setAttribute("id", nid = expando)
                            }
                            groups = tokenize(selector);
                            i = groups.length;
                            nidselect = ridentifier.test(nid) ? "#" + nid : "[id='" + nid + "']";
                            while (i--) {
                                groups[i] = nidselect + " " + toSelector(groups[i])
                            }
                            newSelector = groups.join(",");
                            newContext = rsibling.test(selector) && testContext(context.parentNode) || context
                        }
                        if (newSelector) {
                            try {
                                push.apply(results, newContext.querySelectorAll(newSelector));
                                return results
                            } catch (qsaError) {} finally {
                                if (nid === expando) {
                                    context.removeAttribute("id")
                                }
                            }
                        }
                    }
                }
            }
            return select(selector.replace(rtrim, "$1"), context, results, seed)
        }

        function createCache() {
            var keys = [];

            function cache(key, value) {
                if (keys.push(key + " ") > Expr.cacheLength) {
                    delete cache[keys.shift()]
                }
                return cache[key + " "] = value
            }
            return cache
        }

        function markFunction(fn) {
            fn[expando] = true;
            return fn
        }

        function assert(fn) {
            var div = document.createElement("div");
            try {
                return !!fn(div)
            } catch (e) {
                return false
            } finally {
                if (div.parentNode) {
                    div.parentNode.removeChild(div)
                }
                div = null
            }
        }

        function addHandle(attrs, handler) {
            var arr = attrs.split("|"),
                i = arr.length;
            while (i--) {
                Expr.attrHandle[arr[i]] = handler
            }
        }

        function siblingCheck(a, b) {
            var cur = b && a,
                diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);
            if (diff) {
                return diff
            }
            if (cur) {
                while (cur = cur.nextSibling) {
                    if (cur === b) {
                        return -1
                    }
                }
            }
            return a ? 1 : -1
        }

        function createInputPseudo(type) {
            return function(elem) {
                var name = elem.nodeName.toLowerCase();
                return name === "input" && elem.type === type
            }
        }

        function createButtonPseudo(type) {
            return function(elem) {
                var name = elem.nodeName.toLowerCase();
                return (name === "input" || name === "button") && elem.type === type
            }
        }

        function createPositionalPseudo(fn) {
            return markFunction(function(argument) {
                argument = +argument;
                return markFunction(function(seed, matches) {
                    var j, matchIndexes = fn([], seed.length, argument),
                        i = matchIndexes.length;
                    while (i--) {
                        if (seed[j = matchIndexes[i]]) {
                            seed[j] = !(matches[j] = seed[j])
                        }
                    }
                })
            })
        }

        function testContext(context) {
            return context && typeof context.getElementsByTagName !== "undefined" && context
        }
        support = Sizzle.support = {};
        isXML = Sizzle.isXML = function(elem) {
            var documentElement = elem && (elem.ownerDocument || elem).documentElement;
            return documentElement ? documentElement.nodeName !== "HTML" : false
        };
        setDocument = Sizzle.setDocument = function(node) {
            var hasCompare, parent, doc = node ? node.ownerDocument || node : preferredDoc;
            if (doc === document || doc.nodeType !== 9 || !doc.documentElement) {
                return document
            }
            document = doc;
            docElem = document.documentElement;
            documentIsHTML = !isXML(document);
            if ((parent = document.defaultView) && parent.top !== parent) {
                if (parent.addEventListener) {
                    parent.addEventListener("unload", unloadHandler, false)
                } else if (parent.attachEvent) {
                    parent.attachEvent("onunload", unloadHandler)
                }
            }
            support.attributes = assert(function(div) {
                div.className = "i";
                return !div.getAttribute("className")
            });
            support.getElementsByTagName = assert(function(div) {
                div.appendChild(document.createComment(""));
                return !div.getElementsByTagName("*").length
            });
            support.getElementsByClassName = rnative.test(document.getElementsByClassName);
            support.getById = assert(function(div) {
                docElem.appendChild(div).id = expando;
                return !document.getElementsByName || !document.getElementsByName(expando).length
            });
            if (support.getById) {
                Expr.find["ID"] = function(id, context) {
                    if (typeof context.getElementById !== "undefined" && documentIsHTML) {
                        var m = context.getElementById(id);
                        return m ? [m] : []
                    }
                };
                Expr.filter["ID"] = function(id) {
                    var attrId = id.replace(runescape, funescape);
                    return function(elem) {
                        return elem.getAttribute("id") === attrId
                    }
                }
            } else {
                delete Expr.find["ID"];
                Expr.filter["ID"] = function(id) {
                    var attrId = id.replace(runescape, funescape);
                    return function(elem) {
                        var node = typeof elem.getAttributeNode !== "undefined" && elem.getAttributeNode("id");
                        return node && node.value === attrId
                    }
                }
            }
            Expr.find["TAG"] = support.getElementsByTagName ? function(tag, context) {
                if (typeof context.getElementsByTagName !== "undefined") {
                    return context.getElementsByTagName(tag)
                } else if (support.qsa) {
                    return context.querySelectorAll(tag)
                }
            } : function(tag, context) {
                var elem, tmp = [],
                    i = 0,
                    results = context.getElementsByTagName(tag);
                if (tag === "*") {
                    while (elem = results[i++]) {
                        if (elem.nodeType === 1) {
                            tmp.push(elem)
                        }
                    }
                    return tmp
                }
                return results
            };
            Expr.find["CLASS"] = support.getElementsByClassName && function(className, context) {
                if (typeof context.getElementsByClassName !== "undefined" && documentIsHTML) {
                    return context.getElementsByClassName(className)
                }
            };
            rbuggyMatches = [];
            rbuggyQSA = [];
            if (support.qsa = rnative.test(document.querySelectorAll)) {
                assert(function(div) {
                    docElem.appendChild(div).innerHTML = "<a id='" + expando + "'></a>" + "<select id='" + expando + "-\r\\' msallowcapture=''>" + "<option selected=''></option></select>";
                    if (div.querySelectorAll("[msallowcapture^='']").length) {
                        rbuggyQSA.push("[*^$]=" + whitespace + "*(?:''|\"\")")
                    }
                    if (!div.querySelectorAll("[selected]").length) {
                        rbuggyQSA.push("\\[" + whitespace + "*(?:value|" + booleans + ")")
                    }
                    if (!div.querySelectorAll("[id~=" + expando + "-]").length) {
                        rbuggyQSA.push("~=")
                    }
                    if (!div.querySelectorAll(":checked").length) {
                        rbuggyQSA.push(":checked")
                    }
                    if (!div.querySelectorAll("a#" + expando + "+*").length) {
                        rbuggyQSA.push(".#.+[+~]")
                    }
                });
                assert(function(div) {
                    var input = document.createElement("input");
                    input.setAttribute("type", "hidden");
                    div.appendChild(input).setAttribute("name", "D");
                    if (div.querySelectorAll("[name=d]").length) {
                        rbuggyQSA.push("name" + whitespace + "*[*^$|!~]?=")
                    }
                    if (!div.querySelectorAll(":enabled").length) {
                        rbuggyQSA.push(":enabled", ":disabled")
                    }
                    div.querySelectorAll("*,:x");
                    rbuggyQSA.push(",.*:")
                })
            }
            if (support.matchesSelector = rnative.test(matches = docElem.matches || docElem.webkitMatchesSelector || docElem.mozMatchesSelector || docElem.oMatchesSelector || docElem.msMatchesSelector)) {
                assert(function(div) {
                    support.disconnectedMatch = matches.call(div, "div");
                    matches.call(div, "[s!='']:x");
                    rbuggyMatches.push("!=", pseudos)
                })
            }
            rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join("|"));
            rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join("|"));
            hasCompare = rnative.test(docElem.compareDocumentPosition);
            contains = hasCompare || rnative.test(docElem.contains) ? function(a, b) {
                var adown = a.nodeType === 9 ? a.documentElement : a,
                    bup = b && b.parentNode;
                return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16))
            } : function(a, b) {
                if (b) {
                    while (b = b.parentNode) {
                        if (b === a) {
                            return true
                        }
                    }
                }
                return false
            };
            sortOrder = hasCompare ? function(a, b) {
                if (a === b) {
                    hasDuplicate = true;
                    return 0
                }
                var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;
                if (compare) {
                    return compare
                }
                compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;
                if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {
                    if (a === document || a.ownerDocument === preferredDoc && contains(preferredDoc, a)) {
                        return -1
                    }
                    if (b === document || b.ownerDocument === preferredDoc && contains(preferredDoc, b)) {
                        return 1
                    }
                    return sortInput ? indexOf(sortInput, a) - indexOf(sortInput, b) : 0
                }
                return compare & 4 ? -1 : 1
            } : function(a, b) {
                if (a === b) {
                    hasDuplicate = true;
                    return 0
                }
                var cur, i = 0,
                    aup = a.parentNode,
                    bup = b.parentNode,
                    ap = [a],
                    bp = [b];
                if (!aup || !bup) {
                    return a === document ? -1 : b === document ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf(sortInput, a) - indexOf(sortInput, b) : 0
                } else if (aup === bup) {
                    return siblingCheck(a, b)
                }
                cur = a;
                while (cur = cur.parentNode) {
                    ap.unshift(cur)
                }
                cur = b;
                while (cur = cur.parentNode) {
                    bp.unshift(cur)
                }
                while (ap[i] === bp[i]) {
                    i++
                }
                return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0
            };
            return document
        };
        Sizzle.matches = function(expr, elements) {
            return Sizzle(expr, null, null, elements)
        };
        Sizzle.matchesSelector = function(elem, expr) {
            if ((elem.ownerDocument || elem) !== document) {
                setDocument(elem)
            }
            expr = expr.replace(rattributeQuotes, "='$1']");
            if (support.matchesSelector && documentIsHTML && !compilerCache[expr + " "] && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {
                try {
                    var ret = matches.call(elem, expr);
                    if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {
                        return ret
                    }
                } catch (e) {}
            }
            return Sizzle(expr, document, null, [elem]).length > 0
        };
        Sizzle.contains = function(context, elem) {
            if ((context.ownerDocument || context) !== document) {
                setDocument(context)
            }
            return contains(context, elem)
        };
        Sizzle.attr = function(elem, name) {
            if ((elem.ownerDocument || elem) !== document) {
                setDocument(elem)
            }
            var fn = Expr.attrHandle[name.toLowerCase()],
                val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;
            return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null
        };
        Sizzle.error = function(msg) {
            throw new Error("Syntax error, unrecognized expression: " + msg)
        };
        Sizzle.uniqueSort = function(results) {
            var elem, duplicates = [],
                j = 0,
                i = 0;
            hasDuplicate = !support.detectDuplicates;
            sortInput = !support.sortStable && results.slice(0);
            results.sort(sortOrder);
            if (hasDuplicate) {
                while (elem = results[i++]) {
                    if (elem === results[i]) {
                        j = duplicates.push(i)
                    }
                }
                while (j--) {
                    results.splice(duplicates[j], 1)
                }
            }
            sortInput = null;
            return results
        };
        getText = Sizzle.getText = function(elem) {
            var node, ret = "",
                i = 0,
                nodeType = elem.nodeType;
            if (!nodeType) {
                while (node = elem[i++]) {
                    ret += getText(node)
                }
            } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {
                if (typeof elem.textContent === "string") {
                    return elem.textContent
                } else {
                    for (elem = elem.firstChild; elem; elem = elem.nextSibling) {
                        ret += getText(elem)
                    }
                }
            } else if (nodeType === 3 || nodeType === 4) {
                return elem.nodeValue
            }
            return ret
        };
        Expr = Sizzle.selectors = {
            cacheLength: 50,
            createPseudo: markFunction,
            match: matchExpr,
            attrHandle: {},
            find: {},
            relative: {
                ">": {
                    dir: "parentNode",
                    first: true
                },
                " ": {
                    dir: "parentNode"
                },
                "+": {
                    dir: "previousSibling",
                    first: true
                },
                "~": {
                    dir: "previousSibling"
                }
            },
            preFilter: {
                ATTR: function(match) {
                    match[1] = match[1].replace(runescape, funescape);
                    match[3] = (match[3] || match[4] || match[5] || "").replace(runescape, funescape);
                    if (match[2] === "~=") {
                        match[3] = " " + match[3] + " "
                    }
                    return match.slice(0, 4)
                },
                CHILD: function(match) {
                    match[1] = match[1].toLowerCase();
                    if (match[1].slice(0, 3) === "nth") {
                        if (!match[3]) {
                            Sizzle.error(match[0])
                        }
                        match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === "even" || match[3] === "odd"));
                        match[5] = +(match[7] + match[8] || match[3] === "odd")
                    } else if (match[3]) {
                        Sizzle.error(match[0])
                    }
                    return match
                },
                PSEUDO: function(match) {
                    var excess, unquoted = !match[6] && match[2];
                    if (matchExpr["CHILD"].test(match[0])) {
                        return null
                    }
                    if (match[3]) {
                        match[2] = match[4] || match[5] || ""
                    } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(")", unquoted.length - excess) - unquoted.length)) {
                        match[0] = match[0].slice(0, excess);
                        match[2] = unquoted.slice(0, excess)
                    }
                    return match.slice(0, 3)
                }
            },
            filter: {
                TAG: function(nodeNameSelector) {
                    var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();
                    return nodeNameSelector === "*" ? function() {
                        return true
                    } : function(elem) {
                        return elem.nodeName && elem.nodeName.toLowerCase() === nodeName
                    }
                },
                CLASS: function(className) {
                    var pattern = classCache[className + " "];
                    return pattern || (pattern = new RegExp("(^|" + whitespace + ")" + className + "(" + whitespace + "|$)")) && classCache(className, function(elem) {
                        return pattern.test(typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== "undefined" && elem.getAttribute("class") || "")
                    })
                },
                ATTR: function(name, operator, check) {
                    return function(elem) {
                        var result = Sizzle.attr(elem, name);
                        if (result == null) {
                            return operator === "!="
                        }
                        if (!operator) {
                            return true
                        }
                        result += "";
                        return operator === "=" ? result === check : operator === "!=" ? result !== check : operator === "^=" ? check && result.indexOf(check) === 0 : operator === "*=" ? check && result.indexOf(check) > -1 : operator === "$=" ? check && result.slice(-check.length) === check : operator === "~=" ? (" " + result.replace(rwhitespace, " ") + " ").indexOf(check) > -1 : operator === "|=" ? result === check || result.slice(0, check.length + 1) === check + "-" : false
                    }
                },
                CHILD: function(type, what, argument, first, last) {
                    var simple = type.slice(0, 3) !== "nth",
                        forward = type.slice(-4) !== "last",
                        ofType = what === "of-type";
                    return first === 1 && last === 0 ? function(elem) {
                        return !!elem.parentNode
                    } : function(elem, context, xml) {
                        var cache, uniqueCache, outerCache, node, nodeIndex, start, dir = simple !== forward ? "nextSibling" : "previousSibling",
                            parent = elem.parentNode,
                            name = ofType && elem.nodeName.toLowerCase(),
                            useCache = !xml && !ofType,
                            diff = false;
                        if (parent) {
                            if (simple) {
                                while (dir) {
                                    node = elem;
                                    while (node = node[dir]) {
                                        if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {
                                            return false
                                        }
                                    }
                                    start = dir = type === "only" && !start && "nextSibling"
                                }
                                return true
                            }
                            start = [forward ? parent.firstChild : parent.lastChild];
                            if (forward && useCache) {
                                node = parent;
                                outerCache = node[expando] || (node[expando] = {});
                                uniqueCache = outerCache[node.uniqueID] || (outerCache[node.uniqueID] = {});
                                cache = uniqueCache[type] || [];
                                nodeIndex = cache[0] === dirruns && cache[1];
                                diff = nodeIndex && cache[2];
                                node = nodeIndex && parent.childNodes[nodeIndex];
                                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {
                                    if (node.nodeType === 1 && ++diff && node === elem) {
                                        uniqueCache[type] = [dirruns, nodeIndex, diff];
                                        break
                                    }
                                }
                            } else {
                                if (useCache) {
                                    node = elem;
                                    outerCache = node[expando] || (node[expando] = {});
                                    uniqueCache = outerCache[node.uniqueID] || (outerCache[node.uniqueID] = {});
                                    cache = uniqueCache[type] || [];
                                    nodeIndex = cache[0] === dirruns && cache[1];
                                    diff = nodeIndex
                                }
                                if (diff === false) {
                                    while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {
                                        if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {
                                            if (useCache) {
                                                outerCache = node[expando] || (node[expando] = {});
                                                uniqueCache = outerCache[node.uniqueID] || (outerCache[node.uniqueID] = {});
                                                uniqueCache[type] = [dirruns, diff]
                                            }
                                            if (node === elem) {
                                                break
                                            }
                                        }
                                    }
                                }
                            }
                            diff -= last;
                            return diff === first || diff % first === 0 && diff / first >= 0
                        }
                    }
                },
                PSEUDO: function(pseudo, argument) {
                    var args, fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error("unsupported pseudo: " + pseudo);
                    if (fn[expando]) {
                        return fn(argument)
                    }
                    if (fn.length > 1) {
                        args = [pseudo, pseudo, "", argument];
                        return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function(seed, matches) {
                            var idx, matched = fn(seed, argument),
                                i = matched.length;
                            while (i--) {
                                idx = indexOf(seed, matched[i]);
                                seed[idx] = !(matches[idx] = matched[i])
                            }
                        }) : function(elem) {
                            return fn(elem, 0, args)
                        }
                    }
                    return fn
                }
            },
            pseudos: {
                not: markFunction(function(selector) {
                    var input = [],
                        results = [],
                        matcher = compile(selector.replace(rtrim, "$1"));
                    return matcher[expando] ? markFunction(function(seed, matches, context, xml) {
                        var elem, unmatched = matcher(seed, null, xml, []),
                            i = seed.length;
                        while (i--) {
                            if (elem = unmatched[i]) {
                                seed[i] = !(matches[i] = elem)
                            }
                        }
                    }) : function(elem, context, xml) {
                        input[0] = elem;
                        matcher(input, null, xml, results);
                        input[0] = null;
                        return !results.pop()
                    }
                }),
                has: markFunction(function(selector) {
                    return function(elem) {
                        return Sizzle(selector, elem).length > 0
                    }
                }),
                contains: markFunction(function(text) {
                    text = text.replace(runescape, funescape);
                    return function(elem) {
                        return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1
                    }
                }),
                lang: markFunction(function(lang) {
                    if (!ridentifier.test(lang || "")) {
                        Sizzle.error("unsupported lang: " + lang)
                    }
                    lang = lang.replace(runescape, funescape).toLowerCase();
                    return function(elem) {
                        var elemLang;
                        do {
                            if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute("xml:lang") || elem.getAttribute("lang")) {
                                elemLang = elemLang.toLowerCase();
                                return elemLang === lang || elemLang.indexOf(lang + "-") === 0
                            }
                        } while ((elem = elem.parentNode) && elem.nodeType === 1);
                        return false
                    }
                }),
                target: function(elem) {
                    var hash = window.location && window.location.hash;
                    return hash && hash.slice(1) === elem.id
                },
                root: function(elem) {
                    return elem === docElem
                },
                focus: function(elem) {
                    return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex)
                },
                enabled: function(elem) {
                    return elem.disabled === false
                },
                disabled: function(elem) {
                    return elem.disabled === true
                },
                checked: function(elem) {
                    var nodeName = elem.nodeName.toLowerCase();
                    return nodeName === "input" && !!elem.checked || nodeName === "option" && !!elem.selected
                },
                selected: function(elem) {
                    if (elem.parentNode) {
                        elem.parentNode.selectedIndex
                    }
                    return elem.selected === true
                },
                empty: function(elem) {
                    for (elem = elem.firstChild; elem; elem = elem.nextSibling) {
                        if (elem.nodeType < 6) {
                            return false
                        }
                    }
                    return true
                },
                parent: function(elem) {
                    return !Expr.pseudos["empty"](elem)
                },
                header: function(elem) {
                    return rheader.test(elem.nodeName)
                },
                input: function(elem) {
                    return rinputs.test(elem.nodeName)
                },
                button: function(elem) {
                    var name = elem.nodeName.toLowerCase();
                    return name === "input" && elem.type === "button" || name === "button"
                },
                text: function(elem) {
                    var attr;
                    return elem.nodeName.toLowerCase() === "input" && elem.type === "text" && ((attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text")
                },
                first: createPositionalPseudo(function() {
                    return [0]
                }),
                last: createPositionalPseudo(function(matchIndexes, length) {
                    return [length - 1]
                }),
                eq: createPositionalPseudo(function(matchIndexes, length, argument) {
                    return [argument < 0 ? argument + length : argument]
                }),
                even: createPositionalPseudo(function(matchIndexes, length) {
                    var i = 0;
                    for (; i < length; i += 2) {
                        matchIndexes.push(i)
                    }
                    return matchIndexes
                }),
                odd: createPositionalPseudo(function(matchIndexes, length) {
                    var i = 1;
                    for (; i < length; i += 2) {
                        matchIndexes.push(i)
                    }
                    return matchIndexes
                }),
                lt: createPositionalPseudo(function(matchIndexes, length, argument) {
                    var i = argument < 0 ? argument + length : argument;
                    for (; --i >= 0;) {
                        matchIndexes.push(i)
                    }
                    return matchIndexes
                }),
                gt: createPositionalPseudo(function(matchIndexes, length, argument) {
                    var i = argument < 0 ? argument + length : argument;
                    for (; ++i < length;) {
                        matchIndexes.push(i)
                    }
                    return matchIndexes
                })
            }
        };
        Expr.pseudos["nth"] = Expr.pseudos["eq"];
        for (i in {
                radio: true,
                checkbox: true,
                file: true,
                password: true,
                image: true
            }) {
            Expr.pseudos[i] = createInputPseudo(i)
        }
        for (i in {
                submit: true,
                reset: true
            }) {
            Expr.pseudos[i] = createButtonPseudo(i)
        }

        function setFilters() {}
        setFilters.prototype = Expr.filters = Expr.pseudos;
        Expr.setFilters = new setFilters;
        tokenize = Sizzle.tokenize = function(selector, parseOnly) {
            var matched, match, tokens, type, soFar, groups, preFilters, cached = tokenCache[selector + " "];
            if (cached) {
                return parseOnly ? 0 : cached.slice(0)
            }
            soFar = selector;
            groups = [];
            preFilters = Expr.preFilter;
            while (soFar) {
                if (!matched || (match = rcomma.exec(soFar))) {
                    if (match) {
                        soFar = soFar.slice(match[0].length) || soFar
                    }
                    groups.push(tokens = [])
                }
                matched = false;
                if (match = rcombinators.exec(soFar)) {
                    matched = match.shift();
                    tokens.push({
                        value: matched,
                        type: match[0].replace(rtrim, " ")
                    });
                    soFar = soFar.slice(matched.length)
                }
                for (type in Expr.filter) {
                    if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {
                        matched = match.shift();
                        tokens.push({
                            value: matched,
                            type: type,
                            matches: match
                        });
                        soFar = soFar.slice(matched.length)
                    }
                }
                if (!matched) {
                    break
                }
            }
            return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0)
        };

        function toSelector(tokens) {
            var i = 0,
                len = tokens.length,
                selector = "";
            for (; i < len; i++) {
                selector += tokens[i].value
            }
            return selector
        }

        function addCombinator(matcher, combinator, base) {
            var dir = combinator.dir,
                checkNonElements = base && dir === "parentNode",
                doneName = done++;
            return combinator.first ? function(elem, context, xml) {
                while (elem = elem[dir]) {
                    if (elem.nodeType === 1 || checkNonElements) {
                        return matcher(elem, context, xml)
                    }
                }
            } : function(elem, context, xml) {
                var oldCache, uniqueCache, outerCache, newCache = [dirruns, doneName];
                if (xml) {
                    while (elem = elem[dir]) {
                        if (elem.nodeType === 1 || checkNonElements) {
                            if (matcher(elem, context, xml)) {
                                return true
                            }
                        }
                    }
                } else {
                    while (elem = elem[dir]) {
                        if (elem.nodeType === 1 || checkNonElements) {
                            outerCache = elem[expando] || (elem[expando] = {});
                            uniqueCache = outerCache[elem.uniqueID] || (outerCache[elem.uniqueID] = {});
                            if ((oldCache = uniqueCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {
                                return newCache[2] = oldCache[2]
                            } else {
                                uniqueCache[dir] = newCache;
                                if (newCache[2] = matcher(elem, context, xml)) {
                                    return true
                                }
                            }
                        }
                    }
                }
            }
        }

        function elementMatcher(matchers) {
            return matchers.length > 1 ? function(elem, context, xml) {
                var i = matchers.length;
                while (i--) {
                    if (!matchers[i](elem, context, xml)) {
                        return false
                    }
                }
                return true
            } : matchers[0]
        }

        function multipleContexts(selector, contexts, results) {
            var i = 0,
                len = contexts.length;
            for (; i < len; i++) {
                Sizzle(selector, contexts[i], results)
            }
            return results
        }

        function condense(unmatched, map, filter, context, xml) {
            var elem, newUnmatched = [],
                i = 0,
                len = unmatched.length,
                mapped = map != null;
            for (; i < len; i++) {
                if (elem = unmatched[i]) {
                    if (!filter || filter(elem, context, xml)) {
                        newUnmatched.push(elem);
                        if (mapped) {
                            map.push(i)
                        }
                    }
                }
            }
            return newUnmatched
        }

        function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {
            if (postFilter && !postFilter[expando]) {
                postFilter = setMatcher(postFilter)
            }
            if (postFinder && !postFinder[expando]) {
                postFinder = setMatcher(postFinder, postSelector)
            }
            return markFunction(function(seed, results, context, xml) {
                var temp, i, elem, preMap = [],
                    postMap = [],
                    preexisting = results.length,
                    elems = seed || multipleContexts(selector || "*", context.nodeType ? [context] : context, []),
                    matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems,
                    matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;
                if (matcher) {
                    matcher(matcherIn, matcherOut, context, xml)
                }
                if (postFilter) {
                    temp = condense(matcherOut, postMap);
                    postFilter(temp, [], context, xml);
                    i = temp.length;
                    while (i--) {
                        if (elem = temp[i]) {
                            matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem)
                        }
                    }
                }
                if (seed) {
                    if (postFinder || preFilter) {
                        if (postFinder) {
                            temp = [];
                            i = matcherOut.length;
                            while (i--) {
                                if (elem = matcherOut[i]) {
                                    temp.push(matcherIn[i] = elem)
                                }
                            }
                            postFinder(null, matcherOut = [], temp, xml)
                        }
                        i = matcherOut.length;
                        while (i--) {
                            if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf(seed, elem) : preMap[i]) > -1) {
                                seed[temp] = !(results[temp] = elem)
                            }
                        }
                    }
                } else {
                    matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);
                    if (postFinder) {
                        postFinder(null, results, matcherOut, xml)
                    } else {
                        push.apply(results, matcherOut)
                    }
                }
            })
        }

        function matcherFromTokens(tokens) {
            var checkContext, matcher, j, len = tokens.length,
                leadingRelative = Expr.relative[tokens[0].type],
                implicitRelative = leadingRelative || Expr.relative[" "],
                i = leadingRelative ? 1 : 0,
                matchContext = addCombinator(function(elem) {
                    return elem === checkContext
                }, implicitRelative, true),
                matchAnyContext = addCombinator(function(elem) {
                    return indexOf(checkContext, elem) > -1
                }, implicitRelative, true),
                matchers = [function(elem, context, xml) {
                    var ret = !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));
                    checkContext = null;
                    return ret
                }];
            for (; i < len; i++) {
                if (matcher = Expr.relative[tokens[i].type]) {
                    matchers = [addCombinator(elementMatcher(matchers), matcher)]
                } else {
                    matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);
                    if (matcher[expando]) {
                        j = ++i;
                        for (; j < len; j++) {
                            if (Expr.relative[tokens[j].type]) {
                                break
                            }
                        }
                        return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({
                            value: tokens[i - 2].type === " " ? "*" : ""
                        })).replace(rtrim, "$1"), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens))
                    }
                    matchers.push(matcher)
                }
            }
            return elementMatcher(matchers)
        }

        function matcherFromGroupMatchers(elementMatchers, setMatchers) {
            var bySet = setMatchers.length > 0,
                byElement = elementMatchers.length > 0,
                superMatcher = function(seed, context, xml, results, outermost) {
                    var elem, j, matcher, matchedCount = 0,
                        i = "0",
                        unmatched = seed && [],
                        setMatched = [],
                        contextBackup = outermostContext,
                        elems = seed || byElement && Expr.find["TAG"]("*", outermost),
                        dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || .1,
                        len = elems.length;
                    if (outermost) {
                        outermostContext = context === document || context || outermost
                    }
                    for (; i !== len && (elem = elems[i]) != null; i++) {
                        if (byElement && elem) {
                            j = 0;
                            if (!context && elem.ownerDocument !== document) {
                                setDocument(elem);
                                xml = !documentIsHTML
                            }
                            while (matcher = elementMatchers[j++]) {
                                if (matcher(elem, context || document, xml)) {
                                    results.push(elem);
                                    break
                                }
                            }
                            if (outermost) {
                                dirruns = dirrunsUnique
                            }
                        }
                        if (bySet) {
                            if (elem = !matcher && elem) {
                                matchedCount--
                            }
                            if (seed) {
                                unmatched.push(elem)
                            }
                        }
                    }
                    matchedCount += i;
                    if (bySet && i !== matchedCount) {
                        j = 0;
                        while (matcher = setMatchers[j++]) {
                            matcher(unmatched, setMatched, context, xml)
                        }
                        if (seed) {
                            if (matchedCount > 0) {
                                while (i--) {
                                    if (!(unmatched[i] || setMatched[i])) {
                                        setMatched[i] = pop.call(results)
                                    }
                                }
                            }
                            setMatched = condense(setMatched)
                        }
                        push.apply(results, setMatched);
                        if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {
                            Sizzle.uniqueSort(results)
                        }
                    }
                    if (outermost) {
                        dirruns = dirrunsUnique;
                        outermostContext = contextBackup
                    }
                    return unmatched
                };
            return bySet ? markFunction(superMatcher) : superMatcher
        }
        compile = Sizzle.compile = function(selector, match) {
            var i, setMatchers = [],
                elementMatchers = [],
                cached = compilerCache[selector + " "];
            if (!cached) {
                if (!match) {
                    match = tokenize(selector)
                }
                i = match.length;
                while (i--) {
                    cached = matcherFromTokens(match[i]);
                    if (cached[expando]) {
                        setMatchers.push(cached)
                    } else {
                        elementMatchers.push(cached)
                    }
                }
                cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));
                cached.selector = selector
            }
            return cached
        };
        select = Sizzle.select = function(selector, context, results, seed) {
            var i, tokens, token, type, find, compiled = typeof selector === "function" && selector,
                match = !seed && tokenize(selector = compiled.selector || selector);
            results = results || [];
            if (match.length === 1) {
                tokens = match[0] = match[0].slice(0);
                if (tokens.length > 2 && (token = tokens[0]).type === "ID" && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {
                    context = (Expr.find["ID"](token.matches[0].replace(runescape, funescape), context) || [])[0];
                    if (!context) {
                        return results
                    } else if (compiled) {
                        context = context.parentNode
                    }
                    selector = selector.slice(tokens.shift().value.length)
                }
                i = matchExpr["needsContext"].test(selector) ? 0 : tokens.length;
                while (i--) {
                    token = tokens[i];
                    if (Expr.relative[type = token.type]) {
                        break
                    }
                    if (find = Expr.find[type]) {
                        if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {
                            tokens.splice(i, 1);
                            selector = seed.length && toSelector(tokens);
                            if (!selector) {
                                push.apply(results, seed);
                                return results
                            }
                            break
                        }
                    }
                }
            }(compiled || compile(selector, match))(seed, context, !documentIsHTML, results, !context || rsibling.test(selector) && testContext(context.parentNode) || context);
            return results
        };
        support.sortStable = expando.split("").sort(sortOrder).join("") === expando;
        support.detectDuplicates = !!hasDuplicate;
        setDocument();
        support.sortDetached = assert(function(div1) {
            return div1.compareDocumentPosition(document.createElement("div")) & 1
        });
        if (!assert(function(div) {
                div.innerHTML = "<a href='#'></a>";
                return div.firstChild.getAttribute("href") === "#"
            })) {
            addHandle("type|href|height|width", function(elem, name, isXML) {
                if (!isXML) {
                    return elem.getAttribute(name, name.toLowerCase() === "type" ? 1 : 2)
                }
            })
        }
        if (!support.attributes || !assert(function(div) {
                div.innerHTML = "<input/>";
                div.firstChild.setAttribute("value", "");
                return div.firstChild.getAttribute("value") === ""
            })) {
            addHandle("value", function(elem, name, isXML) {
                if (!isXML && elem.nodeName.toLowerCase() === "input") {
                    return elem.defaultValue
                }
            })
        }
        if (!assert(function(div) {
                return div.getAttribute("disabled") == null
            })) {
            addHandle(booleans, function(elem, name, isXML) {
                var val;
                if (!isXML) {
                    return elem[name] === true ? name.toLowerCase() : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null
                }
            })
        }
        return Sizzle
    }(window);
    jQuery.find = Sizzle;
    jQuery.expr = Sizzle.selectors;
    jQuery.expr[":"] = jQuery.expr.pseudos;
    jQuery.uniqueSort = jQuery.unique = Sizzle.uniqueSort;
    jQuery.text = Sizzle.getText;
    jQuery.isXMLDoc = Sizzle.isXML;
    jQuery.contains = Sizzle.contains;
    var dir = function(elem, dir, until) {
        var matched = [],
            truncate = until !== undefined;
        while ((elem = elem[dir]) && elem.nodeType !== 9) {
            if (elem.nodeType === 1) {
                if (truncate && jQuery(elem).is(until)) {
                    break
                }
                matched.push(elem)
            }
        }
        return matched
    };
    var siblings = function(n, elem) {
        var matched = [];
        for (; n; n = n.nextSibling) {
            if (n.nodeType === 1 && n !== elem) {
                matched.push(n)
            }
        }
        return matched
    };
    var rneedsContext = jQuery.expr.match.needsContext;
    var rsingleTag = /^<([\w-]+)\s*\/?>(?:<\/\1>|)$/;
    var risSimple = /^.[^:#\[\.,]*$/;

    function winnow(elements, qualifier, not) {
        if (jQuery.isFunction(qualifier)) {
            return jQuery.grep(elements, function(elem, i) {
                return !!qualifier.call(elem, i, elem) !== not
            })
        }
        if (qualifier.nodeType) {
            return jQuery.grep(elements, function(elem) {
                return elem === qualifier !== not
            })
        }
        if (typeof qualifier === "string") {
            if (risSimple.test(qualifier)) {
                return jQuery.filter(qualifier, elements, not)
            }
            qualifier = jQuery.filter(qualifier, elements)
        }
        return jQuery.grep(elements, function(elem) {
            return indexOf.call(qualifier, elem) > -1 !== not
        })
    }
    jQuery.filter = function(expr, elems, not) {
        var elem = elems[0];
        if (not) {
            expr = ":not(" + expr + ")"
        }
        return elems.length === 1 && elem.nodeType === 1 ? jQuery.find.matchesSelector(elem, expr) ? [elem] : [] : jQuery.find.matches(expr, jQuery.grep(elems, function(elem) {
            return elem.nodeType === 1
        }))
    };
    jQuery.fn.extend({
        find: function(selector) {
            var i, len = this.length,
                ret = [],
                self = this;
            if (typeof selector !== "string") {
                return this.pushStack(jQuery(selector).filter(function() {
                    for (i = 0; i < len; i++) {
                        if (jQuery.contains(self[i], this)) {
                            return true
                        }
                    }
                }))
            }
            for (i = 0; i < len; i++) {
                jQuery.find(selector, self[i], ret)
            }
            ret = this.pushStack(len > 1 ? jQuery.unique(ret) : ret);
            ret.selector = this.selector ? this.selector + " " + selector : selector;
            return ret
        },
        filter: function(selector) {
            return this.pushStack(winnow(this, selector || [], false))
        },
        not: function(selector) {
            return this.pushStack(winnow(this, selector || [], true))
        },
        is: function(selector) {
            return !!winnow(this, typeof selector === "string" && rneedsContext.test(selector) ? jQuery(selector) : selector || [], false).length
        }
    });
    var rootjQuery, rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
        init = jQuery.fn.init = function(selector, context, root) {
            var match, elem;
            if (!selector) {
                return this
            }
            root = root || rootjQuery;
            if (typeof selector === "string") {
                if (selector[0] === "<" && selector[selector.length - 1] === ">" && selector.length >= 3) {
                    match = [null, selector, null]
                } else {
                    match = rquickExpr.exec(selector)
                }
                if (match && (match[1] || !context)) {
                    if (match[1]) {
                        context = context instanceof jQuery ? context[0] : context;
                        jQuery.merge(this, jQuery.parseHTML(match[1], context && context.nodeType ? context.ownerDocument || context : document, true));
                        if (rsingleTag.test(match[1]) && jQuery.isPlainObject(context)) {
                            for (match in context) {
                                if (jQuery.isFunction(this[match])) {
                                    this[match](context[match])
                                } else {
                                    this.attr(match, context[match])
                                }
                            }
                        }
                        return this
                    } else {
                        elem = document.getElementById(match[2]);
                        if (elem && elem.parentNode) {
                            this.length = 1;
                            this[0] = elem
                        }
                        this.context = document;
                        this.selector = selector;
                        return this
                    }
                } else if (!context || context.jquery) {
                    return (context || root).find(selector)
                } else {
                    return this.constructor(context).find(selector)
                }
            } else if (selector.nodeType) {
                this.context = this[0] = selector;
                this.length = 1;
                return this
            } else if (jQuery.isFunction(selector)) {
                return root.ready !== undefined ? root.ready(selector) : selector(jQuery)
            }
            if (selector.selector !== undefined) {
                this.selector = selector.selector;
                this.context = selector.context
            }
            return jQuery.makeArray(selector, this)
        };
    init.prototype = jQuery.fn;
    rootjQuery = jQuery(document);
    var rparentsprev = /^(?:parents|prev(?:Until|All))/,
        guaranteedUnique = {
            children: true,
            contents: true,
            next: true,
            prev: true
        };
    jQuery.fn.extend({
        has: function(target) {
            var targets = jQuery(target, this),
                l = targets.length;
            return this.filter(function() {
                var i = 0;
                for (; i < l; i++) {
                    if (jQuery.contains(this, targets[i])) {
                        return true
                    }
                }
            })
        },
        closest: function(selectors, context) {
            var cur, i = 0,
                l = this.length,
                matched = [],
                pos = rneedsContext.test(selectors) || typeof selectors !== "string" ? jQuery(selectors, context || this.context) : 0;
            for (; i < l; i++) {
                for (cur = this[i]; cur && cur !== context; cur = cur.parentNode) {
                    if (cur.nodeType < 11 && (pos ? pos.index(cur) > -1 : cur.nodeType === 1 && jQuery.find.matchesSelector(cur, selectors))) {
                        matched.push(cur);
                        break
                    }
                }
            }
            return this.pushStack(matched.length > 1 ? jQuery.uniqueSort(matched) : matched)
        },
        index: function(elem) {
            if (!elem) {
                return this[0] && this[0].parentNode ? this.first().prevAll().length : -1
            }
            if (typeof elem === "string") {
                return indexOf.call(jQuery(elem), this[0])
            }
            return indexOf.call(this, elem.jquery ? elem[0] : elem)
        },
        add: function(selector, context) {
            return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(), jQuery(selector, context))))
        },
        addBack: function(selector) {
            return this.add(selector == null ? this.prevObject : this.prevObject.filter(selector))
        }
    });

    function sibling(cur, dir) {
        while ((cur = cur[dir]) && cur.nodeType !== 1) {}
        return cur
    }
    jQuery.each({
        parent: function(elem) {
            var parent = elem.parentNode;
            return parent && parent.nodeType !== 11 ? parent : null
        },
        parents: function(elem) {
            return dir(elem, "parentNode")
        },
        parentsUntil: function(elem, i, until) {
            return dir(elem, "parentNode", until)
        },
        next: function(elem) {
            return sibling(elem, "nextSibling")
        },
        prev: function(elem) {
            return sibling(elem, "previousSibling")
        },
        nextAll: function(elem) {
            return dir(elem, "nextSibling")
        },
        prevAll: function(elem) {
            return dir(elem, "previousSibling")
        },
        nextUntil: function(elem, i, until) {
            return dir(elem, "nextSibling", until)
        },
        prevUntil: function(elem, i, until) {
            return dir(elem, "previousSibling", until)
        },
        siblings: function(elem) {
            return siblings((elem.parentNode || {}).firstChild, elem)
        },
        children: function(elem) {
            return siblings(elem.firstChild)
        },
        contents: function(elem) {
            return elem.contentDocument || jQuery.merge([], elem.childNodes)
        }
    }, function(name, fn) {
        jQuery.fn[name] = function(until, selector) {
            var matched = jQuery.map(this, fn, until);
            if (name.slice(-5) !== "Until") {
                selector = until
            }
            if (selector && typeof selector === "string") {
                matched = jQuery.filter(selector, matched)
            }
            if (this.length > 1) {
                if (!guaranteedUnique[name]) {
                    jQuery.uniqueSort(matched)
                }
                if (rparentsprev.test(name)) {
                    matched.reverse()
                }
            }
            return this.pushStack(matched)
        }
    });
    var rnotwhite = /\S+/g;

    function createOptions(options) {
        var object = {};
        jQuery.each(options.match(rnotwhite) || [], function(_, flag) {
            object[flag] = true
        });
        return object
    }
    jQuery.Callbacks = function(options) {
        options = typeof options === "string" ? createOptions(options) : jQuery.extend({}, options);
        var firing, memory, fired, locked, list = [],
            queue = [],
            firingIndex = -1,
            fire = function() {
                locked = options.once;
                fired = firing = true;
                for (; queue.length; firingIndex = -1) {
                    memory = queue.shift();
                    while (++firingIndex < list.length) {
                        if (list[firingIndex].apply(memory[0], memory[1]) === false && options.stopOnFalse) {
                            firingIndex = list.length;
                            memory = false
                        }
                    }
                }
                if (!options.memory) {
                    memory = false
                }
                firing = false;
                if (locked) {
                    if (memory) {
                        list = []
                    } else {
                        list = ""
                    }
                }
            },
            self = {
                add: function() {
                    if (list) {
                        if (memory && !firing) {
                            firingIndex = list.length - 1;
                            queue.push(memory)
                        }(function add(args) {
                            jQuery.each(args, function(_, arg) {
                                if (jQuery.isFunction(arg)) {
                                    if (!options.unique || !self.has(arg)) {
                                        list.push(arg)
                                    }
                                } else if (arg && arg.length && jQuery.type(arg) !== "string") {
                                    add(arg)
                                }
                            })
                        })(arguments);
                        if (memory && !firing) {
                            fire()
                        }
                    }
                    return this
                },
                remove: function() {
                    jQuery.each(arguments, function(_, arg) {
                        var index;
                        while ((index = jQuery.inArray(arg, list, index)) > -1) {
                            list.splice(index, 1);
                            if (index <= firingIndex) {
                                firingIndex--
                            }
                        }
                    });
                    return this
                },
                has: function(fn) {
                    return fn ? jQuery.inArray(fn, list) > -1 : list.length > 0
                },
                empty: function() {
                    if (list) {
                        list = []
                    }
                    return this
                },
                disable: function() {
                    locked = queue = [];
                    list = memory = "";
                    return this
                },
                disabled: function() {
                    return !list
                },
                lock: function() {
                    locked = queue = [];
                    if (!memory) {
                        list = memory = ""
                    }
                    return this
                },
                locked: function() {
                    return !!locked
                },
                fireWith: function(context, args) {
                    if (!locked) {
                        args = args || [];
                        args = [context, args.slice ? args.slice() : args];
                        queue.push(args);
                        if (!firing) {
                            fire()
                        }
                    }
                    return this
                },
                fire: function() {
                    self.fireWith(this, arguments);
                    return this
                },
                fired: function() {
                    return !!fired
                }
            };
        return self
    };
    jQuery.extend({
        Deferred: function(func) {
            var tuples = [
                    ["resolve", "done", jQuery.Callbacks("once memory"), "resolved"],
                    ["reject", "fail", jQuery.Callbacks("once memory"), "rejected"],
                    ["notify", "progress", jQuery.Callbacks("memory")]
                ],
                state = "pending",
                promise = {
                    state: function() {
                        return state
                    },
                    always: function() {
                        deferred.done(arguments).fail(arguments);
                        return this
                    },
                    then: function() {
                        var fns = arguments;
                        return jQuery.Deferred(function(newDefer) {
                            jQuery.each(tuples, function(i, tuple) {
                                var fn = jQuery.isFunction(fns[i]) && fns[i];
                                deferred[tuple[1]](function() {
                                    var returned = fn && fn.apply(this, arguments);
                                    if (returned && jQuery.isFunction(returned.promise)) {
                                        returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject)
                                    } else {
                                        newDefer[tuple[0] + "With"](this === promise ? newDefer.promise() : this, fn ? [returned] : arguments)
                                    }
                                })
                            });
                            fns = null
                        }).promise()
                    },
                    promise: function(obj) {
                        return obj != null ? jQuery.extend(obj, promise) : promise
                    }
                },
                deferred = {};
            promise.pipe = promise.then;
            jQuery.each(tuples, function(i, tuple) {
                var list = tuple[2],
                    stateString = tuple[3];
                promise[tuple[1]] = list.add;
                if (stateString) {
                    list.add(function() {
                        state = stateString
                    }, tuples[i ^ 1][2].disable, tuples[2][2].lock)
                }
                deferred[tuple[0]] = function() {
                    deferred[tuple[0] + "With"](this === deferred ? promise : this, arguments);
                    return this
                };
                deferred[tuple[0] + "With"] = list.fireWith
            });
            promise.promise(deferred);
            if (func) {
                func.call(deferred, deferred)
            }
            return deferred
        },
        when: function(subordinate) {
            var i = 0,
                resolveValues = slice.call(arguments),
                length = resolveValues.length,
                remaining = length !== 1 || subordinate && jQuery.isFunction(subordinate.promise) ? length : 0,
                deferred = remaining === 1 ? subordinate : jQuery.Deferred(),
                updateFunc = function(i, contexts, values) {
                    return function(value) {
                        contexts[i] = this;
                        values[i] = arguments.length > 1 ? slice.call(arguments) : value;
                        if (values === progressValues) {
                            deferred.notifyWith(contexts, values)
                        } else if (!--remaining) {
                            deferred.resolveWith(contexts, values)
                        }
                    }
                },
                progressValues, progressContexts, resolveContexts;
            if (length > 1) {
                progressValues = new Array(length);
                progressContexts = new Array(length);
                resolveContexts = new Array(length);
                for (; i < length; i++) {
                    if (resolveValues[i] && jQuery.isFunction(resolveValues[i].promise)) {
                        resolveValues[i].promise().progress(updateFunc(i, progressContexts, progressValues)).done(updateFunc(i, resolveContexts, resolveValues)).fail(deferred.reject)
                    } else {
                        --remaining
                    }
                }
            }
            if (!remaining) {
                deferred.resolveWith(resolveContexts, resolveValues)
            }
            return deferred.promise()
        }
    });
    var readyList;
    jQuery.fn.ready = function(fn) {
        jQuery.ready.promise().done(fn);
        return this
    };
    jQuery.extend({
        isReady: false,
        readyWait: 1,
        holdReady: function(hold) {
            if (hold) {
                jQuery.readyWait++
            } else {
                jQuery.ready(true)
            }
        },
        ready: function(wait) {
            if (wait === true ? --jQuery.readyWait : jQuery.isReady) {
                return
            }
            jQuery.isReady = true;
            if (wait !== true && --jQuery.readyWait > 0) {
                return
            }
            readyList.resolveWith(document, [jQuery]);
            if (jQuery.fn.triggerHandler) {
                jQuery(document).triggerHandler("ready");
                jQuery(document).off("ready")
            }
        }
    });

    function completed() {
        document.removeEventListener("DOMContentLoaded", completed);
        window.removeEventListener("load", completed);
        jQuery.ready()
    }
    jQuery.ready.promise = function(obj) {
        if (!readyList) {
            readyList = jQuery.Deferred();
            if (document.readyState === "complete" || document.readyState !== "loading" && !document.documentElement.doScroll) {
                window.setTimeout(jQuery.ready)
            } else {
                document.addEventListener("DOMContentLoaded", completed);
                window.addEventListener("load", completed)
            }
        }
        return readyList.promise(obj)
    };
    jQuery.ready.promise();
    var access = function(elems, fn, key, value, chainable, emptyGet, raw) {
        var i = 0,
            len = elems.length,
            bulk = key == null;
        if (jQuery.type(key) === "object") {
            chainable = true;
            for (i in key) {
                access(elems, fn, i, key[i], true, emptyGet, raw)
            }
        } else if (value !== undefined) {
            chainable = true;
            if (!jQuery.isFunction(value)) {
                raw = true
            }
            if (bulk) {
                if (raw) {
                    fn.call(elems, value);
                    fn = null
                } else {
                    bulk = fn;
                    fn = function(elem, key, value) {
                        return bulk.call(jQuery(elem), value)
                    }
                }
            }
            if (fn) {
                for (; i < len; i++) {
                    fn(elems[i], key, raw ? value : value.call(elems[i], i, fn(elems[i], key)))
                }
            }
        }
        return chainable ? elems : bulk ? fn.call(elems) : len ? fn(elems[0], key) : emptyGet
    };
    var acceptData = function(owner) {
        return owner.nodeType === 1 || owner.nodeType === 9 || !+owner.nodeType
    };

    function Data() {
        this.expando = jQuery.expando + Data.uid++
    }
    Data.uid = 1;
    Data.prototype = {
        register: function(owner, initial) {
            var value = initial || {};
            if (owner.nodeType) {
                owner[this.expando] = value
            } else {
                Object.defineProperty(owner, this.expando, {
                    value: value,
                    writable: true,
                    configurable: true
                })
            }
            return owner[this.expando]
        },
        cache: function(owner) {
            if (!acceptData(owner)) {
                return {}
            }
            var value = owner[this.expando];
            if (!value) {
                value = {};
                if (acceptData(owner)) {
                    if (owner.nodeType) {
                        owner[this.expando] = value
                    } else {
                        Object.defineProperty(owner, this.expando, {
                            value: value,
                            configurable: true
                        })
                    }
                }
            }
            return value
        },
        set: function(owner, data, value) {
            var prop, cache = this.cache(owner);
            if (typeof data === "string") {
                cache[data] = value
            } else {
                for (prop in data) {
                    cache[prop] = data[prop]
                }
            }
            return cache
        },
        get: function(owner, key) {
            return key === undefined ? this.cache(owner) : owner[this.expando] && owner[this.expando][key]
        },
        access: function(owner, key, value) {
            var stored;
            if (key === undefined || key && typeof key === "string" && value === undefined) {
                stored = this.get(owner, key);
                return stored !== undefined ? stored : this.get(owner, jQuery.camelCase(key))
            }
            this.set(owner, key, value);
            return value !== undefined ? value : key
        },
        remove: function(owner, key) {
            var i, name, camel, cache = owner[this.expando];
            if (cache === undefined) {
                return
            }
            if (key === undefined) {
                this.register(owner)
            } else {
                if (jQuery.isArray(key)) {
                    name = key.concat(key.map(jQuery.camelCase))
                } else {
                    camel = jQuery.camelCase(key);
                    if (key in cache) {
                        name = [key, camel]
                    } else {
                        name = camel;
                        name = name in cache ? [name] : name.match(rnotwhite) || []
                    }
                }
                i = name.length;
                while (i--) {
                    delete cache[name[i]]
                }
            }
            if (key === undefined || jQuery.isEmptyObject(cache)) {
                if (owner.nodeType) {
                    owner[this.expando] = undefined
                } else {
                    delete owner[this.expando]
                }
            }
        },
        hasData: function(owner) {
            var cache = owner[this.expando];
            return cache !== undefined && !jQuery.isEmptyObject(cache)
        }
    };
    var dataPriv = new Data;
    var dataUser = new Data;
    var rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
        rmultiDash = /[A-Z]/g;

    function dataAttr(elem, key, data) {
        var name;
        if (data === undefined && elem.nodeType === 1) {
            name = "data-" + key.replace(rmultiDash, "-$&").toLowerCase();
            data = elem.getAttribute(name);
            if (typeof data === "string") {
                try {
                    data = data === "true" ? true : data === "false" ? false : data === "null" ? null : +data + "" === data ? +data : rbrace.test(data) ? jQuery.parseJSON(data) : data
                } catch (e) {}
                dataUser.set(elem, key, data)
            } else {
                data = undefined
            }
        }
        return data
    }
    jQuery.extend({
        hasData: function(elem) {
            return dataUser.hasData(elem) || dataPriv.hasData(elem)
        },
        data: function(elem, name, data) {
            return dataUser.access(elem, name, data)
        },
        removeData: function(elem, name) {
            dataUser.remove(elem, name)
        },
        _data: function(elem, name, data) {
            return dataPriv.access(elem, name, data)
        },
        _removeData: function(elem, name) {
            dataPriv.remove(elem, name)
        }
    });
    jQuery.fn.extend({
        data: function(key, value) {
            var i, name, data, elem = this[0],
                attrs = elem && elem.attributes;
            if (key === undefined) {
                if (this.length) {
                    data = dataUser.get(elem);
                    if (elem.nodeType === 1 && !dataPriv.get(elem, "hasDataAttrs")) {
                        i = attrs.length;
                        while (i--) {
                            if (attrs[i]) {
                                name = attrs[i].name;
                                if (name.indexOf("data-") === 0) {
                                    name = jQuery.camelCase(name.slice(5));
                                    dataAttr(elem, name, data[name])
                                }
                            }
                        }
                        dataPriv.set(elem, "hasDataAttrs", true)
                    }
                }
                return data
            }
            if (typeof key === "object") {
                return this.each(function() {
                    dataUser.set(this, key)
                })
            }
            return access(this, function(value) {
                var data, camelKey;
                if (elem && value === undefined) {
                    data = dataUser.get(elem, key) || dataUser.get(elem, key.replace(rmultiDash, "-$&").toLowerCase());
                    if (data !== undefined) {
                        return data
                    }
                    camelKey = jQuery.camelCase(key);
                    data = dataUser.get(elem, camelKey);
                    if (data !== undefined) {
                        return data
                    }
                    data = dataAttr(elem, camelKey, undefined);
                    if (data !== undefined) {
                        return data
                    }
                    return
                }
                camelKey = jQuery.camelCase(key);
                this.each(function() {
                    var data = dataUser.get(this, camelKey);
                    dataUser.set(this, camelKey, value);
                    if (key.indexOf("-") > -1 && data !== undefined) {
                        dataUser.set(this, key, value)
                    }
                })
            }, null, value, arguments.length > 1, null, true)
        },
        removeData: function(key) {
            return this.each(function() {
                dataUser.remove(this, key)
            })
        }
    });
    jQuery.extend({
        queue: function(elem, type, data) {
            var queue;
            if (elem) {
                type = (type || "fx") + "queue";
                queue = dataPriv.get(elem, type);
                if (data) {
                    if (!queue || jQuery.isArray(data)) {
                        queue = dataPriv.access(elem, type, jQuery.makeArray(data))
                    } else {
                        queue.push(data)
                    }
                }
                return queue || []
            }
        },
        dequeue: function(elem, type) {
            type = type || "fx";
            var queue = jQuery.queue(elem, type),
                startLength = queue.length,
                fn = queue.shift(),
                hooks = jQuery._queueHooks(elem, type),
                next = function() {
                    jQuery.dequeue(elem, type)
                };
            if (fn === "inprogress") {
                fn = queue.shift();
                startLength--
            }
            if (fn) {
                if (type === "fx") {
                    queue.unshift("inprogress")
                }
                delete hooks.stop;
                fn.call(elem, next, hooks)
            }
            if (!startLength && hooks) {
                hooks.empty.fire()
            }
        },
        _queueHooks: function(elem, type) {
            var key = type + "queueHooks";
            return dataPriv.get(elem, key) || dataPriv.access(elem, key, {
                empty: jQuery.Callbacks("once memory").add(function() {
                    dataPriv.remove(elem, [type + "queue", key])
                })
            })
        }
    });
    jQuery.fn.extend({
        queue: function(type, data) {
            var setter = 2;
            if (typeof type !== "string") {
                data = type;
                type = "fx";
                setter--
            }
            if (arguments.length < setter) {
                return jQuery.queue(this[0], type)
            }
            return data === undefined ? this : this.each(function() {
                var queue = jQuery.queue(this, type, data);
                jQuery._queueHooks(this, type);
                if (type === "fx" && queue[0] !== "inprogress") {
                    jQuery.dequeue(this, type)
                }
            })
        },
        dequeue: function(type) {
            return this.each(function() {
                jQuery.dequeue(this, type)
            })
        },
        clearQueue: function(type) {
            return this.queue(type || "fx", [])
        },
        promise: function(type, obj) {
            var tmp, count = 1,
                defer = jQuery.Deferred(),
                elements = this,
                i = this.length,
                resolve = function() {
                    if (!--count) {
                        defer.resolveWith(elements, [elements])
                    }
                };
            if (typeof type !== "string") {
                obj = type;
                type = undefined
            }
            type = type || "fx";
            while (i--) {
                tmp = dataPriv.get(elements[i], type + "queueHooks");
                if (tmp && tmp.empty) {
                    count++;
                    tmp.empty.add(resolve)
                }
            }
            resolve();
            return defer.promise(obj)
        }
    });
    var pnum = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;
    var rcssNum = new RegExp("^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i");
    var cssExpand = ["Top", "Right", "Bottom", "Left"];
    var isHidden = function(elem, el) {
        elem = el || elem;
        return jQuery.css(elem, "display") === "none" || !jQuery.contains(elem.ownerDocument, elem)
    };

    function adjustCSS(elem, prop, valueParts, tween) {
        var adjusted, scale = 1,
            maxIterations = 20,
            currentValue = tween ? function() {
                return tween.cur()
            } : function() {
                return jQuery.css(elem, prop, "")
            },
            initial = currentValue(),
            unit = valueParts && valueParts[3] || (jQuery.cssNumber[prop] ? "" : "px"),
            initialInUnit = (jQuery.cssNumber[prop] || unit !== "px" && +initial) && rcssNum.exec(jQuery.css(elem, prop));
        if (initialInUnit && initialInUnit[3] !== unit) {
            unit = unit || initialInUnit[3];
            valueParts = valueParts || [];
            initialInUnit = +initial || 1;
            do {
                scale = scale || ".5";
                initialInUnit = initialInUnit / scale;
                jQuery.style(elem, prop, initialInUnit + unit)
            } while (scale !== (scale = currentValue() / initial) && scale !== 1 && --maxIterations)
        }
        if (valueParts) {
            initialInUnit = +initialInUnit || +initial || 0;
            adjusted = valueParts[1] ? initialInUnit + (valueParts[1] + 1) * valueParts[2] : +valueParts[2];
            if (tween) {
                tween.unit = unit;
                tween.start = initialInUnit;
                tween.end = adjusted
            }
        }
        return adjusted
    }
    var rcheckableType = /^(?:checkbox|radio)$/i;
    var rtagName = /<([\w:-]+)/;
    var rscriptType = /^$|\/(?:java|ecma)script/i;
    var wrapMap = {
        option: [1, "<select multiple='multiple'>", "</select>"],
        thead: [1, "<table>", "</table>"],
        col: [2, "<table><colgroup>", "</colgroup></table>"],
        tr: [2, "<table><tbody>", "</tbody></table>"],
        td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
        _default: [0, "", ""]
    };
    wrapMap.optgroup = wrapMap.option;
    wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
    wrapMap.th = wrapMap.td;

    function getAll(context, tag) {
        var ret = typeof context.getElementsByTagName !== "undefined" ? context.getElementsByTagName(tag || "*") : typeof context.querySelectorAll !== "undefined" ? context.querySelectorAll(tag || "*") : [];
        return tag === undefined || tag && jQuery.nodeName(context, tag) ? jQuery.merge([context], ret) : ret
    }

    function setGlobalEval(elems, refElements) {
        var i = 0,
            l = elems.length;
        for (; i < l; i++) {
            dataPriv.set(elems[i], "globalEval", !refElements || dataPriv.get(refElements[i], "globalEval"))
        }
    }
    var rhtml = /<|&#?\w+;/;

    function buildFragment(elems, context, scripts, selection, ignored) {
        var elem, tmp, tag, wrap, contains, j, fragment = context.createDocumentFragment(),
            nodes = [],
            i = 0,
            l = elems.length;
        for (; i < l; i++) {
            elem = elems[i];
            if (elem || elem === 0) {
                if (jQuery.type(elem) === "object") {
                    jQuery.merge(nodes, elem.nodeType ? [elem] : elem)
                } else if (!rhtml.test(elem)) {
                    nodes.push(context.createTextNode(elem))
                } else {
                    tmp = tmp || fragment.appendChild(context.createElement("div"));
                    tag = (rtagName.exec(elem) || ["", ""])[1].toLowerCase();
                    wrap = wrapMap[tag] || wrapMap._default;
                    tmp.innerHTML = wrap[1] + jQuery.htmlPrefilter(elem) + wrap[2];
                    j = wrap[0];
                    while (j--) {
                        tmp = tmp.lastChild
                    }
                    jQuery.merge(nodes, tmp.childNodes);
                    tmp = fragment.firstChild;
                    tmp.textContent = ""
                }
            }
        }
        fragment.textContent = "";
        i = 0;
        while (elem = nodes[i++]) {
            if (selection && jQuery.inArray(elem, selection) > -1) {
                if (ignored) {
                    ignored.push(elem)
                }
                continue
            }
            contains = jQuery.contains(elem.ownerDocument, elem);
            tmp = getAll(fragment.appendChild(elem), "script");
            if (contains) {
                setGlobalEval(tmp)
            }
            if (scripts) {
                j = 0;
                while (elem = tmp[j++]) {
                    if (rscriptType.test(elem.type || "")) {
                        scripts.push(elem)
                    }
                }
            }
        }
        return fragment
    }(function() {
        var fragment = document.createDocumentFragment(),
            div = fragment.appendChild(document.createElement("div")),
            input = document.createElement("input");
        input.setAttribute("type", "radio");
        input.setAttribute("checked", "checked");
        input.setAttribute("name", "t");
        div.appendChild(input);
        support.checkClone = div.cloneNode(true).cloneNode(true).lastChild.checked;
        div.innerHTML = "<textarea>x</textarea>";
        support.noCloneChecked = !!div.cloneNode(true).lastChild.defaultValue
    })();
    var rkeyEvent = /^key/,
        rmouseEvent = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
        rtypenamespace = /^([^.]*)(?:\.(.+)|)/;

    function returnTrue() {
        return true
    }

    function returnFalse() {
        return false
    }

    function safeActiveElement() {
        try {
            return document.activeElement
        } catch (err) {}
    }

    function on(elem, types, selector, data, fn, one) {
        var origFn, type;
        if (typeof types === "object") {
            if (typeof selector !== "string") {
                data = data || selector;
                selector = undefined
            }
            for (type in types) {
                on(elem, type, selector, data, types[type], one)
            }
            return elem
        }
        if (data == null && fn == null) {
            fn = selector;
            data = selector = undefined
        } else if (fn == null) {
            if (typeof selector === "string") {
                fn = data;
                data = undefined
            } else {
                fn = data;
                data = selector;
                selector = undefined
            }
        }
        if (fn === false) {
            fn = returnFalse
        } else if (!fn) {
            return elem
        }
        if (one === 1) {
            origFn = fn;
            fn = function(event) {
                jQuery().off(event);
                return origFn.apply(this, arguments)
            };
            fn.guid = origFn.guid || (origFn.guid = jQuery.guid++)
        }
        return elem.each(function() {
            jQuery.event.add(this, types, fn, data, selector)
        })
    }
    jQuery.event = {
        global: {},
        add: function(elem, types, handler, data, selector) {
            var handleObjIn, eventHandle, tmp, events, t, handleObj, special, handlers, type, namespaces, origType, elemData = dataPriv.get(elem);
            if (!elemData) {
                return
            }
            if (handler.handler) {
                handleObjIn = handler;
                handler = handleObjIn.handler;
                selector = handleObjIn.selector
            }
            if (!handler.guid) {
                handler.guid = jQuery.guid++
            }
            if (!(events = elemData.events)) {
                events = elemData.events = {}
            }
            if (!(eventHandle = elemData.handle)) {
                eventHandle = elemData.handle = function(e) {
                    return typeof jQuery !== "undefined" && jQuery.event.triggered !== e.type ? jQuery.event.dispatch.apply(elem, arguments) : undefined
                }
            }
            types = (types || "").match(rnotwhite) || [""];
            t = types.length;
            while (t--) {
                tmp = rtypenamespace.exec(types[t]) || [];
                type = origType = tmp[1];
                namespaces = (tmp[2] || "").split(".").sort();
                if (!type) {
                    continue
                }
                special = jQuery.event.special[type] || {};
                type = (selector ? special.delegateType : special.bindType) || type;
                special = jQuery.event.special[type] || {};
                handleObj = jQuery.extend({
                    type: type,
                    origType: origType,
                    data: data,
                    handler: handler,
                    guid: handler.guid,
                    selector: selector,
                    needsContext: selector && jQuery.expr.match.needsContext.test(selector),
                    namespace: namespaces.join(".")
                }, handleObjIn);
                if (!(handlers = events[type])) {
                    handlers = events[type] = [];
                    handlers.delegateCount = 0;
                    if (!special.setup || special.setup.call(elem, data, namespaces, eventHandle) === false) {
                        if (elem.addEventListener) {
                            elem.addEventListener(type, eventHandle)
                        }
                    }
                }
                if (special.add) {
                    special.add.call(elem, handleObj);
                    if (!handleObj.handler.guid) {
                        handleObj.handler.guid = handler.guid
                    }
                }
                if (selector) {
                    handlers.splice(handlers.delegateCount++, 0, handleObj)
                } else {
                    handlers.push(handleObj)
                }
                jQuery.event.global[type] = true
            }
        },
        remove: function(elem, types, handler, selector, mappedTypes) {
            var j, origCount, tmp, events, t, handleObj, special, handlers, type, namespaces, origType, elemData = dataPriv.hasData(elem) && dataPriv.get(elem);
            if (!elemData || !(events = elemData.events)) {
                return
            }
            types = (types || "").match(rnotwhite) || [""];
            t = types.length;
            while (t--) {
                tmp = rtypenamespace.exec(types[t]) || [];
                type = origType = tmp[1];
                namespaces = (tmp[2] || "").split(".").sort();
                if (!type) {
                    for (type in events) {
                        jQuery.event.remove(elem, type + types[t], handler, selector, true)
                    }
                    continue
                }
                special = jQuery.event.special[type] || {};
                type = (selector ? special.delegateType : special.bindType) || type;
                handlers = events[type] || [];
                tmp = tmp[2] && new RegExp("(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)");
                origCount = j = handlers.length;
                while (j--) {
                    handleObj = handlers[j];
                    if ((mappedTypes || origType === handleObj.origType) && (!handler || handler.guid === handleObj.guid) && (!tmp || tmp.test(handleObj.namespace)) && (!selector || selector === handleObj.selector || selector === "**" && handleObj.selector)) {
                        handlers.splice(j, 1);
                        if (handleObj.selector) {
                            handlers.delegateCount--
                        }
                        if (special.remove) {
                            special.remove.call(elem, handleObj)
                        }
                    }
                }
                if (origCount && !handlers.length) {
                    if (!special.teardown || special.teardown.call(elem, namespaces, elemData.handle) === false) {
                        jQuery.removeEvent(elem, type, elemData.handle)
                    }
                    delete events[type]
                }
            }
            if (jQuery.isEmptyObject(events)) {
                dataPriv.remove(elem, "handle events")
            }
        },
        dispatch: function(event) {
            event = jQuery.event.fix(event);
            var i, j, ret, matched, handleObj, handlerQueue = [],
                args = slice.call(arguments),
                handlers = (dataPriv.get(this, "events") || {})[event.type] || [],
                special = jQuery.event.special[event.type] || {};
            args[0] = event;
            event.delegateTarget = this;
            if (special.preDispatch && special.preDispatch.call(this, event) === false) {
                return
            }
            handlerQueue = jQuery.event.handlers.call(this, event, handlers);
            i = 0;
            while ((matched = handlerQueue[i++]) && !event.isPropagationStopped()) {
                event.currentTarget = matched.elem;
                j = 0;
                while ((handleObj = matched.handlers[j++]) && !event.isImmediatePropagationStopped()) {
                    if (!event.rnamespace || event.rnamespace.test(handleObj.namespace)) {
                        event.handleObj = handleObj;
                        event.data = handleObj.data;
                        ret = ((jQuery.event.special[handleObj.origType] || {}).handle || handleObj.handler).apply(matched.elem, args);
                        if (ret !== undefined) {
                            if ((event.result = ret) === false) {
                                event.preventDefault();
                                event.stopPropagation()
                            }
                        }
                    }
                }
            }
            if (special.postDispatch) {
                special.postDispatch.call(this, event)
            }
            return event.result
        },
        handlers: function(event, handlers) {
            var i, matches, sel, handleObj, handlerQueue = [],
                delegateCount = handlers.delegateCount,
                cur = event.target;
            if (delegateCount && cur.nodeType && (event.type !== "click" || isNaN(event.button) || event.button < 1)) {
                for (; cur !== this; cur = cur.parentNode || this) {
                    if (cur.nodeType === 1 && (cur.disabled !== true || event.type !== "click")) {
                        matches = [];
                        for (i = 0; i < delegateCount; i++) {
                            handleObj = handlers[i];
                            sel = handleObj.selector + " ";
                            if (matches[sel] === undefined) {
                                matches[sel] = handleObj.needsContext ? jQuery(sel, this).index(cur) > -1 : jQuery.find(sel, this, null, [cur]).length
                            }
                            if (matches[sel]) {
                                matches.push(handleObj)
                            }
                        }
                        if (matches.length) {
                            handlerQueue.push({
                                elem: cur,
                                handlers: matches
                            })
                        }
                    }
                }
            }
            if (delegateCount < handlers.length) {
                handlerQueue.push({
                    elem: this,
                    handlers: handlers.slice(delegateCount)
                })
            }
            return handlerQueue
        },
        props: ("altKey bubbles cancelable ctrlKey currentTarget detail eventPhase " + "metaKey relatedTarget shiftKey target timeStamp view which").split(" "),
        fixHooks: {},
        keyHooks: {
            props: "char charCode key keyCode".split(" "),
            filter: function(event, original) {
                if (event.which == null) {
                    event.which = original.charCode != null ? original.charCode : original.keyCode
                }
                return event
            }
        },
        mouseHooks: {
            props: ("button buttons clientX clientY offsetX offsetY pageX pageY " + "screenX screenY toElement").split(" "),
            filter: function(event, original) {
                var eventDoc, doc, body, button = original.button;
                if (event.pageX == null && original.clientX != null) {
                    eventDoc = event.target.ownerDocument || document;
                    doc = eventDoc.documentElement;
                    body = eventDoc.body;
                    event.pageX = original.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);
                    event.pageY = original.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0)
                }
                if (!event.which && button !== undefined) {
                    event.which = button & 1 ? 1 : button & 2 ? 3 : button & 4 ? 2 : 0
                }
                return event
            }
        },
        fix: function(event) {
            if (event[jQuery.expando]) {
                return event
            }
            var i, prop, copy, type = event.type,
                originalEvent = event,
                fixHook = this.fixHooks[type];
            if (!fixHook) {
                this.fixHooks[type] = fixHook = rmouseEvent.test(type) ? this.mouseHooks : rkeyEvent.test(type) ? this.keyHooks : {}
            }
            copy = fixHook.props ? this.props.concat(fixHook.props) : this.props;
            event = new jQuery.Event(originalEvent);
            i = copy.length;
            while (i--) {
                prop = copy[i];
                event[prop] = originalEvent[prop]
            }
            if (!event.target) {
                event.target = document
            }
            if (event.target.nodeType === 3) {
                event.target = event.target.parentNode
            }
            return fixHook.filter ? fixHook.filter(event, originalEvent) : event
        },
        special: {
            load: {
                noBubble: true
            },
            focus: {
                trigger: function() {
                    if (this !== safeActiveElement() && this.focus) {
                        this.focus();
                        return false
                    }
                },
                delegateType: "focusin"
            },
            blur: {
                trigger: function() {
                    if (this === safeActiveElement() && this.blur) {
                        this.blur();
                        return false
                    }
                },
                delegateType: "focusout"
            },
            click: {
                trigger: function() {
                    if (this.type === "checkbox" && this.click && jQuery.nodeName(this, "input")) {
                        this.click();
                        return false
                    }
                },
                _default: function(event) {
                    return jQuery.nodeName(event.target, "a")
                }
            },
            beforeunload: {
                postDispatch: function(event) {
                    if (event.result !== undefined && event.originalEvent) {
                        event.originalEvent.returnValue = event.result
                    }
                }
            }
        }
    };
    jQuery.removeEvent = function(elem, type, handle) {
        if (elem.removeEventListener) {
            elem.removeEventListener(type, handle)
        }
    };
    jQuery.Event = function(src, props) {
        if (!(this instanceof jQuery.Event)) {
            return new jQuery.Event(src, props)
        }
        if (src && src.type) {
            this.originalEvent = src;
            this.type = src.type;
            this.isDefaultPrevented = src.defaultPrevented || src.defaultPrevented === undefined && src.returnValue === false ? returnTrue : returnFalse
        } else {
            this.type = src
        }
        if (props) {
            jQuery.extend(this, props)
        }
        this.timeStamp = src && src.timeStamp || jQuery.now();
        this[jQuery.expando] = true
    };
    jQuery.Event.prototype = {
        constructor: jQuery.Event,
        isDefaultPrevented: returnFalse,
        isPropagationStopped: returnFalse,
        isImmediatePropagationStopped: returnFalse,
        isSimulated: false,
        preventDefault: function() {
            var e = this.originalEvent;
            this.isDefaultPrevented = returnTrue;
            if (e && !this.isSimulated) {
                e.preventDefault()
            }
        },
        stopPropagation: function() {
            var e = this.originalEvent;
            this.isPropagationStopped = returnTrue;
            if (e && !this.isSimulated) {
                e.stopPropagation()
            }
        },
        stopImmediatePropagation: function() {
            var e = this.originalEvent;
            this.isImmediatePropagationStopped = returnTrue;
            if (e && !this.isSimulated) {
                e.stopImmediatePropagation()
            }
            this.stopPropagation()
        }
    };
    jQuery.each({
        mouseenter: "mouseover",
        mouseleave: "mouseout",
        pointerenter: "pointerover",
        pointerleave: "pointerout"
    }, function(orig, fix) {
        jQuery.event.special[orig] = {
            delegateType: fix,
            bindType: fix,
            handle: function(event) {
                var ret, target = this,
                    related = event.relatedTarget,
                    handleObj = event.handleObj;
                if (!related || related !== target && !jQuery.contains(target, related)) {
                    event.type = handleObj.origType;
                    ret = handleObj.handler.apply(this, arguments);
                    event.type = fix
                }
                return ret
            }
        }
    });
    jQuery.fn.extend({
        on: function(types, selector, data, fn) {
            return on(this, types, selector, data, fn)
        },
        one: function(types, selector, data, fn) {
            return on(this, types, selector, data, fn, 1)
        },
        off: function(types, selector, fn) {
            var handleObj, type;
            if (types && types.preventDefault && types.handleObj) {
                handleObj = types.handleObj;
                jQuery(types.delegateTarget).off(handleObj.namespace ? handleObj.origType + "." + handleObj.namespace : handleObj.origType, handleObj.selector, handleObj.handler);
                return this
            }
            if (typeof types === "object") {
                for (type in types) {
                    this.off(type, selector, types[type])
                }
                return this
            }
            if (selector === false || typeof selector === "function") {
                fn = selector;
                selector = undefined
            }
            if (fn === false) {
                fn = returnFalse
            }
            return this.each(function() {
                jQuery.event.remove(this, types, fn, selector)
            })
        }
    });
    var rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,
        rnoInnerhtml = /<script|<style|<link/i,
        rchecked = /checked\s*(?:[^=]|=\s*.checked.)/i,
        rscriptTypeMasked = /^true\/(.*)/,
        rcleanScript = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;

    function manipulationTarget(elem, content) {
        return jQuery.nodeName(elem, "table") && jQuery.nodeName(content.nodeType !== 11 ? content : content.firstChild, "tr") ? elem.getElementsByTagName("tbody")[0] || elem.appendChild(elem.ownerDocument.createElement("tbody")) : elem
    }

    function disableScript(elem) {
        elem.type = (elem.getAttribute("type") !== null) + "/" + elem.type;
        return elem
    }

    function restoreScript(elem) {
        var match = rscriptTypeMasked.exec(elem.type);
        if (match) {
            elem.type = match[1]
        } else {
            elem.removeAttribute("type")
        }
        return elem
    }

    function cloneCopyEvent(src, dest) {
        var i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;
        if (dest.nodeType !== 1) {
            return
        }
        if (dataPriv.hasData(src)) {
            pdataOld = dataPriv.access(src);
            pdataCur = dataPriv.set(dest, pdataOld);
            events = pdataOld.events;
            if (events) {
                delete pdataCur.handle;
                pdataCur.events = {};
                for (type in events) {
                    for (i = 0, l = events[type].length; i < l; i++) {
                        jQuery.event.add(dest, type, events[type][i])
                    }
                }
            }
        }
        if (dataUser.hasData(src)) {
            udataOld = dataUser.access(src);
            udataCur = jQuery.extend({}, udataOld);
            dataUser.set(dest, udataCur)
        }
    }

    function fixInput(src, dest) {
        var nodeName = dest.nodeName.toLowerCase();
        if (nodeName === "input" && rcheckableType.test(src.type)) {
            dest.checked = src.checked
        } else if (nodeName === "input" || nodeName === "textarea") {
            dest.defaultValue = src.defaultValue
        }
    }

    function domManip(collection, args, callback, ignored) {
        args = concat.apply([], args);
        var fragment, first, scripts, hasScripts, node, doc, i = 0,
            l = collection.length,
            iNoClone = l - 1,
            value = args[0],
            isFunction = jQuery.isFunction(value);
        if (isFunction || l > 1 && typeof value === "string" && !support.checkClone && rchecked.test(value)) {
            return collection.each(function(index) {
                var self = collection.eq(index);
                if (isFunction) {
                    args[0] = value.call(this, index, self.html())
                }
                domManip(self, args, callback, ignored)
            })
        }
        if (l) {
            fragment = buildFragment(args, collection[0].ownerDocument, false, collection, ignored);
            first = fragment.firstChild;
            if (fragment.childNodes.length === 1) {
                fragment = first
            }
            if (first || ignored) {
                scripts = jQuery.map(getAll(fragment, "script"), disableScript);
                hasScripts = scripts.length;
                for (; i < l; i++) {
                    node = fragment;
                    if (i !== iNoClone) {
                        node = jQuery.clone(node, true, true);
                        if (hasScripts) {
                            jQuery.merge(scripts, getAll(node, "script"))
                        }
                    }
                    callback.call(collection[i], node, i)
                }
                if (hasScripts) {
                    doc = scripts[scripts.length - 1].ownerDocument;
                    jQuery.map(scripts, restoreScript);
                    for (i = 0; i < hasScripts; i++) {
                        node = scripts[i];
                        if (rscriptType.test(node.type || "") && !dataPriv.access(node, "globalEval") && jQuery.contains(doc, node)) {
                            if (node.src) {
                                if (jQuery._evalUrl) {
                                    jQuery._evalUrl(node.src)
                                }
                            } else {
                                jQuery.globalEval(node.textContent.replace(rcleanScript, ""))
                            }
                        }
                    }
                }
            }
        }
        return collection
    }

    function remove(elem, selector, keepData) {
        var node, nodes = selector ? jQuery.filter(selector, elem) : elem,
            i = 0;
        for (;
            (node = nodes[i]) != null; i++) {
            if (!keepData && node.nodeType === 1) {
                jQuery.cleanData(getAll(node))
            }
            if (node.parentNode) {
                if (keepData && jQuery.contains(node.ownerDocument, node)) {
                    setGlobalEval(getAll(node, "script"))
                }
                node.parentNode.removeChild(node)
            }
        }
        return elem
    }
    jQuery.extend({
        htmlPrefilter: function(html) {
            return html.replace(rxhtmlTag, "<$1></$2>")
        },
        clone: function(elem, dataAndEvents, deepDataAndEvents) {
            var i, l, srcElements, destElements, clone = elem.cloneNode(true),
                inPage = jQuery.contains(elem.ownerDocument, elem);
            if (!support.noCloneChecked && (elem.nodeType === 1 || elem.nodeType === 11) && !jQuery.isXMLDoc(elem)) {
                destElements = getAll(clone);
                srcElements = getAll(elem);
                for (i = 0, l = srcElements.length; i < l; i++) {
                    fixInput(srcElements[i], destElements[i])
                }
            }
            if (dataAndEvents) {
                if (deepDataAndEvents) {
                    srcElements = srcElements || getAll(elem);
                    destElements = destElements || getAll(clone);
                    for (i = 0, l = srcElements.length; i < l; i++) {
                        cloneCopyEvent(srcElements[i], destElements[i])
                    }
                } else {
                    cloneCopyEvent(elem, clone)
                }
            }
            destElements = getAll(clone, "script");
            if (destElements.length > 0) {
                setGlobalEval(destElements, !inPage && getAll(elem, "script"))
            }
            return clone
        },
        cleanData: function(elems) {
            var data, elem, type, special = jQuery.event.special,
                i = 0;
            for (;
                (elem = elems[i]) !== undefined; i++) {
                if (acceptData(elem)) {
                    if (data = elem[dataPriv.expando]) {
                        if (data.events) {
                            for (type in data.events) {
                                if (special[type]) {
                                    jQuery.event.remove(elem, type)
                                } else {
                                    jQuery.removeEvent(elem, type, data.handle)
                                }
                            }
                        }
                        elem[dataPriv.expando] = undefined
                    }
                    if (elem[dataUser.expando]) {
                        elem[dataUser.expando] = undefined
                    }
                }
            }
        }
    });
    jQuery.fn.extend({
        domManip: domManip,
        detach: function(selector) {
            return remove(this, selector, true)
        },
        remove: function(selector) {
            return remove(this, selector)
        },
        text: function(value) {
            return access(this, function(value) {
                return value === undefined ? jQuery.text(this) : this.empty().each(function() {
                    if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
                        this.textContent = value
                    }
                })
            }, null, value, arguments.length)
        },
        append: function() {
            return domManip(this, arguments, function(elem) {
                if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
                    var target = manipulationTarget(this, elem);
                    target.appendChild(elem)
                }
            })
        },
        prepend: function() {
            return domManip(this, arguments, function(elem) {
                if (this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9) {
                    var target = manipulationTarget(this, elem);
                    target.insertBefore(elem, target.firstChild)
                }
            })
        },
        before: function() {
            return domManip(this, arguments, function(elem) {
                if (this.parentNode) {
                    this.parentNode.insertBefore(elem, this)
                }
            })
        },
        after: function() {
            return domManip(this, arguments, function(elem) {
                if (this.parentNode) {
                    this.parentNode.insertBefore(elem, this.nextSibling)
                }
            })
        },
        empty: function() {
            var elem, i = 0;
            for (;
                (elem = this[i]) != null; i++) {
                if (elem.nodeType === 1) {
                    jQuery.cleanData(getAll(elem, false));
                    elem.textContent = ""
                }
            }
            return this
        },
        clone: function(dataAndEvents, deepDataAndEvents) {
            dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
            deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;
            return this.map(function() {
                return jQuery.clone(this, dataAndEvents, deepDataAndEvents)
            })
        },
        html: function(value) {
            return access(this, function(value) {
                var elem = this[0] || {},
                    i = 0,
                    l = this.length;
                if (value === undefined && elem.nodeType === 1) {
                    return elem.innerHTML
                }
                if (typeof value === "string" && !rnoInnerhtml.test(value) && !wrapMap[(rtagName.exec(value) || ["", ""])[1].toLowerCase()]) {
                    value = jQuery.htmlPrefilter(value);
                    try {
                        for (; i < l; i++) {
                            elem = this[i] || {};
                            if (elem.nodeType === 1) {
                                jQuery.cleanData(getAll(elem, false));
                                elem.innerHTML = value
                            }
                        }
                        elem = 0
                    } catch (e) {}
                }
                if (elem) {
                    this.empty().append(value)
                }
            }, null, value, arguments.length)
        },
        replaceWith: function() {
            var ignored = [];
            return domManip(this, arguments, function(elem) {
                var parent = this.parentNode;
                if (jQuery.inArray(this, ignored) < 0) {
                    jQuery.cleanData(getAll(this));
                    if (parent) {
                        parent.replaceChild(elem, this)
                    }
                }
            }, ignored)
        }
    });
    jQuery.each({
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function(name, original) {
        jQuery.fn[name] = function(selector) {
            var elems, ret = [],
                insert = jQuery(selector),
                last = insert.length - 1,
                i = 0;
            for (; i <= last; i++) {
                elems = i === last ? this : this.clone(true);
                jQuery(insert[i])[original](elems);
                push.apply(ret, elems.get())
            }
            return this.pushStack(ret)
        }
    });
    var iframe, elemdisplay = {
        HTML: "block",
        BODY: "block"
    };

    function actualDisplay(name, doc) {
        var elem = jQuery(doc.createElement(name)).appendTo(doc.body),
            display = jQuery.css(elem[0], "display");
        elem.detach();
        return display
    }

    function defaultDisplay(nodeName) {
        var doc = document,
            display = elemdisplay[nodeName];
        if (!display) {
            display = actualDisplay(nodeName, doc);
            if (display === "none" || !display) {
                iframe = (iframe || jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);
                doc = iframe[0].contentDocument;
                doc.write();
                doc.close();
                display = actualDisplay(nodeName, doc);
                iframe.detach()
            }
            elemdisplay[nodeName] = display
        }
        return display
    }
    var rmargin = /^margin/;
    var rnumnonpx = new RegExp("^(" + pnum + ")(?!px)[a-z%]+$", "i");
    var getStyles = function(elem) {
        var view = elem.ownerDocument.defaultView;
        if (!view || !view.opener) {
            view = window
        }
        return view.getComputedStyle(elem)
    };
    var swap = function(elem, options, callback, args) {
        var ret, name, old = {};
        for (name in options) {
            old[name] = elem.style[name];
            elem.style[name] = options[name]
        }
        ret = callback.apply(elem, args || []);
        for (name in options) {
            elem.style[name] = old[name]
        }
        return ret
    };
    var documentElement = document.documentElement;
    (function() {
        var pixelPositionVal, boxSizingReliableVal, pixelMarginRightVal, reliableMarginLeftVal, container = document.createElement("div"),
            div = document.createElement("div");
        if (!div.style) {
            return
        }
        div.style.backgroundClip = "content-box";
        div.cloneNode(true).style.backgroundClip = "";
        support.clearCloneStyle = div.style.backgroundClip === "content-box";
        container.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;" + "padding:0;margin-top:1px;position:absolute";
        container.appendChild(div);

        function computeStyleTests() {
            div.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;" + "position:relative;display:block;" + "margin:auto;border:1px;padding:1px;" + "top:1%;width:50%";
            div.innerHTML = "";
            documentElement.appendChild(container);
            var divStyle = window.getComputedStyle(div);
            pixelPositionVal = divStyle.top !== "1%";
            reliableMarginLeftVal = divStyle.marginLeft === "2px";
            boxSizingReliableVal = divStyle.width === "4px";
            div.style.marginRight = "50%";
            pixelMarginRightVal = divStyle.marginRight === "4px";
            documentElement.removeChild(container)
        }
        jQuery.extend(support, {
            pixelPosition: function() {
                computeStyleTests();
                return pixelPositionVal
            },
            boxSizingReliable: function() {
                if (boxSizingReliableVal == null) {
                    computeStyleTests()
                }
                return boxSizingReliableVal
            },
            pixelMarginRight: function() {
                if (boxSizingReliableVal == null) {
                    computeStyleTests()
                }
                return pixelMarginRightVal
            },
            reliableMarginLeft: function() {
                if (boxSizingReliableVal == null) {
                    computeStyleTests()
                }
                return reliableMarginLeftVal
            },
            reliableMarginRight: function() {
                var ret, marginDiv = div.appendChild(document.createElement("div"));
                marginDiv.style.cssText = div.style.cssText = "-webkit-box-sizing:content-box;box-sizing:content-box;" + "display:block;margin:0;border:0;padding:0";
                marginDiv.style.marginRight = marginDiv.style.width = "0";
                div.style.width = "1px";
                documentElement.appendChild(container);
                ret = !parseFloat(window.getComputedStyle(marginDiv).marginRight);
                documentElement.removeChild(container);
                div.removeChild(marginDiv);
                return ret
            }
        })
    })();

    function curCSS(elem, name, computed) {
        var width, minWidth, maxWidth, ret, style = elem.style;
        computed = computed || getStyles(elem);
        ret = computed ? computed.getPropertyValue(name) || computed[name] : undefined;
        if ((ret === "" || ret === undefined) && !jQuery.contains(elem.ownerDocument, elem)) {
            ret = jQuery.style(elem, name)
        }
        if (computed) {
            if (!support.pixelMarginRight() && rnumnonpx.test(ret) && rmargin.test(name)) {
                width = style.width;
                minWidth = style.minWidth;
                maxWidth = style.maxWidth;
                style.minWidth = style.maxWidth = style.width = ret;
                ret = computed.width;
                style.width = width;
                style.minWidth = minWidth;
                style.maxWidth = maxWidth
            }
        }
        return ret !== undefined ? ret + "" : ret
    }

    function addGetHookIf(conditionFn, hookFn) {
        return {
            get: function() {
                if (conditionFn()) {
                    delete this.get;
                    return
                }
                return (this.get = hookFn).apply(this, arguments)
            }
        }
    }
    var rdisplayswap = /^(none|table(?!-c[ea]).+)/,
        cssShow = {
            position: "absolute",
            visibility: "hidden",
            display: "block"
        },
        cssNormalTransform = {
            letterSpacing: "0",
            fontWeight: "400"
        },
        cssPrefixes = ["Webkit", "O", "Moz", "ms"],
        emptyStyle = document.createElement("div").style;

    function vendorPropName(name) {
        if (name in emptyStyle) {
            return name
        }
        var capName = name[0].toUpperCase() + name.slice(1),
            i = cssPrefixes.length;
        while (i--) {
            name = cssPrefixes[i] + capName;
            if (name in emptyStyle) {
                return name
            }
        }
    }

    function setPositiveNumber(elem, value, subtract) {
        var matches = rcssNum.exec(value);
        return matches ? Math.max(0, matches[2] - (subtract || 0)) + (matches[3] || "px") : value
    }

    function augmentWidthOrHeight(elem, name, extra, isBorderBox, styles) {
        var i = extra === (isBorderBox ? "border" : "content") ? 4 : name === "width" ? 1 : 0,
            val = 0;
        for (; i < 4; i += 2) {
            if (extra === "margin") {
                val += jQuery.css(elem, extra + cssExpand[i], true, styles)
            }
            if (isBorderBox) {
                if (extra === "content") {
                    val -= jQuery.css(elem, "padding" + cssExpand[i], true, styles)
                }
                if (extra !== "margin") {
                    val -= jQuery.css(elem, "border" + cssExpand[i] + "Width", true, styles)
                }
            } else {
                val += jQuery.css(elem, "padding" + cssExpand[i], true, styles);
                if (extra !== "padding") {
                    val += jQuery.css(elem, "border" + cssExpand[i] + "Width", true, styles)
                }
            }
        }
        return val
    }

    function getWidthOrHeight(elem, name, extra) {
        var valueIsBorderBox = true,
            val = name === "width" ? elem.offsetWidth : elem.offsetHeight,
            styles = getStyles(elem),
            isBorderBox = jQuery.css(elem, "boxSizing", false, styles) === "border-box";
        if (val <= 0 || val == null) {
            val = curCSS(elem, name, styles);
            if (val < 0 || val == null) {
                val = elem.style[name]
            }
            if (rnumnonpx.test(val)) {
                return val
            }
            valueIsBorderBox = isBorderBox && (support.boxSizingReliable() || val === elem.style[name]);
            val = parseFloat(val) || 0
        }
        return val + augmentWidthOrHeight(elem, name, extra || (isBorderBox ? "border" : "content"), valueIsBorderBox, styles) + "px"
    }

    function showHide(elements, show) {
        var display, elem, hidden, values = [],
            index = 0,
            length = elements.length;
        for (; index < length; index++) {
            elem = elements[index];
            if (!elem.style) {
                continue
            }
            values[index] = dataPriv.get(elem, "olddisplay");
            display = elem.style.display;
            if (show) {
                if (!values[index] && display === "none") {
                    elem.style.display = ""
                }
                if (elem.style.display === "" && isHidden(elem)) {
                    values[index] = dataPriv.access(elem, "olddisplay", defaultDisplay(elem.nodeName))
                }
            } else {
                hidden = isHidden(elem);
                if (display !== "none" || !hidden) {
                    dataPriv.set(elem, "olddisplay", hidden ? display : jQuery.css(elem, "display"))
                }
            }
        }
        for (index = 0; index < length; index++) {
            elem = elements[index];
            if (!elem.style) {
                continue
            }
            if (!show || elem.style.display === "none" || elem.style.display === "") {
                elem.style.display = show ? values[index] || "" : "none"
            }
        }
        return elements
    }
    jQuery.extend({
        cssHooks: {
            opacity: {
                get: function(elem, computed) {
                    if (computed) {
                        var ret = curCSS(elem, "opacity");
                        return ret === "" ? "1" : ret
                    }
                }
            }
        },
        cssNumber: {
            animationIterationCount: true,
            columnCount: true,
            fillOpacity: true,
            flexGrow: true,
            flexShrink: true,
            fontWeight: true,
            lineHeight: true,
            opacity: true,
            order: true,
            orphans: true,
            widows: true,
            zIndex: true,
            zoom: true
        },
        cssProps: {
            float: "cssFloat"
        },
        style: function(elem, name, value, extra) {
            if (!elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style) {
                return
            }
            var ret, type, hooks, origName = jQuery.camelCase(name),
                style = elem.style;
            name = jQuery.cssProps[origName] || (jQuery.cssProps[origName] = vendorPropName(origName) || origName);
            hooks = jQuery.cssHooks[name] || jQuery.cssHooks[origName];
            if (value !== undefined) {
                type = typeof value;
                if (type === "string" && (ret = rcssNum.exec(value)) && ret[1]) {
                    value = adjustCSS(elem, name, ret);
                    type = "number"
                }
                if (value == null || value !== value) {
                    return
                }
                if (type === "number") {
                    value += ret && ret[3] || (jQuery.cssNumber[origName] ? "" : "px")
                }
                if (!support.clearCloneStyle && value === "" && name.indexOf("background") === 0) {
                    style[name] = "inherit"
                }
                if (!hooks || !("set" in hooks) || (value = hooks.set(elem, value, extra)) !== undefined) {
                    style[name] = value
                }
            } else {
                if (hooks && "get" in hooks && (ret = hooks.get(elem, false, extra)) !== undefined) {
                    return ret
                }
                return style[name]
            }
        },
        css: function(elem, name, extra, styles) {
            var val, num, hooks, origName = jQuery.camelCase(name);
            name = jQuery.cssProps[origName] || (jQuery.cssProps[origName] = vendorPropName(origName) || origName);
            hooks = jQuery.cssHooks[name] || jQuery.cssHooks[origName];
            if (hooks && "get" in hooks) {
                val = hooks.get(elem, true, extra)
            }
            if (val === undefined) {
                val = curCSS(elem, name, styles)
            }
            if (val === "normal" && name in cssNormalTransform) {
                val = cssNormalTransform[name]
            }
            if (extra === "" || extra) {
                num = parseFloat(val);
                return extra === true || isFinite(num) ? num || 0 : val
            }
            return val
        }
    });
    jQuery.each(["height", "width"], function(i, name) {
        jQuery.cssHooks[name] = {
            get: function(elem, computed, extra) {
                if (computed) {
                    return rdisplayswap.test(jQuery.css(elem, "display")) && elem.offsetWidth === 0 ? swap(elem, cssShow, function() {
                        return getWidthOrHeight(elem, name, extra)
                    }) : getWidthOrHeight(elem, name, extra)
                }
            },
            set: function(elem, value, extra) {
                var matches, styles = extra && getStyles(elem),
                    subtract = extra && augmentWidthOrHeight(elem, name, extra, jQuery.css(elem, "boxSizing", false, styles) === "border-box", styles);
                if (subtract && (matches = rcssNum.exec(value)) && (matches[3] || "px") !== "px") {
                    elem.style[name] = value;
                    value = jQuery.css(elem, name)
                }
                return setPositiveNumber(elem, value, subtract)
            }
        }
    });
    jQuery.cssHooks.marginLeft = addGetHookIf(support.reliableMarginLeft, function(elem, computed) {
        if (computed) {
            return (parseFloat(curCSS(elem, "marginLeft")) || elem.getBoundingClientRect().left - swap(elem, {
                marginLeft: 0
            }, function() {
                return elem.getBoundingClientRect().left
            })) + "px"
        }
    });
    jQuery.cssHooks.marginRight = addGetHookIf(support.reliableMarginRight, function(elem, computed) {
        if (computed) {
            return swap(elem, {
                display: "inline-block"
            }, curCSS, [elem, "marginRight"])
        }
    });
    jQuery.each({
        margin: "",
        padding: "",
        border: "Width"
    }, function(prefix, suffix) {
        jQuery.cssHooks[prefix + suffix] = {
            expand: function(value) {
                var i = 0,
                    expanded = {},
                    parts = typeof value === "string" ? value.split(" ") : [value];
                for (; i < 4; i++) {
                    expanded[prefix + cssExpand[i] + suffix] = parts[i] || parts[i - 2] || parts[0]
                }
                return expanded
            }
        };
        if (!rmargin.test(prefix)) {
            jQuery.cssHooks[prefix + suffix].set = setPositiveNumber
        }
    });
    jQuery.fn.extend({
        css: function(name, value) {
            return access(this, function(elem, name, value) {
                var styles, len, map = {},
                    i = 0;
                if (jQuery.isArray(name)) {
                    styles = getStyles(elem);
                    len = name.length;
                    for (; i < len; i++) {
                        map[name[i]] = jQuery.css(elem, name[i], false, styles)
                    }
                    return map
                }
                return value !== undefined ? jQuery.style(elem, name, value) : jQuery.css(elem, name)
            }, name, value, arguments.length > 1)
        },
        show: function() {
            return showHide(this, true)
        },
        hide: function() {
            return showHide(this)
        },
        toggle: function(state) {
            if (typeof state === "boolean") {
                return state ? this.show() : this.hide()
            }
            return this.each(function() {
                if (isHidden(this)) {
                    jQuery(this).show()
                } else {
                    jQuery(this).hide()
                }
            })
        }
    });

    function Tween(elem, options, prop, end, easing) {
        return new Tween.prototype.init(elem, options, prop, end, easing)
    }
    jQuery.Tween = Tween;
    Tween.prototype = {
        constructor: Tween,
        init: function(elem, options, prop, end, easing, unit) {
            this.elem = elem;
            this.prop = prop;
            this.easing = easing || jQuery.easing._default;
            this.options = options;
            this.start = this.now = this.cur();
            this.end = end;
            this.unit = unit || (jQuery.cssNumber[prop] ? "" : "px")
        },
        cur: function() {
            var hooks = Tween.propHooks[this.prop];
            return hooks && hooks.get ? hooks.get(this) : Tween.propHooks._default.get(this)
        },
        run: function(percent) {
            var eased, hooks = Tween.propHooks[this.prop];
            if (this.options.duration) {
                this.pos = eased = jQuery.easing[this.easing](percent, this.options.duration * percent, 0, 1, this.options.duration)
            } else {
                this.pos = eased = percent
            }
            this.now = (this.end - this.start) * eased + this.start;
            if (this.options.step) {
                this.options.step.call(this.elem, this.now, this)
            }
            if (hooks && hooks.set) {
                hooks.set(this)
            } else {
                Tween.propHooks._default.set(this)
            }
            return this
        }
    };
    Tween.prototype.init.prototype = Tween.prototype;
    Tween.propHooks = {
        _default: {
            get: function(tween) {
                var result;
                if (tween.elem.nodeType !== 1 || tween.elem[tween.prop] != null && tween.elem.style[tween.prop] == null) {
                    return tween.elem[tween.prop]
                }
                result = jQuery.css(tween.elem, tween.prop, "");
                return !result || result === "auto" ? 0 : result
            },
            set: function(tween) {
                if (jQuery.fx.step[tween.prop]) {
                    jQuery.fx.step[tween.prop](tween)
                } else if (tween.elem.nodeType === 1 && (tween.elem.style[jQuery.cssProps[tween.prop]] != null || jQuery.cssHooks[tween.prop])) {
                    jQuery.style(tween.elem, tween.prop, tween.now + tween.unit)
                } else {
                    tween.elem[tween.prop] = tween.now
                }
            }
        }
    };
    Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {
        set: function(tween) {
            if (tween.elem.nodeType && tween.elem.parentNode) {
                tween.elem[tween.prop] = tween.now
            }
        }
    };
    jQuery.easing = {
        linear: function(p) {
            return p
        },
        swing: function(p) {
            return .5 - Math.cos(p * Math.PI) / 2
        },
        _default: "swing"
    };
    jQuery.fx = Tween.prototype.init;
    jQuery.fx.step = {};
    var fxNow, timerId, rfxtypes = /^(?:toggle|show|hide)$/,
        rrun = /queueHooks$/;

    function createFxNow() {
        window.setTimeout(function() {
            fxNow = undefined
        });
        return fxNow = jQuery.now()
    }

    function genFx(type, includeWidth) {
        var which, i = 0,
            attrs = {
                height: type
            };
        includeWidth = includeWidth ? 1 : 0;
        for (; i < 4; i += 2 - includeWidth) {
            which = cssExpand[i];
            attrs["margin" + which] = attrs["padding" + which] = type
        }
        if (includeWidth) {
            attrs.opacity = attrs.width = type
        }
        return attrs
    }

    function createTween(value, prop, animation) {
        var tween, collection = (Animation.tweeners[prop] || []).concat(Animation.tweeners["*"]),
            index = 0,
            length = collection.length;
        for (; index < length; index++) {
            if (tween = collection[index].call(animation, prop, value)) {
                return tween
            }
        }
    }

    function defaultPrefilter(elem, props, opts) {
        var prop, value, toggle, tween, hooks, oldfire, display, checkDisplay, anim = this,
            orig = {},
            style = elem.style,
            hidden = elem.nodeType && isHidden(elem),
            dataShow = dataPriv.get(elem, "fxshow");
        if (!opts.queue) {
            hooks = jQuery._queueHooks(elem, "fx");
            if (hooks.unqueued == null) {
                hooks.unqueued = 0;
                oldfire = hooks.empty.fire;
                hooks.empty.fire = function() {
                    if (!hooks.unqueued) {
                        oldfire()
                    }
                }
            }
            hooks.unqueued++;
            anim.always(function() {
                anim.always(function() {
                    hooks.unqueued--;
                    if (!jQuery.queue(elem, "fx").length) {
                        hooks.empty.fire()
                    }
                })
            })
        }
        if (elem.nodeType === 1 && ("height" in props || "width" in props)) {
            opts.overflow = [style.overflow, style.overflowX, style.overflowY];
            display = jQuery.css(elem, "display");
            checkDisplay = display === "none" ? dataPriv.get(elem, "olddisplay") || defaultDisplay(elem.nodeName) : display;
            if (checkDisplay === "inline" && jQuery.css(elem, "float") === "none") {
                style.display = "inline-block"
            }
        }
        if (opts.overflow) {
            style.overflow = "hidden";
            anim.always(function() {
                style.overflow = opts.overflow[0];
                style.overflowX = opts.overflow[1];
                style.overflowY = opts.overflow[2]
            })
        }
        for (prop in props) {
            value = props[prop];
            if (rfxtypes.exec(value)) {
                delete props[prop];
                toggle = toggle || value === "toggle";
                if (value === (hidden ? "hide" : "show")) {
                    if (value === "show" && dataShow && dataShow[prop] !== undefined) {
                        hidden = true
                    } else {
                        continue
                    }
                }
                orig[prop] = dataShow && dataShow[prop] || jQuery.style(elem, prop)
            } else {
                display = undefined
            }
        }
        if (!jQuery.isEmptyObject(orig)) {
            if (dataShow) {
                if ("hidden" in dataShow) {
                    hidden = dataShow.hidden
                }
            } else {
                dataShow = dataPriv.access(elem, "fxshow", {})
            }
            if (toggle) {
                dataShow.hidden = !hidden
            }
            if (hidden) {
                jQuery(elem).show()
            } else {
                anim.done(function() {
                    jQuery(elem).hide()
                })
            }
            anim.done(function() {
                var prop;
                dataPriv.remove(elem, "fxshow");
                for (prop in orig) {
                    jQuery.style(elem, prop, orig[prop])
                }
            });
            for (prop in orig) {
                tween = createTween(hidden ? dataShow[prop] : 0, prop, anim);
                if (!(prop in dataShow)) {
                    dataShow[prop] = tween.start;
                    if (hidden) {
                        tween.end = tween.start;
                        tween.start = prop === "width" || prop === "height" ? 1 : 0
                    }
                }
            }
        } else if ((display === "none" ? defaultDisplay(elem.nodeName) : display) === "inline") {
            style.display = display
        }
    }

    function propFilter(props, specialEasing) {
        var index, name, easing, value, hooks;
        for (index in props) {
            name = jQuery.camelCase(index);
            easing = specialEasing[name];
            value = props[index];
            if (jQuery.isArray(value)) {
                easing = value[1];
                value = props[index] = value[0]
            }
            if (index !== name) {
                props[name] = value;
                delete props[index]
            }
            hooks = jQuery.cssHooks[name];
            if (hooks && "expand" in hooks) {
                value = hooks.expand(value);
                delete props[name];
                for (index in value) {
                    if (!(index in props)) {
                        props[index] = value[index];
                        specialEasing[index] = easing
                    }
                }
            } else {
                specialEasing[name] = easing
            }
        }
    }

    function Animation(elem, properties, options) {
        var result, stopped, index = 0,
            length = Animation.prefilters.length,
            deferred = jQuery.Deferred().always(function() {
                delete tick.elem
            }),
            tick = function() {
                if (stopped) {
                    return false
                }
                var currentTime = fxNow || createFxNow(),
                    remaining = Math.max(0, animation.startTime + animation.duration - currentTime),
                    temp = remaining / animation.duration || 0,
                    percent = 1 - temp,
                    index = 0,
                    length = animation.tweens.length;
                for (; index < length; index++) {
                    animation.tweens[index].run(percent)
                }
                deferred.notifyWith(elem, [animation, percent, remaining]);
                if (percent < 1 && length) {
                    return remaining
                } else {
                    deferred.resolveWith(elem, [animation]);
                    return false
                }
            },
            animation = deferred.promise({
                elem: elem,
                props: jQuery.extend({}, properties),
                opts: jQuery.extend(true, {
                    specialEasing: {},
                    easing: jQuery.easing._default
                }, options),
                originalProperties: properties,
                originalOptions: options,
                startTime: fxNow || createFxNow(),
                duration: options.duration,
                tweens: [],
                createTween: function(prop, end) {
                    var tween = jQuery.Tween(elem, animation.opts, prop, end, animation.opts.specialEasing[prop] || animation.opts.easing);
                    animation.tweens.push(tween);
                    return tween
                },
                stop: function(gotoEnd) {
                    var index = 0,
                        length = gotoEnd ? animation.tweens.length : 0;
                    if (stopped) {
                        return this
                    }
                    stopped = true;
                    for (; index < length; index++) {
                        animation.tweens[index].run(1)
                    }
                    if (gotoEnd) {
                        deferred.notifyWith(elem, [animation, 1, 0]);
                        deferred.resolveWith(elem, [animation, gotoEnd])
                    } else {
                        deferred.rejectWith(elem, [animation, gotoEnd])
                    }
                    return this
                }
            }),
            props = animation.props;
        propFilter(props, animation.opts.specialEasing);
        for (; index < length; index++) {
            result = Animation.prefilters[index].call(animation, elem, props, animation.opts);
            if (result) {
                if (jQuery.isFunction(result.stop)) {
                    jQuery._queueHooks(animation.elem, animation.opts.queue).stop = jQuery.proxy(result.stop, result)
                }
                return result
            }
        }
        jQuery.map(props, createTween, animation);
        if (jQuery.isFunction(animation.opts.start)) {
            animation.opts.start.call(elem, animation)
        }
        jQuery.fx.timer(jQuery.extend(tick, {
            elem: elem,
            anim: animation,
            queue: animation.opts.queue
        }));
        return animation.progress(animation.opts.progress).done(animation.opts.done, animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)
    }
    jQuery.Animation = jQuery.extend(Animation, {
        tweeners: {
            "*": [function(prop, value) {
                var tween = this.createTween(prop, value);
                adjustCSS(tween.elem, prop, rcssNum.exec(value), tween);
                return tween
            }]
        },
        tweener: function(props, callback) {
            if (jQuery.isFunction(props)) {
                callback = props;
                props = ["*"]
            } else {
                props = props.match(rnotwhite)
            }
            var prop, index = 0,
                length = props.length;
            for (; index < length; index++) {
                prop = props[index];
                Animation.tweeners[prop] = Animation.tweeners[prop] || [];
                Animation.tweeners[prop].unshift(callback)
            }
        },
        prefilters: [defaultPrefilter],
        prefilter: function(callback, prepend) {
            if (prepend) {
                Animation.prefilters.unshift(callback)
            } else {
                Animation.prefilters.push(callback)
            }
        }
    });
    jQuery.speed = function(speed, easing, fn) {
        var opt = speed && typeof speed === "object" ? jQuery.extend({}, speed) : {
            complete: fn || !fn && easing || jQuery.isFunction(speed) && speed,
            duration: speed,
            easing: fn && easing || easing && !jQuery.isFunction(easing) && easing
        };
        opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ? opt.duration : opt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[opt.duration] : jQuery.fx.speeds._default;
        if (opt.queue == null || opt.queue === true) {
            opt.queue = "fx"
        }
        opt.old = opt.complete;
        opt.complete = function() {
            if (jQuery.isFunction(opt.old)) {
                opt.old.call(this)
            }
            if (opt.queue) {
                jQuery.dequeue(this, opt.queue)
            }
        };
        return opt
    };
    jQuery.fn.extend({
        fadeTo: function(speed, to, easing, callback) {
            return this.filter(isHidden).css("opacity", 0).show().end().animate({
                opacity: to
            }, speed, easing, callback)
        },
        animate: function(prop, speed, easing, callback) {
            var empty = jQuery.isEmptyObject(prop),
                optall = jQuery.speed(speed, easing, callback),
                doAnimation = function() {
                    var anim = Animation(this, jQuery.extend({}, prop), optall);
                    if (empty || dataPriv.get(this, "finish")) {
                        anim.stop(true)
                    }
                };
            doAnimation.finish = doAnimation;
            return empty || optall.queue === false ? this.each(doAnimation) : this.queue(optall.queue, doAnimation)
        },
        stop: function(type, clearQueue, gotoEnd) {
            var stopQueue = function(hooks) {
                var stop = hooks.stop;
                delete hooks.stop;
                stop(gotoEnd)
            };
            if (typeof type !== "string") {
                gotoEnd = clearQueue;
                clearQueue = type;
                type = undefined
            }
            if (clearQueue && type !== false) {
                this.queue(type || "fx", [])
            }
            return this.each(function() {
                var dequeue = true,
                    index = type != null && type + "queueHooks",
                    timers = jQuery.timers,
                    data = dataPriv.get(this);
                if (index) {
                    if (data[index] && data[index].stop) {
                        stopQueue(data[index])
                    }
                } else {
                    for (index in data) {
                        if (data[index] && data[index].stop && rrun.test(index)) {
                            stopQueue(data[index])
                        }
                    }
                }
                for (index = timers.length; index--;) {
                    if (timers[index].elem === this && (type == null || timers[index].queue === type)) {
                        timers[index].anim.stop(gotoEnd);
                        dequeue = false;
                        timers.splice(index, 1)
                    }
                }
                if (dequeue || !gotoEnd) {
                    jQuery.dequeue(this, type)
                }
            })
        },
        finish: function(type) {
            if (type !== false) {
                type = type || "fx"
            }
            return this.each(function() {
                var index, data = dataPriv.get(this),
                    queue = data[type + "queue"],
                    hooks = data[type + "queueHooks"],
                    timers = jQuery.timers,
                    length = queue ? queue.length : 0;
                data.finish = true;
                jQuery.queue(this, type, []);
                if (hooks && hooks.stop) {
                    hooks.stop.call(this, true)
                }
                for (index = timers.length; index--;) {
                    if (timers[index].elem === this && timers[index].queue === type) {
                        timers[index].anim.stop(true);
                        timers.splice(index, 1)
                    }
                }
                for (index = 0; index < length; index++) {
                    if (queue[index] && queue[index].finish) {
                        queue[index].finish.call(this)
                    }
                }
                delete data.finish
            })
        }
    });
    jQuery.each(["toggle", "show", "hide"], function(i, name) {
        var cssFn = jQuery.fn[name];
        jQuery.fn[name] = function(speed, easing, callback) {
            return speed == null || typeof speed === "boolean" ? cssFn.apply(this, arguments) : this.animate(genFx(name, true), speed, easing, callback)
        }
    });
    jQuery.each({
        slideDown: genFx("show"),
        slideUp: genFx("hide"),
        slideToggle: genFx("toggle"),
        fadeIn: {
            opacity: "show"
        },
        fadeOut: {
            opacity: "hide"
        },
        fadeToggle: {
            opacity: "toggle"
        }
    }, function(name, props) {
        jQuery.fn[name] = function(speed, easing, callback) {
            return this.animate(props, speed, easing, callback)
        }
    });
    jQuery.timers = [];
    jQuery.fx.tick = function() {
        var timer, i = 0,
            timers = jQuery.timers;
        fxNow = jQuery.now();
        for (; i < timers.length; i++) {
            timer = timers[i];
            if (!timer() && timers[i] === timer) {
                timers.splice(i--, 1)
            }
        }
        if (!timers.length) {
            jQuery.fx.stop()
        }
        fxNow = undefined
    };
    jQuery.fx.timer = function(timer) {
        jQuery.timers.push(timer);
        if (timer()) {
            jQuery.fx.start()
        } else {
            jQuery.timers.pop()
        }
    };
    jQuery.fx.interval = 13;
    jQuery.fx.start = function() {
        if (!timerId) {
            timerId = window.setInterval(jQuery.fx.tick, jQuery.fx.interval)
        }
    };
    jQuery.fx.stop = function() {
        window.clearInterval(timerId);
        timerId = null
    };
    jQuery.fx.speeds = {
        slow: 600,
        fast: 200,
        _default: 400
    };
    jQuery.fn.delay = function(time, type) {
        time = jQuery.fx ? jQuery.fx.speeds[time] || time : time;
        type = type || "fx";
        return this.queue(type, function(next, hooks) {
            var timeout = window.setTimeout(next, time);
            hooks.stop = function() {
                window.clearTimeout(timeout)
            }
        })
    };
    (function() {
        var input = document.createElement("input"),
            select = document.createElement("select"),
            opt = select.appendChild(document.createElement("option"));
        input.type = "checkbox";
        support.checkOn = input.value !== "";
        support.optSelected = opt.selected;
        select.disabled = true;
        support.optDisabled = !opt.disabled;
        input = document.createElement("input");
        input.value = "t";
        input.type = "radio";
        support.radioValue = input.value === "t"
    })();
    var boolHook, attrHandle = jQuery.expr.attrHandle;
    jQuery.fn.extend({
        attr: function(name, value) {
            return access(this, jQuery.attr, name, value, arguments.length > 1)
        },
        removeAttr: function(name) {
            return this.each(function() {
                jQuery.removeAttr(this, name)
            })
        }
    });
    jQuery.extend({
        attr: function(elem, name, value) {
            var ret, hooks, nType = elem.nodeType;
            if (nType === 3 || nType === 8 || nType === 2) {
                return
            }
            if (typeof elem.getAttribute === "undefined") {
                return jQuery.prop(elem, name, value)
            }
            if (nType !== 1 || !jQuery.isXMLDoc(elem)) {
                name = name.toLowerCase();
                hooks = jQuery.attrHooks[name] || (jQuery.expr.match.bool.test(name) ? boolHook : undefined)
            }
            if (value !== undefined) {
                if (value === null) {
                    jQuery.removeAttr(elem, name);
                    return
                }
                if (hooks && "set" in hooks && (ret = hooks.set(elem, value, name)) !== undefined) {
                    return ret
                }
                elem.setAttribute(name, value + "");
                return value
            }
            if (hooks && "get" in hooks && (ret = hooks.get(elem, name)) !== null) {
                return ret
            }
            ret = jQuery.find.attr(elem, name);
            return ret == null ? undefined : ret
        },
        attrHooks: {
            type: {
                set: function(elem, value) {
                    if (!support.radioValue && value === "radio" && jQuery.nodeName(elem, "input")) {
                        var val = elem.value;
                        elem.setAttribute("type", value);
                        if (val) {
                            elem.value = val
                        }
                        return value
                    }
                }
            }
        },
        removeAttr: function(elem, value) {
            var name, propName, i = 0,
                attrNames = value && value.match(rnotwhite);
            if (attrNames && elem.nodeType === 1) {
                while (name = attrNames[i++]) {
                    propName = jQuery.propFix[name] || name;
                    if (jQuery.expr.match.bool.test(name)) {
                        elem[propName] = false
                    }
                    elem.removeAttribute(name)
                }
            }
        }
    });
    boolHook = {
        set: function(elem, value, name) {
            if (value === false) {
                jQuery.removeAttr(elem, name)
            } else {
                elem.setAttribute(name, name)
            }
            return name
        }
    };
    jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g), function(i, name) {
        var getter = attrHandle[name] || jQuery.find.attr;
        attrHandle[name] = function(elem, name, isXML) {
            var ret, handle;
            if (!isXML) {
                handle = attrHandle[name];
                attrHandle[name] = ret;
                ret = getter(elem, name, isXML) != null ? name.toLowerCase() : null;
                attrHandle[name] = handle
            }
            return ret
        }
    });
    var rfocusable = /^(?:input|select|textarea|button)$/i,
        rclickable = /^(?:a|area)$/i;
    jQuery.fn.extend({
        prop: function(name, value) {
            return access(this, jQuery.prop, name, value, arguments.length > 1)
        },
        removeProp: function(name) {
            return this.each(function() {
                delete this[jQuery.propFix[name] || name]
            })
        }
    });
    jQuery.extend({
        prop: function(elem, name, value) {
            var ret, hooks, nType = elem.nodeType;
            if (nType === 3 || nType === 8 || nType === 2) {
                return
            }
            if (nType !== 1 || !jQuery.isXMLDoc(elem)) {
                name = jQuery.propFix[name] || name;
                hooks = jQuery.propHooks[name]
            }
            if (value !== undefined) {
                if (hooks && "set" in hooks && (ret = hooks.set(elem, value, name)) !== undefined) {
                    return ret
                }
                return elem[name] = value
            }
            if (hooks && "get" in hooks && (ret = hooks.get(elem, name)) !== null) {
                return ret
            }
            return elem[name]
        },
        propHooks: {
            tabIndex: {
                get: function(elem) {
                    var tabindex = jQuery.find.attr(elem, "tabindex");
                    return tabindex ? parseInt(tabindex, 10) : rfocusable.test(elem.nodeName) || rclickable.test(elem.nodeName) && elem.href ? 0 : -1
                }
            }
        },
        propFix: {
            for: "htmlFor",
            class: "className"
        }
    });
    if (!support.optSelected) {
        jQuery.propHooks.selected = {
            get: function(elem) {
                var parent = elem.parentNode;
                if (parent && parent.parentNode) {
                    parent.parentNode.selectedIndex
                }
                return null
            },
            set: function(elem) {
                var parent = elem.parentNode;
                if (parent) {
                    parent.selectedIndex;
                    if (parent.parentNode) {
                        parent.parentNode.selectedIndex
                    }
                }
            }
        }
    }
    jQuery.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
        jQuery.propFix[this.toLowerCase()] = this
    });
    var rclass = /[\t\r\n\f]/g;

    function getClass(elem) {
        return elem.getAttribute && elem.getAttribute("class") || ""
    }
    jQuery.fn.extend({
        addClass: function(value) {
            var classes, elem, cur, curValue, clazz, j, finalValue, i = 0;
            if (jQuery.isFunction(value)) {
                return this.each(function(j) {
                    jQuery(this).addClass(value.call(this, j, getClass(this)))
                })
            }
            if (typeof value === "string" && value) {
                classes = value.match(rnotwhite) || [];
                while (elem = this[i++]) {
                    curValue = getClass(elem);
                    cur = elem.nodeType === 1 && (" " + curValue + " ").replace(rclass, " ");
                    if (cur) {
                        j = 0;
                        while (clazz = classes[j++]) {
                            if (cur.indexOf(" " + clazz + " ") < 0) {
                                cur += clazz + " "
                            }
                        }
                        finalValue = jQuery.trim(cur);
                        if (curValue !== finalValue) {
                            elem.setAttribute("class", finalValue)
                        }
                    }
                }
            }
            return this
        },
        removeClass: function(value) {
            var classes, elem, cur, curValue, clazz, j, finalValue, i = 0;
            if (jQuery.isFunction(value)) {
                return this.each(function(j) {
                    jQuery(this).removeClass(value.call(this, j, getClass(this)))
                })
            }
            if (!arguments.length) {
                return this.attr("class", "")
            }
            if (typeof value === "string" && value) {
                classes = value.match(rnotwhite) || [];
                while (elem = this[i++]) {
                    curValue = getClass(elem);
                    cur = elem.nodeType === 1 && (" " + curValue + " ").replace(rclass, " ");
                    if (cur) {
                        j = 0;
                        while (clazz = classes[j++]) {
                            while (cur.indexOf(" " + clazz + " ") > -1) {
                                cur = cur.replace(" " + clazz + " ", " ")
                            }
                        }
                        finalValue = jQuery.trim(cur);
                        if (curValue !== finalValue) {
                            elem.setAttribute("class", finalValue)
                        }
                    }
                }
            }
            return this
        },
        toggleClass: function(value, stateVal) {
            var type = typeof value;
            if (typeof stateVal === "boolean" && type === "string") {
                return stateVal ? this.addClass(value) : this.removeClass(value)
            }
            if (jQuery.isFunction(value)) {
                return this.each(function(i) {
                    jQuery(this).toggleClass(value.call(this, i, getClass(this), stateVal), stateVal)
                })
            }
            return this.each(function() {
                var className, i, self, classNames;
                if (type === "string") {
                    i = 0;
                    self = jQuery(this);
                    classNames = value.match(rnotwhite) || [];
                    while (className = classNames[i++]) {
                        if (self.hasClass(className)) {
                            self.removeClass(className)
                        } else {
                            self.addClass(className)
                        }
                    }
                } else if (value === undefined || type === "boolean") {
                    className = getClass(this);
                    if (className) {
                        dataPriv.set(this, "__className__", className)
                    }
                    if (this.setAttribute) {
                        this.setAttribute("class", className || value === false ? "" : dataPriv.get(this, "__className__") || "")
                    }
                }
            })
        },
        hasClass: function(selector) {
            var className, elem, i = 0;
            className = " " + selector + " ";
            while (elem = this[i++]) {
                if (elem.nodeType === 1 && (" " + getClass(elem) + " ").replace(rclass, " ").indexOf(className) > -1) {
                    return true
                }
            }
            return false
        }
    });
    var rreturn = /\r/g,
        rspaces = /[\x20\t\r\n\f]+/g;
    jQuery.fn.extend({
        val: function(value) {
            var hooks, ret, isFunction, elem = this[0];
            if (!arguments.length) {
                if (elem) {
                    hooks = jQuery.valHooks[elem.type] || jQuery.valHooks[elem.nodeName.toLowerCase()];
                    if (hooks && "get" in hooks && (ret = hooks.get(elem, "value")) !== undefined) {
                        return ret
                    }
                    ret = elem.value;
                    return typeof ret === "string" ? ret.replace(rreturn, "") : ret == null ? "" : ret
                }
                return
            }
            isFunction = jQuery.isFunction(value);
            return this.each(function(i) {
                var val;
                if (this.nodeType !== 1) {
                    return
                }
                if (isFunction) {
                    val = value.call(this, i, jQuery(this).val())
                } else {
                    val = value
                }
                if (val == null) {
                    val = ""
                } else if (typeof val === "number") {
                    val += ""
                } else if (jQuery.isArray(val)) {
                    val = jQuery.map(val, function(value) {
                        return value == null ? "" : value + ""
                    })
                }
                hooks = jQuery.valHooks[this.type] || jQuery.valHooks[this.nodeName.toLowerCase()];
                if (!hooks || !("set" in hooks) || hooks.set(this, val, "value") === undefined) {
                    this.value = val
                }
            })
        }
    });
    jQuery.extend({
        valHooks: {
            option: {
                get: function(elem) {
                    var val = jQuery.find.attr(elem, "value");
                    return val != null ? val : jQuery.trim(jQuery.text(elem)).replace(rspaces, " ")
                }
            },
            select: {
                get: function(elem) {
                    var value, option, options = elem.options,
                        index = elem.selectedIndex,
                        one = elem.type === "select-one" || index < 0,
                        values = one ? null : [],
                        max = one ? index + 1 : options.length,
                        i = index < 0 ? max : one ? index : 0;
                    for (; i < max; i++) {
                        option = options[i];
                        if ((option.selected || i === index) && (support.optDisabled ? !option.disabled : option.getAttribute("disabled") === null) && (!option.parentNode.disabled || !jQuery.nodeName(option.parentNode, "optgroup"))) {
                            value = jQuery(option).val();
                            if (one) {
                                return value
                            }
                            values.push(value)
                        }
                    }
                    return values
                },
                set: function(elem, value) {
                    var optionSet, option, options = elem.options,
                        values = jQuery.makeArray(value),
                        i = options.length;
                    while (i--) {
                        option = options[i];
                        if (option.selected = jQuery.inArray(jQuery.valHooks.option.get(option), values) > -1) {
                            optionSet = true
                        }
                    }
                    if (!optionSet) {
                        elem.selectedIndex = -1
                    }
                    return values
                }
            }
        }
    });
    jQuery.each(["radio", "checkbox"], function() {
        jQuery.valHooks[this] = {
            set: function(elem, value) {
                if (jQuery.isArray(value)) {
                    return elem.checked = jQuery.inArray(jQuery(elem).val(), value) > -1
                }
            }
        };
        if (!support.checkOn) {
            jQuery.valHooks[this].get = function(elem) {
                return elem.getAttribute("value") === null ? "on" : elem.value
            }
        }
    });
    var rfocusMorph = /^(?:focusinfocus|focusoutblur)$/;
    jQuery.extend(jQuery.event, {
        trigger: function(event, data, elem, onlyHandlers) {
            var i, cur, tmp, bubbleType, ontype, handle, special, eventPath = [elem || document],
                type = hasOwn.call(event, "type") ? event.type : event,
                namespaces = hasOwn.call(event, "namespace") ? event.namespace.split(".") : [];
            cur = tmp = elem = elem || document;
            if (elem.nodeType === 3 || elem.nodeType === 8) {
                return
            }
            if (rfocusMorph.test(type + jQuery.event.triggered)) {
                return
            }
            if (type.indexOf(".") > -1) {
                namespaces = type.split(".");
                type = namespaces.shift();
                namespaces.sort()
            }
            ontype = type.indexOf(":") < 0 && "on" + type;
            event = event[jQuery.expando] ? event : new jQuery.Event(type, typeof event === "object" && event);
            event.isTrigger = onlyHandlers ? 2 : 3;
            event.namespace = namespaces.join(".");
            event.rnamespace = event.namespace ? new RegExp("(^|\\.)" + namespaces.join("\\.(?:.*\\.|)") + "(\\.|$)") : null;
            event.result = undefined;
            if (!event.target) {
                event.target = elem
            }
            data = data == null ? [event] : jQuery.makeArray(data, [event]);
            special = jQuery.event.special[type] || {};
            if (!onlyHandlers && special.trigger && special.trigger.apply(elem, data) === false) {
                return
            }
            if (!onlyHandlers && !special.noBubble && !jQuery.isWindow(elem)) {
                bubbleType = special.delegateType || type;
                if (!rfocusMorph.test(bubbleType + type)) {
                    cur = cur.parentNode
                }
                for (; cur; cur = cur.parentNode) {
                    eventPath.push(cur);
                    tmp = cur
                }
                if (tmp === (elem.ownerDocument || document)) {
                    eventPath.push(tmp.defaultView || tmp.parentWindow || window)
                }
            }
            i = 0;
            while ((cur = eventPath[i++]) && !event.isPropagationStopped()) {
                event.type = i > 1 ? bubbleType : special.bindType || type;
                handle = (dataPriv.get(cur, "events") || {})[event.type] && dataPriv.get(cur, "handle");
                if (handle) {
                    handle.apply(cur, data)
                }
                handle = ontype && cur[ontype];
                if (handle && handle.apply && acceptData(cur)) {
                    event.result = handle.apply(cur, data);
                    if (event.result === false) {
                        event.preventDefault()
                    }
                }
            }
            event.type = type;
            if (!onlyHandlers && !event.isDefaultPrevented()) {
                if ((!special._default || special._default.apply(eventPath.pop(), data) === false) && acceptData(elem)) {
                    if (ontype && jQuery.isFunction(elem[type]) && !jQuery.isWindow(elem)) {
                        tmp = elem[ontype];
                        if (tmp) {
                            elem[ontype] = null
                        }
                        jQuery.event.triggered = type;
                        elem[type]();
                        jQuery.event.triggered = undefined;
                        if (tmp) {
                            elem[ontype] = tmp
                        }
                    }
                }
            }
            return event.result
        },
        simulate: function(type, elem, event) {
            var e = jQuery.extend(new jQuery.Event, event, {
                type: type,
                isSimulated: true
            });
            jQuery.event.trigger(e, null, elem)
        }
    });
    jQuery.fn.extend({
        trigger: function(type, data) {
            return this.each(function() {
                jQuery.event.trigger(type, data, this)
            })
        },
        triggerHandler: function(type, data) {
            var elem = this[0];
            if (elem) {
                return jQuery.event.trigger(type, data, elem, true)
            }
        }
    });
    jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick " + "mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " + "change select submit keydown keypress keyup error contextmenu").split(" "), function(i, name) {
        jQuery.fn[name] = function(data, fn) {
            return arguments.length > 0 ? this.on(name, null, data, fn) : this.trigger(name)
        }
    });
    jQuery.fn.extend({
        hover: function(fnOver, fnOut) {
            return this.mouseenter(fnOver).mouseleave(fnOut || fnOver)
        }
    });
    support.focusin = "onfocusin" in window;
    if (!support.focusin) {
        jQuery.each({
            focus: "focusin",
            blur: "focusout"
        }, function(orig, fix) {
            var handler = function(event) {
                jQuery.event.simulate(fix, event.target, jQuery.event.fix(event))
            };
            jQuery.event.special[fix] = {
                setup: function() {
                    var doc = this.ownerDocument || this,
                        attaches = dataPriv.access(doc, fix);
                    if (!attaches) {
                        doc.addEventListener(orig, handler, true)
                    }
                    dataPriv.access(doc, fix, (attaches || 0) + 1)
                },
                teardown: function() {
                    var doc = this.ownerDocument || this,
                        attaches = dataPriv.access(doc, fix) - 1;
                    if (!attaches) {
                        doc.removeEventListener(orig, handler, true);
                        dataPriv.remove(doc, fix)
                    } else {
                        dataPriv.access(doc, fix, attaches)
                    }
                }
            }
        })
    }
    var location = window.location;
    var nonce = jQuery.now();
    var rquery = /\?/;
    jQuery.parseJSON = function(data) {
        return JSON.parse(data + "")
    };
    jQuery.parseXML = function(data) {
        var xml;
        if (!data || typeof data !== "string") {
            return null
        }
        try {
            xml = (new window.DOMParser).parseFromString(data, "text/xml")
        } catch (e) {
            xml = undefined
        }
        if (!xml || xml.getElementsByTagName("parsererror").length) {
            jQuery.error("Invalid XML: " + data)
        }
        return xml
    };
    var rhash = /#.*$/,
        rts = /([?&])_=[^&]*/,
        rheaders = /^(.*?):[ \t]*([^\r\n]*)$/gm,
        rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
        rnoContent = /^(?:GET|HEAD)$/,
        rprotocol = /^\/\//,
        prefilters = {},
        transports = {},
        allTypes = "*/".concat("*"),
        originAnchor = document.createElement("a");
    originAnchor.href = location.href;

    function addToPrefiltersOrTransports(structure) {
        return function(dataTypeExpression, func) {
            if (typeof dataTypeExpression !== "string") {
                func = dataTypeExpression;
                dataTypeExpression = "*"
            }
            var dataType, i = 0,
                dataTypes = dataTypeExpression.toLowerCase().match(rnotwhite) || [];
            if (jQuery.isFunction(func)) {
                while (dataType = dataTypes[i++]) {
                    if (dataType[0] === "+") {
                        dataType = dataType.slice(1) || "*";
                        (structure[dataType] = structure[dataType] || []).unshift(func)
                    } else {
                        (structure[dataType] = structure[dataType] || []).push(func)
                    }
                }
            }
        }
    }

    function inspectPrefiltersOrTransports(structure, options, originalOptions, jqXHR) {
        var inspected = {},
            seekingTransport = structure === transports;

        function inspect(dataType) {
            var selected;
            inspected[dataType] = true;
            jQuery.each(structure[dataType] || [], function(_, prefilterOrFactory) {
                var dataTypeOrTransport = prefilterOrFactory(options, originalOptions, jqXHR);
                if (typeof dataTypeOrTransport === "string" && !seekingTransport && !inspected[dataTypeOrTransport]) {
                    options.dataTypes.unshift(dataTypeOrTransport);
                    inspect(dataTypeOrTransport);
                    return false
                } else if (seekingTransport) {
                    return !(selected = dataTypeOrTransport)
                }
            });
            return selected
        }
        return inspect(options.dataTypes[0]) || !inspected["*"] && inspect("*")
    }

    function ajaxExtend(target, src) {
        var key, deep, flatOptions = jQuery.ajaxSettings.flatOptions || {};
        for (key in src) {
            if (src[key] !== undefined) {
                (flatOptions[key] ? target : deep || (deep = {}))[key] = src[key]
            }
        }
        if (deep) {
            jQuery.extend(true, target, deep)
        }
        return target
    }

    function ajaxHandleResponses(s, jqXHR, responses) {
        var ct, type, finalDataType, firstDataType, contents = s.contents,
            dataTypes = s.dataTypes;
        while (dataTypes[0] === "*") {
            dataTypes.shift();
            if (ct === undefined) {
                ct = s.mimeType || jqXHR.getResponseHeader("Content-Type")
            }
        }
        if (ct) {
            for (type in contents) {
                if (contents[type] && contents[type].test(ct)) {
                    dataTypes.unshift(type);
                    break
                }
            }
        }
        if (dataTypes[0] in responses) {
            finalDataType = dataTypes[0]
        } else {
            for (type in responses) {
                if (!dataTypes[0] || s.converters[type + " " + dataTypes[0]]) {
                    finalDataType = type;
                    break
                }
                if (!firstDataType) {
                    firstDataType = type
                }
            }
            finalDataType = finalDataType || firstDataType
        }
        if (finalDataType) {
            if (finalDataType !== dataTypes[0]) {
                dataTypes.unshift(finalDataType)
            }
            return responses[finalDataType]
        }
    }

    function ajaxConvert(s, response, jqXHR, isSuccess) {
        var conv2, current, conv, tmp, prev, converters = {},
            dataTypes = s.dataTypes.slice();
        if (dataTypes[1]) {
            for (conv in s.converters) {
                converters[conv.toLowerCase()] = s.converters[conv]
            }
        }
        current = dataTypes.shift();
        while (current) {
            if (s.responseFields[current]) {
                jqXHR[s.responseFields[current]] = response
            }
            if (!prev && isSuccess && s.dataFilter) {
                response = s.dataFilter(response, s.dataType)
            }
            prev = current;
            current = dataTypes.shift();
            if (current) {
                if (current === "*") {
                    current = prev
                } else if (prev !== "*" && prev !== current) {
                    conv = converters[prev + " " + current] || converters["* " + current];
                    if (!conv) {
                        for (conv2 in converters) {
                            tmp = conv2.split(" ");
                            if (tmp[1] === current) {
                                conv = converters[prev + " " + tmp[0]] || converters["* " + tmp[0]];
                                if (conv) {
                                    if (conv === true) {
                                        conv = converters[conv2]
                                    } else if (converters[conv2] !== true) {
                                        current = tmp[0];
                                        dataTypes.unshift(tmp[1])
                                    }
                                    break
                                }
                            }
                        }
                    }
                    if (conv !== true) {
                        if (conv && s.throws) {
                            response = conv(response)
                        } else {
                            try {
                                response = conv(response)
                            } catch (e) {
                                return {
                                    state: "parsererror",
                                    error: conv ? e : "No conversion from " + prev + " to " + current
                                }
                            }
                        }
                    }
                }
            }
        }
        return {
            state: "success",
            data: response
        }
    }
    jQuery.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: location.href,
            type: "GET",
            isLocal: rlocalProtocol.test(location.protocol),
            global: true,
            processData: true,
            async: true,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: {
                "*": allTypes,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },
            contents: {
                xml: /\bxml\b/,
                html: /\bhtml/,
                json: /\bjson\b/
            },
            responseFields: {
                xml: "responseXML",
                text: "responseText",
                json: "responseJSON"
            },
            converters: {
                "* text": String,
                "text html": true,
                "text json": jQuery.parseJSON,
                "text xml": jQuery.parseXML
            },
            flatOptions: {
                url: true,
                context: true
            }
        },
        ajaxSetup: function(target, settings) {
            return settings ? ajaxExtend(ajaxExtend(target, jQuery.ajaxSettings), settings) : ajaxExtend(jQuery.ajaxSettings, target)
        },
        ajaxPrefilter: addToPrefiltersOrTransports(prefilters),
        ajaxTransport: addToPrefiltersOrTransports(transports),
        ajax: function(url, options) {
            if (typeof url === "object") {
                options = url;
                url = undefined
            }
            options = options || {};
            var transport, cacheURL, responseHeadersString, responseHeaders, timeoutTimer, urlAnchor, fireGlobals, i, s = jQuery.ajaxSetup({}, options),
                callbackContext = s.context || s,
                globalEventContext = s.context && (callbackContext.nodeType || callbackContext.jquery) ? jQuery(callbackContext) : jQuery.event,
                deferred = jQuery.Deferred(),
                completeDeferred = jQuery.Callbacks("once memory"),
                statusCode = s.statusCode || {},
                requestHeaders = {},
                requestHeadersNames = {},
                state = 0,
                strAbort = "canceled",
                jqXHR = {
                    readyState: 0,
                    getResponseHeader: function(key) {
                        var match;
                        if (state === 2) {
                            if (!responseHeaders) {
                                responseHeaders = {};
                                while (match = rheaders.exec(responseHeadersString)) {
                                    responseHeaders[match[1].toLowerCase()] = match[2]
                                }
                            }
                            match = responseHeaders[key.toLowerCase()]
                        }
                        return match == null ? null : match
                    },
                    getAllResponseHeaders: function() {
                        return state === 2 ? responseHeadersString : null
                    },
                    setRequestHeader: function(name, value) {
                        var lname = name.toLowerCase();
                        if (!state) {
                            name = requestHeadersNames[lname] = requestHeadersNames[lname] || name;
                            requestHeaders[name] = value
                        }
                        return this
                    },
                    overrideMimeType: function(type) {
                        if (!state) {
                            s.mimeType = type
                        }
                        return this
                    },
                    statusCode: function(map) {
                        var code;
                        if (map) {
                            if (state < 2) {
                                for (code in map) {
                                    statusCode[code] = [statusCode[code], map[code]]
                                }
                            } else {
                                jqXHR.always(map[jqXHR.status])
                            }
                        }
                        return this
                    },
                    abort: function(statusText) {
                        var finalText = statusText || strAbort;
                        if (transport) {
                            transport.abort(finalText)
                        }
                        done(0, finalText);
                        return this
                    }
                };
            deferred.promise(jqXHR).complete = completeDeferred.add;
            jqXHR.success = jqXHR.done;
            jqXHR.error = jqXHR.fail;
            s.url = ((url || s.url || location.href) + "").replace(rhash, "").replace(rprotocol, location.protocol + "//");
            s.type = options.method || options.type || s.method || s.type;
            s.dataTypes = jQuery.trim(s.dataType || "*").toLowerCase().match(rnotwhite) || [""];
            if (s.crossDomain == null) {
                urlAnchor = document.createElement("a");
                try {
                    urlAnchor.href = s.url;
                    urlAnchor.href = urlAnchor.href;
                    s.crossDomain = originAnchor.protocol + "//" + originAnchor.host !== urlAnchor.protocol + "//" + urlAnchor.host
                } catch (e) {
                    s.crossDomain = true
                }
            }
            if (s.data && s.processData && typeof s.data !== "string") {
                s.data = jQuery.param(s.data, s.traditional)
            }
            inspectPrefiltersOrTransports(prefilters, s, options, jqXHR);
            if (state === 2) {
                return jqXHR
            }
            fireGlobals = jQuery.event && s.global;
            if (fireGlobals && jQuery.active++ === 0) {
                jQuery.event.trigger("ajaxStart")
            }
            s.type = s.type.toUpperCase();
            s.hasContent = !rnoContent.test(s.type);
            cacheURL = s.url;
            if (!s.hasContent) {
                if (s.data) {
                    cacheURL = s.url += (rquery.test(cacheURL) ? "&" : "?") + s.data;
                    delete s.data
                }
                if (s.cache === false) {
                    s.url = rts.test(cacheURL) ? cacheURL.replace(rts, "$1_=" + nonce++) : cacheURL + (rquery.test(cacheURL) ? "&" : "?") + "_=" + nonce++
                }
            }
            if (s.ifModified) {
                if (jQuery.lastModified[cacheURL]) {
                    jqXHR.setRequestHeader("If-Modified-Since", jQuery.lastModified[cacheURL])
                }
                if (jQuery.etag[cacheURL]) {
                    jqXHR.setRequestHeader("If-None-Match", jQuery.etag[cacheURL])
                }
            }
            if (s.data && s.hasContent && s.contentType !== false || options.contentType) {
                jqXHR.setRequestHeader("Content-Type", s.contentType)
            }
            jqXHR.setRequestHeader("Accept", s.dataTypes[0] && s.accepts[s.dataTypes[0]] ? s.accepts[s.dataTypes[0]] + (s.dataTypes[0] !== "*" ? ", " + allTypes + "; q=0.01" : "") : s.accepts["*"]);
            for (i in s.headers) {
                jqXHR.setRequestHeader(i, s.headers[i])
            }
            if (s.beforeSend && (s.beforeSend.call(callbackContext, jqXHR, s) === false || state === 2)) {
                return jqXHR.abort()
            }
            strAbort = "abort";
            for (i in {
                    success: 1,
                    error: 1,
                    complete: 1
                }) {
                jqXHR[i](s[i])
            }
            transport = inspectPrefiltersOrTransports(transports, s, options, jqXHR);
            if (!transport) {
                done(-1, "No Transport")
            } else {
                jqXHR.readyState = 1;
                if (fireGlobals) {
                    globalEventContext.trigger("ajaxSend", [jqXHR, s])
                }
                if (state === 2) {
                    return jqXHR
                }
                if (s.async && s.timeout > 0) {
                    timeoutTimer = window.setTimeout(function() {
                        jqXHR.abort("timeout")
                    }, s.timeout)
                }
                try {
                    state = 1;
                    transport.send(requestHeaders, done)
                } catch (e) {
                    if (state < 2) {
                        done(-1, e)
                    } else {
                        throw e
                    }
                }
            }

            function done(status, nativeStatusText, responses, headers) {
                var isSuccess, success, error, response, modified, statusText = nativeStatusText;
                if (state === 2) {
                    return
                }
                state = 2;
                if (timeoutTimer) {
                    window.clearTimeout(timeoutTimer)
                }
                transport = undefined;
                responseHeadersString = headers || "";
                jqXHR.readyState = status > 0 ? 4 : 0;
                isSuccess = status >= 200 && status < 300 || status === 304;
                if (responses) {
                    response = ajaxHandleResponses(s, jqXHR, responses)
                }
                response = ajaxConvert(s, response, jqXHR, isSuccess);
                if (isSuccess) {
                    if (s.ifModified) {
                        modified = jqXHR.getResponseHeader("Last-Modified");
                        if (modified) {
                            jQuery.lastModified[cacheURL] = modified
                        }
                        modified = jqXHR.getResponseHeader("etag");
                        if (modified) {
                            jQuery.etag[cacheURL] = modified
                        }
                    }
                    if (status === 204 || s.type === "HEAD") {
                        statusText = "nocontent"
                    } else if (status === 304) {
                        statusText = "notmodified"
                    } else {
                        statusText = response.state;
                        success = response.data;
                        error = response.error;
                        isSuccess = !error
                    }
                } else {
                    error = statusText;
                    if (status || !statusText) {
                        statusText = "error";
                        if (status < 0) {
                            status = 0
                        }
                    }
                }
                jqXHR.status = status;
                jqXHR.statusText = (nativeStatusText || statusText) + "";
                if (isSuccess) {
                    deferred.resolveWith(callbackContext, [success, statusText, jqXHR])
                } else {
                    deferred.rejectWith(callbackContext, [jqXHR, statusText, error])
                }
                jqXHR.statusCode(statusCode);
                statusCode = undefined;
                if (fireGlobals) {
                    globalEventContext.trigger(isSuccess ? "ajaxSuccess" : "ajaxError", [jqXHR, s, isSuccess ? success : error])
                }
                completeDeferred.fireWith(callbackContext, [jqXHR, statusText]);
                if (fireGlobals) {
                    globalEventContext.trigger("ajaxComplete", [jqXHR, s]);
                    if (!--jQuery.active) {
                        jQuery.event.trigger("ajaxStop")
                    }
                }
            }
            return jqXHR
        },
        getJSON: function(url, data, callback) {
            return jQuery.get(url, data, callback, "json")
        },
        getScript: function(url, callback) {
            return jQuery.get(url, undefined, callback, "script")
        }
    });
    jQuery.each(["get", "post"], function(i, method) {
        jQuery[method] = function(url, data, callback, type) {
            if (jQuery.isFunction(data)) {
                type = type || callback;
                callback = data;
                data = undefined
            }
            return jQuery.ajax(jQuery.extend({
                url: url,
                type: method,
                dataType: type,
                data: data,
                success: callback
            }, jQuery.isPlainObject(url) && url))
        }
    });
    jQuery._evalUrl = function(url) {
        return jQuery.ajax({
            url: url,
            type: "GET",
            dataType: "script",
            async: false,
            global: false,
            throws: true
        })
    };
    jQuery.fn.extend({
        wrapAll: function(html) {
            var wrap;
            if (jQuery.isFunction(html)) {
                return this.each(function(i) {
                    jQuery(this).wrapAll(html.call(this, i))
                })
            }
            if (this[0]) {
                wrap = jQuery(html, this[0].ownerDocument).eq(0).clone(true);
                if (this[0].parentNode) {
                    wrap.insertBefore(this[0])
                }
                wrap.map(function() {
                    var elem = this;
                    while (elem.firstElementChild) {
                        elem = elem.firstElementChild
                    }
                    return elem
                }).append(this)
            }
            return this
        },
        wrapInner: function(html) {
            if (jQuery.isFunction(html)) {
                return this.each(function(i) {
                    jQuery(this).wrapInner(html.call(this, i))
                })
            }
            return this.each(function() {
                var self = jQuery(this),
                    contents = self.contents();
                if (contents.length) {
                    contents.wrapAll(html)
                } else {
                    self.append(html)
                }
            })
        },
        wrap: function(html) {
            var isFunction = jQuery.isFunction(html);
            return this.each(function(i) {
                jQuery(this).wrapAll(isFunction ? html.call(this, i) : html)
            })
        },
        unwrap: function() {
            return this.parent().each(function() {
                if (!jQuery.nodeName(this, "body")) {
                    jQuery(this).replaceWith(this.childNodes)
                }
            }).end()
        }
    });
    jQuery.expr.filters.hidden = function(elem) {
        return !jQuery.expr.filters.visible(elem)
    };
    jQuery.expr.filters.visible = function(elem) {
        return elem.offsetWidth > 0 || elem.offsetHeight > 0 || elem.getClientRects().length > 0
    };
    var r20 = /%20/g,
        rbracket = /\[\]$/,
        rCRLF = /\r?\n/g,
        rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,
        rsubmittable = /^(?:input|select|textarea|keygen)/i;

    function buildParams(prefix, obj, traditional, add) {
        var name;
        if (jQuery.isArray(obj)) {
            jQuery.each(obj, function(i, v) {
                if (traditional || rbracket.test(prefix)) {
                    add(prefix, v)
                } else {
                    buildParams(prefix + "[" + (typeof v === "object" && v != null ? i : "") + "]", v, traditional, add)
                }
            })
        } else if (!traditional && jQuery.type(obj) === "object") {
            for (name in obj) {
                buildParams(prefix + "[" + name + "]", obj[name], traditional, add)
            }
        } else {
            add(prefix, obj)
        }
    }
    jQuery.param = function(a, traditional) {
        var prefix, s = [],
            add = function(key, value) {
                value = jQuery.isFunction(value) ? value() : value == null ? "" : value;
                s[s.length] = encodeURIComponent(key) + "=" + encodeURIComponent(value)
            };
        if (traditional === undefined) {
            traditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional
        }
        if (jQuery.isArray(a) || a.jquery && !jQuery.isPlainObject(a)) {
            jQuery.each(a, function() {
                add(this.name, this.value)
            })
        } else {
            for (prefix in a) {
                buildParams(prefix, a[prefix], traditional, add)
            }
        }
        return s.join("&").replace(r20, "+")
    };
    jQuery.fn.extend({
        serialize: function() {
            return jQuery.param(this.serializeArray())
        },
        serializeArray: function() {
            return this.map(function() {
                var elements = jQuery.prop(this, "elements");
                return elements ? jQuery.makeArray(elements) : this
            }).filter(function() {
                var type = this.type;
                return this.name && !jQuery(this).is(":disabled") && rsubmittable.test(this.nodeName) && !rsubmitterTypes.test(type) && (this.checked || !rcheckableType.test(type))
            }).map(function(i, elem) {
                var val = jQuery(this).val();
                return val == null ? null : jQuery.isArray(val) ? jQuery.map(val, function(val) {
                    return {
                        name: elem.name,
                        value: val.replace(rCRLF, "\r\n")
                    }
                }) : {
                    name: elem.name,
                    value: val.replace(rCRLF, "\r\n")
                }
            }).get()
        }
    });
    jQuery.ajaxSettings.xhr = function() {
        try {
            return new window.XMLHttpRequest
        } catch (e) {}
    };
    var xhrSuccessStatus = {
            0: 200,
            1223: 204
        },
        xhrSupported = jQuery.ajaxSettings.xhr();
    support.cors = !!xhrSupported && "withCredentials" in xhrSupported;
    support.ajax = xhrSupported = !!xhrSupported;
    jQuery.ajaxTransport(function(options) {
        var callback, errorCallback;
        if (support.cors || xhrSupported && !options.crossDomain) {
            return {
                send: function(headers, complete) {
                    var i, xhr = options.xhr();
                    xhr.open(options.type, options.url, options.async, options.username, options.password);
                    if (options.xhrFields) {
                        for (i in options.xhrFields) {
                            xhr[i] = options.xhrFields[i]
                        }
                    }
                    if (options.mimeType && xhr.overrideMimeType) {
                        xhr.overrideMimeType(options.mimeType)
                    }
                    if (!options.crossDomain && !headers["X-Requested-With"]) {
                        headers["X-Requested-With"] = "XMLHttpRequest"
                    }
                    for (i in headers) {
                        xhr.setRequestHeader(i, headers[i])
                    }
                    callback = function(type) {
                        return function() {
                            if (callback) {
                                callback = errorCallback = xhr.onload = xhr.onerror = xhr.onabort = xhr.onreadystatechange = null;
                                if (type === "abort") {
                                    xhr.abort()
                                } else if (type === "error") {
                                    if (typeof xhr.status !== "number") {
                                        complete(0, "error")
                                    } else {
                                        complete(xhr.status, xhr.statusText)
                                    }
                                } else {
                                    complete(xhrSuccessStatus[xhr.status] || xhr.status, xhr.statusText, (xhr.responseType || "text") !== "text" || typeof xhr.responseText !== "string" ? {
                                        binary: xhr.response
                                    } : {
                                        text: xhr.responseText
                                    }, xhr.getAllResponseHeaders())
                                }
                            }
                        }
                    };
                    xhr.onload = callback();
                    errorCallback = xhr.onerror = callback("error");
                    if (xhr.onabort !== undefined) {
                        xhr.onabort = errorCallback
                    } else {
                        xhr.onreadystatechange = function() {
                            if (xhr.readyState === 4) {
                                window.setTimeout(function() {
                                    if (callback) {
                                        errorCallback()
                                    }
                                })
                            }
                        }
                    }
                    callback = callback("abort");
                    try {
                        xhr.send(options.hasContent && options.data || null)
                    } catch (e) {
                        if (callback) {
                            throw e
                        }
                    }
                },
                abort: function() {
                    if (callback) {
                        callback()
                    }
                }
            }
        }
    });
    jQuery.ajaxSetup({
        accepts: {
            script: "text/javascript, application/javascript, " + "application/ecmascript, application/x-ecmascript"
        },
        contents: {
            script: /\b(?:java|ecma)script\b/
        },
        converters: {
            "text script": function(text) {
                jQuery.globalEval(text);
                return text
            }
        }
    });
    jQuery.ajaxPrefilter("script", function(s) {
        if (s.cache === undefined) {
            s.cache = false
        }
        if (s.crossDomain) {
            s.type = "GET"
        }
    });
    jQuery.ajaxTransport("script", function(s) {
        if (s.crossDomain) {
            var script, callback;
            return {
                send: function(_, complete) {
                    script = jQuery("<script>").prop({
                        charset: s.scriptCharset,
                        src: s.url
                    }).on("load error", callback = function(evt) {
                        script.remove();
                        callback = null;
                        if (evt) {
                            complete(evt.type === "error" ? 404 : 200, evt.type)
                        }
                    });
                    document.head.appendChild(script[0])
                },
                abort: function() {
                    if (callback) {
                        callback()
                    }
                }
            }
        }
    });
    var oldCallbacks = [],
        rjsonp = /(=)\?(?=&|$)|\?\?/;
    jQuery.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function() {
            var callback = oldCallbacks.pop() || jQuery.expando + "_" + nonce++;
            this[callback] = true;
            return callback
        }
    });
    jQuery.ajaxPrefilter("json jsonp", function(s, originalSettings, jqXHR) {
        var callbackName, overwritten, responseContainer, jsonProp = s.jsonp !== false && (rjsonp.test(s.url) ? "url" : typeof s.data === "string" && (s.contentType || "").indexOf("application/x-www-form-urlencoded") === 0 && rjsonp.test(s.data) && "data");
        if (jsonProp || s.dataTypes[0] === "jsonp") {
            callbackName = s.jsonpCallback = jQuery.isFunction(s.jsonpCallback) ? s.jsonpCallback() : s.jsonpCallback;
            if (jsonProp) {
                s[jsonProp] = s[jsonProp].replace(rjsonp, "$1" + callbackName)
            } else if (s.jsonp !== false) {
                s.url += (rquery.test(s.url) ? "&" : "?") + s.jsonp + "=" + callbackName
            }
            s.converters["script json"] = function() {
                if (!responseContainer) {
                    jQuery.error(callbackName + " was not called")
                }
                return responseContainer[0]
            };
            s.dataTypes[0] = "json";
            overwritten = window[callbackName];
            window[callbackName] = function() {
                responseContainer = arguments
            };
            jqXHR.always(function() {
                if (overwritten === undefined) {
                    jQuery(window).removeProp(callbackName)
                } else {
                    window[callbackName] = overwritten
                }
                if (s[callbackName]) {
                    s.jsonpCallback = originalSettings.jsonpCallback;
                    oldCallbacks.push(callbackName)
                }
                if (responseContainer && jQuery.isFunction(overwritten)) {
                    overwritten(responseContainer[0])
                }
                responseContainer = overwritten = undefined
            });
            return "script"
        }
    });
    jQuery.parseHTML = function(data, context, keepScripts) {
        if (!data || typeof data !== "string") {
            return null
        }
        if (typeof context === "boolean") {
            keepScripts = context;
            context = false
        }
        context = context || document;
        var parsed = rsingleTag.exec(data),
            scripts = !keepScripts && [];
        if (parsed) {
            return [context.createElement(parsed[1])]
        }
        parsed = buildFragment([data], context, scripts);
        if (scripts && scripts.length) {
            jQuery(scripts).remove()
        }
        return jQuery.merge([], parsed.childNodes)
    };
    var _load = jQuery.fn.load;
    jQuery.fn.load = function(url, params, callback) {
        if (typeof url !== "string" && _load) {
            return _load.apply(this, arguments)
        }
        var selector, type, response, self = this,
            off = url.indexOf(" ");
        if (off > -1) {
            selector = jQuery.trim(url.slice(off));
            url = url.slice(0, off)
        }
        if (jQuery.isFunction(params)) {
            callback = params;
            params = undefined
        } else if (params && typeof params === "object") {
            type = "POST";
        }
        if (self.length > 0) {
            jQuery.ajax({
                url: url,
                type: type || "GET",
                dataType: "html",
                data: params
            }).done(function(responseText) {
                response = arguments;
                self.html(selector ? jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector) : responseText)
            }).always(callback && function(jqXHR, status) {
                self.each(function() {
                    callback.apply(this, response || [jqXHR.responseText, status, jqXHR])
                })
            })
        }
        return this
    };
    jQuery.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(i, type) {
        jQuery.fn[type] = function(fn) {
            return this.on(type, fn)
        }
    });
    jQuery.expr.filters.animated = function(elem) {
        return jQuery.grep(jQuery.timers, function(fn) {
            return elem === fn.elem
        }).length
    };

    function getWindow(elem) {
        return jQuery.isWindow(elem) ? elem : elem.nodeType === 9 && elem.defaultView
    }
    jQuery.offset = {
        setOffset: function(elem, options, i) {
            var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition, position = jQuery.css(elem, "position"),
                curElem = jQuery(elem),
                props = {};
            if (position === "static") {
                elem.style.position = "relative"
            }
            curOffset = curElem.offset();
            curCSSTop = jQuery.css(elem, "top");
            curCSSLeft = jQuery.css(elem, "left");
            calculatePosition = (position === "absolute" || position === "fixed") && (curCSSTop + curCSSLeft).indexOf("auto") > -1;
            if (calculatePosition) {
                curPosition = curElem.position();
                curTop = curPosition.top;
                curLeft = curPosition.left
            } else {
                curTop = parseFloat(curCSSTop) || 0;
                curLeft = parseFloat(curCSSLeft) || 0
            }
            if (jQuery.isFunction(options)) {
                options = options.call(elem, i, jQuery.extend({}, curOffset))
            }
            if (options.top != null) {
                props.top = options.top - curOffset.top + curTop
            }
            if (options.left != null) {
                props.left = options.left - curOffset.left + curLeft
            }
            if ("using" in options) {
                options.using.call(elem, props)
            } else {
                curElem.css(props)
            }
        }
    };
    jQuery.fn.extend({
        offset: function(options) {
            if (arguments.length) {
                return options === undefined ? this : this.each(function(i) {
                    jQuery.offset.setOffset(this, options, i)
                })
            }
            var docElem, win, elem = this[0],
                box = {
                    top: 0,
                    left: 0
                },
                doc = elem && elem.ownerDocument;
            if (!doc) {
                return
            }
            docElem = doc.documentElement;
            if (!jQuery.contains(docElem, elem)) {
                return box
            }
            box = elem.getBoundingClientRect();
            win = getWindow(doc);
            return {
                top: box.top + win.pageYOffset - docElem.clientTop,
                left: box.left + win.pageXOffset - docElem.clientLeft
            }
        },
        position: function() {
            if (!this[0]) {
                return
            }
            var offsetParent, offset, elem = this[0],
                parentOffset = {
                    top: 0,
                    left: 0
                };
            if (jQuery.css(elem, "position") === "fixed") {
                offset = elem.getBoundingClientRect()
            } else {
                offsetParent = this.offsetParent();
                offset = this.offset();
                if (!jQuery.nodeName(offsetParent[0], "html")) {
                    parentOffset = offsetParent.offset()
                }
                parentOffset.top += jQuery.css(offsetParent[0], "borderTopWidth", true);
                parentOffset.left += jQuery.css(offsetParent[0], "borderLeftWidth", true)
            }
            return {
                top: offset.top - parentOffset.top - jQuery.css(elem, "marginTop", true),
                left: offset.left - parentOffset.left - jQuery.css(elem, "marginLeft", true)
            }
        },
        offsetParent: function() {
            return this.map(function() {
                var offsetParent = this.offsetParent;
                while (offsetParent && jQuery.css(offsetParent, "position") === "static") {
                    offsetParent = offsetParent.offsetParent
                }
                return offsetParent || documentElement
            })
        }
    });
    jQuery.each({
        scrollLeft: "pageXOffset",
        scrollTop: "pageYOffset"
    }, function(method, prop) {
        var top = "pageYOffset" === prop;
        jQuery.fn[method] = function(val) {
            return access(this, function(elem, method, val) {
                var win = getWindow(elem);
                if (val === undefined) {
                    return win ? win[prop] : elem[method]
                }
                if (win) {
                    win.scrollTo(!top ? val : win.pageXOffset, top ? val : win.pageYOffset)
                } else {
                    elem[method] = val
                }
            }, method, val, arguments.length)
        }
    });
    jQuery.each(["top", "left"], function(i, prop) {
        jQuery.cssHooks[prop] = addGetHookIf(support.pixelPosition, function(elem, computed) {
            if (computed) {
                computed = curCSS(elem, prop);
                return rnumnonpx.test(computed) ? jQuery(elem).position()[prop] + "px" : computed
            }
        })
    });
    jQuery.each({
        Height: "height",
        Width: "width"
    }, function(name, type) {
        jQuery.each({
            padding: "inner" + name,
            content: type,
            "": "outer" + name
        }, function(defaultExtra, funcName) {
            jQuery.fn[funcName] = function(margin, value) {
                var chainable = arguments.length && (defaultExtra || typeof margin !== "boolean"),
                    extra = defaultExtra || (margin === true || value === true ? "margin" : "border");
                return access(this, function(elem, type, value) {
                    var doc;
                    if (jQuery.isWindow(elem)) {
                        return elem.document.documentElement["client" + name]
                    }
                    if (elem.nodeType === 9) {
                        doc = elem.documentElement;
                        return Math.max(elem.body["scroll" + name], doc["scroll" + name], elem.body["offset" + name], doc["offset" + name], doc["client" + name])
                    }
                    return value === undefined ? jQuery.css(elem, type, extra) : jQuery.style(elem, type, value, extra)
                }, type, chainable ? margin : undefined, chainable, null)
            }
        })
    });
    jQuery.fn.extend({
        bind: function(types, data, fn) {
            return this.on(types, null, data, fn)
        },
        unbind: function(types, fn) {
            return this.off(types, null, fn)
        },
        delegate: function(selector, types, data, fn) {
            return this.on(types, selector, data, fn)
        },
        undelegate: function(selector, types, fn) {
            return arguments.length === 1 ? this.off(selector, "**") : this.off(types, selector || "**", fn)
        },
        size: function() {
            return this.length
        }
    });
    jQuery.fn.andSelf = jQuery.fn.addBack;
    if (typeof define === "function" && define.amd) {
        define("jquery", [], function() {
            return jQuery
        })
    }
    var _jQuery = window.jQuery,
        _$ = window.$;
    jQuery.noConflict = function(deep) {
        if (window.$ === jQuery) {
            window.$ = _$
        }
        if (deep && window.jQuery === jQuery) {
            window.jQuery = _jQuery
        }
        return jQuery
    };
    if (!noGlobal) {
        window.jQuery = window.$ = jQuery
    }
    return jQuery
});
window.yii = function($) {
    var pub = {
        reloadableScripts: [],
        clickableSelector: 'a, button, input[type="submit"], input[type="button"], input[type="reset"], ' + 'input[type="image"]',
        changeableSelector: "select, input, textarea",
        getCsrfParam: function() {
            return $("meta[name=csrf-param]").attr("content")
        },
        getCsrfToken: function() {
            return $("meta[name=csrf-token]").attr("content")
        },
        setCsrfToken: function(name, value) {
            $("meta[name=csrf-param]").attr("content", name);
            $("meta[name=csrf-token]").attr("content", value)
        },
        refreshCsrfToken: function() {
            var token = pub.getCsrfToken();
            if (token) {
                $('form input[name="' + pub.getCsrfParam() + '"]').val(token)
            }
        },
        confirm: function(message, ok, cancel) {
            if (window.confirm(message)) {
                !ok || ok()
            } else {
                !cancel || cancel()
            }
        },
        handleAction: function($e, event) {
            var $form = $e.attr("data-form") ? $("#" + $e.attr("data-form")) : $e.closest("form"),
                method = !$e.data("method") && $form ? $form.attr("method") : $e.data("method"),
                action = $e.attr("href"),
                isValidAction = action && action !== "#",
                params = $e.data("params"),
                areValidParams = params && $.isPlainObject(params),
                pjax = $e.data("pjax"),
                usePjax = pjax !== undefined && pjax !== 0 && $.support.pjax,
                pjaxContainer, pjaxOptions = {};
            if (usePjax) {
                pjaxContainer = $e.data("pjax-container") || $e.closest("[data-pjax-container]");
                if (!pjaxContainer.length) {
                    pjaxContainer = $("body")
                }
                pjaxOptions = {
                    container: pjaxContainer,
                    push: !!$e.data("pjax-push-state"),
                    replace: !!$e.data("pjax-replace-state"),
                    scrollTo: $e.data("pjax-scrollto"),
                    pushRedirect: $e.data("pjax-push-redirect"),
                    replaceRedirect: $e.data("pjax-replace-redirect"),
                    skipOuterContainers: $e.data("pjax-skip-outer-containers"),
                    timeout: $e.data("pjax-timeout"),
                    originalEvent: event,
                    originalTarget: $e
                }
            }
            if (method === undefined) {
                if (isValidAction) {
                    usePjax ? $.pjax.click(event, pjaxOptions) : window.location.assign(action)
                } else if ($e.is(":submit") && $form.length) {
                    if (usePjax) {
                        $form.on("submit", function(e) {
                            $.pjax.submit(e, pjaxOptions)
                        })
                    }
                    $form.trigger("submit")
                }
                return
            }
            var oldMethod, oldAction, newForm = !$form.length;
            if (!newForm) {
                oldMethod = $form.attr("method");
                $form.attr("method", method);
                if (isValidAction) {
                    oldAction = $form.attr("action");
                    $form.attr("action", action)
                }
            } else {
                if (!isValidAction) {
                    action = pub.getCurrentUrl()
                }
                $form = $("<form/>", {
                    method: method,
                    action: action
                });
                var target = $e.attr("target");
                if (target) {
                    $form.attr("target", target)
                }
                if (!/(get|post)/i.test(method)) {
                    $form.append($("<input/>", {
                        name: "_method",
                        value: method,
                        type: "hidden"
                    }));
                    method = "post";
                    $form.attr("method", method)
                }
                if (/post/i.test(method)) {
                    var csrfParam = pub.getCsrfParam();
                    if (csrfParam) {
                        $form.append($("<input/>", {
                            name: csrfParam,
                            value: pub.getCsrfToken(),
                            type: "hidden"
                        }))
                    }
                }
                $form.hide().appendTo("body")
            }
            var activeFormData = $form.data("yiiActiveForm");
            if (activeFormData) {
                activeFormData.submitObject = $e
            }
            if (areValidParams) {
                $.each(params, function(name, value) {
                    $form.append($("<input/>").attr({
                        name: name,
                        value: value,
                        type: "hidden"
                    }))
                })
            }
            if (usePjax) {
                $form.on("submit", function(e) {
                    $.pjax.submit(e, pjaxOptions)
                })
            }
            $form.trigger("submit");
            $.when($form.data("yiiSubmitFinalizePromise")).then(function() {
                if (newForm) {
                    $form.remove();
                    return
                }
                if (oldAction !== undefined) {
                    $form.attr("action", oldAction)
                }
                $form.attr("method", oldMethod);
                if (areValidParams) {
                    $.each(params, function(name) {
                        $('input[name="' + name + '"]', $form).remove()
                    })
                }
            })
        },
        getQueryParams: function(url) {
            var pos = url.indexOf("?");
            if (pos < 0) {
                return {}
            }
            var pairs = $.grep(url.substring(pos + 1).split("#")[0].split("&"), function(value) {
                return value !== ""
            });
            var params = {};
            for (var i = 0, len = pairs.length; i < len; i++) {
                var pair = pairs[i].split("=");
                var name = decodeURIComponent(pair[0].replace(/\+/g, "%20"));
                var value = decodeURIComponent(pair[1].replace(/\+/g, "%20"));
                if (!name.length) {
                    continue
                }
                if (params[name] === undefined) {
                    params[name] = value || ""
                } else {
                    if (!$.isArray(params[name])) {
                        params[name] = [params[name]]
                    }
                    params[name].push(value || "")
                }
            }
            return params
        },
        initModule: function(module) {
            if (module.isActive !== undefined && !module.isActive) {
                return
            }
            if ($.isFunction(module.init)) {
                module.init()
            }
            $.each(module, function() {
                if ($.isPlainObject(this)) {
                    pub.initModule(this)
                }
            })
        },
        init: function() {
            initCsrfHandler();
            initRedirectHandler();
            initAssetFilters();
            initDataMethods()
        },
        getBaseCurrentUrl: function() {
            return window.location.protocol + "//" + window.location.host
        },
        getCurrentUrl: function() {
            return window.location.href
        }
    };

    function initCsrfHandler() {
        $.ajaxPrefilter(function(options, originalOptions, xhr) {
            if (!options.crossDomain && pub.getCsrfParam()) {
                xhr.setRequestHeader("X-CSRF-Token", pub.getCsrfToken())
            }
        });
        pub.refreshCsrfToken()
    }

    function initRedirectHandler() {
        $(document).ajaxComplete(function(event, xhr) {
            var url = xhr && xhr.getResponseHeader("X-Redirect");
            if (url) {
                window.location.assign(url)
            }
        })
    }

    function initAssetFilters() {
        var loadedScripts = {};
        $("script[src]").each(function() {
            var url = getAbsoluteUrl(this.src);
            loadedScripts[url] = true
        });
        $.ajaxPrefilter("script", function(options, originalOptions, xhr) {
            if (options.dataType == "jsonp") {
                return
            }
            var url = getAbsoluteUrl(options.url),
                forbiddenRepeatedLoad = loadedScripts[url] === true && !isReloadableAsset(url),
                cleanupRunning = loadedScripts[url] !== undefined && loadedScripts[url]["xhrDone"] === true;
            if (forbiddenRepeatedLoad || cleanupRunning) {
                xhr.abort();
                return
            }
            if (loadedScripts[url] === undefined || loadedScripts[url] === true) {
                loadedScripts[url] = {
                    xhrList: [],
                    xhrDone: false
                }
            }
            xhr.done(function(data, textStatus, jqXHR) {
                if (loadedScripts[jqXHR.yiiUrl]["xhrDone"] === true) {
                    return
                }
                loadedScripts[jqXHR.yiiUrl]["xhrDone"] = true;
                for (var i = 0, len = loadedScripts[jqXHR.yiiUrl]["xhrList"].length; i < len; i++) {
                    var singleXhr = loadedScripts[jqXHR.yiiUrl]["xhrList"][i];
                    if (singleXhr && singleXhr.readyState !== XMLHttpRequest.DONE) {
                        singleXhr.abort()
                    }
                }
                loadedScripts[jqXHR.yiiUrl] = true
            }).fail(function(jqXHR, textStatus) {
                if (textStatus === "abort") {
                    return
                }
                delete loadedScripts[jqXHR.yiiUrl]["xhrList"][jqXHR.yiiIndex];
                var allFailed = true;
                for (var i = 0, len = loadedScripts[jqXHR.yiiUrl]["xhrList"].length; i < len; i++) {
                    if (loadedScripts[jqXHR.yiiUrl]["xhrList"][i]) {
                        allFailed = false
                    }
                }
                if (allFailed) {
                    delete loadedScripts[jqXHR.yiiUrl]
                }
            });
            xhr.yiiIndex = loadedScripts[url]["xhrList"].length;
            xhr.yiiUrl = url;
            loadedScripts[url]["xhrList"][xhr.yiiIndex] = xhr
        });
        $(document).ajaxComplete(function() {
            var styleSheets = [];
            $("link[rel=stylesheet]").each(function() {
                var url = getAbsoluteUrl(this.href);
                if (isReloadableAsset(url)) {
                    return
                }
                $.inArray(url, styleSheets) === -1 ? styleSheets.push(url) : $(this).remove()
            })
        })
    }

    function initDataMethods() {
        var handler = function(event) {
            var $this = $(this),
                method = $this.data("method"),
                message = $this.data("confirm"),
                form = $this.data("form");
            if (method === undefined && message === undefined && form === undefined) {
                return true
            }
            if (message !== undefined) {
                $.proxy(pub.confirm, this)(message, function() {
                    pub.handleAction($this, event)
                })
            } else {
                pub.handleAction($this, event)
            }
            event.stopImmediatePropagation();
            return false
        };
        $(document).on("click.yii", pub.clickableSelector, handler).on("change.yii", pub.changeableSelector, handler)
    }

    function isReloadableAsset(url) {
        for (var i = 0; i < pub.reloadableScripts.length; i++) {
            var rule = getAbsoluteUrl(pub.reloadableScripts[i]);
            var match = new RegExp("^" + escapeRegExp(rule).split("\\*").join(".+") + "$").test(url);
            if (match === true) {
                return true
            }
        }
        return false
    }

    function escapeRegExp(str) {
        return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&")
    }

    function getAbsoluteUrl(url) {
        return url.charAt(0) === "/" ? pub.getBaseCurrentUrl() + url : url
    }
    return pub
}(window.jQuery);
window.jQuery(function() {
    window.yii.initModule(window.yii)
});
(function($) {
    $.fn.yiiActiveForm = function(method) {
        if (methods[method]) {
            return methods[method].apply(this, Array.prototype.slice.call(arguments, 1))
        } else if (typeof method === "object" || !method) {
            return methods.init.apply(this, arguments)
        } else {
            $.error("Method " + method + " does not exist on jQuery.yiiActiveForm");
            return false
        }
    };
    var events = {
        beforeValidate: "beforeValidate",
        afterValidate: "afterValidate",
        beforeValidateAttribute: "beforeValidateAttribute",
        afterValidateAttribute: "afterValidateAttribute",
        beforeSubmit: "beforeSubmit",
        ajaxBeforeSend: "ajaxBeforeSend",
        ajaxComplete: "ajaxComplete",
        afterInit: "afterInit"
    };
    var defaults = {
        encodeErrorSummary: true,
        errorSummary: ".error-summary",
        validateOnSubmit: true,
        errorCssClass: "has-error",
        successCssClass: "has-success",
        validatingCssClass: "validating",
        ajaxParam: "ajax",
        ajaxDataType: "json",
        validationUrl: undefined,
        scrollToError: true,
        scrollToErrorOffset: 0
    };
    var attributeDefaults = {
        id: undefined,
        name: undefined,
        container: undefined,
        input: undefined,
        error: ".help-block",
        encodeError: true,
        validateOnChange: true,
        validateOnBlur: true,
        validateOnType: false,
        validationDelay: 500,
        enableAjaxValidation: false,
        validate: undefined,
        status: 0,
        cancelled: false,
        value: undefined,
        updateAriaInvalid: true
    };
    var submitDefer;
    var setSubmitFinalizeDefer = function($form) {
        submitDefer = $.Deferred();
        $form.data("yiiSubmitFinalizePromise", submitDefer.promise())
    };
    var submitFinalize = function($form) {
        if (submitDefer) {
            submitDefer.resolve();
            submitDefer = undefined;
            $form.removeData("yiiSubmitFinalizePromise")
        }
    };
    var methods = {
        init: function(attributes, options) {
            return this.each(function() {
                var $form = $(this);
                if ($form.data("yiiActiveForm")) {
                    return
                }
                var settings = $.extend({}, defaults, options || {});
                if (settings.validationUrl === undefined) {
                    settings.validationUrl = $form.attr("action")
                }
                $.each(attributes, function(i) {
                    attributes[i] = $.extend({
                        value: getValue($form, this)
                    }, attributeDefaults, this);
                    watchAttribute($form, attributes[i])
                });
                $form.data("yiiActiveForm", {
                    settings: settings,
                    attributes: attributes,
                    submitting: false,
                    validated: false,
                    options: getFormOptions($form)
                });
                $form.bind("reset.yiiActiveForm", methods.resetForm);
                if (settings.validateOnSubmit) {
                    $form.on("mouseup.yiiActiveForm keyup.yiiActiveForm", ":submit", function() {
                        $form.data("yiiActiveForm").submitObject = $(this)
                    });
                    $form.on("submit.yiiActiveForm", methods.submitForm)
                }
                var event = $.Event(events.afterInit);
                $form.trigger(event)
            })
        },
        add: function(attribute) {
            var $form = $(this);
            attribute = $.extend({
                value: getValue($form, attribute)
            }, attributeDefaults, attribute);
            $form.data("yiiActiveForm").attributes.push(attribute);
            watchAttribute($form, attribute)
        },
        remove: function(id) {
            var $form = $(this),
                attributes = $form.data("yiiActiveForm").attributes,
                index = -1,
                attribute = undefined;
            $.each(attributes, function(i) {
                if (attributes[i]["id"] == id) {
                    index = i;
                    attribute = attributes[i];
                    return false
                }
            });
            if (index >= 0) {
                attributes.splice(index, 1);
                unwatchAttribute($form, attribute)
            }
            return attribute
        },
        validateAttribute: function(id) {
            var attribute = methods.find.call(this, id);
            if (attribute != undefined) {
                validateAttribute($(this), attribute, true)
            }
        },
        find: function(id) {
            var attributes = $(this).data("yiiActiveForm").attributes,
                result = undefined;
            $.each(attributes, function(i) {
                if (attributes[i]["id"] == id) {
                    result = attributes[i];
                    return false
                }
            });
            return result
        },
        destroy: function() {
            return this.each(function() {
                $(this).unbind(".yiiActiveForm");
                $(this).removeData("yiiActiveForm")
            })
        },
        data: function() {
            return this.data("yiiActiveForm")
        },
        validate: function(forceValidate) {
            if (forceValidate) {
                $(this).data("yiiActiveForm").submitting = true
            }
            var $form = $(this),
                data = $form.data("yiiActiveForm"),
                needAjaxValidation = false,
                messages = {},
                deferreds = deferredArray(),
                submitting = data.submitting && !forceValidate;
            if (data.submitting) {
                var event = $.Event(events.beforeValidate);
                $form.trigger(event, [messages, deferreds]);
                if (event.result === false) {
                    data.submitting = false;
                    submitFinalize($form);
                    return
                }
            }
            $.each(data.attributes, function() {
                this.$form = $form;
                if (!$(this.input).is(":disabled")) {
                    this.cancelled = false;
                    if (data.submitting || this.status === 2 || this.status === 3) {
                        var msg = messages[this.id];
                        if (msg === undefined) {
                            msg = [];
                            messages[this.id] = msg
                        }
                        var event = $.Event(events.beforeValidateAttribute);
                        $form.trigger(event, [this, msg, deferreds]);
                        if (event.result !== false) {
                            if (this.validate) {
                                this.validate(this, getValue($form, this), msg, deferreds, $form)
                            }
                            if (this.enableAjaxValidation) {
                                needAjaxValidation = true
                            }
                        } else {
                            this.cancelled = true
                        }
                    }
                }
            });
            $.when.apply(this, deferreds).always(function() {
                for (var i in messages) {
                    if (0 === messages[i].length) {
                        delete messages[i]
                    }
                }
                if (needAjaxValidation && ($.isEmptyObject(messages) || data.submitting)) {
                    var $button = data.submitObject,
                        extData = "&" + data.settings.ajaxParam + "=" + $form.attr("id");
                    if ($button && $button.length && $button.attr("name")) {
                        extData += "&" + $button.attr("name") + "=" + $button.attr("value")
                    }
                    $.ajax({
                        url: data.settings.validationUrl,
                        type: $form.attr("method"),
                        data: $form.serialize() + extData,
                        dataType: data.settings.ajaxDataType,
                        complete: function(jqXHR, textStatus) {
                            $form.trigger(events.ajaxComplete, [jqXHR, textStatus])
                        },
                        beforeSend: function(jqXHR, settings) {
                            $form.trigger(events.ajaxBeforeSend, [jqXHR, settings])
                        },
                        success: function(msgs) {
                            if (msgs !== null && typeof msgs === "object") {
                                $.each(data.attributes, function() {
                                    if (!this.enableAjaxValidation || this.cancelled) {
                                        delete msgs[this.id]
                                    }
                                });
                                updateInputs($form, $.extend(messages, msgs), submitting)
                            } else {
                                updateInputs($form, messages, submitting)
                            }
                        },
                        error: function() {
                            data.submitting = false;
                            submitFinalize($form)
                        }
                    })
                } else if (data.submitting) {
                    setTimeout(function() {
                        updateInputs($form, messages, submitting)
                    }, 200)
                } else {
                    updateInputs($form, messages, submitting)
                }
            })
        },
        submitForm: function() {
            var $form = $(this),
                data = $form.data("yiiActiveForm");
            if (data.validated) {
                data.submitting = false;
                var event = $.Event(events.beforeSubmit);
                $form.trigger(event);
                if (event.result === false) {
                    data.validated = false;
                    submitFinalize($form);
                    return false
                }
                updateHiddenButton($form);
                return true
            } else {
                setSubmitFinalizeDefer($form);
                if (data.settings.timer !== undefined) {
                    clearTimeout(data.settings.timer)
                }
                data.submitting = true;
                methods.validate.call($form);
                return false
            }
        },
        resetForm: function() {
            var $form = $(this);
            var data = $form.data("yiiActiveForm");
            setTimeout(function() {
                $.each(data.attributes, function() {
                    this.value = getValue($form, this);
                    this.status = 0;
                    var $container = $form.find(this.container);
                    $container.removeClass(data.settings.validatingCssClass + " " + data.settings.errorCssClass + " " + data.settings.successCssClass);
                    $container.find(this.error).html("")
                });
                $form.find(data.settings.errorSummary).hide().find("ul").html("")
            }, 1)
        },
        updateMessages: function(messages, summary) {
            var $form = $(this);
            var data = $form.data("yiiActiveForm");
            $.each(data.attributes, function() {
                updateInput($form, this, messages)
            });
            if (summary) {
                updateSummary($form, messages)
            }
        },
        updateAttribute: function(id, messages) {
            var attribute = methods.find.call(this, id);
            if (attribute != undefined) {
                var msg = {};
                msg[id] = messages;
                updateInput($(this), attribute, msg)
            }
        }
    };
    var watchAttribute = function($form, attribute) {
        var $input = findInput($form, attribute);
        if (attribute.validateOnChange) {
            $input.on("change.yiiActiveForm", function() {
                validateAttribute($form, attribute, false)
            })
        }
        if (attribute.validateOnBlur) {
            $input.on("blur.yiiActiveForm", function() {
                if (attribute.status == 0 || attribute.status == 1) {
                    validateAttribute($form, attribute, true)
                }
            })
        }
        if (attribute.validateOnType) {
            $input.on("keyup.yiiActiveForm", function(e) {
                if ($.inArray(e.which, [16, 17, 18, 37, 38, 39, 40]) !== -1) {
                    return
                }
                if (attribute.value !== getValue($form, attribute)) {
                    validateAttribute($form, attribute, false, attribute.validationDelay)
                }
            })
        }
    };
    var unwatchAttribute = function($form, attribute) {
        findInput($form, attribute).off(".yiiActiveForm")
    };
    var validateAttribute = function($form, attribute, forceValidate, validationDelay) {
        var data = $form.data("yiiActiveForm");
        if (forceValidate) {
            attribute.status = 2
        }
        $.each(data.attributes, function() {
            if (this.value !== getValue($form, this)) {
                this.status = 2;
                forceValidate = true
            }
        });
        if (!forceValidate) {
            return
        }
        if (data.settings.timer !== undefined) {
            clearTimeout(data.settings.timer)
        }
        data.settings.timer = setTimeout(function() {
            if (data.submitting || $form.is(":hidden")) {
                return
            }
            $.each(data.attributes, function() {
                if (this.status === 2) {
                    this.status = 3;
                    $form.find(this.container).addClass(data.settings.validatingCssClass)
                }
            });
            methods.validate.call($form)
        }, validationDelay ? validationDelay : 200)
    };
    var deferredArray = function() {
        var array = [];
        array.add = function(callback) {
            this.push(new $.Deferred(callback))
        };
        return array
    };
    var buttonOptions = ["action", "target", "method", "enctype"];
    var getFormOptions = function($form) {
        var attributes = {};
        for (var i = 0; i < buttonOptions.length; i++) {
            attributes[buttonOptions[i]] = $form.attr(buttonOptions[i])
        }
        return attributes
    };
    var applyButtonOptions = function($form, $button) {
        for (var i = 0; i < buttonOptions.length; i++) {
            var value = $button.attr("form" + buttonOptions[i]);
            if (value) {
                $form.attr(buttonOptions[i], value)
            }
        }
    };
    var restoreButtonOptions = function($form) {
        var data = $form.data("yiiActiveForm");
        for (var i = 0; i < buttonOptions.length; i++) {
            $form.attr(buttonOptions[i], data.options[buttonOptions[i]] || null)
        }
    };
    var updateInputs = function($form, messages, submitting) {
        var data = $form.data("yiiActiveForm");
        if (data === undefined) {
            return false
        }
        if (submitting) {
            var errorAttributes = [];
            $.each(data.attributes, function() {
                if (!$(this.input).is(":disabled") && !this.cancelled && updateInput($form, this, messages)) {
                    errorAttributes.push(this)
                }
            });
            $form.trigger(events.afterValidate, [messages, errorAttributes]);
            updateSummary($form, messages);
            if (errorAttributes.length) {
                if (data.settings.scrollToError) {
                    var top = $form.find($.map(errorAttributes, function(attribute) {
                        return attribute.input
                    }).join(",")).first().closest(":visible").offset().top - data.settings.scrollToErrorOffset;
                    if (top < 0) {
                        top = 0
                    } else if (top > $(document).height()) {
                        top = $(document).height()
                    }
                    var wtop = $(window).scrollTop();
                    if (top < wtop || top > wtop + $(window).height()) {
                        $(window).scrollTop(top)
                    }
                }
                data.submitting = false
            } else {
                data.validated = true;
                if (data.submitObject) {
                    applyButtonOptions($form, data.submitObject)
                }
                $form.submit();
                if (data.submitObject) {
                    restoreButtonOptions($form)
                }
            }
        } else {
            $.each(data.attributes, function() {
                if (!this.cancelled && (this.status === 2 || this.status === 3)) {
                    updateInput($form, this, messages)
                }
            })
        }
        submitFinalize($form)
    };
    var updateHiddenButton = function($form) {
        var data = $form.data("yiiActiveForm");
        var $button = data.submitObject || $form.find(":submit:first");
        if ($button.length && $button.attr("type") == "submit" && $button.attr("name")) {
            var $hiddenButton = $('input[type="hidden"][name="' + $button.attr("name") + '"]', $form);
            if (!$hiddenButton.length) {
                $("<input>").attr({
                    type: "hidden",
                    name: $button.attr("name"),
                    value: $button.attr("value")
                }).appendTo($form)
            } else {
                $hiddenButton.attr("value", $button.attr("value"))
            }
        }
    };
    var updateInput = function($form, attribute, messages) {
        var data = $form.data("yiiActiveForm"),
            $input = findInput($form, attribute),
            hasError = false;
        if (!$.isArray(messages[attribute.id])) {
            messages[attribute.id] = []
        }
        $form.trigger(events.afterValidateAttribute, [attribute, messages[attribute.id]]);
        attribute.status = 1;
        if ($input.length) {
            hasError = messages[attribute.id].length > 0;
            var $container = $form.find(attribute.container);
            var $error = $container.find(attribute.error);
            updateAriaInvalid($form, attribute, hasError);
            if (hasError) {
                if (attribute.encodeError) {
                    $error.text(messages[attribute.id][0])
                } else {
                    $error.html(messages[attribute.id][0])
                }
                $container.removeClass(data.settings.validatingCssClass + " " + data.settings.successCssClass).addClass(data.settings.errorCssClass)
            } else {
                $error.empty();
                $container.removeClass(data.settings.validatingCssClass + " " + data.settings.errorCssClass + " ").addClass(data.settings.successCssClass)
            }
            attribute.value = getValue($form, attribute)
        }
        return hasError
    };
    var updateSummary = function($form, messages) {
        var data = $form.data("yiiActiveForm"),
            $summary = $form.find(data.settings.errorSummary),
            $ul = $summary.find("ul").empty();
        if ($summary.length && messages) {
            $.each(data.attributes, function() {
                if ($.isArray(messages[this.id]) && messages[this.id].length) {
                    var error = $("<li/>");
                    if (data.settings.encodeErrorSummary) {
                        error.text(messages[this.id][0])
                    } else {
                        error.html(messages[this.id][0])
                    }
                    $ul.append(error)
                }
            });
            $summary.toggle($ul.find("li").length > 0)
        }
    };
    var getValue = function($form, attribute) {
        var $input = findInput($form, attribute);
        var type = $input.attr("type");
        if (type === "checkbox" || type === "radio") {
            var $realInput = $input.filter(":checked");
            if (!$realInput.length) {
                $realInput = $form.find('input[type=hidden][name="' + $input.attr("name") + '"]')
            }
            return $realInput.val()
        } else {
            return $input.val()
        }
    };
    var findInput = function($form, attribute) {
        var $input = $form.find(attribute.input);
        if ($input.length && $input[0].tagName.toLowerCase() === "div") {
            return $input.find("input")
        } else {
            return $input
        }
    };
    var updateAriaInvalid = function($form, attribute, hasError) {
        if (attribute.updateAriaInvalid) {
            $form.find(attribute.input).attr("aria-invalid", hasError ? "true" : "false")
        }
    }
})(window.jQuery);
yii.validation = function($) {
    var pub = {
        isEmpty: function(value) {
            return value === null || value === undefined || $.isArray(value) && value.length === 0 || value === ""
        },
        addMessage: function(messages, message, value) {
            messages.push(message.replace(/\{value\}/g, value))
        },
        required: function(value, messages, options) {
            var valid = false;
            if (options.requiredValue === undefined) {
                var isString = typeof value == "string" || value instanceof String;
                if (options.strict && value !== undefined || !options.strict && !pub.isEmpty(isString ? $.trim(value) : value)) {
                    valid = true
                }
            } else if (!options.strict && value == options.requiredValue || options.strict && value === options.requiredValue) {
                valid = true
            }
            if (!valid) {
                pub.addMessage(messages, options.message, value)
            }
        },
        boolean: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            var valid = !options.strict && (value == options.trueValue || value == options.falseValue) || options.strict && (value === options.trueValue || value === options.falseValue);
            if (!valid) {
                pub.addMessage(messages, options.message, value)
            }
        },
        string: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            if (typeof value !== "string") {
                pub.addMessage(messages, options.message, value);
                return
            }
            if (options.is !== undefined && value.length != options.is) {
                pub.addMessage(messages, options.notEqual, value);
                return
            }
            if (options.min !== undefined && value.length < options.min) {
                pub.addMessage(messages, options.tooShort, value)
            }
            if (options.max !== undefined && value.length > options.max) {
                pub.addMessage(messages, options.tooLong, value)
            }
        },
        file: function(attribute, messages, options) {
            var files = getUploadedFiles(attribute, messages, options);
            $.each(files, function(i, file) {
                validateFile(file, messages, options)
            })
        },
        image: function(attribute, messages, options, deferredList) {
            var files = getUploadedFiles(attribute, messages, options);
            $.each(files, function(i, file) {
                validateFile(file, messages, options);
                if (typeof FileReader === "undefined") {
                    return
                }
                var deferred = $.Deferred();
                pub.validateImage(file, messages, options, deferred, new FileReader, new Image);
                deferredList.push(deferred)
            })
        },
        validateImage: function(file, messages, options, deferred, fileReader, image) {
            image.onload = function() {
                validateImageSize(file, image, messages, options);
                deferred.resolve()
            };
            image.onerror = function() {
                messages.push(options.notImage.replace(/\{file\}/g, file.name));
                deferred.resolve()
            };
            fileReader.onload = function() {
                image.src = this.result
            };
            fileReader.onerror = function() {
                deferred.resolve()
            };
            fileReader.readAsDataURL(file)
        },
        number: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            if (typeof value === "string" && !options.pattern.test(value)) {
                pub.addMessage(messages, options.message, value);
                return
            }
            if (options.min !== undefined && value < options.min) {
                pub.addMessage(messages, options.tooSmall, value)
            }
            if (options.max !== undefined && value > options.max) {
                pub.addMessage(messages, options.tooBig, value)
            }
        },
        range: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            if (!options.allowArray && $.isArray(value)) {
                pub.addMessage(messages, options.message, value);
                return
            }
            var inArray = true;
            $.each($.isArray(value) ? value : [value], function(i, v) {
                if ($.inArray(v, options.range) == -1) {
                    inArray = false;
                    return false
                } else {
                    return true
                }
            });
            if (options.not === undefined) {
                options.not = false
            }
            if (options.not === inArray) {
                pub.addMessage(messages, options.message, value)
            }
        },
        regularExpression: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            if (!options.not && !options.pattern.test(value) || options.not && options.pattern.test(value)) {
                pub.addMessage(messages, options.message, value)
            }
        },
        email: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            var valid = true,
                regexp = /^((?:"?([^"]*)"?\s)?)(?:\s+)?(?:(<?)((.+)@([^>]+))(>?))$/,
                matches = regexp.exec(value);
            if (matches === null) {
                valid = false
            } else {
                var localPart = matches[5],
                    domain = matches[6];
                if (options.enableIDN) {
                    localPart = punycode.toASCII(localPart);
                    domain = punycode.toASCII(domain);
                    value = matches[1] + matches[3] + localPart + "@" + domain + matches[7]
                }
                if (localPart.length > 64) {
                    valid = false
                } else if ((localPart + "@" + domain).length > 254) {
                    valid = false
                } else {
                    valid = options.pattern.test(value) || options.allowName && options.fullPattern.test(value)
                }
            }
            if (!valid) {
                pub.addMessage(messages, options.message, value)
            }
        },
        url: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            if (options.defaultScheme && !/:\/\//.test(value)) {
                value = options.defaultScheme + "://" + value
            }
            var valid = true;
            if (options.enableIDN) {
                var matches = /^([^:]+):\/\/([^\/]+)(.*)$/.exec(value);
                if (matches === null) {
                    valid = false
                } else {
                    value = matches[1] + "://" + punycode.toASCII(matches[2]) + matches[3]
                }
            }
            if (!valid || !options.pattern.test(value)) {
                pub.addMessage(messages, options.message, value)
            }
        },
        trim: function($form, attribute, options) {
            var $input = $form.find(attribute.input);
            var value = $input.val();
            if (!options.skipOnEmpty || !pub.isEmpty(value)) {
                value = $.trim(value);
                $input.val(value)
            }
            return value
        },
        captcha: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            var hash = $("body").data(options.hashKey);
            hash = hash == null ? options.hash : hash[options.caseSensitive ? 0 : 1];
            var v = options.caseSensitive ? value : value.toLowerCase();
            for (var i = v.length - 1, h = 0; i >= 0; --i) {
                h += v.charCodeAt(i)
            }
            if (h != hash) {
                pub.addMessage(messages, options.message, value)
            }
        },
        compare: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            var compareValue, valid = true;
            if (options.compareAttribute === undefined) {
                compareValue = options.compareValue
            } else {
                compareValue = $("#" + options.compareAttribute).val()
            }
            if (options.type === "number") {
                value = parseFloat(value);
                compareValue = parseFloat(compareValue)
            }
            switch (options.operator) {
                case "==":
                    valid = value == compareValue;
                    break;
                case "===":
                    valid = value === compareValue;
                    break;
                case "!=":
                    valid = value != compareValue;
                    break;
                case "!==":
                    valid = value !== compareValue;
                    break;
                case ">":
                    valid = value > compareValue;
                    break;
                case ">=":
                    valid = value >= compareValue;
                    break;
                case "<":
                    valid = value < compareValue;
                    break;
                case "<=":
                    valid = value <= compareValue;
                    break;
                default:
                    valid = false;
                    break
            }
            if (!valid) {
                pub.addMessage(messages, options.message, value)
            }
        },
        ip: function(value, messages, options) {
            if (options.skipOnEmpty && pub.isEmpty(value)) {
                return
            }
            var negation = null,
                cidr = null,
                matches = new RegExp(options.ipParsePattern).exec(value);
            if (matches) {
                negation = matches[1] || null;
                value = matches[2];
                cidr = matches[4] || null
            }
            if (options.subnet === true && cidr === null) {
                pub.addMessage(messages, options.messages.noSubnet, value);
                return
            }
            if (options.subnet === false && cidr !== null) {
                pub.addMessage(messages, options.messages.hasSubnet, value);
                return
            }
            if (options.negation === false && negation !== null) {
                pub.addMessage(messages, options.messages.message, value);
                return
            }
            var ipVersion = value.indexOf(":") === -1 ? 4 : 6;
            if (ipVersion == 6) {
                if (!new RegExp(options.ipv6Pattern).test(value)) {
                    pub.addMessage(messages, options.messages.message, value)
                }
                if (!options.ipv6) {
                    pub.addMessage(messages, options.messages.ipv6NotAllowed, value)
                }
            } else {
                if (!new RegExp(options.ipv4Pattern).test(value)) {
                    pub.addMessage(messages, options.messages.message, value);
                }
                if (!options.ipv4) {
                    pub.addMessage(messages, options.messages.ipv4NotAllowed, value)
                }
            }
        }
    };

    function getUploadedFiles(attribute, messages, options) {
        if (typeof File === "undefined") {
            return []
        }
        var files = $(attribute.input, attribute.$form).get(0).files;
        if (!files) {
            messages.push(options.message);
            return []
        }
        if (files.length === 0) {
            if (!options.skipOnEmpty) {
                messages.push(options.uploadRequired)
            }
            return []
        }
        if (options.maxFiles && options.maxFiles < files.length) {
            messages.push(options.tooMany);
            return []
        }
        return files
    }

    function validateFile(file, messages, options) {
        if (options.extensions && options.extensions.length > 0) {
            var index = file.name.lastIndexOf(".");
            var ext = !~index ? "" : file.name.substr(index + 1, file.name.length).toLowerCase();
            if (!~options.extensions.indexOf(ext)) {
                messages.push(options.wrongExtension.replace(/\{file\}/g, file.name))
            }
        }
        if (options.mimeTypes && options.mimeTypes.length > 0) {
            if (!validateMimeType(options.mimeTypes, file.type)) {
                messages.push(options.wrongMimeType.replace(/\{file\}/g, file.name))
            }
        }
        if (options.maxSize && options.maxSize < file.size) {
            messages.push(options.tooBig.replace(/\{file\}/g, file.name))
        }
        if (options.minSize && options.minSize > file.size) {
            messages.push(options.tooSmall.replace(/\{file\}/g, file.name))
        }
    }

    function validateMimeType(mimeTypes, fileType) {
        for (var i = 0, len = mimeTypes.length; i < len; i++) {
            if (new RegExp(mimeTypes[i]).test(fileType)) {
                return true
            }
        }
        return false
    }

    function validateImageSize(file, image, messages, options) {
        if (options.minWidth && image.width < options.minWidth) {
            messages.push(options.underWidth.replace(/\{file\}/g, file.name))
        }
        if (options.maxWidth && image.width > options.maxWidth) {
            messages.push(options.overWidth.replace(/\{file\}/g, file.name))
        }
        if (options.minHeight && image.height < options.minHeight) {
            messages.push(options.underHeight.replace(/\{file\}/g, file.name))
        }
        if (options.maxHeight && image.height > options.maxHeight) {
            messages.push(options.overHeight.replace(/\{file\}/g, file.name))
        }
    }
    return pub
}(jQuery);
! function(root, factory) {
    if (typeof define === "function" && define.amd) {
        define(["jquery"], function($) {
            return factory(root, $)
        })
    } else if (typeof exports === "object") {
        factory(root, require("jquery"))
    } else {
        factory(root, root.jQuery || root.Zepto)
    }
}(this, function(global, $) {
    "use strict";
    var PLUGIN_NAME = "remodal";
    var NAMESPACE = global.REMODAL_GLOBALS && global.REMODAL_GLOBALS.NAMESPACE || PLUGIN_NAME;
    var ANIMATIONSTART_EVENTS = $.map(["animationstart", "webkitAnimationStart", "MSAnimationStart", "oAnimationStart"], function(eventName) {
        return eventName + "." + NAMESPACE
    }).join(" ");
    var ANIMATIONEND_EVENTS = $.map(["animationend", "webkitAnimationEnd", "MSAnimationEnd", "oAnimationEnd"], function(eventName) {
        return eventName + "." + NAMESPACE
    }).join(" ");
    var DEFAULTS = $.extend({
        hashTracking: true,
        closeOnConfirm: true,
        closeOnCancel: true,
        closeOnEscape: true,
        closeOnOutsideClick: true,
        modifier: ""
    }, global.REMODAL_GLOBALS && global.REMODAL_GLOBALS.DEFAULTS);
    var STATES = {
        CLOSING: "closing",
        CLOSED: "closed",
        OPENING: "opening",
        OPENED: "opened"
    };
    var STATE_CHANGE_REASONS = {
        CONFIRMATION: "confirmation",
        CANCELLATION: "cancellation"
    };
    var IS_ANIMATION = function() {
        var style = document.createElement("div").style;
        return style.animationName !== undefined || style.WebkitAnimationName !== undefined || style.MozAnimationName !== undefined || style.msAnimationName !== undefined || style.OAnimationName !== undefined
    }();
    var current;
    var scrollTop;

    function getAnimationDuration($elem) {
        if (IS_ANIMATION && $elem.css("animation-name") === "none" && $elem.css("-webkit-animation-name") === "none" && $elem.css("-moz-animation-name") === "none" && $elem.css("-o-animation-name") === "none" && $elem.css("-ms-animation-name") === "none") {
            return 0
        }
        var duration = $elem.css("animation-duration") || $elem.css("-webkit-animation-duration") || $elem.css("-moz-animation-duration") || $elem.css("-o-animation-duration") || $elem.css("-ms-animation-duration") || "0s";
        var delay = $elem.css("animation-delay") || $elem.css("-webkit-animation-delay") || $elem.css("-moz-animation-delay") || $elem.css("-o-animation-delay") || $elem.css("-ms-animation-delay") || "0s";
        var iterationCount = $elem.css("animation-iteration-count") || $elem.css("-webkit-animation-iteration-count") || $elem.css("-moz-animation-iteration-count") || $elem.css("-o-animation-iteration-count") || $elem.css("-ms-animation-iteration-count") || "1";
        var max;
        var len;
        var num;
        var i;
        duration = duration.split(", ");
        delay = delay.split(", ");
        iterationCount = iterationCount.split(", ");
        for (i = 0, len = duration.length, max = Number.NEGATIVE_INFINITY; i < len; i++) {
            num = parseFloat(duration[i]) * parseInt(iterationCount[i], 10) + parseFloat(delay[i]);
            if (num > max) {
                max = num
            }
        }
        return num
    }

    function getScrollbarWidth() {
        var outer = document.createElement("div");
        var inner = document.createElement("div");
        var widthNoScroll;
        var widthWithScroll;
        outer.style.visibility = "hidden";
        outer.style.width = "100px";
        document.body.appendChild(outer);
        widthNoScroll = outer.offsetWidth;
        outer.style.overflow = "scroll";
        inner.style.width = "100%";
        outer.appendChild(inner);
        widthWithScroll = inner.offsetWidth;
        outer.parentNode.removeChild(outer);
        return widthNoScroll - widthWithScroll
    }

    function lockScreen() {
        var $html = $("html");
        var lockedClass = namespacify("is-locked");
        var paddingRight;
        var $body;
        if (!$html.hasClass(lockedClass)) {
            $body = $(document.body);
            if ($(document).height() > $(window).height()) {
                paddingRight = getScrollbarWidth();
                var floatMenu = $(".main__head-float.m-fixed");
                if (floatMenu) {
                    floatMenu.css("padding-left", 0 + "px")
                }
            } else {
                paddingRight = 0
            }
            $body.css("padding-right", paddingRight + "px");
            $html.addClass(lockedClass)
        }
    }

    function unlockScreen() {
        var $html = $("html");
        var lockedClass = namespacify("is-locked");
        var paddingRight;
        var $body;
        if ($html.hasClass(lockedClass)) {
            $body = $(document.body);
            paddingRight = parseInt($body.css("padding-right"), 10) - getScrollbarWidth();
            $body.css("padding-right", 0 + "px");
            var floatMenu = $(".main__head-float.m-fixed");
            if (floatMenu) {
                floatMenu.removeAttr("style")
            }
            $html.removeClass(lockedClass)
        }
    }

    function setState(instance, state, isSilent, reason) {
        var newState = namespacify("is", state);
        var allStates = [namespacify("is", STATES.CLOSING), namespacify("is", STATES.OPENING), namespacify("is", STATES.CLOSED), namespacify("is", STATES.OPENED)].join(" ");
        instance.$bg.removeClass(allStates).addClass(newState);
        instance.$overlay.removeClass(allStates).addClass(newState);
        instance.$wrapper.removeClass(allStates).addClass(newState);
        instance.$modal.removeClass(allStates).addClass(newState);
        instance.state = state;
        !isSilent && instance.$modal.trigger({
            type: state,
            reason: reason
        }, [{
            reason: reason
        }])
    }

    function syncWithAnimation(doBeforeAnimation, doAfterAnimation, instance) {
        var runningAnimationsCount = 0;
        var handleAnimationStart = function(e) {
            if (e.target !== this) {
                return
            }
            runningAnimationsCount++
        };
        var handleAnimationEnd = function(e) {
            if (e.target !== this) {
                return
            }
            if (--runningAnimationsCount === 0) {
                $.each(["$bg", "$overlay", "$wrapper", "$modal"], function(index, elemName) {
                    instance[elemName].off(ANIMATIONSTART_EVENTS + " " + ANIMATIONEND_EVENTS)
                });
                doAfterAnimation()
            }
        };
        $.each(["$bg", "$overlay", "$wrapper", "$modal"], function(index, elemName) {
            instance[elemName].on(ANIMATIONSTART_EVENTS, handleAnimationStart).on(ANIMATIONEND_EVENTS, handleAnimationEnd)
        });
        doBeforeAnimation();
        if (getAnimationDuration(instance.$bg) === 0 && getAnimationDuration(instance.$overlay) === 0 && getAnimationDuration(instance.$wrapper) === 0 && getAnimationDuration(instance.$modal) === 0) {
            $.each(["$bg", "$overlay", "$wrapper", "$modal"], function(index, elemName) {
                instance[elemName].off(ANIMATIONSTART_EVENTS + " " + ANIMATIONEND_EVENTS)
            });
            doAfterAnimation()
        }
    }

    function halt(instance) {
        if (instance.state === STATES.CLOSED) {
            return
        }
        $.each(["$bg", "$overlay", "$wrapper", "$modal"], function(index, elemName) {
            instance[elemName].off(ANIMATIONSTART_EVENTS + " " + ANIMATIONEND_EVENTS)
        });
        instance.$bg.removeClass(instance.settings.modifier);
        instance.$overlay.removeClass(instance.settings.modifier).hide();
        instance.$wrapper.hide();
        unlockScreen();
        setState(instance, STATES.CLOSED, true)
    }

    function parseOptions(str) {
        var obj = {};
        var arr;
        var len;
        var val;
        var i;
        str = str.replace(/\s*:\s*/g, ":").replace(/\s*,\s*/g, ",");
        arr = str.split(",");
        for (i = 0, len = arr.length; i < len; i++) {
            arr[i] = arr[i].split(":");
            val = arr[i][1];
            if (typeof val === "string" || val instanceof String) {
                val = val === "true" || (val === "false" ? false : val)
            }
            if (typeof val === "string" || val instanceof String) {
                val = !isNaN(val) ? +val : val
            }
            obj[arr[i][0]] = val
        }
        return obj
    }

    function namespacify() {
        var result = NAMESPACE;
        for (var i = 0; i < arguments.length; ++i) {
            result += "-" + arguments[i]
        }
        return result
    }

    function handleHashChangeEvent() {
        var id = location.hash.replace("#", "");
        var instance;
        var $elem;
        if (!id) {
            if (current && current.state === STATES.OPENED && current.settings.hashTracking) {
                current.close()
            }
        } else {
            try {
                $elem = $("[data-" + PLUGIN_NAME + "-id=" + id.replace(new RegExp("/", "g"), "\\/") + "]")
            } catch (err) {}
            if ($elem && $elem.length) {
                instance = $[PLUGIN_NAME].lookup[$elem.data(PLUGIN_NAME)];
                if (instance && instance.settings.hashTracking) {
                    instance.open()
                }
            }
        }
    }

    function Remodal($modal, options) {
        var $body = $(document.body);
        var remodal = this;
        remodal.settings = $.extend({}, DEFAULTS, options);
        remodal.index = $[PLUGIN_NAME].lookup.push(remodal) - 1;
        remodal.state = STATES.CLOSED;
        remodal.$overlay = $("." + namespacify("overlay"));
        if (!remodal.$overlay.length) {
            remodal.$overlay = $("<div>").addClass(namespacify("overlay") + " " + namespacify("is", STATES.CLOSED)).hide();
            $body.append(remodal.$overlay)
        }
        remodal.$bg = $("." + namespacify("bg")).addClass(namespacify("is", STATES.CLOSED));
        remodal.$modal = $modal;
        remodal.$modal.addClass(NAMESPACE + " " + namespacify("is-initialized") + " " + remodal.settings.modifier + " " + namespacify("is", STATES.CLOSED));
        remodal.$wrapper = $("<div>").addClass(namespacify("wrapper") + " " + remodal.settings.modifier + " " + namespacify("is", STATES.CLOSED)).hide().append(remodal.$modal);
        $body.append(remodal.$wrapper);
        remodal.$wrapper.on("click." + NAMESPACE, "[data-" + PLUGIN_NAME + '-action="close"]', function(e) {
            e.preventDefault();
            remodal.close()
        });
        remodal.$wrapper.on("click." + NAMESPACE, "[data-" + PLUGIN_NAME + '-action="cancel"]', function(e) {
            e.preventDefault();
            remodal.$modal.trigger(STATE_CHANGE_REASONS.CANCELLATION);
            if (remodal.settings.closeOnCancel) {
                remodal.close(STATE_CHANGE_REASONS.CANCELLATION)
            }
        });
        remodal.$wrapper.on("click." + NAMESPACE, "[data-" + PLUGIN_NAME + '-action="confirm"]', function(e) {
            e.preventDefault();
            remodal.$modal.trigger(STATE_CHANGE_REASONS.CONFIRMATION);
            if (remodal.settings.closeOnConfirm) {
                remodal.close(STATE_CHANGE_REASONS.CONFIRMATION)
            }
        });
        remodal.$wrapper.on("click." + NAMESPACE, function(e) {
            var $target = $(e.target);
            if (!$target.hasClass(namespacify("wrapper"))) {
                return
            }
            if (remodal.settings.closeOnOutsideClick) {
                remodal.close()
            }
        })
    }
    Remodal.prototype.open = function() {
        var remodal = this;
        var id;
        if (remodal.state === STATES.OPENING || remodal.state === STATES.CLOSING) {
            return
        }
        id = remodal.$modal.attr("data-" + PLUGIN_NAME + "-id");
        if (id && remodal.settings.hashTracking) {
            scrollTop = $(window).scrollTop();
            location.hash = id
        }
        if (current && current !== remodal) {
            halt(current)
        }
        current = remodal;
        lockScreen();
        remodal.$bg.addClass(remodal.settings.modifier);
        remodal.$overlay.addClass(remodal.settings.modifier).show();
        remodal.$wrapper.show().scrollTop(0);
        syncWithAnimation(function() {
            setState(remodal, STATES.OPENING)
        }, function() {
            setState(remodal, STATES.OPENED)
        }, remodal)
    };
    Remodal.prototype.close = function(reason) {
        var remodal = this;
        if (remodal.state === STATES.OPENING || remodal.state === STATES.CLOSING) {
            return
        }
        if (remodal.settings.hashTracking && remodal.$modal.attr("data-" + PLUGIN_NAME + "-id") === location.hash.substr(1)) {
            location.hash = "";
            $(window).scrollTop(scrollTop)
        }
        syncWithAnimation(function() {
            setState(remodal, STATES.CLOSING, false, reason)
        }, function() {
            remodal.$bg.removeClass(remodal.settings.modifier);
            remodal.$overlay.removeClass(remodal.settings.modifier).hide();
            remodal.$wrapper.hide();
            unlockScreen();
            setState(remodal, STATES.CLOSED, false, reason)
        }, remodal)
    };
    Remodal.prototype.getState = function() {
        return this.state
    };
    Remodal.prototype.destroy = function() {
        var lookup = $[PLUGIN_NAME].lookup;
        var instanceCount;
        halt(this);
        this.$wrapper.remove();
        delete lookup[this.index];
        instanceCount = $.grep(lookup, function(instance) {
            return !!instance
        }).length;
        if (instanceCount === 0) {
            this.$overlay.remove();
            this.$bg.removeClass(namespacify("is", STATES.CLOSING) + " " + namespacify("is", STATES.OPENING) + " " + namespacify("is", STATES.CLOSED) + " " + namespacify("is", STATES.OPENED))
        }
    };
    $[PLUGIN_NAME] = {
        lookup: []
    };
    $.fn[PLUGIN_NAME] = function(opts) {
        var instance;
        var $elem;
        this.each(function(index, elem) {
            $elem = $(elem);
            if ($elem.data(PLUGIN_NAME) == null) {
                instance = new Remodal($elem, opts);
                $elem.data(PLUGIN_NAME, instance.index);
                if (instance.settings.hashTracking && $elem.attr("data-" + PLUGIN_NAME + "-id") === location.hash.substr(1)) {
                    instance.open()
                }
            } else {
                instance = $[PLUGIN_NAME].lookup[$elem.data(PLUGIN_NAME)]
            }
        });
        return instance
    };
    $(document).ready(function() {
        $(document).on("click", "[data-" + PLUGIN_NAME + "-target]", function(e) {
            e.preventDefault();
            var elem = e.currentTarget;
            var id = elem.getAttribute("data-" + PLUGIN_NAME + "-target");
            var $target = $("[data-" + PLUGIN_NAME + "-id=" + id + "]");
            $[PLUGIN_NAME].lookup[$target.data(PLUGIN_NAME)].open()
        });
        $(document).find("." + NAMESPACE).each(function(i, container) {
            var $container = $(container);
            var options = $container.data(PLUGIN_NAME + "-options");
            if (!options) {
                options = {}
            } else if (typeof options === "string" || options instanceof String) {
                options = parseOptions(options)
            }
            $container[PLUGIN_NAME](options)
        });
        $(document).on("keydown." + NAMESPACE, function(e) {
            if (current && current.settings.closeOnEscape && current.state === STATES.OPENED && e.keyCode === 27) {
                current.close()
            }
        });
        $(window).on("hashchange." + NAMESPACE, handleHashChangeEvent)
    })
});
(function(factory) {
    if (typeof define === "function" && define.amd) {
        define(["jquery"], factory)
    } else if (typeof exports === "object") {
        module.exports = factory(require("jquery"))
    } else {
        factory(jQuery)
    }
})(function($) {
    "use strict";
    $.fn.styler = function(options) {
        var opt = $.extend({
            wrapper: "form",
            idSuffix: "-styler",
            filePlaceholder: "????? ??? ??N?N???",
            fileBrowse: "?z????N...",
            selectPlaceholder: "?N??N??N?...",
            selectSearch: false,
            selectSearchLimit: 10,
            selectSearchNotFound: "?????????????????? ??? ????????????",
            selectSearchPlaceholder: "?Y????N???...",
            selectVisibleOptions: 0,
            singleSelectzIndex: "100",
            selectSmartPositioning: true,
            onSelectOpened: function() {},
            onSelectClosed: function() {},
            onFormStyled: function() {}
        }, options);
        return this.each(function() {
            var el = $(this);
            var iOS = navigator.userAgent.match(/(iPad|iPhone|iPod)/i) && !navigator.userAgent.match(/(Windows\sPhone)/i) ? true : false;
            var Android = navigator.userAgent.match(/Android/i) && !navigator.userAgent.match(/(Windows\sPhone)/i) ? true : false;

            function Attributes() {
                var id = "",
                    title = "",
                    classes = "",
                    dataList = "";
                if (el.attr("id") !== undefined && el.attr("id") !== "") id = ' id="' + el.attr("id") + opt.idSuffix + '"';
                if (el.attr("title") !== undefined && el.attr("title") !== "") title = ' title="' + el.attr("title") + '"';
                if (el.attr("class") !== undefined && el.attr("class") !== "") classes = " " + el.attr("class");
                var data = el.data();
                for (var i in data) {
                    if (data[i] !== "") dataList += " data-" + i + '="' + data[i] + '"'
                }
                id += dataList;
                this.id = id;
                this.title = title;
                this.classes = classes
            }
            if (el.is(":checkbox")) {
                el.each(function() {
                    if (el.parent("div.jq-checkbox").length < 1) {
                        var checkboxOutput = function() {
                            var att = new Attributes;
                            var checkbox = $("<div" + att.id + ' class="jq-checkbox' + att.classes + '"' + att.title + '><div class="jq-checkbox__div"></div></div>');
                            el.css({
                                position: "absolute",
                                zIndex: "-1",
                                opacity: 0,
                                margin: 0,
                                padding: 0
                            }).after(checkbox).prependTo(checkbox);
                            checkbox.attr("unselectable", "on").css({
                                "-webkit-user-select": "none",
                                "-moz-user-select": "none",
                                "-ms-user-select": "none",
                                "-o-user-select": "none",
                                "user-select": "none",
                                display: "inline-block",
                                position: "relative",
                                overflow: "hidden"
                            });
                            if (el.is(":checked")) checkbox.addClass("checked");
                            if (el.is(":disabled")) checkbox.addClass("disabled");
                            checkbox.on("click.styler", function() {
                                if (!checkbox.is(".disabled")) {
                                    if (el.is(":checked")) {
                                        el.prop("checked", false);
                                        checkbox.removeClass("checked")
                                    } else {
                                        el.prop("checked", true);
                                        checkbox.addClass("checked")
                                    }
                                    el.change();
                                    return false
                                } else {
                                    return false
                                }
                            });
                            el.closest("label").add('label[for="' + el.attr("id") + '"]').click(function(e) {
                                if (!$(e.target).is("a")) {
                                    checkbox.click();
                                    e.preventDefault()
                                }
                            });
                            el.on("change.styler", function() {
                                if (el.is(":checked")) checkbox.addClass("checked");
                                else checkbox.removeClass("checked")
                            }).on("keydown.styler", function(e) {
                                if (e.which == 32) checkbox.click()
                            }).on("focus.styler", function() {
                                if (!checkbox.is(".disabled")) checkbox.addClass("focused")
                            }).on("blur.styler", function() {
                                checkbox.removeClass("focused")
                            })
                        };
                        checkboxOutput();
                        el.on("refresh", function() {
                            el.off(".styler").parent().before(el).remove();
                            checkboxOutput()
                        })
                    }
                })
            } else if (el.is(":radio")) {
                el.each(function() {
                    if (el.parent("div.jq-radio").length < 1) {
                        var radioOutput = function() {
                            var att = new Attributes;
                            var radio = $("<div" + att.id + ' class="jq-radio' + att.classes + '"' + att.title + '><div class="jq-radio__div"></div></div>');
                            el.css({
                                position: "absolute",
                                zIndex: "-1",
                                opacity: 0,
                                margin: 0,
                                padding: 0
                            }).after(radio).prependTo(radio);
                            radio.attr("unselectable", "on").css({
                                "-webkit-user-select": "none",
                                "-moz-user-select": "none",
                                "-ms-user-select": "none",
                                "-o-user-select": "none",
                                "user-select": "none",
                                display: "inline-block",
                                position: "relative"
                            });
                            if (el.is(":checked")) radio.addClass("checked");
                            if (el.is(":disabled")) radio.addClass("disabled");
                            radio.on("click.styler", function() {
                                if (!radio.is(".disabled")) {
                                    radio.closest(opt.wrapper).find('input[name="' + el.attr("name") + '"]').prop("checked", false).parent().removeClass("checked");
                                    el.prop("checked", true).parent().addClass("checked");
                                    el.change();
                                    return false
                                } else {
                                    return false
                                }
                            });
                            el.closest("label").add('label[for="' + el.attr("id") + '"]').click(function(e) {
                                if (!$(e.target).is("a")) {
                                    radio.click();
                                    e.preventDefault()
                                }
                            });
                            el.on("change.styler", function() {
                                el.parent().addClass("checked")
                            }).on("focus.styler", function() {
                                if (!radio.is(".disabled")) radio.addClass("focused")
                            }).on("blur.styler", function() {
                                radio.removeClass("focused")
                            })
                        };
                        radioOutput();
                        el.on("refresh", function() {
                            el.off(".styler").parent().before(el).remove();
                            radioOutput()
                        })
                    }
                })
            } else if (el.is(":file")) {
                el.css({
                    position: "absolute",
                    top: 0,
                    right: 0,
                    width: "100%",
                    height: "100%",
                    opacity: 0,
                    margin: 0,
                    padding: 0
                }).each(function() {
                    if (el.parent("div.jq-file").length < 1) {
                        var fileOutput = function() {
                            var att = new Attributes;
                            var placeholder = el.data("placeholder");
                            if (placeholder === undefined) placeholder = opt.filePlaceholder;
                            var browse = el.data("browse");
                            if (browse === undefined || browse === "") browse = opt.fileBrowse;
                            var file = $("<div" + att.id + ' class="jq-file' + att.classes + '"' + att.title + ' style="display: inline-block; position: relative; overflow: hidden"></div>');
                            var name = $('<div class="jq-file__name">' + placeholder + "</div>").appendTo(file);
                            $('<div class="jq-file__browse">' + browse + "</div>").appendTo(file);
                            el.after(file);
                            file.append(el);
                            if (el.is(":disabled")) file.addClass("disabled");
                            el.on("change.styler", function() {
                                var value = el.val();
                                if (el.is("[multiple]")) {
                                    value = "";
                                    var files = el[0].files;
                                    for (var i = 0; i < files.length; i++) {
                                        value += (i > 0 ? ", " : "") + files[i].name
                                    }
                                }
                                name.text(value.replace(/.+[\\\/]/, ""));
                                if (value === "") {
                                    name.text(placeholder);
                                    file.removeClass("changed")
                                } else {
                                    file.addClass("changed")
                                }
                            }).on("focus.styler", function() {
                                file.addClass("focused")
                            }).on("blur.styler", function() {
                                file.removeClass("focused")
                            }).on("click.styler", function() {
                                file.removeClass("focused")
                            })
                        };
                        fileOutput();
                        el.on("refresh", function() {
                            el.off(".styler").parent().before(el).remove();
                            fileOutput()
                        })
                    }
                })
            } else if (el.is("select")) {
                el.each(function() {
                    if (el.parent("div.jqselect").length < 1) {
                        var selectboxOutput = function() {
                            function preventScrolling(selector) {
                                selector.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll", function(e) {
                                    var scrollTo = null;
                                    if (e.type == "mousewheel") {
                                        scrollTo = e.originalEvent.wheelDelta * -1
                                    } else if (e.type == "DOMMouseScroll") {
                                        scrollTo = 40 * e.originalEvent.detail
                                    }
                                    if (scrollTo) {
                                        e.stopPropagation();
                                        e.preventDefault();
                                        $(this).scrollTop(scrollTo + $(this).scrollTop())
                                    }
                                })
                            }
                            var option = $("option", el);
                            var list = "";

                            function makeList() {
                                for (var i = 0, len = option.length; i < len; i++) {
                                    var li = "",
                                        liClass = "",
                                        liClasses = "",
                                        dataList = "",
                                        optionClass = "",
                                        optgroupClass = "",
                                        dataJqfsClass = "";
                                    var disabled = "disabled";
                                    var selDis = "selected sel disabled";
                                    if (option.eq(i).prop("selected")) liClass = "selected sel";
                                    if (option.eq(i).is(":disabled")) liClass = disabled;
                                    if (option.eq(i).is(":selected:disabled")) liClass = selDis;
                                    if (option.eq(i).attr("class") !== undefined) {
                                        optionClass = " " + option.eq(i).attr("class");
                                        dataJqfsClass = ' data-jqfs-class="' + option.eq(i).attr("class") + '"'
                                    }
                                    var data = option.eq(i).data();
                                    for (var k in data) {
                                        if (data[k] !== "") dataList += " data-" + k + '="' + data[k] + '"'
                                    }
                                    if (liClass + optionClass !== "") liClasses = ' class="' + liClass + optionClass + '"';
                                    li = "<li" + dataJqfsClass + dataList + liClasses + ">" + option.eq(i).html() + "</li>";
                                    if (option.eq(i).parent().is("optgroup")) {
                                        if (option.eq(i).parent().attr("class") !== undefined) optgroupClass = " " + option.eq(i).parent().attr("class");
                                        li = "<li" + dataJqfsClass + dataList + ' class="' + liClass + optionClass + " option" + optgroupClass + '">' + option.eq(i).html() + "</li>";
                                        if (option.eq(i).is(":first-child")) {
                                            li = '<li class="optgroup' + optgroupClass + '">' + option.eq(i).parent().attr("label") + "</li>" + li
                                        }
                                    }
                                    list += li
                                }
                            }

                            function doSelect() {
                                var att = new Attributes;
                                var searchHTML = "";
                                var selectPlaceholder = el.data("placeholder");
                                var selectSearch = el.data("search");
                                var selectSearchLimit = el.data("search-limit");
                                var selectSearchNotFound = el.data("search-not-found");
                                var selectSearchPlaceholder = el.data("search-placeholder");
                                var singleSelectzIndex = el.data("z-index");
                                var selectSmartPositioning = el.data("smart-positioning");
                                if (selectPlaceholder === undefined) selectPlaceholder = opt.selectPlaceholder;
                                if (selectSearch === undefined || selectSearch === "") selectSearch = opt.selectSearch;
                                if (selectSearchLimit === undefined || selectSearchLimit === "") selectSearchLimit = opt.selectSearchLimit;
                                if (selectSearchNotFound === undefined || selectSearchNotFound === "") selectSearchNotFound = opt.selectSearchNotFound;
                                if (selectSearchPlaceholder === undefined) selectSearchPlaceholder = opt.selectSearchPlaceholder;
                                if (singleSelectzIndex === undefined || singleSelectzIndex === "") singleSelectzIndex = opt.singleSelectzIndex;
                                if (selectSmartPositioning === undefined || selectSmartPositioning === "") selectSmartPositioning = opt.selectSmartPositioning;
                                var selectbox = $("<div" + att.id + ' class="jq-selectbox jqselect' + att.classes + '" style="display: inline-block; position: relative; z-index:' + singleSelectzIndex + '">' + '<div class="jq-selectbox__select"' + att.title + ' style="position: relative">' + '<div class="jq-selectbox__select-text"></div>' + '<div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div>' + "</div>" + "</div>");
                                el.css({
                                    margin: 0,
                                    padding: 0
                                }).after(selectbox).prependTo(selectbox);
                                var divSelect = $("div.jq-selectbox__select", selectbox);
                                var divText = $("div.jq-selectbox__select-text", selectbox);
                                var optionSelected = option.filter(":selected");
                                makeList();
                                if (selectSearch) searchHTML = '<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="' + selectSearchPlaceholder + '"></div>' + '<div class="jq-selectbox__not-found">' + selectSearchNotFound + "</div>";
                                var dropdown = $('<div class="jq-selectbox__dropdown" style="position: absolute">' + searchHTML + '<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">' + list + "</ul>" + "</div>");
                                selectbox.append(dropdown);
                                var ul = $("ul", dropdown);
                                var li = $("li", dropdown);
                                var search = $("input", dropdown);
                                var notFound = $("div.jq-selectbox__not-found", dropdown).hide();
                                if (li.length < selectSearchLimit) search.parent().hide();
                                if (el.val() === "") {
                                    divText.text(selectPlaceholder).addClass("placeholder")
                                } else {
                                    divText.text(optionSelected.text())
                                }
                                var liWidthInner = 0,
                                    liWidth = 0;
                                li.each(function() {
                                    var l = $(this);
                                    l.css({
                                        display: "inline-block"
                                    });
                                    if (l.innerWidth() > liWidthInner) {
                                        liWidthInner = l.innerWidth();
                                        liWidth = l.width()
                                    }
                                    l.css({
                                        display: ""
                                    })
                                });
                                if (divText.is(".placeholder") && divText.width() > liWidthInner) {
                                    divText.width(divText.width())
                                } else {
                                    divText.width(liWidth)
                                }
                                if (liWidthInner > selectbox.width()) dropdown.width(liWidthInner);
                                if (option.first().text() === "" && el.data("placeholder") !== "") {
                                    li.first().hide()
                                }
                                el.css({
                                    position: "absolute",
                                    left: 0,
                                    top: 0,
                                    width: "100%",
                                    height: "100%",
                                    opacity: 0
                                });
                                var selectHeight = selectbox.outerHeight();
                                var searchHeight = search.outerHeight();
                                var isMaxHeight = ul.css("max-height");
                                var liSelected = li.filter(".selected");
                                if (liSelected.length < 1) li.first().addClass("selected sel");
                                if (li.data("li-height") === undefined) li.data("li-height", li.outerHeight());
                                var position = dropdown.css("top");
                                if (dropdown.css("left") == "auto") dropdown.css({
                                    left: 0
                                });
                                if (dropdown.css("top") == "auto") dropdown.css({
                                    top: selectHeight
                                });
                                dropdown.hide();
                                if (liSelected.length) {
                                    if (option.first().text() != optionSelected.text()) {
                                        selectbox.addClass("changed")
                                    }
                                    selectbox.data("jqfs-class", liSelected.data("jqfs-class"));
                                    selectbox.addClass(liSelected.data("jqfs-class"))
                                }
                                if (el.is(":disabled")) {
                                    selectbox.addClass("disabled");
                                    return false
                                }
                                divSelect.click(function() {
                                    if ($("div.jq-selectbox").filter(".opened").length) {
                                        opt.onSelectClosed.call($("div.jq-selectbox").filter(".opened"))
                                    }
                                    el.focus();
                                    if (iOS) return;
                                    var win = $(window);
                                    var liHeight = li.data("li-height");
                                    var topOffset = selectbox.offset().top;
                                    var bottomOffset = win.height() - selectHeight - (topOffset - win.scrollTop());
                                    var visible = el.data("visible-options");
                                    if (visible === undefined || visible === "") visible = opt.selectVisibleOptions;
                                    var minHeight = liHeight * 5;
                                    var newHeight = liHeight * visible;
                                    if (visible > 0 && visible < 6) minHeight = newHeight;
                                    if (visible === 0) newHeight = "auto";
                                    var dropDown = function() {
                                        dropdown.height("auto").css({
                                            bottom: "auto",
                                            top: position
                                        });
                                        var maxHeightBottom = function() {
                                            ul.css("max-height", Math.floor((bottomOffset - 20 - searchHeight) / liHeight) * liHeight)
                                        };
                                        maxHeightBottom();
                                        ul.css("max-height", newHeight);
                                        if (isMaxHeight != "none") {
                                            ul.css("max-height", isMaxHeight)
                                        }
                                        if (bottomOffset < dropdown.outerHeight() + 20) {
                                            maxHeightBottom()
                                        }
                                    };
                                    var dropUp = function() {
                                        dropdown.height("auto").css({
                                            top: "auto",
                                            bottom: position
                                        });
                                        var maxHeightTop = function() {
                                            ul.css("max-height", Math.floor((topOffset - win.scrollTop() - 20 - searchHeight) / liHeight) * liHeight)
                                        };
                                        maxHeightTop();
                                        ul.css("max-height", newHeight);
                                        if (isMaxHeight != "none") {
                                            ul.css("max-height", isMaxHeight)
                                        }
                                        if (topOffset - win.scrollTop() - 20 < dropdown.outerHeight() + 20) {
                                            maxHeightTop()
                                        }
                                    };
                                    if (selectSmartPositioning === true || selectSmartPositioning === 1) {
                                        if (bottomOffset > minHeight + searchHeight + 20) {
                                            dropDown();
                                            selectbox.removeClass("dropup").addClass("dropdown")
                                        } else {
                                            dropUp();
                                            selectbox.removeClass("dropdown").addClass("dropup")
                                        }
                                    } else if (selectSmartPositioning === false || selectSmartPositioning === 0) {
                                        if (bottomOffset > minHeight + searchHeight + 20) {
                                            dropDown();
                                            selectbox.removeClass("dropup").addClass("dropdown")
                                        }
                                    }
                                    if (selectbox.offset().left + dropdown.outerWidth() > win.width()) {
                                        dropdown.css({
                                            left: "auto",
                                            right: 0
                                        })
                                    }
                                    $("div.jqselect").css({
                                        zIndex: singleSelectzIndex - 1
                                    }).removeClass("opened");
                                    selectbox.css({
                                        zIndex: singleSelectzIndex
                                    });
                                    if (dropdown.is(":hidden")) {
                                        $("div.jq-selectbox__dropdown:visible").hide();
                                        dropdown.show();
                                        selectbox.addClass("opened focused");
                                        opt.onSelectOpened.call(selectbox)
                                    } else {
                                        dropdown.hide();
                                        selectbox.removeClass("opened dropup dropdown");
                                        if ($("div.jq-selectbox").filter(".opened").length) {
                                            opt.onSelectClosed.call(selectbox)
                                        }
                                    }
                                    if (search.length) {
                                        search.val("").keyup();
                                        notFound.hide();
                                        search.keyup(function() {
                                            var query = $(this).val();
                                            li.each(function() {
                                                if (!$(this).html().match(new RegExp(".*?" + query + ".*?", "i"))) {
                                                    $(this).hide()
                                                } else {
                                                    $(this).show()
                                                }
                                            });
                                            if (option.first().text() === "" && el.data("placeholder") !== "") {
                                                li.first().hide()
                                            }
                                            if (li.filter(":visible").length < 1) {
                                                notFound.show()
                                            } else {
                                                notFound.hide()
                                            }
                                        })
                                    }
                                    if (li.filter(".selected").length) {
                                        if (el.val() === "") {
                                            ul.scrollTop(0)
                                        } else {
                                            if (ul.innerHeight() / liHeight % 2 !== 0) liHeight = liHeight / 2;
                                            ul.scrollTop(ul.scrollTop() + li.filter(".selected").position().top - ul.innerHeight() / 2 + liHeight)
                                        }
                                    }
                                    preventScrolling(ul);
                                    return false
                                });
                                li.hover(function() {
                                    $(this).siblings().removeClass("selected")
                                });
                                var selectedText = li.filter(".selected").text();
                                li.filter(":not(.disabled):not(.optgroup)").click(function() {
                                    el.focus();
                                    var t = $(this);
                                    var liText = t.text();
                                    if (!t.is(".selected")) {
                                        var index = t.index();
                                        index -= t.prevAll(".optgroup").length;
                                        t.addClass("selected sel").siblings().removeClass("selected sel");
                                        option.prop("selected", false).eq(index).prop("selected", true);
                                        selectedText = liText;
                                        divText.text(liText);
                                        if (selectbox.data("jqfs-class")) selectbox.removeClass(selectbox.data("jqfs-class"));
                                        selectbox.data("jqfs-class", t.data("jqfs-class"));
                                        selectbox.addClass(t.data("jqfs-class"));
                                        el.change()
                                    }
                                    dropdown.hide();
                                    selectbox.removeClass("opened dropup dropdown");
                                    opt.onSelectClosed.call(selectbox)
                                });
                                dropdown.mouseout(function() {
                                    $("li.sel", dropdown).addClass("selected")
                                });
                                el.on("change.styler", function() {
                                    divText.text(option.filter(":selected").text()).removeClass("placeholder");
                                    li.removeClass("selected sel").not(".optgroup").eq(el[0].selectedIndex).addClass("selected sel");
                                    if (option.first().text() != li.filter(".selected").text()) {
                                        selectbox.addClass("changed")
                                    } else {
                                        selectbox.removeClass("changed")
                                    }
                                }).on("focus.styler", function() {
                                    selectbox.addClass("focused");
                                    $("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide()
                                }).on("blur.styler", function() {
                                    selectbox.removeClass("focused")
                                }).on("keydown.styler keyup.styler", function(e) {
                                    var liHeight = li.data("li-height");
                                    if (el.val() === "") {
                                        divText.text(selectPlaceholder).addClass("placeholder")
                                    } else {
                                        divText.text(option.filter(":selected").text())
                                    }
                                    li.removeClass("selected sel").not(".optgroup").eq(el[0].selectedIndex).addClass("selected sel");
                                    if (e.which == 38 || e.which == 37 || e.which == 33 || e.which == 36) {
                                        if (el.val() === "") {
                                            ul.scrollTop(0)
                                        } else {
                                            ul.scrollTop(ul.scrollTop() + li.filter(".selected").position().top)
                                        }
                                    }
                                    if (e.which == 40 || e.which == 39 || e.which == 34 || e.which == 35) {
                                        ul.scrollTop(ul.scrollTop() + li.filter(".selected").position().top - ul.innerHeight() + liHeight)
                                    }
                                    if (e.which == 13) {
                                        e.preventDefault();
                                        dropdown.hide();
                                        selectbox.removeClass("opened dropup dropdown");
                                        opt.onSelectClosed.call(selectbox)
                                    }
                                }).on("keydown.styler", function(e) {
                                    if (e.which == 32) {
                                        e.preventDefault();
                                        divSelect.click()
                                    }
                                });
                                $(document).on("click", function(e) {
                                    if (!$(e.target).parents().hasClass("jq-selectbox") && e.target.nodeName != "OPTION") {
                                        if ($("div.jq-selectbox").filter(".opened").length) {
                                            opt.onSelectClosed.call($("div.jq-selectbox").filter(".opened"))
                                        }
                                        if (search.length) search.val("").keyup();
                                        dropdown.hide().find("li.sel").addClass("selected");
                                        selectbox.removeClass("focused opened dropup dropdown")
                                    }
                                })
                            }

                            function doMultipleSelect() {
                                var att = new Attributes;
                                var selectbox = $("<div" + att.id + ' class="jq-select-multiple jqselect' + att.classes + '"' + att.title + ' style="display: inline-block; position: relative"></div>');
                                el.css({
                                    margin: 0,
                                    padding: 0
                                }).after(selectbox);
                                makeList();
                                selectbox.append("<ul>" + list + "</ul>");
                                var ul = $("ul", selectbox).css({
                                    position: "relative",
                                    "overflow-x": "hidden",
                                    "-webkit-overflow-scrolling": "touch"
                                });
                                var li = $("li", selectbox).attr("unselectable", "on");
                                var size = el.attr("size");
                                var ulHeight = ul.outerHeight();
                                var liHeight = li.outerHeight();
                                if (size !== undefined && size > 0) {
                                    ul.css({
                                        height: liHeight * size
                                    })
                                } else {
                                    ul.css({
                                        height: liHeight * 4
                                    })
                                }
                                if (ulHeight > selectbox.height()) {
                                    ul.css("overflowY", "scroll");
                                    preventScrolling(ul);
                                    if (li.filter(".selected").length) {
                                        ul.scrollTop(ul.scrollTop() + li.filter(".selected").position().top)
                                    }
                                }
                                el.prependTo(selectbox).css({
                                    position: "absolute",
                                    left: 0,
                                    top: 0,
                                    width: "100%",
                                    height: "100%",
                                    opacity: 0
                                });
                                if (el.is(":disabled")) {
                                    selectbox.addClass("disabled");
                                    option.each(function() {
                                        if ($(this).is(":selected")) li.eq($(this).index()).addClass("selected")
                                    })
                                } else {
                                    li.filter(":not(.disabled):not(.optgroup)").click(function(e) {
                                        el.focus();
                                        var clkd = $(this);
                                        if (!e.ctrlKey && !e.metaKey) clkd.addClass("selected");
                                        if (!e.shiftKey) clkd.addClass("first");
                                        if (!e.ctrlKey && !e.metaKey && !e.shiftKey) clkd.siblings().removeClass("selected first");
                                        if (e.ctrlKey || e.metaKey) {
                                            if (clkd.is(".selected")) clkd.removeClass("selected first");
                                            else clkd.addClass("selected first");
                                            clkd.siblings().removeClass("first")
                                        }
                                        if (e.shiftKey) {
                                            var prev = false,
                                                next = false;
                                            clkd.siblings().removeClass("selected").siblings(".first").addClass("selected");
                                            clkd.prevAll().each(function() {
                                                if ($(this).is(".first")) prev = true
                                            });
                                            clkd.nextAll().each(function() {
                                                if ($(this).is(".first")) next = true
                                            });
                                            if (prev) {
                                                clkd.prevAll().each(function() {
                                                    if ($(this).is(".selected")) return false;
                                                    else $(this).not(".disabled, .optgroup").addClass("selected")
                                                })
                                            }
                                            if (next) {
                                                clkd.nextAll().each(function() {
                                                    if ($(this).is(".selected")) return false;
                                                    else $(this).not(".disabled, .optgroup").addClass("selected");
                                                })
                                            }
                                            if (li.filter(".selected").length == 1) clkd.addClass("first")
                                        }
                                        option.prop("selected", false);
                                        li.filter(".selected").each(function() {
                                            var t = $(this);
                                            var index = t.index();
                                            if (t.is(".option")) index -= t.prevAll(".optgroup").length;
                                            option.eq(index).prop("selected", true)
                                        });
                                        el.change()
                                    });
                                    option.each(function(i) {
                                        $(this).data("optionIndex", i)
                                    });
                                    el.on("change.styler", function() {
                                        li.removeClass("selected");
                                        var arrIndexes = [];
                                        option.filter(":selected").each(function() {
                                            arrIndexes.push($(this).data("optionIndex"))
                                        });
                                        li.not(".optgroup").filter(function(i) {
                                            return $.inArray(i, arrIndexes) > -1
                                        }).addClass("selected")
                                    }).on("focus.styler", function() {
                                        selectbox.addClass("focused")
                                    }).on("blur.styler", function() {
                                        selectbox.removeClass("focused")
                                    });
                                    if (ulHeight > selectbox.height()) {
                                        el.on("keydown.styler", function(e) {
                                            if (e.which == 38 || e.which == 37 || e.which == 33) {
                                                ul.scrollTop(ul.scrollTop() + li.filter(".selected").position().top - liHeight)
                                            }
                                            if (e.which == 40 || e.which == 39 || e.which == 34) {
                                                ul.scrollTop(ul.scrollTop() + li.filter(".selected:last").position().top - ul.innerHeight() + liHeight * 2)
                                            }
                                        })
                                    }
                                }
                            }
                            if (el.is("[multiple]")) {
                                if (Android || iOS) return;
                                doMultipleSelect()
                            } else {
                                doSelect()
                            }
                        };
                        selectboxOutput();
                        el.on("refresh", function() {
                            el.off(".styler").parent().before(el).remove();
                            selectboxOutput()
                        })
                    }
                })
            } else if (el.is(":reset")) {
                el.on("click", function() {
                    setTimeout(function() {
                        el.closest(opt.wrapper).find("input, select").trigger("refresh")
                    }, 1)
                })
            }
        }).promise().done(function() {
            opt.onFormStyled.call()
        })
    }
});
(function($) {
    var plugin = {};
    var defaults = {
        mode: "horizontal",
        slideSelector: "",
        infiniteLoop: true,
        hideControlOnEnd: false,
        speed: 500,
        easing: null,
        slideMargin: 0,
        startSlide: 0,
        randomStart: false,
        captions: false,
        ticker: false,
        tickerHover: false,
        adaptiveHeight: false,
        adaptiveHeightSpeed: 500,
        video: false,
        useCSS: true,
        preloadImages: "visible",
        responsive: true,
        slideZIndex: 50,
        wrapperClass: "bx-wrapper",
        touchEnabled: true,
        swipeThreshold: 50,
        oneToOneTouch: true,
        preventDefaultSwipeX: true,
        preventDefaultSwipeY: false,
        pager: true,
        pagerType: "full",
        pagerShortSeparator: " / ",
        pagerSelector: null,
        buildPager: null,
        pagerCustom: null,
        controls: true,
        nextText: "Next",
        prevText: "Prev",
        nextSelector: null,
        prevSelector: null,
        autoControls: false,
        startText: "Start",
        stopText: "Stop",
        autoControlsCombine: false,
        autoControlsSelector: null,
        auto: false,
        pause: 4e3,
        autoStart: true,
        autoDirection: "next",
        autoHover: false,
        autoDelay: 0,
        autoSlideForOnePage: false,
        minSlides: 1,
        maxSlides: 1,
        moveSlides: 0,
        slideWidth: 0,
        onSliderLoad: function() {},
        onSlideBefore: function() {},
        onSlideAfter: function() {},
        onSlideNext: function() {},
        onSlidePrev: function() {},
        onSliderResize: function() {}
    };
    $.fn.bxSlider = function(options) {
        if (this.length == 0) return this;
        if (this.length > 1) {
            this.each(function() {
                $(this).bxSlider(options)
            });
            return this
        }
        var slider = {};
        var el = this;
        plugin.el = this;
        var windowWidth = $(window).width();
        var windowHeight = $(window).height();
        var init = function() {
            slider.settings = $.extend({}, defaults, options);
            slider.settings.slideWidth = parseInt(slider.settings.slideWidth);
            slider.children = el.children(slider.settings.slideSelector);
            if (slider.children.length < slider.settings.minSlides) slider.settings.minSlides = slider.children.length;
            if (slider.children.length < slider.settings.maxSlides) slider.settings.maxSlides = slider.children.length;
            if (slider.settings.randomStart) slider.settings.startSlide = Math.floor(Math.random() * slider.children.length);
            slider.active = {
                index: slider.settings.startSlide
            };
            slider.carousel = slider.settings.minSlides > 1 || slider.settings.maxSlides > 1;
            if (slider.carousel) slider.settings.preloadImages = "all";
            slider.minThreshold = slider.settings.minSlides * slider.settings.slideWidth + (slider.settings.minSlides - 1) * slider.settings.slideMargin;
            slider.maxThreshold = slider.settings.maxSlides * slider.settings.slideWidth + (slider.settings.maxSlides - 1) * slider.settings.slideMargin;
            slider.working = false;
            slider.controls = {};
            slider.interval = null;
            slider.animProp = slider.settings.mode == "vertical" ? "top" : "left";
            slider.usingCSS = slider.settings.useCSS && slider.settings.mode != "fade" && function() {
                var div = document.createElement("div");
                var props = ["WebkitPerspective", "MozPerspective", "OPerspective", "msPerspective"];
                for (var i in props) {
                    if (div.style[props[i]] !== undefined) {
                        slider.cssPrefix = props[i].replace("Perspective", "").toLowerCase();
                        slider.animProp = "-" + slider.cssPrefix + "-transform";
                        return true
                    }
                }
                return false
            }();
            if (slider.settings.mode == "vertical") slider.settings.maxSlides = slider.settings.minSlides;
            el.data("origStyle", el.attr("style"));
            el.children(slider.settings.slideSelector).each(function() {
                $(this).data("origStyle", $(this).attr("style"))
            });
            setup()
        };
        var setup = function() {
            el.wrap('<div class="' + slider.settings.wrapperClass + '"><div class="bx-viewport"></div></div>');
            slider.viewport = el.parent();
            slider.loader = $('<div class="bx-loading" />');
            slider.viewport.prepend(slider.loader);
            el.css({
                width: slider.settings.mode == "horizontal" ? slider.children.length * 100 + 215 + "%" : "auto",
                position: "relative"
            });
            if (slider.usingCSS && slider.settings.easing) {
                el.css("-" + slider.cssPrefix + "-transition-timing-function", slider.settings.easing)
            } else if (!slider.settings.easing) {
                slider.settings.easing = "swing"
            }
            var slidesShowing = getNumberSlidesShowing();
            slider.viewport.css({
                width: "100%",
                overflow: "hidden",
                position: "relative"
            });
            slider.viewport.parent().css({
                maxWidth: getViewportMaxWidth()
            });
            if (!slider.settings.pager) {
                slider.viewport.parent().css({
                    margin: "0 auto 0px"
                })
            }
            slider.children.css({
                float: slider.settings.mode == "horizontal" ? "left" : "none",
                listStyle: "none",
                position: "relative"
            });
            slider.children.css("width", getSlideWidth());
            if (slider.settings.mode == "horizontal" && slider.settings.slideMargin > 0) slider.children.css("marginRight", slider.settings.slideMargin);
            if (slider.settings.mode == "vertical" && slider.settings.slideMargin > 0) slider.children.css("marginBottom", slider.settings.slideMargin);
            if (slider.settings.mode == "fade") {
                slider.children.css({
                    position: "absolute",
                    zIndex: 0,
                    display: "none"
                });
                slider.children.eq(slider.settings.startSlide).css({
                    zIndex: slider.settings.slideZIndex,
                    display: "block"
                })
            }
            slider.controls.el = $('<div class="bx-controls" />');
            if (slider.settings.captions) appendCaptions();
            slider.active.last = slider.settings.startSlide == getPagerQty() - 1;
            if (slider.settings.video) el.fitVids();
            var preloadSelector = slider.children.eq(slider.settings.startSlide);
            if (slider.settings.preloadImages == "all") preloadSelector = slider.children;
            if (!slider.settings.ticker) {
                if (slider.settings.pager) appendPager();
                if (slider.settings.controls) appendControls();
                if (slider.settings.auto && slider.settings.autoControls) appendControlsAuto();
                if (slider.settings.controls || slider.settings.autoControls || slider.settings.pager) slider.viewport.after(slider.controls.el)
            } else {
                slider.settings.pager = false
            }
            loadElements(preloadSelector, start)
        };
        var loadElements = function(selector, callback) {
            var total = selector.find("img, iframe").length;
            if (total == 0) {
                callback();
                return
            }
            var count = 0;
            selector.find("img, iframe").each(function() {
                $(this).one("load", function() {
                    if (++count == total) callback()
                }).each(function() {
                    if (this.complete) $(this).load()
                })
            })
        };
        var start = function() {
            if (slider.settings.infiniteLoop && slider.settings.mode != "fade" && !slider.settings.ticker) {
                var slice = slider.settings.mode == "vertical" ? slider.settings.minSlides : slider.settings.maxSlides;
                var sliceAppend = slider.children.slice(0, slice).clone().addClass("bx-clone");
                var slicePrepend = slider.children.slice(-slice).clone().addClass("bx-clone");
                el.append(sliceAppend).prepend(slicePrepend)
            }
            slider.loader.remove();
            setSlidePosition();
            if (slider.settings.mode == "vertical") slider.settings.adaptiveHeight = true;
            slider.viewport.height(getViewportHeight());
            el.redrawSlider();
            slider.settings.onSliderLoad(slider.active.index);
            slider.initialized = true;
            if (slider.settings.responsive) $(window).bind("resize", resizeWindow);
            if (slider.settings.auto && slider.settings.autoStart && (getPagerQty() > 1 || slider.settings.autoSlideForOnePage)) initAuto();
            if (slider.settings.ticker) initTicker();
            if (slider.settings.pager) updatePagerActive(slider.settings.startSlide);
            if (slider.settings.controls) updateDirectionControls();
            if (slider.settings.touchEnabled && !slider.settings.ticker) initTouch()
        };
        var getViewportHeight = function() {
            var height = 0;
            var children = $();
            if (slider.settings.mode != "vertical" && !slider.settings.adaptiveHeight) {
                children = slider.children
            } else {
                if (!slider.carousel) {
                    children = slider.children.eq(slider.active.index)
                } else {
                    var currentIndex = slider.settings.moveSlides == 1 ? slider.active.index : slider.active.index * getMoveBy();
                    children = slider.children.eq(currentIndex);
                    for (i = 1; i <= slider.settings.maxSlides - 1; i++) {
                        if (currentIndex + i >= slider.children.length) {
                            children = children.add(slider.children.eq(i - 1))
                        } else {
                            children = children.add(slider.children.eq(currentIndex + i))
                        }
                    }
                }
            }
            if (slider.settings.mode == "vertical") {
                children.each(function(index) {
                    height += $(this).outerHeight()
                });
                if (slider.settings.slideMargin > 0) {
                    height += slider.settings.slideMargin * (slider.settings.minSlides - 1)
                }
            } else {
                height = Math.max.apply(Math, children.map(function() {
                    return $(this).outerHeight(false)
                }).get())
            }
            if (slider.viewport.css("box-sizing") == "border-box") {
                height += parseFloat(slider.viewport.css("padding-top")) + parseFloat(slider.viewport.css("padding-bottom")) + parseFloat(slider.viewport.css("border-top-width")) + parseFloat(slider.viewport.css("border-bottom-width"))
            } else if (slider.viewport.css("box-sizing") == "padding-box") {
                height += parseFloat(slider.viewport.css("padding-top")) + parseFloat(slider.viewport.css("padding-bottom"))
            }
            return height
        };
        var getViewportMaxWidth = function() {
            var width = "100%";
            if (slider.settings.slideWidth > 0) {
                if (slider.settings.mode == "horizontal") {
                    width = slider.settings.maxSlides * slider.settings.slideWidth + (slider.settings.maxSlides - 1) * slider.settings.slideMargin
                } else {
                    width = slider.settings.slideWidth
                }
            }
            return width
        };
        var getSlideWidth = function() {
            var newElWidth = slider.settings.slideWidth;
            var wrapWidth = slider.viewport.width();
            if (slider.settings.slideWidth == 0 || slider.settings.slideWidth > wrapWidth && !slider.carousel || slider.settings.mode == "vertical") {
                newElWidth = wrapWidth
            } else if (slider.settings.maxSlides > 1 && slider.settings.mode == "horizontal") {
                if (wrapWidth > slider.maxThreshold) {} else if (wrapWidth < slider.minThreshold) {
                    newElWidth = (wrapWidth - slider.settings.slideMargin * (slider.settings.minSlides - 1)) / slider.settings.minSlides
                }
            }
            return newElWidth
        };
        var getNumberSlidesShowing = function() {
            var slidesShowing = 1;
            if (slider.settings.mode == "horizontal" && slider.settings.slideWidth > 0) {
                if (slider.viewport.width() < slider.minThreshold) {
                    slidesShowing = slider.settings.minSlides
                } else if (slider.viewport.width() > slider.maxThreshold) {
                    slidesShowing = slider.settings.maxSlides
                } else {
                    var childWidth = slider.children.first().width() + slider.settings.slideMargin;
                    slidesShowing = Math.floor((slider.viewport.width() + slider.settings.slideMargin) / childWidth)
                }
            } else if (slider.settings.mode == "vertical") {
                slidesShowing = slider.settings.minSlides
            }
            return slidesShowing
        };
        var getPagerQty = function() {
            var pagerQty = 0;
            if (slider.settings.moveSlides > 0) {
                if (slider.settings.infiniteLoop) {
                    pagerQty = Math.ceil(slider.children.length / getMoveBy())
                } else {
                    var breakPoint = 0;
                    var counter = 0;
                    while (breakPoint < slider.children.length) {
                        ++pagerQty;
                        breakPoint = counter + getNumberSlidesShowing();
                        counter += slider.settings.moveSlides <= getNumberSlidesShowing() ? slider.settings.moveSlides : getNumberSlidesShowing()
                    }
                }
            } else {
                pagerQty = Math.ceil(slider.children.length / getNumberSlidesShowing())
            }
            return pagerQty
        };
        var getMoveBy = function() {
            if (slider.settings.moveSlides > 0 && slider.settings.moveSlides <= getNumberSlidesShowing()) {
                return slider.settings.moveSlides
            }
            return getNumberSlidesShowing()
        };
        var setSlidePosition = function() {
            if (slider.children.length > slider.settings.maxSlides && slider.active.last && !slider.settings.infiniteLoop) {
                if (slider.settings.mode == "horizontal") {
                    var lastChild = slider.children.last();
                    var position = lastChild.position();
                    setPositionProperty(-(position.left - (slider.viewport.width() - lastChild.outerWidth())), "reset", 0)
                } else if (slider.settings.mode == "vertical") {
                    var lastShowingIndex = slider.children.length - slider.settings.minSlides;
                    var position = slider.children.eq(lastShowingIndex).position();
                    setPositionProperty(-position.top, "reset", 0)
                }
            } else {
                var position = slider.children.eq(slider.active.index * getMoveBy()).position();
                if (slider.active.index == getPagerQty() - 1) slider.active.last = true;
                if (position != undefined) {
                    if (slider.settings.mode == "horizontal") setPositionProperty(-position.left, "reset", 0);
                    else if (slider.settings.mode == "vertical") setPositionProperty(-position.top, "reset", 0)
                }
            }
        };
        var setPositionProperty = function(value, type, duration, params) {
            if (slider.usingCSS) {
                var propValue = slider.settings.mode == "vertical" ? "translate3d(0, " + value + "px, 0)" : "translate3d(" + value + "px, 0, 0)";
                el.css("-" + slider.cssPrefix + "-transition-duration", duration / 1e3 + "s");
                if (type == "slide") {
                    el.css(slider.animProp, propValue);
                    el.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", function() {
                        el.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");
                        updateAfterSlideTransition()
                    })
                } else if (type == "reset") {
                    el.css(slider.animProp, propValue)
                } else if (type == "ticker") {
                    el.css("-" + slider.cssPrefix + "-transition-timing-function", "linear");
                    el.css(slider.animProp, propValue);
                    el.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", function() {
                        el.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd");
                        setPositionProperty(params["resetValue"], "reset", 0);
                        tickerLoop()
                    })
                }
            } else {
                var animateObj = {};
                animateObj[slider.animProp] = value;
                if (type == "slide") {
                    el.animate(animateObj, duration, slider.settings.easing, function() {
                        updateAfterSlideTransition()
                    })
                } else if (type == "reset") {
                    el.css(slider.animProp, value)
                } else if (type == "ticker") {
                    el.animate(animateObj, speed, "linear", function() {
                        setPositionProperty(params["resetValue"], "reset", 0);
                        tickerLoop()
                    })
                }
            }
        };
        var populatePager = function() {
            var pagerHtml = "";
            var pagerQty = getPagerQty();
            for (var i = 0; i < pagerQty; i++) {
                var linkContent = "";
                if (slider.settings.buildPager && $.isFunction(slider.settings.buildPager)) {
                    linkContent = slider.settings.buildPager(i);
                    slider.pagerEl.addClass("bx-custom-pager")
                } else {
                    linkContent = i + 1;
                    slider.pagerEl.addClass("bx-default-pager")
                }
                pagerHtml += '<div class="bx-pager-item"><a href="" data-slide-index="' + i + '" class="bx-pager-link">' + linkContent + "</a></div>"
            }
            slider.pagerEl.html(pagerHtml)
        };
        var appendPager = function() {
            if (!slider.settings.pagerCustom) {
                slider.pagerEl = $('<div class="bx-pager" />');
                if (slider.settings.pagerSelector) {
                    $(slider.settings.pagerSelector).html(slider.pagerEl)
                } else {
                    slider.controls.el.addClass("bx-has-pager").append(slider.pagerEl)
                }
                populatePager()
            } else {
                slider.pagerEl = $(slider.settings.pagerCustom)
            }
            slider.pagerEl.on("click", "a", clickPagerBind)
        };
        var appendControls = function() {
            slider.controls.next = $('<a class="bx-next" href="">' + slider.settings.nextText + "</a>");
            slider.controls.prev = $('<a class="bx-prev" href="">' + slider.settings.prevText + "</a>");
            slider.controls.next.bind("click", clickNextBind);
            slider.controls.prev.bind("click", clickPrevBind);
            if (slider.settings.nextSelector) {
                $(slider.settings.nextSelector).append(slider.controls.next)
            }
            if (slider.settings.prevSelector) {
                $(slider.settings.prevSelector).append(slider.controls.prev)
            }
            if (!slider.settings.nextSelector && !slider.settings.prevSelector) {
                slider.controls.directionEl = $('<div class="bx-controls-direction" />');
                slider.controls.directionEl.append(slider.controls.prev).append(slider.controls.next);
                slider.controls.el.addClass("bx-has-controls-direction").append(slider.controls.directionEl)
            }
        };
        var appendControlsAuto = function() {
            slider.controls.start = $('<div class="bx-controls-auto-item"><a class="bx-start" href="">' + slider.settings.startText + "</a></div>");
            slider.controls.stop = $('<div class="bx-controls-auto-item"><a class="bx-stop" href="">' + slider.settings.stopText + "</a></div>");
            slider.controls.autoEl = $('<div class="bx-controls-auto" />');
            slider.controls.autoEl.on("click", ".bx-start", clickStartBind);
            slider.controls.autoEl.on("click", ".bx-stop", clickStopBind);
            if (slider.settings.autoControlsCombine) {
                slider.controls.autoEl.append(slider.controls.start)
            } else {
                slider.controls.autoEl.append(slider.controls.start).append(slider.controls.stop)
            }
            if (slider.settings.autoControlsSelector) {
                $(slider.settings.autoControlsSelector).html(slider.controls.autoEl)
            } else {
                slider.controls.el.addClass("bx-has-controls-auto").append(slider.controls.autoEl)
            }
            updateAutoControls(slider.settings.autoStart ? "stop" : "start")
        };
        var appendCaptions = function() {
            slider.children.each(function(index) {
                var title = $(this).find("img:first").attr("title");
                if (title != undefined && ("" + title).length) {
                    $(this).append('<div class="bx-caption"><span>' + title + "</span></div>")
                }
            })
        };
        var clickNextBind = function(e) {
            if (slider.settings.auto) el.stopAuto();
            el.goToNextSlide();
            e.preventDefault()
        };
        var clickPrevBind = function(e) {
            if (slider.settings.auto) el.stopAuto();
            el.goToPrevSlide();
            e.preventDefault()
        };
        var clickStartBind = function(e) {
            el.startAuto();
            e.preventDefault()
        };
        var clickStopBind = function(e) {
            el.stopAuto();
            e.preventDefault()
        };
        var clickPagerBind = function(e) {
            if (slider.settings.auto) el.stopAuto();
            var pagerLink = $(e.currentTarget);
            if (pagerLink.attr("data-slide-index") !== undefined) {
                var pagerIndex = parseInt(pagerLink.attr("data-slide-index"));
                if (pagerIndex != slider.active.index) el.goToSlide(pagerIndex);
                e.preventDefault()
            }
        };
        var updatePagerActive = function(slideIndex) {
            var len = slider.children.length;
            if (slider.settings.pagerType == "short") {
                if (slider.settings.maxSlides > 1) {
                    len = Math.ceil(slider.children.length / slider.settings.maxSlides)
                }
                slider.pagerEl.html(slideIndex + 1 + slider.settings.pagerShortSeparator + len);
                return
            }
            slider.pagerEl.find("a").removeClass("active");
            slider.pagerEl.each(function(i, el) {
                $(el).find("a").eq(slideIndex).addClass("active")
            })
        };
        var updateAfterSlideTransition = function() {
            if (slider.settings.infiniteLoop) {
                var position = "";
                if (slider.active.index == 0) {
                    position = slider.children.eq(0).position()
                } else if (slider.active.index == getPagerQty() - 1 && slider.carousel) {
                    position = slider.children.eq((getPagerQty() - 1) * getMoveBy()).position()
                } else if (slider.active.index == slider.children.length - 1) {
                    position = slider.children.eq(slider.children.length - 1).position()
                }
                if (position) {
                    if (slider.settings.mode == "horizontal") {
                        setPositionProperty(-position.left, "reset", 0)
                    } else if (slider.settings.mode == "vertical") {
                        setPositionProperty(-position.top, "reset", 0)
                    }
                }
            }
            slider.working = false;
            slider.settings.onSlideAfter(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index)
        };
        var updateAutoControls = function(state) {
            if (slider.settings.autoControlsCombine) {
                slider.controls.autoEl.html(slider.controls[state])
            } else {
                slider.controls.autoEl.find("a").removeClass("active");
                slider.controls.autoEl.find("a:not(.bx-" + state + ")").addClass("active")
            }
        };
        var updateDirectionControls = function() {
            if (getPagerQty() == 1) {
                slider.controls.prev.addClass("disabled");
                slider.controls.next.addClass("disabled")
            } else if (!slider.settings.infiniteLoop && slider.settings.hideControlOnEnd) {
                if (slider.active.index == 0) {
                    slider.controls.prev.addClass("disabled");
                    slider.controls.next.removeClass("disabled")
                } else if (slider.active.index == getPagerQty() - 1) {
                    slider.controls.next.addClass("disabled");
                    slider.controls.prev.removeClass("disabled")
                } else {
                    slider.controls.prev.removeClass("disabled");
                    slider.controls.next.removeClass("disabled")
                }
            }
        };
        var initAuto = function() {
            if (slider.settings.autoDelay > 0) {
                var timeout = setTimeout(el.startAuto, slider.settings.autoDelay)
            } else {
                el.startAuto()
            }
            if (slider.settings.autoHover) {
                el.hover(function() {
                    if (slider.interval) {
                        el.stopAuto(true);
                        slider.autoPaused = true
                    }
                }, function() {
                    if (slider.autoPaused) {
                        el.startAuto(true);
                        slider.autoPaused = null
                    }
                })
            }
        };
        var initTicker = function() {
            var startPosition = 0;
            if (slider.settings.autoDirection == "next") {
                el.append(slider.children.clone().addClass("bx-clone"))
            } else {
                el.prepend(slider.children.clone().addClass("bx-clone"));
                var position = slider.children.first().position();
                startPosition = slider.settings.mode == "horizontal" ? -position.left : -position.top
            }
            setPositionProperty(startPosition, "reset", 0);
            slider.settings.pager = false;
            slider.settings.controls = false;
            slider.settings.autoControls = false;
            if (slider.settings.tickerHover && !slider.usingCSS) {
                slider.viewport.hover(function() {
                    el.stop()
                }, function() {
                    var totalDimens = 0;
                    slider.children.each(function(index) {
                        totalDimens += slider.settings.mode == "horizontal" ? $(this).outerWidth(true) : $(this).outerHeight(true)
                    });
                    var ratio = slider.settings.speed / totalDimens;
                    var property = slider.settings.mode == "horizontal" ? "left" : "top";
                    var newSpeed = ratio * (totalDimens - Math.abs(parseInt(el.css(property))));
                    tickerLoop(newSpeed)
                })
            }
            tickerLoop()
        };
        var tickerLoop = function(resumeSpeed) {
            speed = resumeSpeed ? resumeSpeed : slider.settings.speed;
            var position = {
                left: 0,
                top: 0
            };
            var reset = {
                left: 0,
                top: 0
            };
            if (slider.settings.autoDirection == "next") {
                position = el.find(".bx-clone").first().position()
            } else {
                reset = slider.children.first().position()
            }
            var animateProperty = slider.settings.mode == "horizontal" ? -position.left : -position.top;
            var resetValue = slider.settings.mode == "horizontal" ? -reset.left : -reset.top;
            var params = {
                resetValue: resetValue
            };
            setPositionProperty(animateProperty, "ticker", speed, params)
        };
        var initTouch = function() {
            slider.touch = {
                start: {
                    x: 0,
                    y: 0
                },
                end: {
                    x: 0,
                    y: 0
                }
            };
            slider.viewport.bind("touchstart", onTouchStart)
        };
        var onTouchStart = function(e) {
            if (slider.working) {
                e.preventDefault()
            } else {
                slider.touch.originalPos = el.position();
                var orig = e.originalEvent;
                slider.touch.start.x = orig.changedTouches[0].pageX;
                slider.touch.start.y = orig.changedTouches[0].pageY;
                slider.viewport.bind("touchmove", onTouchMove);
                slider.viewport.bind("touchend", onTouchEnd)
            }
        };
        var onTouchMove = function(e) {
            var orig = e.originalEvent;
            var xMovement = Math.abs(orig.changedTouches[0].pageX - slider.touch.start.x);
            var yMovement = Math.abs(orig.changedTouches[0].pageY - slider.touch.start.y);
            if (xMovement * 3 > yMovement && slider.settings.preventDefaultSwipeX) {
                e.preventDefault()
            } else if (yMovement * 3 > xMovement && slider.settings.preventDefaultSwipeY) {
                e.preventDefault()
            }
            if (slider.settings.mode != "fade" && slider.settings.oneToOneTouch) {
                var value = 0;
                if (slider.settings.mode == "horizontal") {
                    var change = orig.changedTouches[0].pageX - slider.touch.start.x;
                    value = slider.touch.originalPos.left + change
                } else {
                    var change = orig.changedTouches[0].pageY - slider.touch.start.y;
                    value = slider.touch.originalPos.top + change
                }
                setPositionProperty(value, "reset", 0)
            }
        };
        var onTouchEnd = function(e) {
            slider.viewport.unbind("touchmove", onTouchMove);
            var orig = e.originalEvent;
            var value = 0;
            slider.touch.end.x = orig.changedTouches[0].pageX;
            slider.touch.end.y = orig.changedTouches[0].pageY;
            if (slider.settings.mode == "fade") {
                var distance = Math.abs(slider.touch.start.x - slider.touch.end.x);
                if (distance >= slider.settings.swipeThreshold) {
                    slider.touch.start.x > slider.touch.end.x ? el.goToNextSlide() : el.goToPrevSlide();
                    el.stopAuto()
                }
            } else {
                var distance = 0;
                if (slider.settings.mode == "horizontal") {
                    distance = slider.touch.end.x - slider.touch.start.x;
                    value = slider.touch.originalPos.left
                } else {
                    distance = slider.touch.end.y - slider.touch.start.y;
                    value = slider.touch.originalPos.top
                }
                if (!slider.settings.infiniteLoop && (slider.active.index == 0 && distance > 0 || slider.active.last && distance < 0)) {
                    setPositionProperty(value, "reset", 200)
                } else {
                    if (Math.abs(distance) >= slider.settings.swipeThreshold) {
                        distance < 0 ? el.goToNextSlide() : el.goToPrevSlide();
                        el.stopAuto()
                    } else {
                        setPositionProperty(value, "reset", 200)
                    }
                }
            }
            slider.viewport.unbind("touchend", onTouchEnd)
        };
        var resizeWindow = function(e) {
            if (!slider.initialized) return;
            var windowWidthNew = $(window).width();
            var windowHeightNew = $(window).height();
            if (windowWidth != windowWidthNew || windowHeight != windowHeightNew) {
                windowWidth = windowWidthNew;
                windowHeight = windowHeightNew;
                el.redrawSlider();
                slider.settings.onSliderResize.call(el, slider.active.index)
            }
        };
        el.goToSlide = function(slideIndex, direction) {
            if (slider.working || slider.active.index == slideIndex) return;
            slider.working = true;
            slider.oldIndex = slider.active.index;
            if (slideIndex < 0) {
                slider.active.index = getPagerQty() - 1
            } else if (slideIndex >= getPagerQty()) {
                slider.active.index = 0
            } else {
                slider.active.index = slideIndex
            }
            slider.settings.onSlideBefore(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index);
            if (direction == "next") {
                slider.settings.onSlideNext(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index)
            } else if (direction == "prev") {
                slider.settings.onSlidePrev(slider.children.eq(slider.active.index), slider.oldIndex, slider.active.index)
            }
            slider.active.last = slider.active.index >= getPagerQty() - 1;
            if (slider.settings.pager) updatePagerActive(slider.active.index);
            if (slider.settings.controls) updateDirectionControls();
            if (slider.settings.mode == "fade") {
                if (slider.settings.adaptiveHeight && slider.viewport.height() != getViewportHeight()) {
                    slider.viewport.animate({
                        height: getViewportHeight()
                    }, slider.settings.adaptiveHeightSpeed)
                }
                slider.children.filter(":visible").fadeOut(slider.settings.speed).css({
                    zIndex: 0
                });
                slider.children.eq(slider.active.index).css("zIndex", slider.settings.slideZIndex + 1).fadeIn(slider.settings.speed, function() {
                    $(this).css("zIndex", slider.settings.slideZIndex);
                    updateAfterSlideTransition()
                })
            } else {
                if (slider.settings.adaptiveHeight && slider.viewport.height() != getViewportHeight()) {
                    slider.viewport.animate({
                        height: getViewportHeight()
                    }, slider.settings.adaptiveHeightSpeed)
                }
                var moveBy = 0;
                var position = {
                    left: 0,
                    top: 0
                };
                if (!slider.settings.infiniteLoop && slider.carousel && slider.active.last) {
                    if (slider.settings.mode == "horizontal") {
                        var lastChild = slider.children.eq(slider.children.length - 1);
                        position = lastChild.position();
                        moveBy = slider.viewport.width() - lastChild.outerWidth()
                    } else {
                        var lastShowingIndex = slider.children.length - slider.settings.minSlides;
                        position = slider.children.eq(lastShowingIndex).position()
                    }
                } else if (slider.carousel && slider.active.last && direction == "prev") {
                    var eq = slider.settings.moveSlides == 1 ? slider.settings.maxSlides - getMoveBy() : (getPagerQty() - 1) * getMoveBy() - (slider.children.length - slider.settings.maxSlides);
                    var lastChild = el.children(".bx-clone").eq(eq);
                    position = lastChild.position()
                } else if (direction == "next" && slider.active.index == 0) {
                    position = el.find("> .bx-clone").eq(slider.settings.maxSlides).position();
                    slider.active.last = false
                } else if (slideIndex >= 0) {
                    var requestEl = slideIndex * getMoveBy();
                    position = slider.children.eq(requestEl).position()
                }
                if ("undefined" !== typeof position) {
                    var value = slider.settings.mode == "horizontal" ? -(position.left - moveBy) : -position.top;
                    setPositionProperty(value, "slide", slider.settings.speed)
                }
            }
        };
        el.goToNextSlide = function() {
            if (!slider.settings.infiniteLoop && slider.active.last) return;
            var pagerIndex = parseInt(slider.active.index) + 1;
            el.goToSlide(pagerIndex, "next")
        };
        el.goToPrevSlide = function() {
            if (!slider.settings.infiniteLoop && slider.active.index == 0) return;
            var pagerIndex = parseInt(slider.active.index) - 1;
            el.goToSlide(pagerIndex, "prev")
        };
        el.startAuto = function(preventControlUpdate) {
            if (slider.interval) return;
            slider.interval = setInterval(function() {
                slider.settings.autoDirection == "next" ? el.goToNextSlide() : el.goToPrevSlide()
            }, slider.settings.pause);
            if (slider.settings.autoControls && preventControlUpdate != true) updateAutoControls("stop")
        };
        el.stopAuto = function(preventControlUpdate) {
            if (!slider.interval) return;
            clearInterval(slider.interval);
            slider.interval = null;
            if (slider.settings.autoControls && preventControlUpdate != true) updateAutoControls("start")
        };
        el.getCurrentSlide = function() {
            return slider.active.index
        };
        el.getCurrentSlideElement = function() {
            return slider.children.eq(slider.active.index)
        };
        el.getSlideCount = function() {
            return slider.children.length
        };
        el.redrawSlider = function() {
            slider.children.add(el.find(".bx-clone")).width(getSlideWidth());
            slider.viewport.css("height", getViewportHeight());
            if (!slider.settings.ticker) setSlidePosition();
            if (slider.active.last) slider.active.index = getPagerQty() - 1;
            if (slider.active.index >= getPagerQty()) slider.active.last = true;
            if (slider.settings.pager && !slider.settings.pagerCustom) {
                populatePager();
                updatePagerActive(slider.active.index)
            }
        };
        el.destroySlider = function() {
            if (!slider.initialized) return;
            slider.initialized = false;
            $(".bx-clone", this).remove();
            slider.children.each(function() {
                $(this).data("origStyle") != undefined ? $(this).attr("style", $(this).data("origStyle")) : $(this).removeAttr("style")
            });
            $(this).data("origStyle") != undefined ? this.attr("style", $(this).data("origStyle")) : $(this).removeAttr("style");
            $(this).unwrap().unwrap();
            if (slider.controls.el) slider.controls.el.remove();
            if (slider.controls.next) slider.controls.next.remove();
            if (slider.controls.prev) slider.controls.prev.remove();
            if (slider.pagerEl && slider.settings.controls) slider.pagerEl.remove();
            $(".bx-caption", this).remove();
            if (slider.controls.autoEl) slider.controls.autoEl.remove();
            clearInterval(slider.interval);
            if (slider.settings.responsive) $(window).unbind("resize", resizeWindow)
        };
        el.reloadSlider = function(settings) {
            if (settings != undefined) options = settings;
            el.destroySlider();
            init()
        };
        init();
        return this
    }
})(jQuery);
! function(a) {
    "function" == typeof define && define.amd ? define(["jquery"], a) : "object" == typeof exports ? module.exports = a : a(jQuery)
}(function(a) {
    function b(b) {
        var g = b || window.event,
            h = i.call(arguments, 1),
            j = 0,
            l = 0,
            m = 0,
            n = 0,
            o = 0,
            p = 0;
        if (b = a.event.fix(g), b.type = "mousewheel", "detail" in g && (m = -1 * g.detail), "wheelDelta" in g && (m = g.wheelDelta), "wheelDeltaY" in g && (m = g.wheelDeltaY), "wheelDeltaX" in g && (l = -1 * g.wheelDeltaX), "axis" in g && g.axis === g.HORIZONTAL_AXIS && (l = -1 * m, m = 0), j = 0 === m ? l : m, "deltaY" in g && (m = -1 * g.deltaY, j = m), "deltaX" in g && (l = g.deltaX, 0 === m && (j = -1 * l)), 0 !== m || 0 !== l) {
            if (1 === g.deltaMode) {
                var q = a.data(this, "mousewheel-line-height");
                j *= q, m *= q, l *= q
            } else if (2 === g.deltaMode) {
                var r = a.data(this, "mousewheel-page-height");
                j *= r, m *= r, l *= r
            }
            if (n = Math.max(Math.abs(m), Math.abs(l)), (!f || f > n) && (f = n, d(g, n) && (f /= 40)), d(g, n) && (j /= 40, l /= 40, m /= 40), j = Math[j >= 1 ? "floor" : "ceil"](j / f), l = Math[l >= 1 ? "floor" : "ceil"](l / f), m = Math[m >= 1 ? "floor" : "ceil"](m / f), k.settings.normalizeOffset && this.getBoundingClientRect) {
                var s = this.getBoundingClientRect();
                o = b.clientX - s.left, p = b.clientY - s.top
            }
            return b.deltaX = l, b.deltaY = m, b.deltaFactor = f, b.offsetX = o, b.offsetY = p, b.deltaMode = 0, h.unshift(b, j, l, m), e && clearTimeout(e), e = setTimeout(c, 200), (a.event.dispatch || a.event.handle).apply(this, h)
        }
    }

    function c() {
        f = null
    }

    function d(a, b) {
        return k.settings.adjustOldDeltas && "mousewheel" === a.type && b % 120 === 0
    }
    var e, f, g = ["wheel", "mousewheel", "DOMMouseScroll", "MozMousePixelScroll"],
        h = "onwheel" in document || document.documentMode >= 9 ? ["wheel"] : ["mousewheel", "DomMouseScroll", "MozMousePixelScroll"],
        i = Array.prototype.slice;
    if (a.event.fixHooks)
        for (var j = g.length; j;) a.event.fixHooks[g[--j]] = a.event.mouseHooks;
    var k = a.event.special.mousewheel = {
        version: "3.1.12",
        setup: function() {
            if (this.addEventListener)
                for (var c = h.length; c;) this.addEventListener(h[--c], b, !1);
            else this.onmousewheel = b;
            a.data(this, "mousewheel-line-height", k.getLineHeight(this)), a.data(this, "mousewheel-page-height", k.getPageHeight(this))
        },
        teardown: function() {
            if (this.removeEventListener)
                for (var c = h.length; c;) this.removeEventListener(h[--c], b, !1);
            else this.onmousewheel = null;
            a.removeData(this, "mousewheel-line-height"), a.removeData(this, "mousewheel-page-height")
        },
        getLineHeight: function(b) {
            var c = a(b),
                d = c["offsetParent" in a.fn ? "offsetParent" : "parent"]();
            return d.length || (d = a("body")), parseInt(d.css("fontSize"), 10) || parseInt(c.css("fontSize"), 10) || 16
        },
        getPageHeight: function(b) {
            return a(b).height()
        },
        settings: {
            adjustOldDeltas: !0,
            normalizeOffset: !0
        }
    };
    a.fn.extend({
        mousewheel: function(a) {
            return a ? this.bind("mousewheel", a) : this.trigger("mousewheel")
        },
        unmousewheel: function(a) {
            return this.unbind("mousewheel", a)
        }
    })
});
! function(e) {
    "undefined" != typeof module && module.exports ? module.exports = e : e(jQuery, window, document)
}(function(e) {
    ! function(t) {
        var o = "function" == typeof define && define.amd,
            a = "undefined" != typeof module && module.exports,
            n = "https:" == document.location.protocol ? "https:" : "http:",
            i = "cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.12/jquery.mousewheel.min.js";
        o || (a ? require("jquery-mousewheel")(e) : e.event.special.mousewheel || e("head").append(decodeURI("%3Cscript src=" + n + "//" + i + "%3E%3C/script%3E"))), t()
    }(function() {
        var t, o = "mCustomScrollbar",
            a = "mCS",
            n = ".mCustomScrollbar",
            i = {
                setTop: 0,
                setLeft: 0,
                axis: "y",
                scrollbarPosition: "inside",
                scrollInertia: 950,
                autoDraggerLength: !0,
                alwaysShowScrollbar: 0,
                snapOffset: 0,
                mouseWheel: {
                    enable: !0,
                    scrollAmount: "auto",
                    axis: "y",
                    deltaFactor: "auto",
                    disableOver: ["select", "option", "keygen", "datalist", "textarea"]
                },
                scrollButtons: {
                    scrollType: "stepless",
                    scrollAmount: "auto"
                },
                keyboard: {
                    enable: !0,
                    scrollType: "stepless",
                    scrollAmount: "auto"
                },
                contentTouchScroll: 25,
                advanced: {
                    autoScrollOnFocus: "input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",
                    updateOnContentResize: !0,
                    updateOnImageLoad: !0
                },
                theme: "light",
                callbacks: {
                    onTotalScrollOffset: 0,
                    onTotalScrollBackOffset: 0,
                    alwaysTriggerOffsets: !0
                }
            },
            r = 0,
            l = {},
            s = window.attachEvent && !window.addEventListener ? 1 : 0,
            c = !1,
            d = ["mCSB_dragger_onDrag", "mCSB_scrollTools_onDrag", "mCS_img_loaded", "mCS_disabled", "mCS_destroyed", "mCS_no_scrollbar", "mCS-autoHide", "mCS-dir-rtl", "mCS_no_scrollbar_y", "mCS_no_scrollbar_x", "mCS_y_hidden", "mCS_x_hidden", "mCSB_draggerContainer", "mCSB_buttonUp", "mCSB_buttonDown", "mCSB_buttonLeft", "mCSB_buttonRight"],
            u = {
                init: function(t) {
                    var t = e.extend(!0, {}, i, t),
                        o = f.call(this);
                    if (t.live) {
                        var s = t.liveSelector || this.selector || n,
                            c = e(s);
                        if ("off" === t.live) return void m(s);
                        l[s] = setTimeout(function() {
                            c.mCustomScrollbar(t), "once" === t.live && c.length && m(s)
                        }, 500)
                    } else m(s);
                    return t.setWidth = t.set_width ? t.set_width : t.setWidth, t.setHeight = t.set_height ? t.set_height : t.setHeight, t.axis = t.horizontalScroll ? "x" : p(t.axis), t.scrollInertia = t.scrollInertia > 0 && t.scrollInertia < 17 ? 17 : t.scrollInertia, "object" != typeof t.mouseWheel && 1 == t.mouseWheel && (t.mouseWheel = {
                        enable: !0,
                        scrollAmount: "auto",
                        axis: "y",
                        preventDefault: !1,
                        deltaFactor: "auto",
                        normalizeDelta: !1,
                        invert: !1
                    }), t.mouseWheel.scrollAmount = t.mouseWheelPixels ? t.mouseWheelPixels : t.mouseWheel.scrollAmount, t.mouseWheel.normalizeDelta = t.advanced.normalizeMouseWheelDelta ? t.advanced.normalizeMouseWheelDelta : t.mouseWheel.normalizeDelta, t.scrollButtons.scrollType = g(t.scrollButtons.scrollType), h(t), e(o).each(function() {
                        var o = e(this);
                        if (!o.data(a)) {
                            o.data(a, {
                                idx: ++r,
                                opt: t,
                                scrollRatio: {
                                    y: null,
                                    x: null
                                },
                                overflowed: null,
                                contentReset: {
                                    y: null,
                                    x: null
                                },
                                bindEvents: !1,
                                tweenRunning: !1,
                                sequential: {},
                                langDir: o.css("direction"),
                                cbOffsets: null,
                                trigger: null
                            });
                            var n = o.data(a),
                                i = n.opt,
                                l = o.data("mcs-axis"),
                                s = o.data("mcs-scrollbar-position"),
                                c = o.data("mcs-theme");
                            l && (i.axis = l), s && (i.scrollbarPosition = s), c && (i.theme = c, h(i)), v.call(this), e("#mCSB_" + n.idx + "_container img:not(." + d[2] + ")").addClass(d[2]), u.update.call(null, o)
                        }
                    })
                },
                update: function(t, o) {
                    var n = t || f.call(this);
                    return e(n).each(function() {
                        var t = e(this);
                        if (t.data(a)) {
                            var n = t.data(a),
                                i = n.opt,
                                r = e("#mCSB_" + n.idx + "_container"),
                                l = [e("#mCSB_" + n.idx + "_dragger_vertical"), e("#mCSB_" + n.idx + "_dragger_horizontal")];
                            if (!r.length) return;
                            n.tweenRunning && V(t), t.hasClass(d[3]) && t.removeClass(d[3]), t.hasClass(d[4]) && t.removeClass(d[4]), S.call(this), _.call(this), "y" === i.axis || i.advanced.autoExpandHorizontalScroll || r.css("width", x(r.children())), n.overflowed = B.call(this), O.call(this), i.autoDraggerLength && b.call(this), C.call(this), k.call(this);
                            var s = [Math.abs(r[0].offsetTop), Math.abs(r[0].offsetLeft)];
                            "x" !== i.axis && (n.overflowed[0] ? l[0].height() > l[0].parent().height() ? T.call(this) : (Q(t, s[0].toString(), {
                                dir: "y",
                                dur: 0,
                                overwrite: "none"
                            }), n.contentReset.y = null) : (T.call(this), "y" === i.axis ? M.call(this) : "yx" === i.axis && n.overflowed[1] && Q(t, s[1].toString(), {
                                dir: "x",
                                dur: 0,
                                overwrite: "none"
                            }))), "y" !== i.axis && (n.overflowed[1] ? l[1].width() > l[1].parent().width() ? T.call(this) : (Q(t, s[1].toString(), {
                                dir: "x",
                                dur: 0,
                                overwrite: "none"
                            }), n.contentReset.x = null) : (T.call(this), "x" === i.axis ? M.call(this) : "yx" === i.axis && n.overflowed[0] && Q(t, s[0].toString(), {
                                dir: "y",
                                dur: 0,
                                overwrite: "none"
                            }))), o && n && (2 === o && i.callbacks.onImageLoad && "function" == typeof i.callbacks.onImageLoad ? i.callbacks.onImageLoad.call(this) : 3 === o && i.callbacks.onSelectorChange && "function" == typeof i.callbacks.onSelectorChange ? i.callbacks.onSelectorChange.call(this) : i.callbacks.onUpdate && "function" == typeof i.callbacks.onUpdate && i.callbacks.onUpdate.call(this)), X.call(this)
                        }
                    })
                },
                scrollTo: function(t, o) {
                    if ("undefined" != typeof t && null != t) {
                        var n = f.call(this);
                        return e(n).each(function() {
                            var n = e(this);
                            if (n.data(a)) {
                                var i = n.data(a),
                                    r = i.opt,
                                    l = {
                                        trigger: "external",
                                        scrollInertia: r.scrollInertia,
                                        scrollEasing: "mcsEaseInOut",
                                        moveDragger: !1,
                                        timeout: 60,
                                        callbacks: !0,
                                        onStart: !0,
                                        onUpdate: !0,
                                        onComplete: !0
                                    },
                                    s = e.extend(!0, {}, l, o),
                                    c = Y.call(this, t),
                                    d = s.scrollInertia > 0 && s.scrollInertia < 17 ? 17 : s.scrollInertia;
                                c[0] = j.call(this, c[0], "y"), c[1] = j.call(this, c[1], "x"), s.moveDragger && (c[0] *= i.scrollRatio.y, c[1] *= i.scrollRatio.x), s.dur = d, setTimeout(function() {
                                    null !== c[0] && "undefined" != typeof c[0] && "x" !== r.axis && i.overflowed[0] && (s.dir = "y", s.overwrite = "all", Q(n, c[0].toString(), s)), null !== c[1] && "undefined" != typeof c[1] && "y" !== r.axis && i.overflowed[1] && (s.dir = "x", s.overwrite = "none", Q(n, c[1].toString(), s))
                                }, s.timeout)
                            }
                        })
                    }
                },
                stop: function() {
                    var t = f.call(this);
                    return e(t).each(function() {
                        var t = e(this);
                        t.data(a) && V(t)
                    })
                },
                disable: function(t) {
                    var o = f.call(this);
                    return e(o).each(function() {
                        var o = e(this);
                        if (o.data(a)) {
                            {
                                o.data(a)
                            }
                            X.call(this, "remove"), M.call(this), t && T.call(this), O.call(this, !0), o.addClass(d[3])
                        }
                    })
                },
                destroy: function() {
                    var t = f.call(this);
                    return e(t).each(function() {
                        var n = e(this);
                        if (n.data(a)) {
                            var i = n.data(a),
                                r = i.opt,
                                l = e("#mCSB_" + i.idx),
                                s = e("#mCSB_" + i.idx + "_container"),
                                c = e(".mCSB_" + i.idx + "_scrollbar");
                            r.live && m(r.liveSelector || e(t).selector), X.call(this, "remove"), M.call(this), T.call(this), n.removeData(a), Z(this, "mcs"), c.remove(), s.find("img." + d[2]).removeClass(d[2]), l.replaceWith(s.contents()), n.removeClass(o + " _" + a + "_" + i.idx + " " + d[6] + " " + d[7] + " " + d[5] + " " + d[3]).addClass(d[4])
                        }
                    })
                }
            },
            f = function() {
                return "object" != typeof e(this) || e(this).length < 1 ? n : this
            },
            h = function(t) {
                var o = ["rounded", "rounded-dark", "rounded-dots", "rounded-dots-dark"],
                    a = ["rounded-dots", "rounded-dots-dark", "3d", "3d-dark", "3d-thick", "3d-thick-dark", "inset", "inset-dark", "inset-2", "inset-2-dark", "inset-3", "inset-3-dark"],
                    n = ["minimal", "minimal-dark"],
                    i = ["minimal", "minimal-dark"],
                    r = ["minimal", "minimal-dark"];
                t.autoDraggerLength = e.inArray(t.theme, o) > -1 ? !1 : t.autoDraggerLength, t.autoExpandScrollbar = e.inArray(t.theme, a) > -1 ? !1 : t.autoExpandScrollbar, t.scrollButtons.enable = e.inArray(t.theme, n) > -1 ? !1 : t.scrollButtons.enable, t.autoHideScrollbar = e.inArray(t.theme, i) > -1 ? !0 : t.autoHideScrollbar, t.scrollbarPosition = e.inArray(t.theme, r) > -1 ? "outside" : t.scrollbarPosition
            },
            m = function(e) {
                l[e] && (clearTimeout(l[e]), Z(l, e))
            },
            p = function(e) {
                return "yx" === e || "xy" === e || "auto" === e ? "yx" : "x" === e || "horizontal" === e ? "x" : "y"
            },
            g = function(e) {
                return "stepped" === e || "pixels" === e || "step" === e || "click" === e ? "stepped" : "stepless"
            },
            v = function() {
                var t = e(this),
                    n = t.data(a),
                    i = n.opt,
                    r = i.autoExpandScrollbar ? " " + d[1] + "_expand" : "",
                    l = ["<div id='mCSB_" + n.idx + "_scrollbar_vertical' class='mCSB_scrollTools mCSB_" + n.idx + "_scrollbar mCS-" + i.theme + " mCSB_scrollTools_vertical" + r + "'><div class='" + d[12] + "'><div id='mCSB_" + n.idx + "_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>", "<div id='mCSB_" + n.idx + "_scrollbar_horizontal' class='mCSB_scrollTools mCSB_" + n.idx + "_scrollbar mCS-" + i.theme + " mCSB_scrollTools_horizontal" + r + "'><div class='" + d[12] + "'><div id='mCSB_" + n.idx + "_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],
                    s = "yx" === i.axis ? "mCSB_vertical_horizontal" : "x" === i.axis ? "mCSB_horizontal" : "mCSB_vertical",
                    c = "yx" === i.axis ? l[0] + l[1] : "x" === i.axis ? l[1] : l[0],
                    u = "yx" === i.axis ? "<div id='mCSB_" + n.idx + "_container_wrapper' class='mCSB_container_wrapper' />" : "",
                    f = i.autoHideScrollbar ? " " + d[6] : "",
                    h = "x" !== i.axis && "rtl" === n.langDir ? " " + d[7] : "";
                i.setWidth && t.css("width", i.setWidth), i.setHeight && t.css("height", i.setHeight), i.setLeft = "y" !== i.axis && "rtl" === n.langDir ? "989999px" : i.setLeft, t.addClass(o + " _" + a + "_" + n.idx + f + h).wrapInner("<div id='mCSB_" + n.idx + "' class='mCustomScrollBox mCS-" + i.theme + " " + s + "'><div id='mCSB_" + n.idx + "_container' class='mCSB_container' style='position:relative; top:" + i.setTop + "; left:" + i.setLeft + ";' dir=" + n.langDir + " /></div>");
                var m = e("#mCSB_" + n.idx),
                    p = e("#mCSB_" + n.idx + "_container");
                "y" === i.axis || i.advanced.autoExpandHorizontalScroll || p.css("width", x(p.children())), "outside" === i.scrollbarPosition ? ("static" === t.css("position") && t.css("position", "relative"), t.css("overflow", "visible"), m.addClass("mCSB_outside").after(c)) : (m.addClass("mCSB_inside").append(c), p.wrap(u)), w.call(this);
                var g = [e("#mCSB_" + n.idx + "_dragger_vertical"), e("#mCSB_" + n.idx + "_dragger_horizontal")];
                g[0].css("min-height", g[0].height()), g[1].css("min-width", g[1].width())
            },
            x = function(t) {
                return Math.max.apply(Math, t.map(function() {
                    return e(this).outerWidth(!0)
                }).get())
            },
            _ = function() {
                var t = e(this),
                    o = t.data(a),
                    n = o.opt,
                    i = e("#mCSB_" + o.idx + "_container");
                n.advanced.autoExpandHorizontalScroll && "y" !== n.axis && i.css({
                    position: "absolute",
                    width: "auto"
                }).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({
                    width: Math.ceil(i[0].getBoundingClientRect().right + .4) - Math.floor(i[0].getBoundingClientRect().left),
                    position: "relative"
                }).unwrap()
            },
            w = function() {
                var t = e(this),
                    o = t.data(a),
                    n = o.opt,
                    i = e(".mCSB_" + o.idx + "_scrollbar:first"),
                    r = tt(n.scrollButtons.tabindex) ? "tabindex='" + n.scrollButtons.tabindex + "'" : "",
                    l = ["<a href='#' class='" + d[13] + "' oncontextmenu='return false;' " + r + " />", "<a href='#' class='" + d[14] + "' oncontextmenu='return false;' " + r + " />", "<a href='#' class='" + d[15] + "' oncontextmenu='return false;' " + r + " />", "<a href='#' class='" + d[16] + "' oncontextmenu='return false;' " + r + " />"],
                    s = ["x" === n.axis ? l[2] : l[0], "x" === n.axis ? l[3] : l[1], l[2], l[3]];
                n.scrollButtons.enable && i.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])
            },
            S = function() {
                var t = e(this),
                    o = t.data(a),
                    n = e("#mCSB_" + o.idx),
                    i = t.css("max-height") || "none",
                    r = -1 !== i.indexOf("%"),
                    l = t.css("box-sizing");
                if ("none" !== i) {
                    var s = r ? t.parent().height() * parseInt(i) / 100 : parseInt(i);
                    "border-box" === l && (s -= t.innerHeight() - t.height() + (t.outerHeight() - t.innerHeight())), n.css("max-height", Math.round(s))
                }
            },
            b = function() {
                var t = e(this),
                    o = t.data(a),
                    n = e("#mCSB_" + o.idx),
                    i = e("#mCSB_" + o.idx + "_container"),
                    r = [e("#mCSB_" + o.idx + "_dragger_vertical"), e("#mCSB_" + o.idx + "_dragger_horizontal")],
                    l = [n.height() / i.outerHeight(!1), n.width() / i.outerWidth(!1)],
                    c = [parseInt(r[0].css("min-height")), Math.round(l[0] * r[0].parent().height()), parseInt(r[1].css("min-width")), Math.round(l[1] * r[1].parent().width())],
                    d = s && c[1] < c[0] ? c[0] : c[1],
                    u = s && c[3] < c[2] ? c[2] : c[3];
                r[0].css({
                    height: d,
                    "max-height": r[0].parent().height() - 10
                }).find(".mCSB_dragger_bar").css({
                    "line-height": c[0] + "px"
                }), r[1].css({
                    width: u,
                    "max-width": r[1].parent().width() - 10
                })
            },
            C = function() {
                var t = e(this),
                    o = t.data(a),
                    n = e("#mCSB_" + o.idx),
                    i = e("#mCSB_" + o.idx + "_container"),
                    r = [e("#mCSB_" + o.idx + "_dragger_vertical"), e("#mCSB_" + o.idx + "_dragger_horizontal")],
                    l = [i.outerHeight(!1) - n.height(), i.outerWidth(!1) - n.width()],
                    s = [l[0] / (r[0].parent().height() - r[0].height()), l[1] / (r[1].parent().width() - r[1].width())];
                o.scrollRatio = {
                    y: s[0],
                    x: s[1]
                }
            },
            y = function(e, t, o) {
                var a = o ? d[0] + "_expanded" : "",
                    n = e.closest(".mCSB_scrollTools");
                "active" === t ? (e.toggleClass(d[0] + " " + a), n.toggleClass(d[1]), e[0]._draggable = e[0]._draggable ? 0 : 1) : e[0]._draggable || ("hide" === t ? (e.removeClass(d[0]), n.removeClass(d[1])) : (e.addClass(d[0]), n.addClass(d[1])))
            },
            B = function() {
                var t = e(this),
                    o = t.data(a),
                    n = e("#mCSB_" + o.idx),
                    i = e("#mCSB_" + o.idx + "_container"),
                    r = null == o.overflowed ? i.height() : i.outerHeight(!1),
                    l = null == o.overflowed ? i.width() : i.outerWidth(!1);
                return [r > n.height(), l > n.width()]
            },
            T = function() {
                var t = e(this),
                    o = t.data(a),
                    n = o.opt,
                    i = e("#mCSB_" + o.idx),
                    r = e("#mCSB_" + o.idx + "_container"),
                    l = [e("#mCSB_" + o.idx + "_dragger_vertical"), e("#mCSB_" + o.idx + "_dragger_horizontal")];
                if (V(t), ("x" !== n.axis && !o.overflowed[0] || "y" === n.axis && o.overflowed[0]) && (l[0].add(r).css("top", 0), Q(t, "_resetY")), "y" !== n.axis && !o.overflowed[1] || "x" === n.axis && o.overflowed[1]) {
                    var s = dx = 0;
                    "rtl" === o.langDir && (s = i.width() - r.outerWidth(!1), dx = Math.abs(s / o.scrollRatio.x)), r.css("left", s), l[1].css("left", dx), Q(t, "_resetX")
                }
            },
            k = function() {
                function t() {
                    r = setTimeout(function() {
                        e.event.special.mousewheel ? (clearTimeout(r), W.call(o[0])) : t()
                    }, 100)
                }
                var o = e(this),
                    n = o.data(a),
                    i = n.opt;
                if (!n.bindEvents) {
                    if (R.call(this), i.contentTouchScroll && E.call(this), D.call(this), i.mouseWheel.enable) {
                        var r;
                        t()
                    }
                    P.call(this), H.call(this), i.advanced.autoScrollOnFocus && z.call(this), i.scrollButtons.enable && U.call(this), i.keyboard.enable && q.call(this), n.bindEvents = !0
                }
            },
            M = function() {
                var t = e(this),
                    o = t.data(a),
                    n = o.opt,
                    i = a + "_" + o.idx,
                    r = ".mCSB_" + o.idx + "_scrollbar",
                    l = e("#mCSB_" + o.idx + ",#mCSB_" + o.idx + "_container,#mCSB_" + o.idx + "_container_wrapper," + r + " ." + d[12] + ",#mCSB_" + o.idx + "_dragger_vertical,#mCSB_" + o.idx + "_dragger_horizontal," + r + ">a"),
                    s = e("#mCSB_" + o.idx + "_container");
                n.advanced.releaseDraggableSelectors && l.add(e(n.advanced.releaseDraggableSelectors)), o.bindEvents && (e(document).unbind("." + i), l.each(function() {
                    e(this).unbind("." + i)
                }), clearTimeout(t[0]._focusTimeout), Z(t[0], "_focusTimeout"), clearTimeout(o.sequential.step), Z(o.sequential, "step"), clearTimeout(s[0].onCompleteTimeout), Z(s[0], "onCompleteTimeout"), o.bindEvents = !1)
            },
            O = function(t) {
                var o = e(this),
                    n = o.data(a),
                    i = n.opt,
                    r = e("#mCSB_" + n.idx + "_container_wrapper"),
                    l = r.length ? r : e("#mCSB_" + n.idx + "_container"),
                    s = [e("#mCSB_" + n.idx + "_scrollbar_vertical"), e("#mCSB_" + n.idx + "_scrollbar_horizontal")],
                    c = [s[0].find(".mCSB_dragger"), s[1].find(".mCSB_dragger")];
                "x" !== i.axis && (n.overflowed[0] && !t ? (s[0].add(c[0]).add(s[0].children("a")).css("display", "block"), l.removeClass(d[8] + " " + d[10])) : (i.alwaysShowScrollbar ? (2 !== i.alwaysShowScrollbar && c[0].css("display", "none"), l.removeClass(d[10])) : (s[0].css("display", "none"), l.addClass(d[10])), l.addClass(d[8]))), "y" !== i.axis && (n.overflowed[1] && !t ? (s[1].add(c[1]).add(s[1].children("a")).css("display", "block"), l.removeClass(d[9] + " " + d[11])) : (i.alwaysShowScrollbar ? (2 !== i.alwaysShowScrollbar && c[1].css("display", "none"), l.removeClass(d[11])) : (s[1].css("display", "none"), l.addClass(d[11])), l.addClass(d[9]))), n.overflowed[0] || n.overflowed[1] ? o.removeClass(d[5]) : o.addClass(d[5])
            },
            I = function(e) {
                var t = e.type;
                switch (t) {
                    case "pointerdown":
                    case "MSPointerDown":
                    case "pointermove":
                    case "MSPointerMove":
                    case "pointerup":
                    case "MSPointerUp":
                        return e.target.ownerDocument !== document ? [e.originalEvent.screenY, e.originalEvent.screenX, !1] : [e.originalEvent.pageY, e.originalEvent.pageX, !1];
                    case "touchstart":
                    case "touchmove":
                    case "touchend":
                        var o = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0],
                            a = e.originalEvent.touches.length || e.originalEvent.changedTouches.length;
                        return e.target.ownerDocument !== document ? [o.screenY, o.screenX, a > 1] : [o.pageY, o.pageX, a > 1];
                    default:
                        return [e.pageY, e.pageX, !1]
                }
            },
            R = function() {
                function t(e) {
                    var t = m.find("iframe");
                    if (t.length) {
                        var o = e ? "auto" : "none";
                        t.css("pointer-events", o)
                    }
                }

                function o(e, t, o, a) {
                    if (m[0].idleTimer = u.scrollInertia < 233 ? 250 : 0, n.attr("id") === h[1]) var i = "x",
                        r = (n[0].offsetLeft - t + a) * d.scrollRatio.x;
                    else var i = "y",
                        r = (n[0].offsetTop - e + o) * d.scrollRatio.y;
                    Q(l, r.toString(), {
                        dir: i,
                        drag: !0
                    })
                }
                var n, i, r, l = e(this),
                    d = l.data(a),
                    u = d.opt,
                    f = a + "_" + d.idx,
                    h = ["mCSB_" + d.idx + "_dragger_vertical", "mCSB_" + d.idx + "_dragger_horizontal"],
                    m = e("#mCSB_" + d.idx + "_container"),
                    p = e("#" + h[0] + ",#" + h[1]),
                    g = u.advanced.releaseDraggableSelectors ? p.add(e(u.advanced.releaseDraggableSelectors)) : p;
                p.bind("mousedown." + f + " touchstart." + f + " pointerdown." + f + " MSPointerDown." + f, function(o) {
                    if (o.stopImmediatePropagation(), o.preventDefault(), $(o)) {
                        c = !0, s && (document.onselectstart = function() {
                            return !1
                        }), t(!1), V(l), n = e(this);
                        var a = n.offset(),
                            d = I(o)[0] - a.top,
                            f = I(o)[1] - a.left,
                            h = n.height() + a.top,
                            m = n.width() + a.left;
                        h > d && d > 0 && m > f && f > 0 && (i = d, r = f), y(n, "active", u.autoExpandScrollbar)
                    }
                }).bind("touchmove." + f, function(e) {
                    e.stopImmediatePropagation(), e.preventDefault();
                    var t = n.offset(),
                        a = I(e)[0] - t.top,
                        l = I(e)[1] - t.left;
                    o(i, r, a, l)
                }), e(document).bind("mousemove." + f + " pointermove." + f + " MSPointerMove." + f, function(e) {
                    if (n) {
                        var t = n.offset(),
                            a = I(e)[0] - t.top,
                            l = I(e)[1] - t.left;
                        if (i === a) return;
                        o(i, r, a, l)
                    }
                }).add(g).bind("mouseup." + f + " touchend." + f + " pointerup." + f + " MSPointerUp." + f, function() {
                    n && (y(n, "active", u.autoExpandScrollbar), n = null), c = !1, s && (document.onselectstart = null), t(!0)
                })
            },
            E = function() {
                function o(e) {
                    if (!et(e) || c || I(e)[2]) return void(t = 0);
                    t = 1, S = 0, b = 0;
                    var o = M.offset();
                    d = I(e)[0] - o.top, u = I(e)[1] - o.left, A = [I(e)[0], I(e)[1]]
                }

                function n(e) {
                    if (et(e) && !c && !I(e)[2] && (e.stopImmediatePropagation(), !b || S)) {
                        p = J();
                        var t = k.offset(),
                            o = I(e)[0] - t.top,
                            a = I(e)[1] - t.left,
                            n = "mcsLinearOut";
                        if (R.push(o), E.push(a), A[2] = Math.abs(I(e)[0] - A[0]), A[3] = Math.abs(I(e)[1] - A[1]), y.overflowed[0]) var i = O[0].parent().height() - O[0].height(),
                            r = d - o > 0 && o - d > -(i * y.scrollRatio.y) && (2 * A[3] < A[2] || "yx" === B.axis);
                        if (y.overflowed[1]) var l = O[1].parent().width() - O[1].width(),
                            f = u - a > 0 && a - u > -(l * y.scrollRatio.x) && (2 * A[2] < A[3] || "yx" === B.axis);
                        r || f ? (e.preventDefault(), S = 1) : b = 1, _ = "yx" === B.axis ? [d - o, u - a] : "x" === B.axis ? [null, u - a] : [d - o, null], M[0].idleTimer = 250, y.overflowed[0] && s(_[0], D, n, "y", "all", !0), y.overflowed[1] && s(_[1], D, n, "x", W, !0)
                    }
                }

                function i(e) {
                    if (!et(e) || c || I(e)[2]) return void(t = 0);
                    t = 1, e.stopImmediatePropagation(), V(C), m = J();
                    var o = k.offset();
                    f = I(e)[0] - o.top, h = I(e)[1] - o.left, R = [], E = []
                }

                function r(e) {
                    if (et(e) && !c && !I(e)[2]) {
                        e.stopImmediatePropagation(), S = 0, b = 0, g = J();
                        var t = k.offset(),
                            o = I(e)[0] - t.top,
                            a = I(e)[1] - t.left;
                        if (!(g - p > 30)) {
                            x = 1e3 / (g - m);
                            var n = "mcsEaseOut",
                                i = 2.5 > x,
                                r = i ? [R[R.length - 2], E[E.length - 2]] : [0, 0];
                            v = i ? [o - r[0], a - r[1]] : [o - f, a - h];
                            var d = [Math.abs(v[0]), Math.abs(v[1])];
                            x = i ? [Math.abs(v[0] / 4), Math.abs(v[1] / 4)] : [x, x];
                            var u = [Math.abs(M[0].offsetTop) - v[0] * l(d[0] / x[0], x[0]), Math.abs(M[0].offsetLeft) - v[1] * l(d[1] / x[1], x[1])];
                            _ = "yx" === B.axis ? [u[0], u[1]] : "x" === B.axis ? [null, u[1]] : [u[0], null], w = [4 * d[0] + B.scrollInertia, 4 * d[1] + B.scrollInertia];
                            var C = parseInt(B.contentTouchScroll) || 0;
                            _[0] = d[0] > C ? _[0] : 0, _[1] = d[1] > C ? _[1] : 0, y.overflowed[0] && s(_[0], w[0], n, "y", W, !1), y.overflowed[1] && s(_[1], w[1], n, "x", W, !1)
                        }
                    }
                }

                function l(e, t) {
                    var o = [1.5 * t, 2 * t, t / 1.5, t / 2];
                    return e > 90 ? t > 4 ? o[0] : o[3] : e > 60 ? t > 3 ? o[3] : o[2] : e > 30 ? t > 8 ? o[1] : t > 6 ? o[0] : t > 4 ? t : o[2] : t > 8 ? t : o[3]
                }

                function s(e, t, o, a, n, i) {
                    e && Q(C, e.toString(), {
                        dur: t,
                        scrollEasing: o,
                        dir: a,
                        overwrite: n,
                        drag: i
                    })
                }
                var d, u, f, h, m, p, g, v, x, _, w, S, b, C = e(this),
                    y = C.data(a),
                    B = y.opt,
                    T = a + "_" + y.idx,
                    k = e("#mCSB_" + y.idx),
                    M = e("#mCSB_" + y.idx + "_container"),
                    O = [e("#mCSB_" + y.idx + "_dragger_vertical"), e("#mCSB_" + y.idx + "_dragger_horizontal")],
                    R = [],
                    E = [],
                    D = 0,
                    W = "yx" === B.axis ? "none" : "all",
                    A = [],
                    P = M.find("iframe"),
                    z = ["touchstart." + T + " pointerdown." + T + " MSPointerDown." + T, "touchmove." + T + " pointermove." + T + " MSPointerMove." + T, "touchend." + T + " pointerup." + T + " MSPointerUp." + T];
                M.bind(z[0], function(e) {
                    o(e)
                }).bind(z[1], function(e) {
                    n(e)
                }), k.bind(z[0], function(e) {
                    i(e)
                }).bind(z[2], function(e) {
                    r(e)
                }), P.length && P.each(function() {
                    e(this).load(function() {
                        L(this) && e(this.contentDocument || this.contentWindow.document).bind(z[0], function(e) {
                            o(e), i(e)
                        }).bind(z[1], function(e) {
                            n(e)
                        }).bind(z[2], function(e) {
                            r(e)
                        })
                    })
                })
            },
            D = function() {
                function o() {
                    return window.getSelection ? window.getSelection().toString() : document.selection && "Control" != document.selection.type ? document.selection.createRange().text : 0
                }

                function n(e, t, o) {
                    d.type = o && i ? "stepped" : "stepless", d.scrollAmount = 10, F(r, e, t, "mcsLinearOut", o ? 60 : null)
                }
                var i, r = e(this),
                    l = r.data(a),
                    s = l.opt,
                    d = l.sequential,
                    u = a + "_" + l.idx,
                    f = e("#mCSB_" + l.idx + "_container"),
                    h = f.parent();
                f.bind("mousedown." + u, function() {
                    t || i || (i = 1, c = !0)
                }).add(document).bind("mousemove." + u, function(e) {
                    if (!t && i && o()) {
                        var a = f.offset(),
                            r = I(e)[0] - a.top + f[0].offsetTop,
                            c = I(e)[1] - a.left + f[0].offsetLeft;
                        r > 0 && r < h.height() && c > 0 && c < h.width() ? d.step && n("off", null, "stepped") : ("x" !== s.axis && l.overflowed[0] && (0 > r ? n("on", 38) : r > h.height() && n("on", 40)), "y" !== s.axis && l.overflowed[1] && (0 > c ? n("on", 37) : c > h.width() && n("on", 39)))
                    }
                }).bind("mouseup." + u, function() {
                    t || (i && (i = 0, n("off", null)), c = !1)
                })
            },
            W = function() {
                function t(t, a) {
                    if (V(o), !A(o, t.target)) {
                        var r = "auto" !== i.mouseWheel.deltaFactor ? parseInt(i.mouseWheel.deltaFactor) : s && t.deltaFactor < 100 ? 100 : t.deltaFactor || 100;
                        if ("x" === i.axis || "x" === i.mouseWheel.axis) var d = "x",
                            u = [Math.round(r * n.scrollRatio.x), parseInt(i.mouseWheel.scrollAmount)],
                            f = "auto" !== i.mouseWheel.scrollAmount ? u[1] : u[0] >= l.width() ? .9 * l.width() : u[0],
                            h = Math.abs(e("#mCSB_" + n.idx + "_container")[0].offsetLeft),
                            m = c[1][0].offsetLeft,
                            p = c[1].parent().width() - c[1].width(),
                            g = t.deltaX || t.deltaY || a;
                        else var d = "y",
                            u = [Math.round(r * n.scrollRatio.y), parseInt(i.mouseWheel.scrollAmount)],
                            f = "auto" !== i.mouseWheel.scrollAmount ? u[1] : u[0] >= l.height() ? .9 * l.height() : u[0],
                            h = Math.abs(e("#mCSB_" + n.idx + "_container")[0].offsetTop),
                            m = c[0][0].offsetTop,
                            p = c[0].parent().height() - c[0].height(),
                            g = t.deltaY || a;
                        "y" === d && !n.overflowed[0] || "x" === d && !n.overflowed[1] || (i.mouseWheel.invert && (g = -g), i.mouseWheel.normalizeDelta && (g = 0 > g ? -1 : 1), (g > 0 && 0 !== m || 0 > g && m !== p || i.mouseWheel.preventDefault) && (t.stopImmediatePropagation(), t.preventDefault()), Q(o, (h - g * f).toString(), {
                            dir: d
                        }))
                    }
                }
                var o = e(this),
                    n = o.data(a),
                    i = n.opt,
                    r = a + "_" + n.idx,
                    l = e("#mCSB_" + n.idx),
                    c = [e("#mCSB_" + n.idx + "_dragger_vertical"), e("#mCSB_" + n.idx + "_dragger_horizontal")],
                    d = e("#mCSB_" + n.idx + "_container").find("iframe");
                n && (d.length && d.each(function() {
                    e(this).load(function() {
                        L(this) && e(this.contentDocument || this.contentWindow.document).bind("mousewheel." + r, function(e, o) {
                            t(e, o)
                        })
                    })
                }), l.bind("mousewheel." + r, function(e, o) {
                    t(e, o)
                }))
            },
            L = function(e) {
                var t = null;
                try {
                    var o = e.contentDocument || e.contentWindow.document;
                    t = o.body.innerHTML
                } catch (a) {}
                return null !== t
            },
            A = function(t, o) {
                var n = o.nodeName.toLowerCase(),
                    i = t.data(a).opt.mouseWheel.disableOver,
                    r = ["select", "textarea"];
                return e.inArray(n, i) > -1 && !(e.inArray(n, r) > -1 && !e(o).is(":focus"))
            },
            P = function() {
                var t = e(this),
                    o = t.data(a),
                    n = a + "_" + o.idx,
                    i = e("#mCSB_" + o.idx + "_container"),
                    r = i.parent(),
                    l = e(".mCSB_" + o.idx + "_scrollbar ." + d[12]);
                l.bind("touchstart." + n + " pointerdown." + n + " MSPointerDown." + n, function() {
                    c = !0
                }).bind("touchend." + n + " pointerup." + n + " MSPointerUp." + n, function() {
                    c = !1
                }).bind("click." + n, function(a) {
                    if (e(a.target).hasClass(d[12]) || e(a.target).hasClass("mCSB_draggerRail")) {
                        V(t);
                        var n = e(this),
                            l = n.find(".mCSB_dragger");
                        if (n.parent(".mCSB_scrollTools_horizontal").length > 0) {
                            if (!o.overflowed[1]) return;
                            var s = "x",
                                c = a.pageX > l.offset().left ? -1 : 1,
                                u = Math.abs(i[0].offsetLeft) - .9 * c * r.width()
                        } else {
                            if (!o.overflowed[0]) return;
                            var s = "y",
                                c = a.pageY > l.offset().top ? -1 : 1,
                                u = Math.abs(i[0].offsetTop) - .9 * c * r.height()
                        }
                        Q(t, u.toString(), {
                            dir: s,
                            scrollEasing: "mcsEaseInOut"
                        })
                    }
                })
            },
            z = function() {
                var t = e(this),
                    o = t.data(a),
                    n = o.opt,
                    i = a + "_" + o.idx,
                    r = e("#mCSB_" + o.idx + "_container"),
                    l = r.parent();
                r.bind("focusin." + i, function() {
                    var o = e(document.activeElement),
                        a = r.find(".mCustomScrollBox").length,
                        i = 0;
                    o.is(n.advanced.autoScrollOnFocus) && (V(t), clearTimeout(t[0]._focusTimeout), t[0]._focusTimer = a ? (i + 17) * a : 0, t[0]._focusTimeout = setTimeout(function() {
                        var e = [ot(o)[0], ot(o)[1]],
                            a = [r[0].offsetTop, r[0].offsetLeft],
                            s = [a[0] + e[0] >= 0 && a[0] + e[0] < l.height() - o.outerHeight(!1), a[1] + e[1] >= 0 && a[0] + e[1] < l.width() - o.outerWidth(!1)],
                            c = "yx" !== n.axis || s[0] || s[1] ? "all" : "none";
                        "x" === n.axis || s[0] || Q(t, e[0].toString(), {
                            dir: "y",
                            scrollEasing: "mcsEaseInOut",
                            overwrite: c,
                            dur: i
                        }), "y" === n.axis || s[1] || Q(t, e[1].toString(), {
                            dir: "x",
                            scrollEasing: "mcsEaseInOut",
                            overwrite: c,
                            dur: i
                        })
                    }, t[0]._focusTimer))
                })
            },
            H = function() {
                var t = e(this),
                    o = t.data(a),
                    n = a + "_" + o.idx,
                    i = e("#mCSB_" + o.idx + "_container").parent();
                i.bind("scroll." + n, function() {
                    (0 !== i.scrollTop() || 0 !== i.scrollLeft()) && e(".mCSB_" + o.idx + "_scrollbar").css("visibility", "hidden")
                })
            },
            U = function() {
                var t = e(this),
                    o = t.data(a),
                    n = o.opt,
                    i = o.sequential,
                    r = a + "_" + o.idx,
                    l = ".mCSB_" + o.idx + "_scrollbar",
                    s = e(l + ">a");
                s.bind("mousedown." + r + " touchstart." + r + " pointerdown." + r + " MSPointerDown." + r + " mouseup." + r + " touchend." + r + " pointerup." + r + " MSPointerUp." + r + " mouseout." + r + " pointerout." + r + " MSPointerOut." + r + " click." + r, function(a) {
                    function r(e, o) {
                        i.scrollAmount = n.snapAmount || n.scrollButtons.scrollAmount, F(t, e, o)
                    }
                    if (a.preventDefault(), $(a)) {
                        var l = e(this).attr("class");
                        switch (i.type = n.scrollButtons.scrollType, a.type) {
                            case "mousedown":
                            case "touchstart":
                            case "pointerdown":
                            case "MSPointerDown":
                                if ("stepped" === i.type) return;
                                c = !0, o.tweenRunning = !1, r("on", l);
                                break;
                            case "mouseup":
                            case "touchend":
                            case "pointerup":
                            case "MSPointerUp":
                            case "mouseout":
                            case "pointerout":
                            case "MSPointerOut":
                                if ("stepped" === i.type) return;
                                c = !1, i.dir && r("off", l);
                                break;
                            case "click":
                                if ("stepped" !== i.type || o.tweenRunning) return;
                                r("on", l)
                        }
                    }
                })
            },
            q = function() {
                function t(t) {
                    function a(e, t) {
                        r.type = i.keyboard.scrollType, r.scrollAmount = i.snapAmount || i.keyboard.scrollAmount, "stepped" === r.type && n.tweenRunning || F(o, e, t)
                    }
                    switch (t.type) {
                        case "blur":
                            n.tweenRunning && r.dir && a("off", null);
                            break;
                        case "keydown":
                        case "keyup":
                            var l = t.keyCode ? t.keyCode : t.which,
                                s = "on";
                            if ("x" !== i.axis && (38 === l || 40 === l) || "y" !== i.axis && (37 === l || 39 === l)) {
                                if ((38 === l || 40 === l) && !n.overflowed[0] || (37 === l || 39 === l) && !n.overflowed[1]) return;
                                "keyup" === t.type && (s = "off"), e(document.activeElement).is(u) || (t.preventDefault(), t.stopImmediatePropagation(), a(s, l))
                            } else if (33 === l || 34 === l) {
                                if ((n.overflowed[0] || n.overflowed[1]) && (t.preventDefault(), t.stopImmediatePropagation()), "keyup" === t.type) {
                                    V(o);
                                    var f = 34 === l ? -1 : 1;
                                    if ("x" === i.axis || "yx" === i.axis && n.overflowed[1] && !n.overflowed[0]) var h = "x",
                                        m = Math.abs(c[0].offsetLeft) - .9 * f * d.width();
                                    else var h = "y",
                                        m = Math.abs(c[0].offsetTop) - .9 * f * d.height();
                                    Q(o, m.toString(), {
                                        dir: h,
                                        scrollEasing: "mcsEaseInOut"
                                    })
                                }
                            } else if ((35 === l || 36 === l) && !e(document.activeElement).is(u) && ((n.overflowed[0] || n.overflowed[1]) && (t.preventDefault(), t.stopImmediatePropagation()), "keyup" === t.type)) {
                                if ("x" === i.axis || "yx" === i.axis && n.overflowed[1] && !n.overflowed[0]) var h = "x",
                                    m = 35 === l ? Math.abs(d.width() - c.outerWidth(!1)) : 0;
                                else var h = "y",
                                    m = 35 === l ? Math.abs(d.height() - c.outerHeight(!1)) : 0;
                                Q(o, m.toString(), {
                                    dir: h,
                                    scrollEasing: "mcsEaseInOut"
                                })
                            }
                    }
                }
                var o = e(this),
                    n = o.data(a),
                    i = n.opt,
                    r = n.sequential,
                    l = a + "_" + n.idx,
                    s = e("#mCSB_" + n.idx),
                    c = e("#mCSB_" + n.idx + "_container"),
                    d = c.parent(),
                    u = "input,textarea,select,datalist,keygen,[contenteditable='true']",
                    f = c.find("iframe"),
                    h = ["blur." + l + " keydown." + l + " keyup." + l];
                f.length && f.each(function() {
                    e(this).load(function() {
                        L(this) && e(this.contentDocument || this.contentWindow.document).bind(h[0], function(e) {
                            t(e)
                        })
                    })
                }), s.attr("tabindex", "0").bind(h[0], function(e) {
                    t(e)
                })
            },
            F = function(t, o, n, i, r) {
                function l(e) {
                    var o = "stepped" !== f.type,
                        a = r ? r : e ? o ? p / 1.5 : g : 1e3 / 60,
                        n = e ? o ? 7.5 : 40 : 2.5,
                        s = [Math.abs(h[0].offsetTop), Math.abs(h[0].offsetLeft)],
                        d = [c.scrollRatio.y > 10 ? 10 : c.scrollRatio.y, c.scrollRatio.x > 10 ? 10 : c.scrollRatio.x],
                        u = "x" === f.dir[0] ? s[1] + f.dir[1] * d[1] * n : s[0] + f.dir[1] * d[0] * n,
                        m = "x" === f.dir[0] ? s[1] + f.dir[1] * parseInt(f.scrollAmount) : s[0] + f.dir[1] * parseInt(f.scrollAmount),
                        v = "auto" !== f.scrollAmount ? m : u,
                        x = i ? i : e ? o ? "mcsLinearOut" : "mcsEaseInOut" : "mcsLinear",
                        _ = e ? !0 : !1;
                    return e && 17 > a && (v = "x" === f.dir[0] ? s[1] : s[0]), Q(t, v.toString(), {
                        dir: f.dir[0],
                        scrollEasing: x,
                        dur: a,
                        onComplete: _
                    }), e ? void(f.dir = !1) : (clearTimeout(f.step), void(f.step = setTimeout(function() {
                        l()
                    }, a)))
                }

                function s() {
                    clearTimeout(f.step), Z(f, "step"), V(t)
                }
                var c = t.data(a),
                    u = c.opt,
                    f = c.sequential,
                    h = e("#mCSB_" + c.idx + "_container"),
                    m = "stepped" === f.type ? !0 : !1,
                    p = u.scrollInertia < 26 ? 26 : u.scrollInertia,
                    g = u.scrollInertia < 1 ? 17 : u.scrollInertia;
                switch (o) {
                    case "on":
                        if (f.dir = [n === d[16] || n === d[15] || 39 === n || 37 === n ? "x" : "y", n === d[13] || n === d[15] || 38 === n || 37 === n ? -1 : 1], V(t), tt(n) && "stepped" === f.type) return;
                        l(m);
                        break;
                    case "off":
                        s(), (m || c.tweenRunning && f.dir) && l(!0)
                }
            },
            Y = function(t) {
                var o = e(this).data(a).opt,
                    n = [];
                return "function" == typeof t && (t = t()), t instanceof Array ? n = t.length > 1 ? [t[0], t[1]] : "x" === o.axis ? [null, t[0]] : [t[0], null] : (n[0] = t.y ? t.y : t.x || "x" === o.axis ? null : t, n[1] = t.x ? t.x : t.y || "y" === o.axis ? null : t), "function" == typeof n[0] && (n[0] = n[0]()), "function" == typeof n[1] && (n[1] = n[1]()), n
            },
            j = function(t, o) {
                if (null != t && "undefined" != typeof t) {
                    var n = e(this),
                        i = n.data(a),
                        r = i.opt,
                        l = e("#mCSB_" + i.idx + "_container"),
                        s = l.parent(),
                        c = typeof t;
                    o || (o = "x" === r.axis ? "x" : "y");
                    var d = "x" === o ? l.outerWidth(!1) : l.outerHeight(!1),
                        f = "x" === o ? l[0].offsetLeft : l[0].offsetTop,
                        h = "x" === o ? "left" : "top";
                    switch (c) {
                        case "function":
                            return t();
                        case "object":
                            var m = t.jquery ? t : e(t);
                            if (!m.length) return;
                            return "x" === o ? ot(m)[1] : ot(m)[0];
                        case "string":
                        case "number":
                            if (tt(t)) return Math.abs(t);
                            if (-1 !== t.indexOf("%")) return Math.abs(d * parseInt(t) / 100);
                            if (-1 !== t.indexOf("-=")) return Math.abs(f - parseInt(t.split("-=")[1]));
                            if (-1 !== t.indexOf("+=")) {
                                var p = f + parseInt(t.split("+=")[1]);
                                return p >= 0 ? 0 : Math.abs(p)
                            }
                            if (-1 !== t.indexOf("px") && tt(t.split("px")[0])) return Math.abs(t.split("px")[0]);
                            if ("top" === t || "left" === t) return 0;
                            if ("bottom" === t) return Math.abs(s.height() - l.outerHeight(!1));
                            if ("right" === t) return Math.abs(s.width() - l.outerWidth(!1));
                            if ("first" === t || "last" === t) {
                                var m = l.find(":" + t);
                                return "x" === o ? ot(m)[1] : ot(m)[0]
                            }
                            return e(t).length ? "x" === o ? ot(e(t))[1] : ot(e(t))[0] : (l.css(h, t), void u.update.call(null, n[0]))
                    }
                }
            },
            X = function(t) {
                function o() {
                    clearTimeout(h[0].autoUpdate), h[0].autoUpdate = setTimeout(function() {
                        return f.advanced.updateOnSelectorChange && (m = r(), m !== w) ? (l(3), void(w = m)) : (f.advanced.updateOnContentResize && (p = [h.outerHeight(!1), h.outerWidth(!1), v.height(), v.width(), _()[0], _()[1]], (p[0] !== S[0] || p[1] !== S[1] || p[2] !== S[2] || p[3] !== S[3] || p[4] !== S[4] || p[5] !== S[5]) && (l(p[0] !== S[0] || p[1] !== S[1]), S = p)), f.advanced.updateOnImageLoad && (g = n(), g !== b && (h.find("img").each(function() {
                            i(this)
                        }), b = g)), void((f.advanced.updateOnSelectorChange || f.advanced.updateOnContentResize || f.advanced.updateOnImageLoad) && o()))
                    }, 60)
                }

                function n() {
                    var e = 0;
                    return f.advanced.updateOnImageLoad && (e = h.find("img").length), e
                }

                function i(t) {
                    function o(e, t) {
                        return function() {
                            return t.apply(e, arguments)
                        }
                    }

                    function a() {
                        this.onload = null, e(t).addClass(d[2]), l(2)
                    }
                    if (e(t).hasClass(d[2])) return void l();
                    var n = new Image;
                    n.onload = o(n, a), n.src = t.src
                }

                function r() {
                    f.advanced.updateOnSelectorChange === !0 && (f.advanced.updateOnSelectorChange = "*");
                    var t = 0,
                        o = h.find(f.advanced.updateOnSelectorChange);
                    return f.advanced.updateOnSelectorChange && o.length > 0 && o.each(function() {
                        t += e(this).height() + e(this).width()
                    }), t
                }

                function l(e) {
                    clearTimeout(h[0].autoUpdate), u.update.call(null, s[0], e)
                }
                var s = e(this),
                    c = s.data(a),
                    f = c.opt,
                    h = e("#mCSB_" + c.idx + "_container");
                if (t) return clearTimeout(h[0].autoUpdate), void Z(h[0], "autoUpdate");
                var m, p, g, v = h.parent(),
                    x = [e("#mCSB_" + c.idx + "_scrollbar_vertical"), e("#mCSB_" + c.idx + "_scrollbar_horizontal")],
                    _ = function() {
                        return [x[0].is(":visible") ? x[0].outerHeight(!0) : 0, x[1].is(":visible") ? x[1].outerWidth(!0) : 0]
                    },
                    w = r(),
                    S = [h.outerHeight(!1), h.outerWidth(!1), v.height(), v.width(), _()[0], _()[1]],
                    b = n();
                o()
            },
            N = function(e, t, o) {
                return Math.round(e / t) * t - o
            },
            V = function(t) {
                var o = t.data(a),
                    n = e("#mCSB_" + o.idx + "_container,#mCSB_" + o.idx + "_container_wrapper,#mCSB_" + o.idx + "_dragger_vertical,#mCSB_" + o.idx + "_dragger_horizontal");
                n.each(function() {
                    K.call(this)
                })
            },
            Q = function(t, o, n) {
                function i(e) {
                    return s && c.callbacks[e] && "function" == typeof c.callbacks[e]
                }

                function r() {
                    return [c.callbacks.alwaysTriggerOffsets || _ >= w[0] + b, c.callbacks.alwaysTriggerOffsets || -C >= _]
                }

                function l() {
                    var e = [h[0].offsetTop, h[0].offsetLeft],
                        o = [v[0].offsetTop, v[0].offsetLeft],
                        a = [h.outerHeight(!1), h.outerWidth(!1)],
                        i = [f.height(), f.width()];
                    t[0].mcs = {
                        content: h,
                        top: e[0],
                        left: e[1],
                        draggerTop: o[0],
                        draggerLeft: o[1],
                        topPct: Math.round(100 * Math.abs(e[0]) / (Math.abs(a[0]) - i[0])),
                        leftPct: Math.round(100 * Math.abs(e[1]) / (Math.abs(a[1]) - i[1])),
                        direction: n.dir
                    }
                }
                var s = t.data(a),
                    c = s.opt,
                    d = {
                        trigger: "internal",
                        dir: "y",
                        scrollEasing: "mcsEaseOut",
                        drag: !1,
                        dur: c.scrollInertia,
                        overwrite: "all",
                        callbacks: !0,
                        onStart: !0,
                        onUpdate: !0,
                        onComplete: !0
                    },
                    n = e.extend(d, n),
                    u = [n.dur, n.drag ? 0 : n.dur],
                    f = e("#mCSB_" + s.idx),
                    h = e("#mCSB_" + s.idx + "_container"),
                    m = h.parent(),
                    p = c.callbacks.onTotalScrollOffset ? Y.call(t, c.callbacks.onTotalScrollOffset) : [0, 0],
                    g = c.callbacks.onTotalScrollBackOffset ? Y.call(t, c.callbacks.onTotalScrollBackOffset) : [0, 0];
                if (s.trigger = n.trigger, (0 !== m.scrollTop() || 0 !== m.scrollLeft()) && (e(".mCSB_" + s.idx + "_scrollbar").css("visibility", "visible"), m.scrollTop(0).scrollLeft(0)), "_resetY" !== o || s.contentReset.y || (i("onOverflowYNone") && c.callbacks.onOverflowYNone.call(t[0]), s.contentReset.y = 1), "_resetX" !== o || s.contentReset.x || (i("onOverflowXNone") && c.callbacks.onOverflowXNone.call(t[0]), s.contentReset.x = 1), "_resetY" !== o && "_resetX" !== o) {
                    switch (!s.contentReset.y && t[0].mcs || !s.overflowed[0] || (i("onOverflowY") && c.callbacks.onOverflowY.call(t[0]), s.contentReset.x = null), !s.contentReset.x && t[0].mcs || !s.overflowed[1] || (i("onOverflowX") && c.callbacks.onOverflowX.call(t[0]), s.contentReset.x = null), c.snapAmount && (o = N(o, c.snapAmount, c.snapOffset)), n.dir) {
                        case "x":
                            var v = e("#mCSB_" + s.idx + "_dragger_horizontal"),
                                x = "left",
                                _ = h[0].offsetLeft,
                                w = [f.width() - h.outerWidth(!1), v.parent().width() - v.width()],
                                S = [o, 0 === o ? 0 : o / s.scrollRatio.x],
                                b = p[1],
                                C = g[1],
                                B = b > 0 ? b / s.scrollRatio.x : 0,
                                T = C > 0 ? C / s.scrollRatio.x : 0;
                            break;
                        case "y":
                            var v = e("#mCSB_" + s.idx + "_dragger_vertical"),
                                x = "top",
                                _ = h[0].offsetTop,
                                w = [f.height() - h.outerHeight(!1), v.parent().height() - v.height()],
                                S = [o, 0 === o ? 0 : o / s.scrollRatio.y],
                                b = p[0],
                                C = g[0],
                                B = b > 0 ? b / s.scrollRatio.y : 0,
                                T = C > 0 ? C / s.scrollRatio.y : 0
                    }
                    S[1] < 0 || 0 === S[0] && 0 === S[1] ? S = [0, 0] : S[1] >= w[1] ? S = [w[0], w[1]] : S[0] = -S[0], t[0].mcs || (l(), i("onInit") && c.callbacks.onInit.call(t[0])), clearTimeout(h[0].onCompleteTimeout), (s.tweenRunning || !(0 === _ && S[0] >= 0 || _ === w[0] && S[0] <= w[0])) && (G(v[0], x, Math.round(S[1]), u[1], n.scrollEasing), G(h[0], x, Math.round(S[0]), u[0], n.scrollEasing, n.overwrite, {
                        onStart: function() {
                            n.callbacks && n.onStart && !s.tweenRunning && (i("onScrollStart") && (l(), c.callbacks.onScrollStart.call(t[0])), s.tweenRunning = !0, y(v), s.cbOffsets = r())
                        },
                        onUpdate: function() {
                            n.callbacks && n.onUpdate && i("whileScrolling") && (l(), c.callbacks.whileScrolling.call(t[0]))
                        },
                        onComplete: function() {
                            if (n.callbacks && n.onComplete) {
                                "yx" === c.axis && clearTimeout(h[0].onCompleteTimeout);
                                var e = h[0].idleTimer || 0;
                                h[0].onCompleteTimeout = setTimeout(function() {
                                    i("onScroll") && (l(), c.callbacks.onScroll.call(t[0])), i("onTotalScroll") && S[1] >= w[1] - B && s.cbOffsets[0] && (l(), c.callbacks.onTotalScroll.call(t[0])), i("onTotalScrollBack") && S[1] <= T && s.cbOffsets[1] && (l(), c.callbacks.onTotalScrollBack.call(t[0])), s.tweenRunning = !1, h[0].idleTimer = 0, y(v, "hide")
                                }, e)
                            }
                        }
                    }))
                }
            },
            G = function(e, t, o, a, n, i, r) {
                function l() {
                    S.stop || (x || m.call(), x = J() - v, s(), x >= S.time && (S.time = x > S.time ? x + f - (x - S.time) : x + f - 1, S.time < x + 1 && (S.time = x + 1)), S.time < a ? S.id = h(l) : g.call())
                }

                function s() {
                    a > 0 ? (S.currVal = u(S.time, _, b, a, n), w[t] = Math.round(S.currVal) + "px") : w[t] = o + "px", p.call()
                }

                function c() {
                    f = 1e3 / 60, S.time = x + f, h = window.requestAnimationFrame ? window.requestAnimationFrame : function(e) {
                        return s(), setTimeout(e, .01)
                    }, S.id = h(l)
                }

                function d() {
                    null != S.id && (window.requestAnimationFrame ? window.cancelAnimationFrame(S.id) : clearTimeout(S.id), S.id = null)
                }

                function u(e, t, o, a, n) {
                    switch (n) {
                        case "linear":
                        case "mcsLinear":
                            return o * e / a + t;
                        case "mcsLinearOut":
                            return e /= a, e--, o * Math.sqrt(1 - e * e) + t;
                        case "easeInOutSmooth":
                            return e /= a / 2, 1 > e ? o / 2 * e * e + t : (e--, -o / 2 * (e * (e - 2) - 1) + t);
                        case "easeInOutStrong":
                            return e /= a / 2, 1 > e ? o / 2 * Math.pow(2, 10 * (e - 1)) + t : (e--, o / 2 * (-Math.pow(2, -10 * e) + 2) + t);
                        case "easeInOut":
                        case "mcsEaseInOut":
                            return e /= a / 2, 1 > e ? o / 2 * e * e * e + t : (e -= 2, o / 2 * (e * e * e + 2) + t);
                        case "easeOutSmooth":
                            return e /= a, e--, -o * (e * e * e * e - 1) + t;
                        case "easeOutStrong":
                            return o * (-Math.pow(2, -10 * e / a) + 1) + t;
                        case "easeOut":
                        case "mcsEaseOut":
                        default:
                            var i = (e /= a) * e,
                                r = i * e;
                            return t + o * (.499999999999997 * r * i + -2.5 * i * i + 5.5 * r + -6.5 * i + 4 * e)
                    }
                }
                e._mTween || (e._mTween = {
                    top: {},
                    left: {}
                });
                var f, h, r = r || {},
                    m = r.onStart || function() {},
                    p = r.onUpdate || function() {},
                    g = r.onComplete || function() {},
                    v = J(),
                    x = 0,
                    _ = e.offsetTop,
                    w = e.style,
                    S = e._mTween[t];
                "left" === t && (_ = e.offsetLeft);
                var b = o - _;
                S.stop = 0, "none" !== i && d(), c()
            },
            J = function() {
                return window.performance && window.performance.now ? window.performance.now() : window.performance && window.performance.webkitNow ? window.performance.webkitNow() : Date.now ? Date.now() : (new Date).getTime()
            },
            K = function() {
                var e = this;
                e._mTween || (e._mTween = {
                    top: {},
                    left: {}
                });
                for (var t = ["top", "left"], o = 0; o < t.length; o++) {
                    var a = t[o];
                    e._mTween[a].id && (window.requestAnimationFrame ? window.cancelAnimationFrame(e._mTween[a].id) : clearTimeout(e._mTween[a].id), e._mTween[a].id = null, e._mTween[a].stop = 1)
                }
            },
            Z = function(e, t) {
                try {
                    delete e[t]
                } catch (o) {
                    e[t] = null
                }
            },
            $ = function(e) {
                return !(e.which && 1 !== e.which)
            },
            et = function(e) {
                var t = e.originalEvent.pointerType;
                return !(t && "touch" !== t && 2 !== t)
            },
            tt = function(e) {
                return !isNaN(parseFloat(e)) && isFinite(e)
            },
            ot = function(e) {
                var t = e.parents(".mCSB_container");
                return [e.offset().top - t.offset().top, e.offset().left - t.offset().left]
            };
        e.fn[o] = function(t) {
            return u[t] ? u[t].apply(this, Array.prototype.slice.call(arguments, 1)) : "object" != typeof t && t ? void e.error("Method " + t + " does not exist") : u.init.apply(this, arguments)
        }, e[o] = function(t) {
            return u[t] ? u[t].apply(this, Array.prototype.slice.call(arguments, 1)) : "object" != typeof t && t ? void e.error("Method " + t + " does not exist") : u.init.apply(this, arguments)
        }, e[o].defaults = i, window[o] = !0, e(window).load(function() {
            e(n)[o](), e.extend(e.expr[":"], {
                mcsInView: e.expr[":"].mcsInView || function(t) {
                    var o, a, n = e(t),
                        i = n.parents(".mCSB_container");
                    if (i.length) return o = i.parent(), a = [i[0].offsetTop, i[0].offsetLeft], a[0] + ot(n)[0] >= 0 && a[0] + ot(n)[0] < o.height() - n.outerHeight(!1) && a[1] + ot(n)[1] >= 0 && a[1] + ot(n)[1] < o.width() - n.outerWidth(!1)
                },
                mcsOverflow: e.expr[":"].mcsOverflow || function(t) {
                    var o = e(t).data(a);
                    if (o) return o.overflowed[0] || o.overflowed[1]
                }
            })
        })
    })
});
(function(jQuery, undefined) {
    var stepHooks = "backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",
        rplusequals = /^([\-+])=\s*(\d+\.?\d*)/,
        stringParsers = [{
            re: /rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
            parse: function(execResult) {
                return [execResult[1], execResult[2], execResult[3], execResult[4]]
            }
        }, {
            re: /rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
            parse: function(execResult) {
                return [execResult[1] * 2.55, execResult[2] * 2.55, execResult[3] * 2.55, execResult[4]]
            }
        }, {
            re: /#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
            parse: function(execResult) {
                return [parseInt(execResult[1], 16), parseInt(execResult[2], 16), parseInt(execResult[3], 16)]
            }
        }, {
            re: /#([a-f0-9])([a-f0-9])([a-f0-9])/,
            parse: function(execResult) {
                return [parseInt(execResult[1] + execResult[1], 16), parseInt(execResult[2] + execResult[2], 16), parseInt(execResult[3] + execResult[3], 16)]
            }
        }, {
            re: /hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
            space: "hsla",
            parse: function(execResult) {
                return [execResult[1], execResult[2] / 100, execResult[3] / 100, execResult[4]]
            }
        }],
        color = jQuery.Color = function(color, green, blue, alpha) {
            return new jQuery.Color.fn.parse(color, green, blue, alpha)
        },
        spaces = {
            rgba: {
                props: {
                    red: {
                        idx: 0,
                        type: "byte"
                    },
                    green: {
                        idx: 1,
                        type: "byte"
                    },
                    blue: {
                        idx: 2,
                        type: "byte"
                    }
                }
            },
            hsla: {
                props: {
                    hue: {
                        idx: 0,
                        type: "degrees"
                    },
                    saturation: {
                        idx: 1,
                        type: "percent"
                    },
                    lightness: {
                        idx: 2,
                        type: "percent"
                    }
                }
            }
        },
        propTypes = {
            byte: {
                floor: true,
                max: 255
            },
            percent: {
                max: 1
            },
            degrees: {
                mod: 360,
                floor: true
            }
        },
        support = color.support = {},
        supportElem = jQuery("<p>")[0],
        colors, each = jQuery.each;
    supportElem.style.cssText = "background-color:rgba(1,1,1,.5)";
    support.rgba = supportElem.style.backgroundColor.indexOf("rgba") > -1;
    each(spaces, function(spaceName, space) {
        space.cache = "_" + spaceName;
        space.props.alpha = {
            idx: 3,
            type: "percent",
            def: 1
        }
    });

    function clamp(value, prop, allowEmpty) {
        var type = propTypes[prop.type] || {};
        if (value == null) {
            return allowEmpty || !prop.def ? null : prop.def
        }
        value = type.floor ? ~~value : parseFloat(value);
        if (isNaN(value)) {
            return prop.def
        }
        if (type.mod) {
            return (value + type.mod) % type.mod
        }
        return 0 > value ? 0 : type.max < value ? type.max : value
    }

    function stringParse(string) {
        var inst = color(),
            rgba = inst._rgba = [];
        string = string.toLowerCase();
        each(stringParsers, function(i, parser) {
            var parsed, match = parser.re.exec(string),
                values = match && parser.parse(match),
                spaceName = parser.space || "rgba";
            if (values) {
                parsed = inst[spaceName](values);
                inst[spaces[spaceName].cache] = parsed[spaces[spaceName].cache];
                rgba = inst._rgba = parsed._rgba;
                return false
            }
        });
        if (rgba.length) {
            if (rgba.join() === "0,0,0,0") {
                jQuery.extend(rgba, colors.transparent)
            }
            return inst
        }
        return colors[string]
    }
    color.fn = jQuery.extend(color.prototype, {
        parse: function(red, green, blue, alpha) {
            if (red === undefined) {
                this._rgba = [null, null, null, null];
                return this
            }
            if (red.jquery || red.nodeType) {
                red = jQuery(red).css(green);
                green = undefined
            }
            var inst = this,
                type = jQuery.type(red),
                rgba = this._rgba = [];
            if (green !== undefined) {
                red = [red, green, blue, alpha];
                type = "array"
            }
            if (type === "string") {
                return this.parse(stringParse(red) || colors._default)
            }
            if (type === "array") {
                each(spaces.rgba.props, function(key, prop) {
                    rgba[prop.idx] = clamp(red[prop.idx], prop)
                });
                return this
            }
            if (type === "object") {
                if (red instanceof color) {
                    each(spaces, function(spaceName, space) {
                        if (red[space.cache]) {
                            inst[space.cache] = red[space.cache].slice()
                        }
                    })
                } else {
                    each(spaces, function(spaceName, space) {
                        var cache = space.cache;
                        each(space.props, function(key, prop) {
                            if (!inst[cache] && space.to) {
                                if (key === "alpha" || red[key] == null) {
                                    return
                                }
                                inst[cache] = space.to(inst._rgba)
                            }
                            inst[cache][prop.idx] = clamp(red[key], prop, true)
                        });
                        if (inst[cache] && jQuery.inArray(null, inst[cache].slice(0, 3)) < 0) {
                            inst[cache][3] = 1;
                            if (space.from) {
                                inst._rgba = space.from(inst[cache])
                            }
                        }
                    })
                }
                return this
            }
        },
        is: function(compare) {
            var is = color(compare),
                same = true,
                inst = this;
            each(spaces, function(_, space) {
                var localCache, isCache = is[space.cache];
                if (isCache) {
                    localCache = inst[space.cache] || space.to && space.to(inst._rgba) || [];
                    each(space.props, function(_, prop) {
                        if (isCache[prop.idx] != null) {
                            same = isCache[prop.idx] === localCache[prop.idx];
                            return same
                        }
                    })
                }
                return same
            });
            return same
        },
        _space: function() {
            var used = [],
                inst = this;
            each(spaces, function(spaceName, space) {
                if (inst[space.cache]) {
                    used.push(spaceName)
                }
            });
            return used.pop()
        },
        transition: function(other, distance) {
            var end = color(other),
                spaceName = end._space(),
                space = spaces[spaceName],
                startColor = this.alpha() === 0 ? color("transparent") : this,
                start = startColor[space.cache] || space.to(startColor._rgba),
                result = start.slice();
            end = end[space.cache];
            each(space.props, function(key, prop) {
                var index = prop.idx,
                    startValue = start[index],
                    endValue = end[index],
                    type = propTypes[prop.type] || {};
                if (endValue === null) {
                    return
                }
                if (startValue === null) {
                    result[index] = endValue
                } else {
                    if (type.mod) {
                        if (endValue - startValue > type.mod / 2) {
                            startValue += type.mod
                        } else if (startValue - endValue > type.mod / 2) {
                            startValue -= type.mod
                        }
                    }
                    result[index] = clamp((endValue - startValue) * distance + startValue, prop)
                }
            });
            return this[spaceName](result)
        },
        blend: function(opaque) {
            if (this._rgba[3] === 1) {
                return this
            }
            var rgb = this._rgba.slice(),
                a = rgb.pop(),
                blend = color(opaque)._rgba;
            return color(jQuery.map(rgb, function(v, i) {
                return (1 - a) * blend[i] + a * v
            }))
        },
        toRgbaString: function() {
            var prefix = "rgba(",
                rgba = jQuery.map(this._rgba, function(v, i) {
                    return v == null ? i > 2 ? 1 : 0 : v
                });
            if (rgba[3] === 1) {
                rgba.pop();
                prefix = "rgb("
            }
            return prefix + rgba.join() + ")"
        },
        toHslaString: function() {
            var prefix = "hsla(",
                hsla = jQuery.map(this.hsla(), function(v, i) {
                    if (v == null) {
                        v = i > 2 ? 1 : 0
                    }
                    if (i && i < 3) {
                        v = Math.round(v * 100) + "%"
                    }
                    return v
                });
            if (hsla[3] === 1) {
                hsla.pop();
                prefix = "hsl("
            }
            return prefix + hsla.join() + ")"
        },
        toHexString: function(includeAlpha) {
            var rgba = this._rgba.slice(),
                alpha = rgba.pop();
            if (includeAlpha) {
                rgba.push(~~(alpha * 255))
            }
            return "#" + jQuery.map(rgba, function(v) {
                v = (v || 0).toString(16);
                return v.length === 1 ? "0" + v : v
            }).join("")
        },
        toString: function() {
            return this._rgba[3] === 0 ? "transparent" : this.toRgbaString()
        }
    });
    color.fn.parse.prototype = color.fn;

    function hue2rgb(p, q, h) {
        h = (h + 1) % 1;
        if (h * 6 < 1) {
            return p + (q - p) * h * 6
        }
        if (h * 2 < 1) {
            return q
        }
        if (h * 3 < 2) {
            return p + (q - p) * (2 / 3 - h) * 6
        }
        return p
    }
    spaces.hsla.to = function(rgba) {
        if (rgba[0] == null || rgba[1] == null || rgba[2] == null) {
            return [null, null, null, rgba[3]]
        }
        var r = rgba[0] / 255,
            g = rgba[1] / 255,
            b = rgba[2] / 255,
            a = rgba[3],
            max = Math.max(r, g, b),
            min = Math.min(r, g, b),
            diff = max - min,
            add = max + min,
            l = add * .5,
            h, s;
        if (min === max) {
            h = 0
        } else if (r === max) {
            h = 60 * (g - b) / diff + 360
        } else if (g === max) {
            h = 60 * (b - r) / diff + 120
        } else {
            h = 60 * (r - g) / diff + 240
        }
        if (diff === 0) {
            s = 0
        } else if (l <= .5) {
            s = diff / add
        } else {
            s = diff / (2 - add)
        }
        return [Math.round(h) % 360, s, l, a == null ? 1 : a]
    };
    spaces.hsla.from = function(hsla) {
        if (hsla[0] == null || hsla[1] == null || hsla[2] == null) {
            return [null, null, null, hsla[3]]
        }
        var h = hsla[0] / 360,
            s = hsla[1],
            l = hsla[2],
            a = hsla[3],
            q = l <= .5 ? l * (1 + s) : l + s - l * s,
            p = 2 * l - q;
        return [Math.round(hue2rgb(p, q, h + 1 / 3) * 255), Math.round(hue2rgb(p, q, h) * 255), Math.round(hue2rgb(p, q, h - 1 / 3) * 255), a]
    };
    each(spaces, function(spaceName, space) {
        var props = space.props,
            cache = space.cache,
            to = space.to,
            from = space.from;
        color.fn[spaceName] = function(value) {
            if (to && !this[cache]) {
                this[cache] = to(this._rgba)
            }
            if (value === undefined) {
                return this[cache].slice()
            }
            var ret, type = jQuery.type(value),
                arr = type === "array" || type === "object" ? value : arguments,
                local = this[cache].slice();
            each(props, function(key, prop) {
                var val = arr[type === "object" ? key : prop.idx];
                if (val == null) {
                    val = local[prop.idx]
                }
                local[prop.idx] = clamp(val, prop)
            });
            if (from) {
                ret = color(from(local));
                ret[cache] = local;
                return ret
            } else {
                return color(local)
            }
        };
        each(props, function(key, prop) {
            if (color.fn[key]) {
                return
            }
            color.fn[key] = function(value) {
                var vtype = jQuery.type(value),
                    fn = key === "alpha" ? this._hsla ? "hsla" : "rgba" : spaceName,
                    local = this[fn](),
                    cur = local[prop.idx],
                    match;
                if (vtype === "undefined") {
                    return cur
                }
                if (vtype === "function") {
                    value = value.call(this, cur);
                    vtype = jQuery.type(value)
                }
                if (value == null && prop.empty) {
                    return this
                }
                if (vtype === "string") {
                    match = rplusequals.exec(value);
                    if (match) {
                        value = cur + parseFloat(match[2]) * (match[1] === "+" ? 1 : -1)
                    }
                }
                local[prop.idx] = value;
                return this[fn](local)
            }
        })
    });
    color.hook = function(hook) {
        var hooks = hook.split(" ");
        each(hooks, function(i, hook) {
            jQuery.cssHooks[hook] = {
                set: function(elem, value) {
                    var parsed, curElem, backgroundColor = "";
                    if (value !== "transparent" && (jQuery.type(value) !== "string" || (parsed = stringParse(value)))) {
                        value = color(parsed || value);
                        if (!support.rgba && value._rgba[3] !== 1) {
                            curElem = hook === "backgroundColor" ? elem.parentNode : elem;
                            while ((backgroundColor === "" || backgroundColor === "transparent") && curElem && curElem.style) {
                                try {
                                    backgroundColor = jQuery.css(curElem, "backgroundColor");
                                    curElem = curElem.parentNode
                                } catch (e) {}
                            }
                            value = value.blend(backgroundColor && backgroundColor !== "transparent" ? backgroundColor : "_default")
                        }
                        value = value.toRgbaString()
                    }
                    try {
                        elem.style[hook] = value
                    } catch (e) {}
                }
            };
            jQuery.fx.step[hook] = function(fx) {
                if (!fx.colorInit) {
                    fx.start = color(fx.elem, hook);
                    fx.end = color(fx.end);
                    fx.colorInit = true
                }
                jQuery.cssHooks[hook].set(fx.elem, fx.start.transition(fx.end, fx.pos))
            }
        })
    };
    color.hook(stepHooks);
    jQuery.cssHooks.borderColor = {
        expand: function(value) {
            var expanded = {};
            each(["Top", "Right", "Bottom", "Left"], function(i, part) {
                expanded["border" + part + "Color"] = value
            });
            return expanded
        }
    };
    colors = jQuery.Color.names = {
        aqua: "#00ffff",
        black: "#000000",
        blue: "#0000ff",
        fuchsia: "#ff00ff",
        gray: "#808080",
        green: "#008000",
        lime: "#00ff00",
        maroon: "#800000",
        navy: "#000080",
        olive: "#808000",
        purple: "#800080",
        red: "#ff0000",
        silver: "#c0c0c0",
        teal: "#008080",
        white: "#ffffff",
        yellow: "#ffff00",
        transparent: [null, null, null, 0],
        _default: "#ffffff"
    }
})(jQuery);
(function(factory) {
    if (typeof define === "function" && define.amd) {
        define(["jquery"], factory)
    } else if (typeof exports === "object") {
        factory(require("jquery"))
    } else {
        factory(jQuery)
    }
})(function(jQuery) {
    var S2 = function() {
        if (jQuery && jQuery.fn && jQuery.fn.select2 && jQuery.fn.select2.amd) {
            var S2 = jQuery.fn.select2.amd
        }
        var S2;
        (function() {
            if (!S2 || !S2.requirejs) {
                if (!S2) {
                    S2 = {}
                } else {
                    require = S2
                }
                var requirejs, require, define;
                (function(undef) {
                    var main, req, makeMap, handlers, defined = {},
                        waiting = {},
                        config = {},
                        defining = {},
                        hasOwn = Object.prototype.hasOwnProperty,
                        aps = [].slice,
                        jsSuffixRegExp = /\.js$/;

                    function hasProp(obj, prop) {
                        return hasOwn.call(obj, prop)
                    }

                    function normalize(name, baseName) {
                        var nameParts, nameSegment, mapValue, foundMap, lastIndex, foundI, foundStarMap, starI, i, j, part, baseParts = baseName && baseName.split("/"),
                            map = config.map,
                            starMap = map && map["*"] || {};
                        if (name && name.charAt(0) === ".") {
                            if (baseName) {
                                baseParts = baseParts.slice(0, baseParts.length - 1);
                                name = name.split("/");
                                lastIndex = name.length - 1;
                                if (config.nodeIdCompat && jsSuffixRegExp.test(name[lastIndex])) {
                                    name[lastIndex] = name[lastIndex].replace(jsSuffixRegExp, "")
                                }
                                name = baseParts.concat(name);
                                for (i = 0; i < name.length; i += 1) {
                                    part = name[i];
                                    if (part === ".") {
                                        name.splice(i, 1);
                                        i -= 1
                                    } else if (part === "..") {
                                        if (i === 1 && (name[2] === ".." || name[0] === "..")) {
                                            break
                                        } else if (i > 0) {
                                            name.splice(i - 1, 2);
                                            i -= 2
                                        }
                                    }
                                }
                                name = name.join("/")
                            } else if (name.indexOf("./") === 0) {
                                name = name.substring(2)
                            }
                        }
                        if ((baseParts || starMap) && map) {
                            nameParts = name.split("/");
                            for (i = nameParts.length; i > 0; i -= 1) {
                                nameSegment = nameParts.slice(0, i).join("/");
                                if (baseParts) {
                                    for (j = baseParts.length; j > 0; j -= 1) {
                                        mapValue = map[baseParts.slice(0, j).join("/")];
                                        if (mapValue) {
                                            mapValue = mapValue[nameSegment];
                                            if (mapValue) {
                                                foundMap = mapValue;
                                                foundI = i;
                                                break
                                            }
                                        }
                                    }
                                }
                                if (foundMap) {
                                    break
                                }
                                if (!foundStarMap && starMap && starMap[nameSegment]) {
                                    foundStarMap = starMap[nameSegment];
                                    starI = i
                                }
                            }
                            if (!foundMap && foundStarMap) {
                                foundMap = foundStarMap;
                                foundI = starI
                            }
                            if (foundMap) {
                                nameParts.splice(0, foundI, foundMap);
                                name = nameParts.join("/")
                            }
                        }
                        return name
                    }

                    function makeRequire(relName, forceSync) {
                        return function() {
                            return req.apply(undef, aps.call(arguments, 0).concat([relName, forceSync]))
                        }
                    }

                    function makeNormalize(relName) {
                        return function(name) {
                            return normalize(name, relName)
                        }
                    }

                    function makeLoad(depName) {
                        return function(value) {
                            defined[depName] = value
                        }
                    }

                    function callDep(name) {
                        if (hasProp(waiting, name)) {
                            var args = waiting[name];
                            delete waiting[name];
                            defining[name] = true;
                            main.apply(undef, args)
                        }
                        if (!hasProp(defined, name) && !hasProp(defining, name)) {
                            throw new Error("No " + name)
                        }
                        return defined[name]
                    }

                    function splitPrefix(name) {
                        var prefix, index = name ? name.indexOf("!") : -1;
                        if (index > -1) {
                            prefix = name.substring(0, index);
                            name = name.substring(index + 1, name.length)
                        }
                        return [prefix, name]
                    }
                    makeMap = function(name, relName) {
                        var plugin, parts = splitPrefix(name),
                            prefix = parts[0];
                        name = parts[1];
                        if (prefix) {
                            prefix = normalize(prefix, relName);
                            plugin = callDep(prefix)
                        }
                        if (prefix) {
                            if (plugin && plugin.normalize) {
                                name = plugin.normalize(name, makeNormalize(relName))
                            } else {
                                name = normalize(name, relName)
                            }
                        } else {
                            name = normalize(name, relName);
                            parts = splitPrefix(name);
                            prefix = parts[0];
                            name = parts[1];
                            if (prefix) {
                                plugin = callDep(prefix)
                            }
                        }
                        return {
                            f: prefix ? prefix + "!" + name : name,
                            n: name,
                            pr: prefix,
                            p: plugin
                        }
                    };

                    function makeConfig(name) {
                        return function() {
                            return config && config.config && config.config[name] || {}
                        }
                    }
                    handlers = {
                        require: function(name) {
                            return makeRequire(name)
                        },
                        exports: function(name) {
                            var e = defined[name];
                            if (typeof e !== "undefined") {
                                return e
                            } else {
                                return defined[name] = {}
                            }
                        },
                        module: function(name) {
                            return {
                                id: name,
                                uri: "",
                                exports: defined[name],
                                config: makeConfig(name)
                            }
                        }
                    };
                    main = function(name, deps, callback, relName) {
                        var cjsModule, depName, ret, map, i, args = [],
                            callbackType = typeof callback,
                            usingExports;
                        relName = relName || name;
                        if (callbackType === "undefined" || callbackType === "function") {
                            deps = !deps.length && callback.length ? ["require", "exports", "module"] : deps;
                            for (i = 0; i < deps.length; i += 1) {
                                map = makeMap(deps[i], relName);
                                depName = map.f;
                                if (depName === "require") {
                                    args[i] = handlers.require(name)
                                } else if (depName === "exports") {
                                    args[i] = handlers.exports(name);
                                    usingExports = true
                                } else if (depName === "module") {
                                    cjsModule = args[i] = handlers.module(name)
                                } else if (hasProp(defined, depName) || hasProp(waiting, depName) || hasProp(defining, depName)) {
                                    args[i] = callDep(depName)
                                } else if (map.p) {
                                    map.p.load(map.n, makeRequire(relName, true), makeLoad(depName), {});
                                    args[i] = defined[depName]
                                } else {
                                    throw new Error(name + " missing " + depName)
                                }
                            }
                            ret = callback ? callback.apply(defined[name], args) : undefined;
                            if (name) {
                                if (cjsModule && cjsModule.exports !== undef && cjsModule.exports !== defined[name]) {
                                    defined[name] = cjsModule.exports
                                } else if (ret !== undef || !usingExports) {
                                    defined[name] = ret
                                }
                            }
                        } else if (name) {
                            defined[name] = callback
                        }
                    };
                    requirejs = require = req = function(deps, callback, relName, forceSync, alt) {
                        if (typeof deps === "string") {
                            if (handlers[deps]) {
                                return handlers[deps](callback)
                            }
                            return callDep(makeMap(deps, callback).f)
                        } else if (!deps.splice) {
                            config = deps;
                            if (config.deps) {
                                req(config.deps, config.callback)
                            }
                            if (!callback) {
                                return
                            }
                            if (callback.splice) {
                                deps = callback;
                                callback = relName;
                                relName = null
                            } else {
                                deps = undef
                            }
                        }
                        callback = callback || function() {};
                        if (typeof relName === "function") {
                            relName = forceSync;
                            forceSync = alt
                        }
                        if (forceSync) {
                            main(undef, deps, callback, relName)
                        } else {
                            setTimeout(function() {
                                main(undef, deps, callback, relName)
                            }, 4)
                        }
                        return req
                    };
                    req.config = function(cfg) {
                        return req(cfg)
                    };
                    requirejs._defined = defined;
                    define = function(name, deps, callback) {
                        if (!deps.splice) {
                            callback = deps;
                            deps = []
                        }
                        if (!hasProp(defined, name) && !hasProp(waiting, name)) {
                            waiting[name] = [name, deps, callback]
                        }
                    };
                    define.amd = {
                        jQuery: true
                    }
                })();
                S2.requirejs = requirejs;
                S2.require = require;
                S2.define = define
            }
        })();
        S2.define("almond", function() {});
        S2.define("jquery", [], function() {
            var _$ = jQuery || $;
            if (_$ == null && console && console.error) {
                console.error("Select2: An instance of jQuery or a jQuery-compatible library was not " + "found. Make sure that you are including jQuery before Select2 on your " + "web page.")
            }
            return _$
        });
        S2.define("select2/utils", ["jquery"], function($) {
            var Utils = {};
            Utils.Extend = function(ChildClass, SuperClass) {
                var __hasProp = {}.hasOwnProperty;

                function BaseConstructor() {
                    this.constructor = ChildClass
                }
                for (var key in SuperClass) {
                    if (__hasProp.call(SuperClass, key)) {
                        ChildClass[key] = SuperClass[key]
                    }
                }
                BaseConstructor.prototype = SuperClass.prototype;
                ChildClass.prototype = new BaseConstructor;
                ChildClass.__super__ = SuperClass.prototype;
                return ChildClass
            };

            function getMethods(theClass) {
                var proto = theClass.prototype;
                var methods = [];
                for (var methodName in proto) {
                    var m = proto[methodName];
                    if (typeof m !== "function") {
                        continue
                    }
                    if (methodName === "constructor") {
                        continue
                    }
                    methods.push(methodName)
                }
                return methods
            }
            Utils.Decorate = function(SuperClass, DecoratorClass) {
                var decoratedMethods = getMethods(DecoratorClass);
                var superMethods = getMethods(SuperClass);

                function DecoratedClass() {
                    var unshift = Array.prototype.unshift;
                    var argCount = DecoratorClass.prototype.constructor.length;
                    var calledConstructor = SuperClass.prototype.constructor;
                    if (argCount > 0) {
                        unshift.call(arguments, SuperClass.prototype.constructor);
                        calledConstructor = DecoratorClass.prototype.constructor
                    }
                    calledConstructor.apply(this, arguments)
                }
                DecoratorClass.displayName = SuperClass.displayName;

                function ctr() {
                    this.constructor = DecoratedClass
                }
                DecoratedClass.prototype = new ctr;
                for (var m = 0; m < superMethods.length; m++) {
                    var superMethod = superMethods[m];
                    DecoratedClass.prototype[superMethod] = SuperClass.prototype[superMethod]
                }
                var calledMethod = function(methodName) {
                    var originalMethod = function() {};
                    if (methodName in DecoratedClass.prototype) {
                        originalMethod = DecoratedClass.prototype[methodName]
                    }
                    var decoratedMethod = DecoratorClass.prototype[methodName];
                    return function() {
                        var unshift = Array.prototype.unshift;
                        unshift.call(arguments, originalMethod);
                        return decoratedMethod.apply(this, arguments)
                    }
                };
                for (var d = 0; d < decoratedMethods.length; d++) {
                    var decoratedMethod = decoratedMethods[d];
                    DecoratedClass.prototype[decoratedMethod] = calledMethod(decoratedMethod)
                }
                return DecoratedClass
            };
            var Observable = function() {
                this.listeners = {}
            };
            Observable.prototype.on = function(event, callback) {
                this.listeners = this.listeners || {};
                if (event in this.listeners) {
                    this.listeners[event].push(callback)
                } else {
                    this.listeners[event] = [callback]
                }
            };
            Observable.prototype.trigger = function(event) {
                var slice = Array.prototype.slice;
                this.listeners = this.listeners || {};
                if (event in this.listeners) {
                    this.invoke(this.listeners[event], slice.call(arguments, 1))
                }
                if ("*" in this.listeners) {
                    this.invoke(this.listeners["*"], arguments)
                }
            };
            Observable.prototype.invoke = function(listeners, params) {
                for (var i = 0, len = listeners.length; i < len; i++) {
                    listeners[i].apply(this, params)
                }
            };
            Utils.Observable = Observable;
            Utils.generateChars = function(length) {
                var chars = "";
                for (var i = 0; i < length; i++) {
                    var randomChar = Math.floor(Math.random() * 36);
                    chars += randomChar.toString(36)
                }
                return chars
            };
            Utils.bind = function(func, context) {
                return function() {
                    func.apply(context, arguments)
                }
            };
            Utils._convertData = function(data) {
                for (var originalKey in data) {
                    var keys = originalKey.split("-");
                    var dataLevel = data;
                    if (keys.length === 1) {
                        continue
                    }
                    for (var k = 0; k < keys.length; k++) {
                        var key = keys[k];
                        key = key.substring(0, 1).toLowerCase() + key.substring(1);
                        if (!(key in dataLevel)) {
                            dataLevel[key] = {}
                        }
                        if (k == keys.length - 1) {
                            dataLevel[key] = data[originalKey]
                        }
                        dataLevel = dataLevel[key]
                    }
                    delete data[originalKey]
                }
                return data
            };
            Utils.hasScroll = function(index, el) {
                var $el = $(el);
                var overflowX = el.style.overflowX;
                var overflowY = el.style.overflowY;
                if (overflowX === overflowY && (overflowY === "hidden" || overflowY === "visible")) {
                    return false
                }
                if (overflowX === "scroll" || overflowY === "scroll") {
                    return true
                }
                return $el.innerHeight() < el.scrollHeight || $el.innerWidth() < el.scrollWidth
            };
            Utils.escapeMarkup = function(markup) {
                var replaceMap = {
                    "\\": "&#92;",
                    "&": "&amp;",
                    "<": "&lt;",
                    ">": "&gt;",
                    '"': "&quot;",
                    "'": "&#39;",
                    "/": "&#47;"
                };
                if (typeof markup !== "string") {
                    return markup
                }
                return String(markup).replace(/[&<>"'\/\\]/g, function(match) {
                    return replaceMap[match]
                })
            };
            Utils.appendMany = function($element, $nodes) {
                if ($.fn.jquery.substr(0, 3) === "1.7") {
                    var $jqNodes = $();
                    $.map($nodes, function(node) {
                        $jqNodes = $jqNodes.add(node)
                    });
                    $nodes = $jqNodes
                }
                $element.append($nodes)
            };
            return Utils
        });
        S2.define("select2/results", ["jquery", "./utils"], function($, Utils) {
            function Results($element, options, dataAdapter) {
                this.$element = $element;
                this.data = dataAdapter;
                this.options = options;
                Results.__super__.constructor.call(this)
            }
            Utils.Extend(Results, Utils.Observable);
            Results.prototype.render = function() {
                var $results = $('<ul class="select2-results__options" role="tree"></ul>');
                if (this.options.get("multiple")) {
                    $results.attr("aria-multiselectable", "true")
                }
                this.$results = $results;
                return $results
            };
            Results.prototype.clear = function() {
                this.$results.empty()
            };
            Results.prototype.displayMessage = function(params) {
                var escapeMarkup = this.options.get("escapeMarkup");
                this.clear();
                this.hideLoading();
                var $message = $('<li role="treeitem" class="select2-results__option"></li>');
                var message = this.options.get("translations").get(params.message);
                $message.append(escapeMarkup(message(params.args)));
                this.$results.append($message)
            };
            Results.prototype.append = function(data) {
                this.hideLoading();
                var $options = [];
                if (data.results == null || data.results.length === 0) {
                    if (this.$results.children().length === 0) {
                        this.trigger("results:message", {
                            message: "noResults"
                        })
                    }
                    return
                }
                data.results = this.sort(data.results);
                for (var d = 0; d < data.results.length; d++) {
                    var item = data.results[d];
                    var $option = this.option(item);
                    $options.push($option)
                }
                this.$results.append($options)
            };
            Results.prototype.position = function($results, $dropdown) {
                var $resultsContainer = $dropdown.find(".select2-results");
                $resultsContainer.append($results)
            };
            Results.prototype.sort = function(data) {
                var sorter = this.options.get("sorter");
                return sorter(data)
            };
            Results.prototype.setClasses = function() {
                var self = this;
                this.data.current(function(selected) {
                    var selectedIds = $.map(selected, function(s) {
                        return s.id.toString()
                    });
                    var $options = self.$results.find(".select2-results__option[aria-selected]");
                    $options.each(function() {
                        var $option = $(this);
                        var item = $.data(this, "data");
                        var id = "" + item.id;
                        if (item.element != null && item.element.selected || item.element == null && $.inArray(id, selectedIds) > -1) {
                            $option.attr("aria-selected", "true")
                        } else {
                            $option.attr("aria-selected", "false")
                        }
                    });
                    var $selected = $options.filter("[aria-selected=true]");
                    if ($selected.length > 0) {
                        $selected.first().trigger("mouseenter")
                    } else {
                        $options.first().trigger("mouseenter")
                    }
                })
            };
            Results.prototype.showLoading = function(params) {
                this.hideLoading();
                var loadingMore = this.options.get("translations").get("searching");
                var loading = {
                    disabled: true,
                    loading: true,
                    text: loadingMore(params)
                };
                var $loading = this.option(loading);
                $loading.className += " loading-results";
                this.$results.prepend($loading)
            };
            Results.prototype.hideLoading = function() {
                this.$results.find(".loading-results").remove()
            };
            Results.prototype.option = function(data) {
                var option = document.createElement("li");
                option.className = "select2-results__option";
                var attrs = {
                    role: "treeitem",
                    "aria-selected": "false"
                };
                if (data.data) {
                    for (var key in data.data) {
                        if (key != "data") {
                            attrs["data-" + key] = data.data[key]
                        }
                    }
                }
                if (data.disabled) {
                    delete attrs["aria-selected"];
                    attrs["aria-disabled"] = "true"
                }
                if (data.id == null) {
                    delete attrs["aria-selected"]
                }
                if (data._resultId != null) {
                    option.id = data._resultId
                }
                if (data.title) {
                    option.title = data.title
                }
                if (data.children) {
                    attrs.role = "group";
                    attrs["aria-label"] = data.text;
                    delete attrs["aria-selected"]
                }
                for (var attr in attrs) {
                    var val = attrs[attr];
                    option.setAttribute(attr, val)
                }
                if (data.children) {
                    var $option = $(option);
                    var label = document.createElement("strong");
                    label.className = "select2-results__group";
                    var $label = $(label);
                    this.template(data, label);
                    var $children = [];
                    for (var c = 0; c < data.children.length; c++) {
                        var child = data.children[c];
                        var $child = this.option(child);
                        $children.push($child)
                    }
                    var $childrenContainer = $("<ul></ul>", {
                        class: "select2-results__options select2-results__options--nested"
                    });
                    $childrenContainer.append($children);
                    $option.append(label);
                    $option.append($childrenContainer)
                } else {
                    this.template(data, option)
                }
                $.data(option, "data", data);
                return option
            };
            Results.prototype.bind = function(container, $container) {
                var self = this;
                var id = container.id + "-results";
                this.$results.attr("id", id);
                container.on("results:all", function(params) {
                    self.clear();
                    self.append(params.data);
                    if (container.isOpen()) {
                        self.setClasses()
                    }
                });
                container.on("results:append", function(params) {
                    self.append(params.data);
                    if (container.isOpen()) {
                        self.setClasses()
                    }
                });
                container.on("query", function(params) {
                    self.showLoading(params)
                });
                container.on("select", function() {
                    if (!container.isOpen()) {
                        return
                    }
                    self.setClasses()
                });
                container.on("unselect", function() {
                    if (!container.isOpen()) {
                        return
                    }
                    self.setClasses()
                });
                container.on("open", function() {
                    self.$results.attr("aria-expanded", "true");
                    self.$results.attr("aria-hidden", "false");
                    self.setClasses();
                    self.ensureHighlightVisible()
                });
                container.on("close", function() {
                    self.$results.attr("aria-expanded", "false");
                    self.$results.attr("aria-hidden", "true");
                    self.$results.removeAttr("aria-activedescendant")
                });
                container.on("results:toggle", function() {
                    var $highlighted = self.getHighlightedResults();
                    if ($highlighted.length === 0) {
                        return
                    }
                    $highlighted.trigger("mouseup")
                });
                container.on("results:select", function() {
                    var $highlighted = self.getHighlightedResults();
                    if ($highlighted.length === 0) {
                        return
                    }
                    var data = $highlighted.data("data");
                    if ($highlighted.attr("aria-selected") == "true") {
                        self.trigger("close")
                    } else {
                        self.trigger("select", {
                            data: data
                        })
                    }
                });
                container.on("results:previous", function() {
                    var $highlighted = self.getHighlightedResults();
                    var $options = self.$results.find("[aria-selected]");
                    var currentIndex = $options.index($highlighted);
                    if (currentIndex === 0) {
                        return
                    }
                    var nextIndex = currentIndex - 1;
                    if ($highlighted.length === 0) {
                        nextIndex = 0
                    }
                    var $next = $options.eq(nextIndex);
                    $next.trigger("mouseenter");
                    var currentOffset = self.$results.offset().top;
                    var nextTop = $next.offset().top;
                    var nextOffset = self.$results.scrollTop() + (nextTop - currentOffset);
                    if (nextIndex === 0) {
                        self.$results.scrollTop(0)
                    } else if (nextTop - currentOffset < 0) {
                        self.$results.scrollTop(nextOffset)
                    }
                });
                container.on("results:next", function() {
                    var $highlighted = self.getHighlightedResults();
                    var $options = self.$results.find("[aria-selected]");
                    var currentIndex = $options.index($highlighted);
                    var nextIndex = currentIndex + 1;
                    if (nextIndex >= $options.length) {
                        return
                    }
                    var $next = $options.eq(nextIndex);
                    $next.trigger("mouseenter");
                    var currentOffset = self.$results.offset().top + self.$results.outerHeight(false);
                    var nextBottom = $next.offset().top + $next.outerHeight(false);
                    var nextOffset = self.$results.scrollTop() + nextBottom - currentOffset;
                    if (nextIndex === 0) {
                        self.$results.scrollTop(0)
                    } else if (nextBottom > currentOffset) {
                        self.$results.scrollTop(nextOffset)
                    }
                });
                container.on("results:focus", function(params) {
                    params.element.addClass("select2-results__option--highlighted")
                });
                container.on("results:message", function(params) {
                    self.displayMessage(params)
                });
                if ($.fn.mousewheel) {
                    this.$results.on("mousewheel", function(e) {
                        var top = self.$results.scrollTop();
                        var bottom = self.$results.get(0).scrollHeight - self.$results.scrollTop() + e.deltaY;
                        var isAtTop = e.deltaY > 0 && top - e.deltaY <= 0;
                        var isAtBottom = e.deltaY < 0 && bottom <= self.$results.height();
                        if (isAtTop) {
                            self.$results.scrollTop(0);
                            e.preventDefault();
                            e.stopPropagation()
                        } else if (isAtBottom) {
                            self.$results.scrollTop(self.$results.get(0).scrollHeight - self.$results.height());
                            e.preventDefault();
                            e.stopPropagation()
                        }
                    })
                }
                this.$results.on("mouseup", ".select2-results__option[aria-selected]", function(evt) {
                    var $this = $(this);
                    var data = $this.data("data");
                    if ($this.attr("aria-selected") === "true") {
                        if (self.options.get("multiple")) {
                            self.trigger("unselect", {
                                originalEvent: evt,
                                data: data
                            })
                        } else {
                            self.trigger("close")
                        }
                        return
                    }
                    self.trigger("select", {
                        originalEvent: evt,
                        data: data
                    })
                });
                this.$results.on("mouseenter", ".select2-results__option[aria-selected]", function(evt) {
                    var data = $(this).data("data");
                    self.getHighlightedResults().removeClass("select2-results__option--highlighted");
                    self.trigger("results:focus", {
                        data: data,
                        element: $(this)
                    })
                })
            };
            Results.prototype.getHighlightedResults = function() {
                var $highlighted = this.$results.find(".select2-results__option--highlighted");
                return $highlighted
            };
            Results.prototype.destroy = function() {
                this.$results.remove()
            };
            Results.prototype.ensureHighlightVisible = function() {
                var $highlighted = this.getHighlightedResults();
                if ($highlighted.length === 0) {
                    return
                }
                var $options = this.$results.find("[aria-selected]");
                var currentIndex = $options.index($highlighted);
                var currentOffset = this.$results.offset().top;
                var nextTop = $highlighted.offset().top;
                var nextOffset = this.$results.scrollTop() + (nextTop - currentOffset);
                var offsetDelta = nextTop - currentOffset;
                nextOffset -= $highlighted.outerHeight(false) * 2;
                if (currentIndex <= 2) {
                    this.$results.scrollTop(0)
                } else if (offsetDelta > this.$results.outerHeight() || offsetDelta < 0) {
                    this.$results.scrollTop(nextOffset)
                }
            };
            Results.prototype.template = function(result, container) {
                var template = this.options.get("templateResult");
                var escapeMarkup = this.options.get("escapeMarkup");
                var content = template(result);
                if (content == null) {
                    container.style.display = "none"
                } else if (typeof content === "string") {
                    container.innerHTML = escapeMarkup(content)
                } else {
                    $(container).append(content)
                }
            };
            return Results
        });
        S2.define("select2/keys", [], function() {
            var KEYS = {
                BACKSPACE: 8,
                TAB: 9,
                ENTER: 13,
                SHIFT: 16,
                CTRL: 17,
                ALT: 18,
                ESC: 27,
                SPACE: 32,
                PAGE_UP: 33,
                PAGE_DOWN: 34,
                END: 35,
                HOME: 36,
                LEFT: 37,
                UP: 38,
                RIGHT: 39,
                DOWN: 40,
                DELETE: 46
            };
            return KEYS
        });
        S2.define("select2/selection/base", ["jquery", "../utils", "../keys"], function($, Utils, KEYS) {
            function BaseSelection($element, options) {
                this.$element = $element;
                this.options = options;
                BaseSelection.__super__.constructor.call(this)
            }
            Utils.Extend(BaseSelection, Utils.Observable);
            BaseSelection.prototype.render = function() {
                var $selection = $('<span class="select2-selection" role="combobox" ' + 'aria-autocomplete="list" aria-haspopup="true" aria-expanded="false">' + "</span>");
                this._tabindex = 0;
                if (this.$element.data("old-tabindex") != null) {
                    this._tabindex = this.$element.data("old-tabindex")
                } else if (this.$element.attr("tabindex") != null) {
                    this._tabindex = this.$element.attr("tabindex")
                }
                $selection.attr("title", this.$element.attr("title"));
                $selection.attr("tabindex", this._tabindex);
                this.$selection = $selection;
                return $selection
            };
            BaseSelection.prototype.bind = function(container, $container) {
                var self = this;
                var id = container.id + "-container";
                var resultsId = container.id + "-results";
                this.container = container;
                this.$selection.on("focus", function(evt) {
                    self.trigger("focus", evt)
                });
                this.$selection.on("blur", function(evt) {
                    self.trigger("blur", evt)
                });
                this.$selection.on("keydown", function(evt) {
                    self.trigger("keypress", evt);
                    if (evt.which === KEYS.SPACE) {
                        evt.preventDefault()
                    }
                });
                container.on("results:focus", function(params) {
                    self.$selection.attr("aria-activedescendant", params.data._resultId)
                });
                container.on("selection:update", function(params) {
                    self.update(params.data)
                });
                container.on("open", function() {
                    self.$selection.attr("aria-expanded", "true");
                    self.$selection.attr("aria-owns", resultsId);
                    self._attachCloseHandler(container)
                });
                container.on("close", function() {
                    self.$selection.attr("aria-expanded", "false");
                    self.$selection.removeAttr("aria-activedescendant");
                    self.$selection.removeAttr("aria-owns");
                    self.$selection.focus();
                    self._detachCloseHandler(container)
                });
                container.on("enable", function() {
                    self.$selection.attr("tabindex", self._tabindex)
                });
                container.on("disable", function() {
                    self.$selection.attr("tabindex", "-1")
                })
            };
            BaseSelection.prototype._attachCloseHandler = function(container) {
                var self = this;
                $(document.body).on("mousedown.select2." + container.id, function(e) {
                    var $target = $(e.target);
                    var $select = $target.closest(".select2");
                    var $all = $(".select2.select2-container--open");
                    $all.each(function() {
                        var $this = $(this);
                        if (this == $select[0]) {
                            return
                        }
                        var $element = $this.data("element");
                        $element.select2("close")
                    })
                })
            };
            BaseSelection.prototype._detachCloseHandler = function(container) {
                $(document.body).off("mousedown.select2." + container.id)
            };
            BaseSelection.prototype.position = function($selection, $container) {
                var $selectionContainer = $container.find(".selection");
                $selectionContainer.append($selection)
            };
            BaseSelection.prototype.destroy = function() {
                this._detachCloseHandler(this.container)
            };
            BaseSelection.prototype.update = function(data) {
                throw new Error("The `update` method must be defined in child classes.")
            };
            return BaseSelection
        });
        S2.define("select2/selection/single", ["jquery", "./base", "../utils", "../keys"], function($, BaseSelection, Utils, KEYS) {
            function SingleSelection() {
                SingleSelection.__super__.constructor.apply(this, arguments)
            }
            Utils.Extend(SingleSelection, BaseSelection);
            SingleSelection.prototype.render = function() {
                var $selection = SingleSelection.__super__.render.call(this);
                $selection.addClass("select2-selection--single");
                $selection.html('<span class="select2-selection__rendered"></span>' + '<span class="select2-selection__arrow" role="presentation">' + '<b role="presentation"></b>' + "</span>");
                return $selection
            };
            SingleSelection.prototype.bind = function(container, $container) {
                var self = this;
                SingleSelection.__super__.bind.apply(this, arguments);
                var id = container.id + "-container";
                this.$selection.find(".select2-selection__rendered").attr("id", id);
                this.$selection.attr("aria-labelledby", id);
                this.$selection.on("mousedown", function(evt) {
                    if (evt.which !== 1) {
                        return
                    }
                    self.trigger("toggle", {
                        originalEvent: evt
                    })
                });
                this.$selection.on("focus", function(evt) {});
                this.$selection.on("blur", function(evt) {});
                container.on("selection:update", function(params) {
                    self.update(params.data)
                })
            };
            SingleSelection.prototype.clear = function() {
                this.$selection.find(".select2-selection__rendered").empty()
            };
            SingleSelection.prototype.display = function(data) {
                var template = this.options.get("templateSelection");
                var escapeMarkup = this.options.get("escapeMarkup");
                return escapeMarkup(template(data))
            };
            SingleSelection.prototype.selectionContainer = function() {
                return $("<span></span>")
            };
            SingleSelection.prototype.update = function(data) {
                if (data.length === 0) {
                    this.clear();
                    return
                }
                var selection = data[0];
                var formatted = this.display(selection);
                var $rendered = this.$selection.find(".select2-selection__rendered");
                $rendered.empty().append(formatted);
                $rendered.prop("title", selection.title || selection.text)
            };
            return SingleSelection
        });
        S2.define("select2/selection/multiple", ["jquery", "./base", "../utils"], function($, BaseSelection, Utils) {
            function MultipleSelection($element, options) {
                MultipleSelection.__super__.constructor.apply(this, arguments)
            }
            Utils.Extend(MultipleSelection, BaseSelection);
            MultipleSelection.prototype.render = function() {
                var $selection = MultipleSelection.__super__.render.call(this);
                $selection.addClass("select2-selection--multiple");
                $selection.html('<ul class="select2-selection__rendered"></ul>');
                return $selection
            };
            MultipleSelection.prototype.bind = function(container, $container) {
                var self = this;
                MultipleSelection.__super__.bind.apply(this, arguments);
                this.$selection.on("click", function(evt) {
                    self.trigger("toggle", {
                        originalEvent: evt
                    })
                });
                this.$selection.on("click", ".select2-selection__choice__remove", function(evt) {
                    var $remove = $(this);
                    var $selection = $remove.parent();
                    var data = $selection.data("data");
                    self.trigger("unselect", {
                        originalEvent: evt,
                        data: data
                    })
                })
            };
            MultipleSelection.prototype.clear = function() {
                this.$selection.find(".select2-selection__rendered").empty()
            };
            MultipleSelection.prototype.display = function(data) {
                var template = this.options.get("templateSelection");
                var escapeMarkup = this.options.get("escapeMarkup");
                return escapeMarkup(template(data))
            };
            MultipleSelection.prototype.selectionContainer = function() {
                var $container = $('<li class="select2-selection__choice">' + '<span class="select2-selection__choice__remove" role="presentation">' + "&times;" + "</span>" + "</li>");
                return $container
            };
            MultipleSelection.prototype.update = function(data) {
                this.clear();
                if (data.length === 0) {
                    return
                }
                var $selections = [];
                for (var d = 0; d < data.length; d++) {
                    var selection = data[d];
                    var formatted = this.display(selection);
                    var $selection = this.selectionContainer();
                    $selection.append(formatted);
                    $selection.prop("title", selection.title || selection.text);
                    $selection.data("data", selection);
                    $selections.push($selection)
                }
                var $rendered = this.$selection.find(".select2-selection__rendered");
                Utils.appendMany($rendered, $selections)
            };
            return MultipleSelection
        });
        S2.define("select2/selection/placeholder", ["../utils"], function(Utils) {
            function Placeholder(decorated, $element, options) {
                this.placeholder = this.normalizePlaceholder(options.get("placeholder"));
                decorated.call(this, $element, options)
            }
            Placeholder.prototype.normalizePlaceholder = function(_, placeholder) {
                if (typeof placeholder === "string") {
                    placeholder = {
                        id: "",
                        text: placeholder
                    }
                }
                return placeholder
            };
            Placeholder.prototype.createPlaceholder = function(decorated, placeholder) {
                var $placeholder = this.selectionContainer();
                $placeholder.html(this.display(placeholder));
                $placeholder.addClass("select2-selection__placeholder").removeClass("select2-selection__choice");
                return $placeholder
            };
            Placeholder.prototype.update = function(decorated, data) {
                var singlePlaceholder = data.length == 1 && data[0].id != this.placeholder.id;
                var multipleSelections = data.length > 1;
                if (multipleSelections || singlePlaceholder) {
                    return decorated.call(this, data)
                }
                this.clear();
                var $placeholder = this.createPlaceholder(this.placeholder);
                this.$selection.find(".select2-selection__rendered").append($placeholder)
            };
            return Placeholder
        });
        S2.define("select2/selection/allowClear", ["jquery", "../keys"], function($, KEYS) {
            function AllowClear() {}
            AllowClear.prototype.bind = function(decorated, container, $container) {
                var self = this;
                decorated.call(this, container, $container);
                if (this.placeholder == null) {
                    if (this.options.get("debug") && window.console && console.error) {
                        console.error("Select2: The `allowClear` option should be used in combination " + "with the `placeholder` option.")
                    }
                }
                this.$selection.on("mousedown", ".select2-selection__clear", function(evt) {
                    self._handleClear(evt)
                });
                container.on("keypress", function(evt) {
                    self._handleKeyboardClear(evt, container)
                })
            };
            AllowClear.prototype._handleClear = function(_, evt) {
                if (this.options.get("disabled")) {
                    return
                }
                var $clear = this.$selection.find(".select2-selection__clear");
                if ($clear.length === 0) {
                    return
                }
                evt.stopPropagation();
                var data = $clear.data("data");
                for (var d = 0; d < data.length; d++) {
                    var unselectData = {
                        data: data[d]
                    };
                    this.trigger("unselect", unselectData);
                    if (unselectData.prevented) {
                        return
                    }
                }
                this.$element.val(this.placeholder.id).trigger("change");
                this.trigger("toggle")
            };
            AllowClear.prototype._handleKeyboardClear = function(_, evt, container) {
                if (container.isOpen()) {
                    return
                }
                if (evt.which == KEYS.DELETE || evt.which == KEYS.BACKSPACE) {
                    this._handleClear(evt)
                }
            };
            AllowClear.prototype.update = function(decorated, data) {
                decorated.call(this, data);
                if (this.$selection.find(".select2-selection__placeholder").length > 0 || data.length === 0) {
                    return
                }
                var $remove = $('<span class="select2-selection__clear">' + "&times;" + "</span>");
                $remove.data("data", data);
                this.$selection.find(".select2-selection__rendered").prepend($remove)
            };
            return AllowClear
        });
        S2.define("select2/selection/search", ["jquery", "../utils", "../keys"], function($, Utils, KEYS) {
            function Search(decorated, $element, options) {
                decorated.call(this, $element, options)
            }
            Search.prototype.render = function(decorated) {
                var $search = $('<li class="select2-search select2-search--inline">' + '<input class="select2-search__field" type="search" tabindex="-1"' + ' autocomplete="off" autocorrect="off" autocapitalize="off"' + ' spellcheck="false" role="textbox" />' + "</li>");
                this.$searchContainer = $search;
                this.$search = $search.find("input");
                var $rendered = decorated.call(this);
                return $rendered
            };
            Search.prototype.bind = function(decorated, container, $container) {
                var self = this;
                decorated.call(this, container, $container);
                container.on("open", function() {
                    self.$search.attr("tabindex", 0);
                    self.$search.focus()
                });
                container.on("close", function() {
                    self.$search.attr("tabindex", -1);
                    self.$search.val("");
                    self.$search.focus()
                });
                container.on("enable", function() {
                    self.$search.prop("disabled", false)
                });
                container.on("disable", function() {
                    self.$search.prop("disabled", true)
                });
                this.$selection.on("focusin", ".select2-search--inline", function(evt) {
                    self.trigger("focus", evt)
                });
                this.$selection.on("focusout", ".select2-search--inline", function(evt) {
                    self.trigger("blur", evt)
                });
                this.$selection.on("keydown", ".select2-search--inline", function(evt) {
                    evt.stopPropagation();
                    self.trigger("keypress", evt);
                    self._keyUpPrevented = evt.isDefaultPrevented();
                    var key = evt.which;
                    if (key === KEYS.BACKSPACE && self.$search.val() === "") {
                        var $previousChoice = self.$searchContainer.prev(".select2-selection__choice");
                        if ($previousChoice.length > 0) {
                            var item = $previousChoice.data("data");
                            self.searchRemoveChoice(item);
                            evt.preventDefault()
                        }
                    }
                });
                var isIE = function() {
                    var ua = window.navigator.userAgent.toLowerCase();
                    if (ua.indexOf("msie") > 0 || ua.indexOf("trident") > 0) {
                        return true
                    } else {
                        return false
                    }
                }();
                this.$selection.on("input", ".select2-search--inline", function(evt) {
                    self.$selection.off("keyup.search")
                });
                this.$selection.on("keyup.search, paste", ".select2-search--inline", function(evt) {
                    setTimeout(function() {
                        self.handleSearch(evt)
                    }, 10)
                })
            };
            Search.prototype.createPlaceholder = function(decorated, placeholder) {
                this.$search.attr("placeholder", placeholder.text)
            };
            Search.prototype.update = function(decorated, data) {
                this.$search.attr("placeholder", "");
                decorated.call(this, data);
                this.$selection.find(".select2-selection__rendered").append(this.$searchContainer);
                this.resizeSearch()
            };
            Search.prototype.handleSearch = function() {
                this.resizeSearch();
                if (!this._keyUpPrevented) {
                    var input = this.$search.val();
                    this.trigger("query", {
                        term: input
                    })
                }
                this._keyUpPrevented = false
            };
            Search.prototype.searchRemoveChoice = function(decorated, item) {
                this.trigger("unselect", {
                    data: item
                });
                this.trigger("open");
                this.$search.val(item.text + " ")
            };
            Search.prototype.resizeSearch = function() {
                this.$search.css("width", "25px");
                var width = "";
                if (this.$search.attr("placeholder") !== "" && 12 > this.$search.val().length) {
                    if (this.$selection.closest(".container-tags--create").length) {
                        width = 90
                    } else {
                        width = this.$selection.find(".select2-selection__rendered").innerWidth()
                    }
                } else {
                    var minimumWidth = this.$search.val().length + 1;
                    var $shadowDiv = $('<div style="display:none;">');
                    $shadowDiv.text(this.$search.val());
                    $("body").append($shadowDiv);
                    width = $shadowDiv.width();
                    $shadowDiv.remove()
                }
                if (this.$selection.closest(".container-tags--create").length === 0) {
                    width += 20
                }
                this.$search.css("width", width + 10 + "px")
            };
            return Search
        });
        S2.define("select2/selection/eventRelay", ["jquery"], function($) {
            function EventRelay() {}
            EventRelay.prototype.bind = function(decorated, container, $container) {
                var self = this;
                var relayEvents = ["open", "opening", "close", "closing", "select", "selecting", "unselect", "unselecting"];
                var preventableEvents = ["opening", "closing", "selecting", "unselecting"];
                decorated.call(this, container, $container);
                container.on("*", function(name, params) {
                    if ($.inArray(name, relayEvents) === -1) {
                        return
                    }
                    params = params || {};
                    var evt = $.Event("select2:" + name, {
                        params: params
                    });
                    self.$element.trigger(evt);
                    if ($.inArray(name, preventableEvents) === -1) {
                        return
                    }
                    params.prevented = evt.isDefaultPrevented()
                })
            };
            return EventRelay
        });
        S2.define("select2/translation", ["jquery", "require"], function($, require) {
            function Translation(dict) {
                this.dict = dict || {}
            }
            Translation.prototype.all = function() {
                return this.dict
            };
            Translation.prototype.get = function(key) {
                return this.dict[key]
            };
            Translation.prototype.extend = function(translation) {
                this.dict = $.extend({}, translation.all(), this.dict)
            };
            Translation._cache = {};
            Translation.loadPath = function(path) {
                if (!(path in Translation._cache)) {
                    var translations = require(path);
                    Translation._cache[path] = translations
                }
                return new Translation(Translation._cache[path])
            };
            return Translation
        });
        S2.define("select2/diacritics", [], function() {
            var diacritics = {
                "a": "A",
                "i??": "A",
                "A": "A",
                "A?": "A",
                "A": "A",
                "a?": "A",
                "a?": "A",
                "a??": "A",
                "a??": "A",
                "A?": "A",
                "A": "A",
                "A": "A",
                "a?": "A",
                "a?": "A",
                "a??": "A",
                "a??": "A",
                "E": "A",
                "C ": "A",
                "A": "A",
                "Cz": "A",
                "a??": "A",
                "A": "A",
                "C?": "A",
                "C?": "A",
                "E": "A",
                "E": "A",
                "a? ": "A",
                "a?": "A",
                "a?": "A",
                "a?": "A",
                "A": "A",
                "E?": "A",
                "a?": "A",
                "e??": "AA",
                "A": "AE",
                "C?": "AE",
                "C?": "AE",
                "e??": "AO",
                "e?": "AU",
                "e??": "AV",
                "e??": "AV",
                "e??": "AY",
                "a": "B",
                "i??": "B",
                "a?": "B",
                "a?": "B",
                "a?": "B",
                "E?": "B",
                "?": "B",
                "??": "B",
                "a?": "C",
                "i??": "C",
                "A": "C",
                "A?": "C",
                "AS": "C",
                "A?": "C",
                "A": "C",
                "a??": "C",
                "?": "C",
                "E": "C",
                "e??": "C",
                "a?": "D",
                "i?": "D",
                "a?S": "D",
                "AZ": "D",
                "a??": "D",
                "a??": "D",
                "a?": "D",
                "a?Z": "D",
                "A?": "D",
                "?": "D",
                "?S": "D",
                "?": "D",
                "e??": "D",
                "C": "DZ",
                "C": "DZ",
                "C?": "Dz",
                "C": "Dz",
                "a?": "E",
                "i??": "E",
                "A?": "E",
                "A": "E",
                "AS": "E",
                "a": "E",
                "a??": "E",
                "a": "E",
                "a": "E",
                "a??": "E",
                "A": "E",
                "a?": "E",
                "a?": "E",
                "A": "E",
                "A": "E",
                "A": "E",
                "a??": "E",
                "As": "E",
                "E": "E",
                "E": "E",
                "a??": "E",
                "a": "E",
                "E?": "E",
                "a??": "E",
                "A?": "E",
                "a??": "E",
                "a?s": "E",
                "??": "E",
                "?Z": "E",
                "a": "F",
                "i?": "F",
                "a?z": "F",
                "?": "F",
                "e?": "F",
                "a?": "G",
                "i?": "G",
                "C?": "G",
                "A?": "G",
                "a? ": "G",
                "Az": "G",
                "A ": "G",
                "C": "G",
                "A?": "G",
                "C": "G",
                "?": "G",
                "ez ": "G",
                "e??": "G",
                "e??": "G",
                "a?": "H",
                "i??": "H",
                "A": "H",
                "a??": "H",
                "a?": "H",
                "Ez": "H",
                "a?": "H",
                "a??": "H",
                "a??": "H",
                "A": "H",
                "a": "H",
                "a": "H",
                "ez?": "H",
                "a?": "I",
                "i?": "I",
                "A?": "I",
                "A?": "I",
                "AZ": "I",
                "A?": "I",
                "A?": "I",
                "A": "I",
                "A": "I",
                "A?": "I",
                "a?": "I",
                "a?": "I",
                "C?": "I",
                "E?": "I",
                "ES": "I",
                "aS": "I",
                "A": "I",
                "a?": "I",
                "?": "I",
                "a?": "J",
                "i??": "J",
                "A?": "J",
                "E?": "J",
                "a": "K",
                "i?": "K",
                "a?": "K",
                "C?": "K",
                "a??": "K",
                "A": "K",
                "a??": "K",
                "??": "K",
                "a": "K",
                "e?": "K",
                "e?": "K",
                "e?": "K",
                "ez?": "K",
                "a?": "L",
                "i?": "L",
                "A?": "L",
                "A?": "L",
                "A?": "L",
                "a?": "L",
                "a??": "L",
                "A": "L",
                "a??": "L",
                "a??": "L",
                "A?": "L",
                "E?": "L",
                "a?": "L",
                "a ": "L",
                "e??": "L",
                "e?": "L",
                "ez": "L",
                "C": "LJ",
                "C?": "Lj",
                "a": "M",
                "i?": "M",
                "a??": "M",
                "a?": "M",
                "a?": "M",
                "a": "M",
                "??": "M",
                "a?": "N",
                "i?": "N",
                "C?": "N",
                "A?": "N",
                "A": "N",
                "a?": "N",
                "A": "N",
                "a?": "N",
                "A": "N",
                "a?S": "N",
                "a??": "N",
                "E ": "N",
                "??": "N",
                "ez?": "N",
                "ez": "N",
                "CS": "NJ",
                "C": "Nj",
                "a": "O",
                "i??": "O",
                "A": "O",
                "A": "O",
                "A": "O",
                "a": "O",
                "a?": "O",
                "a": "O",
                "a": "O",
                "A": "O",
                "a??": "O",
                "E": "O",
                "a?Z": "O",
                "A?": "O",
                "a??": "O",
                "a?": "O",
                "AZ": "O",
                "E": "O",
                "E": "O",
                "A": "O",
                "E?": "O",
                "aZ": "O",
                "A?": "O",
                "C": "O",
                "E?": "O",
                "EZ": "O",
                "? ": "O",
                "a?": "O",
                "as": "O",
                "a ": "O",
                "az": "O",
                "a?": "O",
                "a?": "O",
                "a?": "O",
                "C?": "O",
                "C": "O",
                "A?": "O",
                "C?": "O",
                "?": "O",
                "?Y": "O",
                "e?S": "O",
                "e??": "O",
                "??": "OI",
                "e?Z": "OO",
                "E?": "OU",
                "a": "P",
                "i?": "P",
                "a?": "P",
                "a?": "P",
                "?": "P",
                "a?": "P",
                "e??": "P",
                "e?": "P",
                "e?": "P",
                "a": "Q",
                "i?": "Q",
                "e?": "Q",
                "e??": "Q",
                "ES": "Q",
                "a": "R",
                "i??": "R",
                "A": "R",
                "a??": "R",
                "A?": "R",
                "E?": "R",
                "E": "R",
                "a?s": "R",
                "a??": "R",
                "A": "R",
                "a?z": "R",
                "E?": "R",
                "a": "R",
                "e?s": "R",
                "ez": "R",
                "ez": "R",
                "a?": "S",
                "i??": "S",
                "a?z": "S",
                "As": "S",
                "a?": "S",
                "A?": "S",
                "a? ": "S",
                "A ": "S",
                "a?": "S",
                "a??": "S",
                "a??": "S",
                "E?": "S",
                "Az": "S",
                "a?": "S",
                "ez?": "S",
                "ez": "S",
                "a": "T",
                "i??": "T",
                "a??": "T",
                "A": "T",
                "a?": "T",
                "Es": "T",
                "A?": "T",
                "a?": "T",
                "a?": "T",
                "A": "T",
                "?": "T",
                "?": "T",
                "E?": "T",
                "ez": "T",
                "e??": "TZ",
                "aS": "U",
                "i?": "U",
                "A": "U",
                "As": "U",
                "A": "U",
                "A?": "U",
                "a??": "U",
                "A?": "U",
                "a??": "U",
                "A": "U",
                "A?": "U",
                "C": "U",
                "C": "U",
                "C": "U",
                "C": "U",
                "a": "U",
                "A": "U",
                "A": "U",
                "C": "U",
                "E": "U",
                "E": "U",
                "??": "U",
                "a?": "U",
                "a?": "U",
                "a": "U",
                "a": "U",
                "a": "U",
                "a": "U",
                "a??": "U",
                "A?": "U",
                "a?": "U",
                "a??": "U",
                "E": "U",
                "a": "V",
                "i?": "V",
                "a??": "V",
                "a??": "V",
                "??": "V",
                "e?z": "V",
                "E": "V",
                "e? ": "VY",
                "a?": "W",
                "i?": "W",
                "a?": "W",
                "a?": "W",
                "A?": "W",
                "a?": "W",
                "a?": "W",
                "a??": "W",
                "a?": "W",
                "a?": "X",
                "i??": "X",
                "a?S": "X",
                "a??": "X",
                "aZ": "Y",
                "i??": "Y",
                "a?": "Y",
                "A?": "Y",
                "A": "Y",
                "a?": "Y",
                "E?": "Y",
                "a?Z": "Y",
                "A?": "Y",
                "a": "Y",
                "a?": "Y",
                "??": "Y",
                "EZ": "Y",
                "a?": "Y",
                "a?": "Z",
                "i??": "Z",
                "A?": "Z",
                "a??": "Z",
                "A": "Z",
                "A?": "Z",
                "a?": "Z",
                "a?": "Z",
                "?": "Z",
                "E": "Z",
                "a?": "Z",
                "a": "Z",
                "e??": "Z",
                "a?": "a",
                "i??": "a",
                "a?s": "a",
                "A ": "a",
                "A?": "a",
                "A?": "a",
                "a?": "a",
                "a??": "a",
                "a?": "a",
                "a?": "a",
                "A?": "a",
                "A?": "a",
                "A?": "a",
                "a?": "a",
                "a??": "a",
                "a?": "a",
                "a??": "a",
                "E": "a",
                "C?": "a",
                "A": "a",
                "CY": "a",
                "a??": "a",
                "A?": "a",
                "C": "a",
                "CZ": "a",
                "E?": "a",
                "E?": "a",
                "a??": "a",
                "a?": "a",
                "a?": "a",
                "a??": "a",
                "A": "a",
                "a?": "a",
                "E?": "a",
                "e??": "aa",
                "A": "ae",
                "C?": "ae",
                "C?": "ae",
                "e?": "ao",
                "e?": "au",
                "e??": "av",
                "e?": "av",
                "e??": "ay",
                "a": "b",
                "i?": "b",
                "a??": "b",
                "a?": "b",
                "a?": "b",
                "?": "b",
                "??": "b",
                "E": "b",
                "a": "c",
                "i??": "c",
                "A": "c",
                "A": "c",
                "A": "c",
                "A?": "c",
                "A": "c",
                "a?": "c",
                "??": "c",
                "E?": "c",
                "e??": "c",
                "a": "c",
                "a": "d",
                "i?": "d",
                "a?": "d",
                "A?": "d",
                "a??": "d",
                "a?": "d",
                "a?": "d",
                "a??": "d",
                "A": "d",
                "??": "d",
                "E": "d",
                "E": "d",
                "e??": "d",
                "C?": "dz",
                "C": "dz",
                "a": "e",
                "i?": "e",
                "A?": "e",
                "A": "e",
                "A?": "e",
                "a?": "e",
                "a??": "e",
                "a": "e",
                "a?": "e",
                "a??": "e",
                "A": "e",
                "a?": "e",
                "a?": "e",
                "A": "e",
                "A": "e",
                "A": "e",
                "a?": "e",
                "A": "e",
                "E": "e",
                "E": "e",
                "a??": "e",
                "a": "e",
                "E": "e",
                "a??": "e",
                "A": "e",
                "a?": "e",
                "a?": "e",
                "E": "e",
                "E": "e",
                "C?": "e",
                "a": "f",
                "i?": "f",
                "a?Y": "f",
                "?": "f",
                "e??": "f",
                "a": "g",
                "i?": "g",
                "C": "g",
                "A?": "g",
                "a??": "g",
                "AY": "g",
                "A?": "g",
                "C": "g",
                "A?": "g",
                "C?": "g",
                "E ": "g",
                "ez?": "g",
                "a?": "g",
                "e??": "g",
                "a": "h",
                "i??": "h",
                "A?": "h",
                "a??": "h",
                "a?": "h",
                "EY": "h",
                "a??": "h",
                "a?": "h",
                "a?": "h",
                "a?": "h",
                "A": "h",
                "a?": "h",
                "a": "h",
                "E?": "h",
                "?": "hv",
                "a?": "i",
                "i?": "i",
                "A": "i",
                "A": "i",
                "A": "i",
                "A": "i",
                "A": "i",
                "A": "i",
                "A?": "i",
                "a??": "i",
                "a": "i",
                "C?": "i",
                "E": "i",
                "E": "i",
                "a": "i",
                "A?": "i",
                "a?": "i",
                "E?": "i",
                "A": "i",
                "a": "j",
                "i?S": "j",
                "A": "j",
                "C": "j",
                "E": "j",
                "as": "k",
                "i?": "k",
                "a?": "k",
                "C": "k",
                "a??": "k",
                "A": "k",
                "a?": "k",
                "?": "k",
                "a?": "k",
                "e??": "k",
                "e??": "k",
                "e?": "k",
                "ez?": "k",
                "a": "l",
                "i??": "l",
                "A": "l",
                "A?": "l",
                "A?": "l",
                "a?": "l",
                "a??": "l",
                "A?": "l",
                "a??": "l",
                "a?": "l",
                "A?": "l",
                "A": "l",
                "?s": "l",
                "E": "l",
                "a?": "l",
                "e?": "l",
                "ez?": "l",
                "e?": "l",
                "C": "lj",
                "a?": "m",
                "i??": "m",
                "a??": "m",
                "a??": "m",
                "a??": "m",
                "E": "m",
                "E?": "m",
                "a?": "n",
                "i?Z": "n",
                "C?": "n",
                "A": "n",
                "A": "n",
                "a?": "n",
                "A?": "n",
                "a?": "n",
                "A": "n",
                "a?": "n",
                "a?": "n",
                "?z": "n",
                "E?": "n",
                "A": "n",
                "ez": "n",
                "ez?": "n",
                "C?": "nj",
                "az": "o",
                "i??": "o",
                "A?": "o",
                "A?": "o",
                "A?": "o",
                "a": "o",
                "a": "o",
                "a": "o",
                "a": "o",
                "A": "o",
                "a??": "o",
                "E": "o",
                "a??": "o",
                "A?": "o",
                "a?": "o",
                "a?": "o",
                "A?": "o",
                "E?": "o",
                "E": "o",
                "A": "o",
                "E": "o",
                "a?": "o",
                "A": "o",
                "C": "o",
                "E?": "o",
                "E?": "o",
                "??": "o",
                "a?": "o",
                "a": "o",
                "a?": "o",
                "aY": "o",
                "a?": "o",
                "a?": "o",
                "a": "o",
                "C": "o",
                "C": "o",
                "A?": "o",
                "C?": "o",
                "E": "o",
                "e?": "o",
                "e??": "o",
                "E": "o",
                "??": "oi",
                "E?": "ou",
                "e??": "oo",
                "aY": "p",
                "i??": "p",
                "a?": "p",
                "a?": "p",
                "??": "p",
                "a?": "p",
                "e?": "p",
                "e?": "p",
                "e?": "p",
                "a ": "q",
                "i?": "q",
                "E": "q",
                "e?": "q",
                "e?": "q",
                "a?": "r",
                "i?": "r",
                "A": "r",
                "a?": "r",
                "A": "r",
                "E": "r",
                "E": "r",
                "a?": "r",
                "a??": "r",
                "A": "r",
                "a?Y": "r",
                "E?": "r",
                "E?": "r",
                "e?": "r",
                "ez": "r",
                "ez?": "r",
                "a?": "s",
                "i?": "s",
                "AY": "s",
                "A": "s",
                "a??": "s",
                "A?": "s",
                "a??": "s",
                "A?": "s",
                "a?": "s",
                "a??": "s",
                "a?": "s",
                "E": "s",
                "AY": "s",
                "E?": "s",
                "ez": "s",
                "ez": "s",
                "a?": "s",
                "a?": "t",
                "i?": "t",
                "a?": "t",
                "a?": "t",
                "A?": "t",
                "a?": "t",
                "E": "t",
                "A?": "t",
                "a?": "t",
                "a??": "t",
                "A": "t",
                "?": "t",
                "E?": "t",
                "a": "t",
                "ez": "t",
                "e?": "tz",
                "a": "u",
                "i?": "u",
                "A?": "u",
                "A?": "u",
                "A": "u",
                "A": "u",
                "a??": "u",
                "A": "u",
                "a?": "u",
                "A": "u",
                "A?": "u",
                "C?": "u",
                "C?": "u",
                "C": "u",
                "Cs": "u",
                "a": "u",
                "A?": "u",
                "A": "u",
                "C": "u",
                "E": "u",
                "E": "u",
                "?": "u",
                "a": "u",
                "a": "u",
                "a?": "u",
                "a": "u",
                "a": "u",
                "a?": "u",
                "a??": "u",
                "A?": "u",
                "a?": "u",
                "a?": "u",
                "E": "u",
                "a?": "v",
                "i?": "v",
                "a??": "v",
                "a??": "v",
                "E": "v",
                "e?Y": "v",
                "E?": "v",
                "e??": "vy",
                "a": "w",
                "i?": "w",
                "a??": "w",
                "a??": "w",
                "A": "w",
                "a?": "w",
                "a?": "w",
                "a??": "w",
                "a?": "w",
                "a?": "w",
                "a": "x",
                "i??": "x",
                "a?": "x",
                "a??": "x",
                "a?": "y",
                "i?": "y",
                "a?": "y",
                "A?": "y",
                "A": "y",
                "a?": "y",
                "E?": "y",
                "a??": "y",
                "A?": "y",
                "a": "y",
                "a?": "y",
                "a": "y",
                "??": "y",
                "E?": "y",
                "a?": "y",
                "a": "z",
                "i?s": "z",
                "A?": "z",
                "a?": "z",
                "A?": "z",
                "A?": "z",
                "a?": "z",
                "a?": "z",
                "?": "z",
                "E?": "z",
                "E": "z",
                "a": "z",
                "e??": "z",
                "I": "I",
                "I?": "I",
                "I": "I",
                "IS": "I",
                "I?": "I",
                "I?": "IY",
                "IZ": "I?",
                "I": "I?",
                "I?": "I",
                "I": "I",
                "I": "I",
                "I": "I",
                "I?": "I?",
                "IS": "I?",
                "I?": "I?",
                "I?": "I?",
                "I?": "I",
                "I": "I",
                "I": "I",
                "I": "I",
                "I": "I?"
            };
            return diacritics
        });
        S2.define("select2/data/base", ["../utils"], function(Utils) {
            function BaseAdapter($element, options) {
                BaseAdapter.__super__.constructor.call(this)
            }
            Utils.Extend(BaseAdapter, Utils.Observable);
            BaseAdapter.prototype.current = function(callback) {
                throw new Error("The `current` method must be defined in child classes.")
            };
            BaseAdapter.prototype.query = function(params, callback) {
                throw new Error("The `query` method must be defined in child classes.")
            };
            BaseAdapter.prototype.bind = function(container, $container) {};
            BaseAdapter.prototype.destroy = function() {};
            BaseAdapter.prototype.generateResultId = function(container, data) {
                var id = container.id + "-result-";
                id += Utils.generateChars(4);
                if (data.id != null) {
                    id += "-" + data.id.toString()
                } else {
                    id += "-" + Utils.generateChars(4)
                }
                return id
            };
            return BaseAdapter
        });
        S2.define("select2/data/select", ["./base", "../utils", "jquery"], function(BaseAdapter, Utils, $) {
            function SelectAdapter($element, options) {
                this.$element = $element;
                this.options = options;
                SelectAdapter.__super__.constructor.call(this)
            }
            Utils.Extend(SelectAdapter, BaseAdapter);
            SelectAdapter.prototype.current = function(callback) {
                var data = [];
                var self = this;
                this.$element.find(":selected").each(function() {
                    var $option = $(this);
                    var option = self.item($option);
                    data.push(option)
                });
                callback(data)
            };
            SelectAdapter.prototype.select = function(data) {
                var self = this;
                data.selected = true;
                if ($(data.element).is("option")) {
                    data.element.selected = true;
                    this.$element.trigger("change");
                    return
                }
                if (this.$element.prop("multiple")) {
                    this.current(function(currentData) {
                        var val = [];
                        data = [data];
                        data.push.apply(data, currentData);
                        for (var d = 0; d < data.length; d++) {
                            var id = data[d].id;
                            if ($.inArray(id, val) === -1) {
                                val.push(id)
                            }
                        }
                        self.$element.val(val);
                        self.$element.trigger("change")
                    })
                } else {
                    var val = data.id;
                    this.$element.val(val);
                    this.$element.trigger("change")
                }
            };
            SelectAdapter.prototype.unselect = function(data) {
                var self = this;
                if (!this.$element.prop("multiple")) {
                    return
                }
                data.selected = false;
                if ($(data.element).is("option")) {
                    data.element.selected = false;
                    this.$element.trigger("change");
                    return
                }
                this.current(function(currentData) {
                    var val = [];
                    for (var d = 0; d < currentData.length; d++) {
                        var id = currentData[d].id;
                        if (id !== data.id && $.inArray(id, val) === -1) {
                            val.push(id)
                        }
                    }
                    self.$element.val(val);
                    self.$element.trigger("change")
                })
            };
            SelectAdapter.prototype.bind = function(container, $container) {
                var self = this;
                this.container = container;
                container.on("select", function(params) {
                    self.select(params.data)
                });
                container.on("unselect", function(params) {
                    self.unselect(params.data)
                })
            };
            SelectAdapter.prototype.destroy = function() {
                this.$element.find("*").each(function() {
                    $.removeData(this, "data")
                })
            };
            SelectAdapter.prototype.query = function(params, callback) {
                var data = [];
                var self = this;
                var $options = this.$element.children();
                $options.each(function() {
                    var $option = $(this);
                    if (!$option.is("option") && !$option.is("optgroup")) {
                        return
                    }
                    var option = self.item($option);
                    var matches = self.matches(params, option);
                    if (matches !== null) {
                        data.push(matches)
                    }
                });
                callback({
                    results: data
                })
            };
            SelectAdapter.prototype.addOptions = function($options) {
                Utils.appendMany(this.$element, $options)
            };
            SelectAdapter.prototype.option = function(data) {
                var option;
                if (data.children) {
                    option = document.createElement("optgroup");
                    option.label = data.text
                } else {
                    option = document.createElement("option");
                    if (option.textContent !== undefined) {
                        option.textContent = data.text
                    } else {
                        option.innerText = data.text
                    }
                }
                if (data.id) {
                    option.value = data.id
                }
                if (data.disabled) {
                    option.disabled = true
                }
                if (data.selected) {
                    option.selected = true
                }
                if (data.title) {
                    option.title = data.title
                }
                var $option = $(option);
                var normalizedData = this._normalizeItem(data);
                normalizedData.element = option;
                $.data(option, "data", normalizedData);
                return $option
            };
            SelectAdapter.prototype.item = function($option) {
                var data = {};
                data = $.data($option[0], "data");
                if (data != null) {
                    return data
                }
                if ($option.is("option")) {
                    data = {
                        id: $option.val(),
                        text: $option.text(),
                        disabled: $option.prop("disabled"),
                        selected: $option.prop("selected"),
                        title: $option.prop("title"),
                        data: $option.data()
                    }
                } else if ($option.is("optgroup")) {
                    data = {
                        text: $option.prop("label"),
                        children: [],
                        title: $option.prop("title")
                    };
                    var $children = $option.children("option");
                    var children = [];
                    for (var c = 0; c < $children.length; c++) {
                        var $child = $($children[c]);
                        var child = this.item($child);
                        children.push(child)
                    }
                    data.children = children
                }
                data = this._normalizeItem(data);
                data.element = $option[0];
                $.data($option[0], "data", data);
                return data
            };
            SelectAdapter.prototype._normalizeItem = function(item) {
                if (!$.isPlainObject(item)) {
                    item = {
                        id: item,
                        text: item
                    }
                }
                item = $.extend({}, {
                    text: ""
                }, item);
                var defaults = {
                    selected: false,
                    disabled: false
                };
                if (item.id != null) {
                    item.id = item.id.toString()
                }
                if (item.text != null) {
                    item.text = item.text.toString()
                }
                if (item._resultId == null && item.id && this.container != null) {
                    item._resultId = this.generateResultId(this.container, item)
                }
                return $.extend({}, defaults, item)
            };
            SelectAdapter.prototype.matches = function(params, data) {
                var matcher = this.options.get("matcher");
                return matcher(params, data)
            };
            return SelectAdapter
        });
        S2.define("select2/data/array", ["./select", "../utils", "jquery"], function(SelectAdapter, Utils, $) {
            function ArrayAdapter($element, options) {
                var data = options.get("data") || [];
                ArrayAdapter.__super__.constructor.call(this, $element, options);
                this.addOptions(this.convertToOptions(data))
            }
            Utils.Extend(ArrayAdapter, SelectAdapter);
            ArrayAdapter.prototype.select = function(data) {
                var $option = this.$element.find("option").filter(function(i, elm) {
                    return elm.value == data.id.toString()
                });
                if ($option.length === 0) {
                    $option = this.option(data);
                    this.addOptions($option)
                }
                ArrayAdapter.__super__.select.call(this, data)
            };
            ArrayAdapter.prototype.convertToOptions = function(data) {
                var self = this;
                var $existing = this.$element.find("option");
                var existingIds = $existing.map(function() {
                    return self.item($(this)).id
                }).get();
                var $options = [];

                function onlyItem(item) {
                    return function() {
                        return $(this).val() == item.id
                    }
                }
                for (var d = 0; d < data.length; d++) {
                    var item = this._normalizeItem(data[d]);
                    if ($.inArray(item.id, existingIds) >= 0) {
                        var $existingOption = $existing.filter(onlyItem(item));
                        var existingData = this.item($existingOption);
                        var newData = $.extend(true, {}, existingData, item);
                        var $newOption = this.option(existingData);
                        $existingOption.replaceWith($newOption);
                        continue
                    }
                    var $option = this.option(item);
                    if (item.children) {
                        var $children = this.convertToOptions(item.children);
                        Utils.appendMany($option, $children)
                    }
                    $options.push($option)
                }
                return $options
            };
            return ArrayAdapter
        });
        S2.define("select2/data/ajax", ["./array", "../utils", "jquery"], function(ArrayAdapter, Utils, $) {
            function AjaxAdapter($element, options) {
                this.ajaxOptions = this._applyDefaults(options.get("ajax"));
                if (this.ajaxOptions.processResults != null) {
                    this.processResults = this.ajaxOptions.processResults
                }
                ArrayAdapter.__super__.constructor.call(this, $element, options)
            }
            Utils.Extend(AjaxAdapter, ArrayAdapter);
            AjaxAdapter.prototype._applyDefaults = function(options) {
                var defaults = {
                    data: function(params) {
                        return {
                            q: params.term
                        }
                    },
                    transport: function(params, success, failure) {
                        var $request = $.ajax(params);
                        $request.then(success);
                        $request.fail(failure);
                        return $request
                    }
                };
                return $.extend({}, defaults, options, true)
            };
            AjaxAdapter.prototype.processResults = function(results) {
                return results
            };
            AjaxAdapter.prototype.query = function(params, callback) {
                var matches = [];
                var self = this;
                if (this._request != null) {
                    if ($.isFunction(this._request.abort)) {
                        this._request.abort()
                    }
                    this._request = null
                }
                var options = $.extend({
                    type: "GET"
                }, this.ajaxOptions);
                if (typeof options.url === "function") {
                    options.url = options.url(params)
                }
                if (typeof options.data === "function") {
                    options.data = options.data(params)
                }

                function request() {
                    var $request = options.transport(options, function(data) {
                        var results = self.processResults(data, params);
                        if (self.options.get("debug") && window.console && console.error) {
                            if (!results || !results.results || !$.isArray(results.results)) {
                                console.error("Select2: The AJAX results did not return an array in the " + "`results` key of the response.")
                            }
                        }
                        callback(results)
                    }, function() {});
                    self._request = $request
                }
                if (this.ajaxOptions.delay && params.term !== "") {
                    if (this._queryTimeout) {
                        window.clearTimeout(this._queryTimeout)
                    }
                    this._queryTimeout = window.setTimeout(request, this.ajaxOptions.delay)
                } else {
                    request()
                }
            };
            return AjaxAdapter
        });
        S2.define("select2/data/tags", ["jquery"], function($) {
            function Tags(decorated, $element, options) {
                var tags = options.get("tags");
                var createTag = options.get("createTag");
                if (createTag !== undefined) {
                    this.createTag = createTag
                }
                decorated.call(this, $element, options);
                if ($.isArray(tags)) {
                    for (var t = 0; t < tags.length; t++) {
                        var tag = tags[t];
                        var item = this._normalizeItem(tag);
                        var $option = this.option(item);
                        this.$element.append($option)
                    }
                }
            }
            Tags.prototype.query = function(decorated, params, callback) {
                var self = this;
                this._removeOldTags();
                if (params.term == null || params.page != null) {
                    decorated.call(this, params, callback);
                    return
                }

                function wrapper(obj, child) {
                    var data = obj.results;
                    for (var i = 0; i < data.length; i++) {
                        var option = data[i];
                        var checkChildren = option.children != null && !wrapper({
                            results: option.children
                        }, true);
                        var checkText = option.text === params.term;
                        if (checkText || checkChildren) {
                            if (child) {
                                return false
                            }
                            obj.data = data;
                            callback(obj);
                            return
                        }
                    }
                    if (child) {
                        return true
                    }
                    var tag = self.createTag(params);
                    if (tag != null) {
                        var $option = self.option(tag);
                        $option.attr("data-select2-tag", true);
                        self.addOptions([$option]);
                        self.insertTag(data, tag)
                    }
                    obj.results = data;
                    callback(obj)
                }
                decorated.call(this, params, wrapper)
            };
            Tags.prototype.createTag = function(decorated, params) {
                var term = $.trim(params.term);
                if (term === "") {
                    return null
                }
                return {
                    id: term,
                    text: term
                }
            };
            Tags.prototype.insertTag = function(_, data, tag) {
                data.unshift(tag)
            };
            Tags.prototype._removeOldTags = function(_) {
                var tag = this._lastTag;
                var $options = this.$element.find("option[data-select2-tag]");
                $options.each(function() {
                    if (this.selected) {
                        return
                    }
                    $(this).remove()
                })
            };
            return Tags
        });
        S2.define("select2/data/tokenizer", ["jquery"], function($) {
            function Tokenizer(decorated, $element, options) {
                var tokenizer = options.get("tokenizer");
                if (tokenizer !== undefined) {
                    this.tokenizer = tokenizer
                }
                decorated.call(this, $element, options)
            }
            Tokenizer.prototype.bind = function(decorated, container, $container) {
                decorated.call(this, container, $container);
                this.$search = container.dropdown.$search || container.selection.$search || $container.find(".select2-search__field")
            };
            Tokenizer.prototype.query = function(decorated, params, callback) {
                var self = this;

                function select(data) {
                    self.select(data)
                }
                params.term = params.term || "";
                var tokenData = this.tokenizer(params, this.options, select);
                if (tokenData.term !== params.term) {
                    if (this.$search.length) {
                        this.$search.val(tokenData.term);
                        this.$search.focus()
                    }
                    params.term = tokenData.term
                }
                decorated.call(this, params, callback)
            };
            Tokenizer.prototype.tokenizer = function(_, params, options, callback) {
                var separators = options.get("tokenSeparators") || [];
                var term = params.term;
                var i = 0;
                var createTag = this.createTag || function(params) {
                    return {
                        id: params.term,
                        text: params.term
                    }
                };
                if (separators.indexOf(term) >= 0) {
                    return {
                        term: ""
                    }
                }
                while (i < term.length) {
                    var termChar = term[i];
                    if ($.inArray(termChar, separators) === -1) {
                        i++;
                        continue
                    }
                    var part = term.substr(0, i);
                    var partParams = $.extend({}, params, {
                        term: part
                    });
                    var data = createTag(partParams);
                    callback(data);
                    term = term.substr(i + 1) || "";
                    i = 0
                }
                return {
                    term: term
                }
            };
            return Tokenizer
        });
        S2.define("select2/data/minimumInputLength", [], function() {
            function MinimumInputLength(decorated, $e, options) {
                this.minimumInputLength = options.get("minimumInputLength");
                decorated.call(this, $e, options)
            }
            MinimumInputLength.prototype.query = function(decorated, params, callback) {
                params.term = params.term || "";
                if (params.term.length < this.minimumInputLength) {
                    this.trigger("results:message", {
                        message: "inputTooShort",
                        args: {
                            minimum: this.minimumInputLength,
                            input: params.term,
                            params: params
                        }
                    });
                    return
                }
                decorated.call(this, params, callback)
            };
            return MinimumInputLength
        });
        S2.define("select2/data/maximumInputLength", [], function() {
            function MaximumInputLength(decorated, $e, options) {
                this.maximumInputLength = options.get("maximumInputLength");
                decorated.call(this, $e, options)
            }
            MaximumInputLength.prototype.query = function(decorated, params, callback) {
                params.term = params.term || "";
                if (this.maximumInputLength > 0 && params.term.length > this.maximumInputLength) {
                    this.trigger("results:message", {
                        message: "inputTooLong",
                        args: {
                            maximum: this.maximumInputLength,
                            input: params.term,
                            params: params
                        }
                    });
                    return
                }
                decorated.call(this, params, callback)
            };
            return MaximumInputLength
        });
        S2.define("select2/data/maximumSelectionLength", [], function() {
            function MaximumSelectionLength(decorated, $e, options) {
                this.maximumSelectionLength = options.get("maximumSelectionLength");
                decorated.call(this, $e, options)
            }
            MaximumSelectionLength.prototype.query = function(decorated, params, callback) {
                var self = this;
                this.current(function(currentData) {
                    var count = currentData != null ? currentData.length : 0;
                    if (self.maximumSelectionLength > 0 && count >= self.maximumSelectionLength) {
                        self.trigger("results:message", {
                            message: "maximumSelected",
                            args: {
                                maximum: self.maximumSelectionLength
                            }
                        });
                        return
                    }
                    decorated.call(self, params, callback)
                })
            };
            return MaximumSelectionLength
        });
        S2.define("select2/dropdown", ["jquery", "./utils"], function($, Utils) {
            function Dropdown($element, options) {
                this.$element = $element;
                this.options = options;
                Dropdown.__super__.constructor.call(this)
            }
            Utils.Extend(Dropdown, Utils.Observable);
            Dropdown.prototype.render = function() {
                var $dropdown = $('<span class="select2-dropdown">' + '<span class="select2-results"></span>' + "</span>");
                $dropdown.attr("dir", this.options.get("dir"));
                this.$dropdown = $dropdown;
                return $dropdown
            };
            Dropdown.prototype.position = function($dropdown, $container) {};
            Dropdown.prototype.destroy = function() {
                this.$dropdown.remove()
            };
            return Dropdown
        });
        S2.define("select2/dropdown/search", ["jquery", "../utils"], function($, Utils) {
            function Search() {}
            Search.prototype.render = function(decorated) {
                var $rendered = decorated.call(this);
                var $search = $('<span class="select2-search select2-search--dropdown">' + '<input class="select2-search__field" type="search" tabindex="-1"' + ' autocomplete="off" autocorrect="off" autocapitalize="off"' + ' spellcheck="false" role="textbox" />' + "</span>");
                this.$searchContainer = $search;
                this.$search = $search.find("input");
                $rendered.prepend($search);
                return $rendered
            };
            Search.prototype.bind = function(decorated, container, $container) {
                var self = this;
                decorated.call(this, container, $container);
                this.$search.on("keydown", function(evt) {
                    self.trigger("keypress", evt);
                    self._keyUpPrevented = evt.isDefaultPrevented()
                });
                this.$search.on("input", function(evt) {
                    $(this).off("keyup")
                });
                this.$search.on("keyup input", function(evt) {
                    self.handleSearch(evt)
                });
                container.on("open", function() {
                    self.$search.attr("tabindex", 0);
                    self.$search.focus();
                    window.setTimeout(function() {
                        self.$search.focus()
                    }, 0)
                });
                container.on("close", function() {
                    self.$search.attr("tabindex", -1);
                    self.$search.val("")
                });
                container.on("results:all", function(params) {
                    if (params.query.term == null || params.query.term === "") {
                        var showSearch = self.showSearch(params);
                        if (showSearch) {
                            self.$searchContainer.removeClass("select2-search--hide")
                        } else {
                            self.$searchContainer.addClass("select2-search--hide")
                        }
                    }
                })
            };
            Search.prototype.handleSearch = function(evt) {
                if (!this._keyUpPrevented) {
                    var input = this.$search.val();
                    this.trigger("query", {
                        term: input
                    })
                }
                this._keyUpPrevented = false
            };
            Search.prototype.showSearch = function(_, params) {
                return true
            };
            return Search
        });
        S2.define("select2/dropdown/hidePlaceholder", [], function() {
            function HidePlaceholder(decorated, $element, options, dataAdapter) {
                this.placeholder = this.normalizePlaceholder(options.get("placeholder"));
                decorated.call(this, $element, options, dataAdapter)
            }
            HidePlaceholder.prototype.append = function(decorated, data) {
                data.results = this.removePlaceholder(data.results);
                decorated.call(this, data)
            };
            HidePlaceholder.prototype.normalizePlaceholder = function(_, placeholder) {
                if (typeof placeholder === "string") {
                    placeholder = {
                        id: "",
                        text: placeholder
                    }
                }
                return placeholder
            };
            HidePlaceholder.prototype.removePlaceholder = function(_, data) {
                var modifiedData = data.slice(0);
                for (var d = data.length - 1; d >= 0; d--) {
                    var item = data[d];
                    if (this.placeholder.id === item.id) {
                        modifiedData.splice(d, 1)
                    }
                }
                return modifiedData
            };
            return HidePlaceholder
        });
        S2.define("select2/dropdown/infiniteScroll", ["jquery"], function($) {
            function InfiniteScroll(decorated, $element, options, dataAdapter) {
                this.lastParams = {};
                decorated.call(this, $element, options, dataAdapter);
                this.$loadingMore = this.createLoadingMore();
                this.loading = false
            }
            InfiniteScroll.prototype.append = function(decorated, data) {
                this.$loadingMore.remove();
                this.loading = false;
                decorated.call(this, data);
                if (this.showLoadingMore(data)) {
                    this.$results.append(this.$loadingMore)
                }
            };
            InfiniteScroll.prototype.bind = function(decorated, container, $container) {
                var self = this;
                decorated.call(this, container, $container);
                container.on("query", function(params) {
                    self.lastParams = params;
                    self.loading = true
                });
                container.on("query:append", function(params) {
                    self.lastParams = params;
                    self.loading = true
                });
                this.$results.on("scroll", function() {
                    var isLoadMoreVisible = $.contains(document.documentElement, self.$loadingMore[0]);
                    if (self.loading || !isLoadMoreVisible) {
                        return
                    }
                    var currentOffset = self.$results.offset().top + self.$results.outerHeight(false);
                    var loadingMoreOffset = self.$loadingMore.offset().top + self.$loadingMore.outerHeight(false);
                    if (currentOffset + 50 >= loadingMoreOffset) {
                        self.loadMore()
                    }
                })
            };
            InfiniteScroll.prototype.loadMore = function() {
                this.loading = true;
                var params = $.extend({}, {
                    page: 1
                }, this.lastParams);
                params.page++;
                this.trigger("query:append", params)
            };
            InfiniteScroll.prototype.showLoadingMore = function(_, data) {
                return data.pagination && data.pagination.more
            };
            InfiniteScroll.prototype.createLoadingMore = function() {
                var $option = $('<li class="option load-more" role="treeitem"></li>');
                var message = this.options.get("translations").get("loadingMore");
                $option.html(message(this.lastParams));
                return $option
            };
            return InfiniteScroll
        });
        S2.define("select2/dropdown/attachBody", ["jquery", "../utils"], function($, Utils) {
            function AttachBody(decorated, $element, options) {
                this.$dropdownParent = options.get("dropdownParent") || document.body;
                decorated.call(this, $element, options)
            }
            AttachBody.prototype.bind = function(decorated, container, $container) {
                var self = this;
                var setupResultsEvents = false;
                decorated.call(this, container, $container);
                container.on("open", function() {
                    self._showDropdown();
                    self._attachPositioningHandler(container);
                    if (!setupResultsEvents) {
                        setupResultsEvents = true;
                        container.on("results:all", function() {
                            self._positionDropdown();
                            self._resizeDropdown()
                        });
                        container.on("results:append", function() {
                            self._positionDropdown();
                            self._resizeDropdown()
                        })
                    }
                });
                container.on("close", function() {
                    self._hideDropdown();
                    self._detachPositioningHandler(container)
                });
                this.$dropdownContainer.on("mousedown", function(evt) {
                    evt.stopPropagation()
                })
            };
            AttachBody.prototype.position = function(decorated, $dropdown, $container) {
                $dropdown.attr("class", $container.attr("class"));
                $dropdown.removeClass("select2");
                $dropdown.addClass("select2-container--open");
                $dropdown.css({
                    position: "absolute",
                    top: -999999
                });
                this.$container = $container
            };
            AttachBody.prototype.render = function(decorated) {
                var $container = $("<span></span>");
                var $dropdown = decorated.call(this);
                $container.append($dropdown);
                this.$dropdownContainer = $container;
                return $container
            };
            AttachBody.prototype._hideDropdown = function(decorated) {
                this.$dropdownContainer.detach()
            };
            AttachBody.prototype._attachPositioningHandler = function(container) {
                var self = this;
                var scrollEvent = "scroll.select2." + container.id;
                var resizeEvent = "resize.select2." + container.id;
                var orientationEvent = "orientationchange.select2." + container.id;
                var $watchers = this.$container.parents().filter(Utils.hasScroll);
                $watchers.each(function() {
                    $(this).data("select2-scroll-position", {
                        x: $(this).scrollLeft(),
                        y: $(this).scrollTop()
                    })
                });
                $watchers.on(scrollEvent, function(ev) {
                    var position = $(this).data("select2-scroll-position");
                    $(this).scrollTop(position.y)
                });
                $(window).on(scrollEvent + " " + resizeEvent + " " + orientationEvent, function(e) {
                    self._positionDropdown();
                    self._resizeDropdown()
                })
            };
            AttachBody.prototype._detachPositioningHandler = function(container) {
                var scrollEvent = "scroll.select2." + container.id;
                var resizeEvent = "resize.select2." + container.id;
                var orientationEvent = "orientationchange.select2." + container.id;
                var $watchers = this.$container.parents().filter(Utils.hasScroll);
                $watchers.off(scrollEvent);
                $(window).off(scrollEvent + " " + resizeEvent + " " + orientationEvent)
            };
            AttachBody.prototype._positionDropdown = function() {
                var $window = $(window);
                var isCurrentlyAbove = this.$dropdown.hasClass("select2-dropdown--above");
                var isCurrentlyBelow = this.$dropdown.hasClass("select2-dropdown--below");
                var newDirection = null;
                var position = this.$container.position();
                var offset = this.$container.offset();
                offset.bottom = offset.top + this.$container.outerHeight(false);
                var container = {
                    height: this.$container.outerHeight(false)
                };
                container.top = offset.top;
                container.bottom = offset.top + container.height;
                var dropdown = {
                    height: this.$dropdown.outerHeight(false)
                };
                var viewport = {
                    top: $window.scrollTop(),
                    bottom: $window.scrollTop() + $window.height()
                };
                var enoughRoomAbove = false;
                var enoughRoomBelow = true;
                var css = {
                    left: offset.left,
                    top: container.bottom
                };
                if (!isCurrentlyAbove && !isCurrentlyBelow) {
                    newDirection = "below"
                }
                if (!enoughRoomBelow && enoughRoomAbove && !isCurrentlyAbove) {
                    newDirection = "above"
                } else if (!enoughRoomAbove && enoughRoomBelow && isCurrentlyAbove) {
                    newDirection = "below"
                }
                if (newDirection == "above" || isCurrentlyAbove && newDirection !== "below") {
                    css.top = container.top - dropdown.height
                }
                if (newDirection != null) {
                    this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--" + newDirection);
                    this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--" + newDirection)
                }
                this.$dropdownContainer.css(css)
            };
            AttachBody.prototype._resizeDropdown = function() {
                this.$dropdownContainer.width();
                var css = {
                    width: this.$container.outerWidth(false) + "px"
                };
                if (this.options.get("dropdownAutoWidth")) {
                    css.minWidth = css.width;
                    css.width = "auto"
                }
                this.$dropdown.css(css)
            };
            AttachBody.prototype._showDropdown = function(decorated) {
                this.$dropdownContainer.appendTo(this.$dropdownParent);
                this._positionDropdown();
                this._resizeDropdown()
            };
            return AttachBody
        });
        S2.define("select2/dropdown/minimumResultsForSearch", [], function() {
            function countResults(data) {
                var count = 0;
                for (var d = 0; d < data.length; d++) {
                    var item = data[d];
                    if (item.children) {
                        count += countResults(item.children)
                    } else {
                        count++
                    }
                }
                return count
            }

            function MinimumResultsForSearch(decorated, $element, options, dataAdapter) {
                this.minimumResultsForSearch = options.get("minimumResultsForSearch");
                if (this.minimumResultsForSearch < 0) {
                    this.minimumResultsForSearch = Infinity
                }
                decorated.call(this, $element, options, dataAdapter)
            }
            MinimumResultsForSearch.prototype.showSearch = function(decorated, params) {
                if (countResults(params.data.results) < this.minimumResultsForSearch) {
                    return false
                }
                return decorated.call(this, params)
            };
            return MinimumResultsForSearch
        });
        S2.define("select2/dropdown/selectOnClose", [], function() {
            function SelectOnClose() {}
            SelectOnClose.prototype.bind = function(decorated, container, $container) {
                var self = this;
                decorated.call(this, container, $container);
                container.on("close", function() {
                    self._handleSelectOnClose()
                })
            };
            SelectOnClose.prototype._handleSelectOnClose = function() {
                var $highlightedResults = this.getHighlightedResults();
                if ($highlightedResults.length < 1) {
                    return
                }
                this.trigger("select", {
                    data: $highlightedResults.data("data")
                })
            };
            return SelectOnClose
        });
        S2.define("select2/dropdown/closeOnSelect", [], function() {
            function CloseOnSelect() {}
            CloseOnSelect.prototype.bind = function(decorated, container, $container) {
                var self = this;
                decorated.call(this, container, $container);
                container.on("select", function(evt) {
                    self._selectTriggered(evt)
                });
                container.on("unselect", function(evt) {
                    self._selectTriggered(evt)
                })
            };
            CloseOnSelect.prototype._selectTriggered = function(_, evt) {
                var originalEvent = evt.originalEvent;
                if (originalEvent && originalEvent.ctrlKey) {
                    return
                }
                this.trigger("close")
            };
            return CloseOnSelect
        });
        S2.define("select2/i18n/en", [], function() {
            return {
                errorLoading: function() {
                    return "The results could not be loaded."
                },
                inputTooLong: function(args) {
                    var overChars = args.input.length - args.maximum;
                    var message = "Please delete " + overChars + " character";
                    if (overChars != 1) {
                        message += "s"
                    }
                    return message
                },
                inputTooShort: function(args) {
                    var remainingChars = args.minimum - args.input.length;
                    var case_1 = "N??????????";
                    if (remainingChars > 1) {
                        case_1 = "N???????????"
                    }
                    var message = "????????N? ?N? " + remainingChars + " " + case_1 + " ???N? ????????? N??N??N?N?N????";
                    return message
                },
                loadingMore: function() {
                    return "Loading more resultsa"
                },
                maximumSelected: function(args) {
                    var message = "You can only select " + args.maximum + " item";
                    if (args.maximum != 1) {
                        message += "s"
                    }
                    return message
                },
                noResults: function() {
                    return "No results found"
                },
                searching: function() {
                    return "Searchinga"
                }
            }
        });
        S2.define("select2/defaults", ["jquery", "require", "./results", "./selection/single", "./selection/multiple", "./selection/placeholder", "./selection/allowClear", "./selection/search", "./selection/eventRelay", "./utils", "./translation", "./diacritics", "./data/select", "./data/array", "./data/ajax", "./data/tags", "./data/tokenizer", "./data/minimumInputLength", "./data/maximumInputLength", "./data/maximumSelectionLength", "./dropdown", "./dropdown/search", "./dropdown/hidePlaceholder", "./dropdown/infiniteScroll", "./dropdown/attachBody", "./dropdown/minimumResultsForSearch", "./dropdown/selectOnClose", "./dropdown/closeOnSelect", "./i18n/en"], function($, require, ResultsList, SingleSelection, MultipleSelection, Placeholder, AllowClear, SelectionSearch, EventRelay, Utils, Translation, DIACRITICS, SelectData, ArrayData, AjaxData, Tags, Tokenizer, MinimumInputLength, MaximumInputLength, MaximumSelectionLength, Dropdown, DropdownSearch, HidePlaceholder, InfiniteScroll, AttachBody, MinimumResultsForSearch, SelectOnClose, CloseOnSelect, EnglishTranslation) {
            function Defaults() {
                this.reset()
            }
            Defaults.prototype.apply = function(options) {
                options = $.extend({}, this.defaults, options);
                if (options.dataAdapter == null) {
                    if (options.ajax != null) {
                        options.dataAdapter = AjaxData
                    } else if (options.data != null) {
                        options.dataAdapter = ArrayData
                    } else {
                        options.dataAdapter = SelectData
                    }
                    if (options.minimumInputLength > 0) {
                        options.dataAdapter = Utils.Decorate(options.dataAdapter, MinimumInputLength)
                    }
                    if (options.maximumInputLength > 0) {
                        options.dataAdapter = Utils.Decorate(options.dataAdapter, MaximumInputLength)
                    }
                    if (options.maximumSelectionLength > 0) {
                        options.dataAdapter = Utils.Decorate(options.dataAdapter, MaximumSelectionLength)
                    }
                    if (options.tags) {
                        options.dataAdapter = Utils.Decorate(options.dataAdapter, Tags)
                    }
                    if (options.tokenSeparators != null || options.tokenizer != null) {
                        options.dataAdapter = Utils.Decorate(options.dataAdapter, Tokenizer)
                    }
                    if (options.query != null) {
                        var Query = require(options.amdBase + "compat/query");
                        options.dataAdapter = Utils.Decorate(options.dataAdapter, Query)
                    }
                    if (options.initSelection != null) {
                        var InitSelection = require(options.amdBase + "compat/initSelection");
                        options.dataAdapter = Utils.Decorate(options.dataAdapter, InitSelection)
                    }
                }
                if (options.resultsAdapter == null) {
                    options.resultsAdapter = ResultsList;
                    if (options.ajax != null) {
                        options.resultsAdapter = Utils.Decorate(options.resultsAdapter, InfiniteScroll)
                    }
                    if (options.placeholder != null) {
                        options.resultsAdapter = Utils.Decorate(options.resultsAdapter, HidePlaceholder)
                    }
                    if (options.selectOnClose) {
                        options.resultsAdapter = Utils.Decorate(options.resultsAdapter, SelectOnClose)
                    }
                }
                if (options.dropdownAdapter == null) {
                    if (options.multiple) {
                        options.dropdownAdapter = Dropdown
                    } else {
                        var SearchableDropdown = Utils.Decorate(Dropdown, DropdownSearch);
                        options.dropdownAdapter = SearchableDropdown
                    }
                    if (options.minimumResultsForSearch !== 0) {
                        options.dropdownAdapter = Utils.Decorate(options.dropdownAdapter, MinimumResultsForSearch)
                    }
                    if (options.closeOnSelect) {
                        options.dropdownAdapter = Utils.Decorate(options.dropdownAdapter, CloseOnSelect)
                    }
                    if (options.dropdownCssClass != null || options.dropdownCss != null || options.adaptDropdownCssClass != null) {
                        var DropdownCSS = require(options.amdBase + "compat/dropdownCss");
                        options.dropdownAdapter = Utils.Decorate(options.dropdownAdapter, DropdownCSS)
                    }
                    options.dropdownAdapter = Utils.Decorate(options.dropdownAdapter, AttachBody)
                }
                if (options.selectionAdapter == null) {
                    if (options.multiple) {
                        options.selectionAdapter = MultipleSelection
                    } else {
                        options.selectionAdapter = SingleSelection
                    }
                    if (options.placeholder != null) {
                        options.selectionAdapter = Utils.Decorate(options.selectionAdapter, Placeholder)
                    }
                    if (options.allowClear) {
                        options.selectionAdapter = Utils.Decorate(options.selectionAdapter, AllowClear)
                    }
                    if (options.multiple) {
                        options.selectionAdapter = Utils.Decorate(options.selectionAdapter, SelectionSearch)
                    }
                    if (options.containerCssClass != null || options.containerCss != null || options.adaptContainerCssClass != null) {
                        var ContainerCSS = require(options.amdBase + "compat/containerCss");
                        options.selectionAdapter = Utils.Decorate(options.selectionAdapter, ContainerCSS)
                    }
                    options.selectionAdapter = Utils.Decorate(options.selectionAdapter, EventRelay)
                }
                if (typeof options.language === "string") {
                    if (options.language.indexOf("-") > 0) {
                        var languageParts = options.language.split("-");
                        var baseLanguage = languageParts[0];
                        options.language = [options.language, baseLanguage]
                    } else {
                        options.language = [options.language]
                    }
                }
                if ($.isArray(options.language)) {
                    var languages = new Translation;
                    options.language.push("en");
                    var languageNames = options.language;
                    for (var l = 0; l < languageNames.length; l++) {
                        var name = languageNames[l];
                        var language = {};
                        try {
                            language = Translation.loadPath(name)
                        } catch (e) {
                            try {
                                name = this.defaults.amdLanguageBase + name;
                                language = Translation.loadPath(name)
                            } catch (ex) {
                                if (options.debug && window.console && console.warn) {
                                    console.warn('Select2: The language file for "' + name + '" could not be ' + "automatically loaded. A fallback will be used instead.")
                                }
                                continue
                            }
                        }
                        languages.extend(language)
                    }
                    options.translations = languages
                } else {
                    var baseTranslation = Translation.loadPath(this.defaults.amdLanguageBase + "en");
                    var customTranslation = new Translation(options.language);
                    customTranslation.extend(baseTranslation);
                    options.translations = customTranslation
                }
                return options
            };
            Defaults.prototype.reset = function() {
                function stripDiacritics(text) {
                    function match(a) {
                        return DIACRITICS[a] || a
                    }
                    return text.replace(/[^\u0000-\u007E]/g, match)
                }

                function matcher(params, data) {
                    if ($.trim(params.term) === "") {
                        return data
                    }
                    if (data.children && data.children.length > 0) {
                        var match = $.extend(true, {}, data);
                        for (var c = data.children.length - 1; c >= 0; c--) {
                            var child = data.children[c];
                            var matches = matcher(params, child);
                            if (matches == null) {
                                match.children.splice(c, 1)
                            }
                        }
                        if (match.children.length > 0) {
                            return match
                        }
                        return matcher(params, match)
                    }
                    var original = stripDiacritics(data.text).toUpperCase();
                    var term = stripDiacritics(params.term).toUpperCase();
                    if (original.indexOf(term) > -1) {
                        return data
                    }
                    return null
                }
                this.defaults = {
                    amdBase: "./",
                    amdLanguageBase: "./i18n/",
                    closeOnSelect: true,
                    debug: false,
                    dropdownAutoWidth: false,
                    escapeMarkup: Utils.escapeMarkup,
                    language: EnglishTranslation,
                    matcher: matcher,
                    minimumInputLength: 0,
                    maximumInputLength: 0,
                    maximumSelectionLength: 0,
                    minimumResultsForSearch: 0,
                    selectOnClose: false,
                    sorter: function(data) {
                        return data
                    },
                    templateResult: function(result) {
                        return result.text
                    },
                    templateSelection: function(selection) {
                        return selection.text
                    },
                    theme: "default",
                    width: "resolve"
                }
            };
            Defaults.prototype.set = function(key, value) {
                var camelKey = $.camelCase(key);
                var data = {};
                data[camelKey] = value;
                var convertedData = Utils._convertData(data);
                $.extend(this.defaults, convertedData)
            };
            var defaults = new Defaults;
            return defaults
        });
        S2.define("select2/options", ["require", "jquery", "./defaults", "./utils"], function(require, $, Defaults, Utils) {
            function Options(options, $element) {
                this.options = options;
                if ($element != null) {
                    this.fromElement($element)
                }
                this.options = Defaults.apply(this.options);
                if ($element && $element.is("input")) {
                    var InputCompat = require(this.get("amdBase") + "compat/inputData");
                    this.options.dataAdapter = Utils.Decorate(this.options.dataAdapter, InputCompat)
                }
            }
            Options.prototype.fromElement = function($e) {
                var excludedData = ["select2"];
                if (this.options.multiple == null) {
                    this.options.multiple = $e.prop("multiple")
                }
                if (this.options.disabled == null) {
                    this.options.disabled = $e.prop("disabled")
                }
                if (this.options.language == null) {
                    if ($e.prop("lang")) {
                        this.options.language = $e.prop("lang").toLowerCase()
                    } else if ($e.closest("[lang]").prop("lang")) {
                        this.options.language = $e.closest("[lang]").prop("lang")
                    }
                }
                if (this.options.dir == null) {
                    if ($e.prop("dir")) {
                        this.options.dir = $e.prop("dir")
                    } else if ($e.closest("[dir]").prop("dir")) {
                        this.options.dir = $e.closest("[dir]").prop("dir")
                    } else {
                        this.options.dir = "ltr"
                    }
                }
                $e.prop("disabled", this.options.disabled);
                $e.prop("multiple", this.options.multiple);
                if ($e.data("select2Tags")) {
                    if (this.options.debug && window.console && console.warn) {
                        console.warn("Select2: The `data-select2-tags` attribute has been changed to " + 'use the `data-data` and `data-tags="true"` attributes and will be ' + "removed in future versions of Select2.")
                    }
                    $e.data("data", $e.data("select2Tags"));
                    $e.data("tags", true)
                }
                if ($e.data("ajaxUrl")) {
                    if (this.options.debug && window.console && console.warn) {
                        console.warn("Select2: The `data-ajax-url` attribute has been changed to " + "`data-ajax--url` and support for the old attribute will be removed" + " in future versions of Select2.")
                    }
                    $e.attr("ajax--url", $e.data("ajaxUrl"));
                    $e.data("ajax--url", $e.data("ajaxUrl"))
                }
                var dataset = {};
                if ($.fn.jquery && $.fn.jquery.substr(0, 2) == "1." && $e[0].dataset) {
                    dataset = $.extend(true, {}, $e[0].dataset, $e.data())
                } else {
                    dataset = $e.data()
                }
                var data = $.extend(true, {}, dataset);
                data = Utils._convertData(data);
                for (var key in data) {
                    if ($.inArray(key, excludedData) > -1) {
                        continue
                    }
                    if ($.isPlainObject(this.options[key])) {
                        $.extend(this.options[key], data[key])
                    } else {
                        this.options[key] = data[key]
                    }
                }
                return this
            };
            Options.prototype.get = function(key) {
                return this.options[key]
            };
            Options.prototype.set = function(key, val) {
                this.options[key] = val
            };
            return Options
        });
        S2.define("select2/core", ["jquery", "./options", "./utils", "./keys"], function($, Options, Utils, KEYS) {
            var Select2 = function($element, options) {
                if ($element.data("select2") != null) {
                    $element.data("select2").destroy()
                }
                this.$element = $element;
                this.id = this._generateId($element);
                options = options || {};
                this.options = new Options(options, $element);
                Select2.__super__.constructor.call(this);
                var tabindex = $element.attr("tabindex") || 0;
                $element.data("old-tabindex", tabindex);
                $element.attr("tabindex", "-1");
                var DataAdapter = this.options.get("dataAdapter");
                this.dataAdapter = new DataAdapter($element, this.options);
                var $container = this.render();
                this._placeContainer($container);
                var SelectionAdapter = this.options.get("selectionAdapter");
                this.selection = new SelectionAdapter($element, this.options);
                this.$selection = this.selection.render();
                this.selection.position(this.$selection, $container);
                var DropdownAdapter = this.options.get("dropdownAdapter");
                this.dropdown = new DropdownAdapter($element, this.options);
                this.$dropdown = this.dropdown.render();
                this.dropdown.position(this.$dropdown, $container);
                var ResultsAdapter = this.options.get("resultsAdapter");
                this.results = new ResultsAdapter($element, this.options, this.dataAdapter);
                this.$results = this.results.render();
                this.results.position(this.$results, this.$dropdown);
                var self = this;
                this._bindAdapters();
                this._registerDomEvents();
                this._registerDataEvents();
                this._registerSelectionEvents();
                this._registerDropdownEvents();
                this._registerResultsEvents();
                this._registerEvents();
                this.dataAdapter.current(function(initialData) {
                    self.trigger("selection:update", {
                        data: initialData
                    })
                });
                $element.addClass("select2-hidden-accessible");
                $element.attr("aria-hidden", "true");
                this._syncAttributes();
                $element.data("select2", this)
            };
            Utils.Extend(Select2, Utils.Observable);
            Select2.prototype._generateId = function($element) {
                var id = "";
                if ($element.attr("id") != null) {
                    id = $element.attr("id")
                } else if ($element.attr("name") != null) {
                    id = $element.attr("name") + "-" + Utils.generateChars(2)
                } else {
                    id = Utils.generateChars(4)
                }
                id = "select2-" + id;
                return id
            };
            Select2.prototype._placeContainer = function($container) {
                $container.insertAfter(this.$element);
                var width = this._resolveWidth(this.$element, this.options.get("width"));
                if (width != null) {
                    $container.css("width", width)
                }
            };
            Select2.prototype._resolveWidth = function($element, method) {
                var WIDTH = /^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;
                if (method == "resolve") {
                    var styleWidth = this._resolveWidth($element, "style");
                    if (styleWidth != null) {
                        return styleWidth
                    }
                    return this._resolveWidth($element, "element")
                }
                if (method == "element") {
                    var elementWidth = $element.outerWidth(false);
                    if (elementWidth <= 0) {
                        return "auto"
                    }
                    return elementWidth + "px"
                }
                if (method == "style") {
                    var style = $element.attr("style");
                    if (typeof style !== "string") {
                        return null
                    }
                    var attrs = style.split(";");
                    for (var i = 0, l = attrs.length; i < l; i = i + 1) {
                        var attr = attrs[i].replace(/\s/g, "");
                        var matches = attr.match(WIDTH);
                        if (matches !== null && matches.length >= 1) {
                            return matches[1]
                        }
                    }
                    return null
                }
                return method
            };
            Select2.prototype._bindAdapters = function() {
                this.dataAdapter.bind(this, this.$container);
                this.selection.bind(this, this.$container);
                this.dropdown.bind(this, this.$container);
                this.results.bind(this, this.$container)
            };
            Select2.prototype._registerDomEvents = function() {
                var self = this;
                this.$element.on("change.select2", function() {
                    self.dataAdapter.current(function(data) {
                        self.trigger("selection:update", {
                            data: data
                        })
                    })
                });
                this._sync = Utils.bind(this._syncAttributes, this);
                if (this.$element[0].attachEvent) {
                    this.$element[0].attachEvent("onpropertychange", this._sync)
                }
                var observer = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
                if (observer != null) {
                    this._observer = new observer(function(mutations) {
                        $.each(mutations, self._sync)
                    });
                    this._observer.observe(this.$element[0], {
                        attributes: true,
                        subtree: false
                    })
                } else if (this.$element[0].addEventListener) {
                    this.$element[0].addEventListener("DOMAttrModified", self._sync, false)
                }
            };
            Select2.prototype._registerDataEvents = function() {
                var self = this;
                this.dataAdapter.on("*", function(name, params) {
                    self.trigger(name, params)
                })
            };
            Select2.prototype._registerSelectionEvents = function() {
                var self = this;
                var nonRelayEvents = ["toggle"];
                this.selection.on("toggle", function() {
                    self.toggleDropdown()
                });
                this.selection.on("*", function(name, params) {
                    if ($.inArray(name, nonRelayEvents) !== -1) {
                        return
                    }
                    self.trigger(name, params)
                })
            };
            Select2.prototype._registerDropdownEvents = function() {
                var self = this;
                this.dropdown.on("*", function(name, params) {
                    self.trigger(name, params)
                })
            };
            Select2.prototype._registerResultsEvents = function() {
                var self = this;
                this.results.on("*", function(name, params) {
                    self.trigger(name, params)
                })
            };
            Select2.prototype._registerEvents = function() {
                var self = this;
                this.on("open", function() {
                    self.$container.addClass("select2-container--open")
                });
                this.on("close", function() {
                    self.$container.removeClass("select2-container--open")
                });
                this.on("enable", function() {
                    self.$container.removeClass("select2-container--disabled")
                });
                this.on("disable", function() {
                    self.$container.addClass("select2-container--disabled")
                });
                this.on("focus", function() {
                    self.$container.addClass("select2-container--focus")
                });
                this.on("blur", function() {
                    self.$container.removeClass("select2-container--focus")
                });
                this.on("query", function(params) {
                    if (!self.isOpen()) {
                        self.trigger("open")
                    }
                    this.dataAdapter.query(params, function(data) {
                        self.trigger("results:all", {
                            data: data,
                            query: params
                        })
                    })
                });
                this.on("query:append", function(params) {
                    this.dataAdapter.query(params, function(data) {
                        self.trigger("results:append", {
                            data: data,
                            query: params
                        })
                    })
                });
                this.on("keypress", function(evt) {
                    var key = evt.which;
                    if (self.isOpen()) {
                        if (key === KEYS.ENTER) {
                            self.trigger("results:select");
                            evt.preventDefault()
                        } else if (key === KEYS.SPACE && evt.ctrlKey) {
                            self.trigger("results:toggle");
                            evt.preventDefault()
                        } else if (key === KEYS.UP) {
                            self.trigger("results:previous");
                            evt.preventDefault()
                        } else if (key === KEYS.DOWN) {
                            self.trigger("results:next");
                            evt.preventDefault()
                        } else if (key === KEYS.ESC || key === KEYS.TAB) {
                            self.close();
                            evt.preventDefault()
                        }
                    } else {
                        if (key === KEYS.ENTER || key === KEYS.SPACE || (key === KEYS.DOWN || key === KEYS.UP) && evt.altKey) {
                            self.open();
                            evt.preventDefault()
                        }
                    }
                })
            };
            Select2.prototype._syncAttributes = function() {
                this.options.set("disabled", this.$element.prop("disabled"));
                if (this.options.get("disabled")) {
                    if (this.isOpen()) {
                        this.close()
                    }
                    this.trigger("disable")
                } else {
                    this.trigger("enable")
                }
            };
            Select2.prototype.trigger = function(name, args) {
                var actualTrigger = Select2.__super__.trigger;
                var preTriggerMap = {
                    open: "opening",
                    close: "closing",
                    select: "selecting",
                    unselect: "unselecting"
                };
                if (name in preTriggerMap) {
                    var preTriggerName = preTriggerMap[name];
                    var preTriggerArgs = {
                        prevented: false,
                        name: name,
                        args: args
                    };
                    actualTrigger.call(this, preTriggerName, preTriggerArgs);
                    if (preTriggerArgs.prevented) {
                        args.prevented = true;
                        return
                    }
                }
                actualTrigger.call(this, name, args)
            };
            Select2.prototype.toggleDropdown = function() {
                if (this.options.get("disabled")) {
                    return
                }
                if (this.isOpen()) {
                    this.close()
                } else {
                    this.open()
                }
            };
            Select2.prototype.open = function() {
                if (this.isOpen()) {
                    return
                }
                this.trigger("query", {});
                this.trigger("open")
            };
            Select2.prototype.close = function() {
                if (!this.isOpen()) {
                    return
                }
                this.trigger("close")
            };
            Select2.prototype.isOpen = function() {
                return this.$container.hasClass("select2-container--open")
            };
            Select2.prototype.enable = function(args) {
                if (this.options.get("debug") && window.console && console.warn) {
                    console.warn('Select2: The `select2("enable")` method has been deprecated and will' + ' be removed in later Select2 versions. Use $element.prop("disabled")' + " instead.")
                }
                if (args == null || args.length === 0) {
                    args = [true]
                }
                var disabled = !args[0];
                this.$element.prop("disabled", disabled)
            };
            Select2.prototype.data = function() {
                if (this.options.get("debug") && arguments.length > 0 && window.console && console.warn) {
                    console.warn('Select2: Data can no longer be set using `select2("data")`. You ' + "should consider setting the value instead using `$element.val()`.")
                }
                var data = [];
                this.dataAdapter.current(function(currentData) {
                    data = currentData
                });
                return data
            };
            Select2.prototype.val = function(args) {
                if (this.options.get("debug") && window.console && console.warn) {
                    console.warn('Select2: The `select2("val")` method has been deprecated and will be' + " removed in later Select2 versions. Use $element.val() instead.")
                }
                if (args == null || args.length === 0) {
                    return this.$element.val()
                }
                var newVal = args[0];
                if ($.isArray(newVal)) {
                    newVal = $.map(newVal, function(obj) {
                        return obj.toString()
                    })
                }
                this.$element.val(newVal).trigger("change")
            };
            Select2.prototype.destroy = function() {
                this.$container.remove();
                if (this.$element[0].detachEvent) {
                    this.$element[0].detachEvent("onpropertychange", this._sync)
                }
                if (this._observer != null) {
                    this._observer.disconnect();
                    this._observer = null
                } else if (this.$element[0].removeEventListener) {
                    this.$element[0].removeEventListener("DOMAttrModified", this._sync, false)
                }
                this._sync = null;
                this.$element.off(".select2");
                this.$element.attr("tabindex", this.$element.data("old-tabindex"));
                this.$element.removeClass("select2-hidden-accessible");
                this.$element.attr("aria-hidden", "false");
                this.$element.removeData("select2");
                this.dataAdapter.destroy();
                this.selection.destroy();
                this.dropdown.destroy();
                this.results.destroy();
                this.dataAdapter = null;
                this.selection = null;
                this.dropdown = null;
                this.results = null
            };
            Select2.prototype.render = function() {
                var $container = $('<span class="select2 select2-container">' + '<span class="selection"></span>' + '<span class="dropdown-wrapper" aria-hidden="true"></span>' + "</span>");
                $container.attr("dir", this.options.get("dir"));
                this.$container = $container;
                this.$container.addClass("select2-container--" + this.options.get("theme"));
                $container.data("element", this.$element);
                return $container
            };
            return Select2
        });
        S2.define("jquery.select2", ["jquery", "require", "./select2/core", "./select2/defaults"], function($, require, Select2, Defaults) {
            require("jquery.mousewheel");
            if ($.fn.select2 == null) {
                var thisMethods = ["open", "close", "destroy"];
                $.fn.select2 = function(options) {
                    options = options || {};
                    if (typeof options === "object") {
                        this.each(function() {
                            var instanceOptions = $.extend({}, options, true);
                            var instance = new Select2($(this), instanceOptions)
                        });
                        return this
                    } else if (typeof options === "string") {
                        var instance = this.data("select2");
                        if (instance == null && window.console && console.error) {
                            console.error("The select2('" + options + "') method was called on an " + "element that is not using Select2.")
                        }
                        var args = Array.prototype.slice.call(arguments, 1);
                        var ret = instance[options](args);
                        if ($.inArray(options, thisMethods) > -1) {
                            return this
                        }
                        return ret
                    } else {
                        throw new Error("Invalid arguments for Select2: " + options)
                    }
                }
            }
            if ($.fn.select2.defaults == null) {
                $.fn.select2.defaults = Defaults
            }
            return Select2
        });
        S2.define("jquery.mousewheel", ["jquery"], function($) {
            return $
        });
        return {
            define: S2.define,
            require: S2.require
        }
    }();
    var select2 = S2.require("jquery.select2");
    jQuery.fn.select2.amd = S2;
    return select2
});
(function($) {
    "use strict";
    var tooltipsStorage = {};
    var tooltipsSettingsStorage = {};
    var tooltipId = 0;
    var tooltipLastShowId = false;
    var tooltipClasses = {
        base: "system-mytooltip--base",
        item: "system-mytooltip--item",
        hover: "system-mytooltip--hover",
        backing: "system-mytooltip--backing",
        help: "mytooltip--cursor-help",
        close: "js-mytooltip-close"
    };
    var directionClasses = {
        top: "mytooltip--top",
        right: "mytooltip--right",
        bottom: "mytooltip--bottom",
        left: "mytooltip--left"
    };
    var eventsNames = {
        showBefore: "show-before",
        showComplete: "show-complete",
        hideBefore: "hide-before",
        hideComplete: "hide-complete"
    };
    $(document).on("mouseleave", "." + tooltipClasses.hover, function() {
        methods.hide()
    });
    $(document).on("click", function(event) {
        var $target = $(event.target);
        if ($target.hasClass(tooltipClasses.base) || $target.closest("." + tooltipClasses.item).length && !$target.hasClass(tooltipClasses.close)) return;
        tooltipLastShowId = false;
        methods.hide()
    });
    if (!String.prototype.trim) {
        (function() {
            String.prototype.trim = function() {
                return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "")
            }
        })()
    }
    var methods = {
        init: function(options) {
            var self = $(this);
            if (self.attr("data-mytooltip-id")) return;
            var id = tooltipId;
            tooltipId++;
            self.attr("data-mytooltip-id", id);
            var userOptions = $.extend(true, {}, options, methods.getAttrOptions(self));
            var currentOptions = $.extend(true, {}, methods.getDefaultOptions(), userOptions);
            if (methods.stringToBoolean(currentOptions.fromTitle)) {
                var selfTitle = self.attr("title");
                currentOptions.content = selfTitle ? selfTitle : currentOptions.content
            } else {
                var html = methods.getHtmlTemplate(currentOptions.content, currentOptions);
                if (html !== false) currentOptions.content = html
            }
            if (currentOptions.content == "") return;
            tooltipsStorage[id] = {
                id: id,
                current: self,
                options: currentOptions
            };
            self.addClass(tooltipClasses.base);
            if (currentOptions.cursorHelp) {
                self.addClass(tooltipClasses.help)
            }
            methods.setEvents(tooltipsStorage[id])
        },
        create: function(data) {
            var id = data.id;
            var options = data.options;
            var current = $(data.current);
            if (!methods.isEmptyObjectProperty(id) || current.hasClass(data.options.ignoreClass) || typeof options.cancelExecution === "function" && options.cancelExecution()) {
                return
            }
            if (tooltipLastShowId === id) {
                methods.hide();
                methods.resetLastShow();
                return
            }
            tooltipLastShowId = id;
            methods.callEvents(data.current, eventsNames.showBefore);
            var direction = directionClasses[options.direction];
            var content = options.content;
            var html = null;
            if (options.dinamicContent) {
                content = current.attr("data-mytooltip-content");
                html = methods.getHtmlTemplate(content, options);
                content = html !== false ? html : content
            }
            var tooltip = $('<div style="display: none;" data-mytooltip-id="' + id + '" class="mytooltip system-mytooltip--' + options.action + " " + tooltipClasses.item + " " + direction + " " + options.customClass + '">' + content + "</div>");
            if (!methods.stringToBoolean(options.showArrow)) {
                tooltip.addClass("mytooltip-noshow-arrow")
            }
            if (options.theme) {
                tooltip.addClass("mytooltip-theme-" + options.theme)
            }
            if (options.hoverTooltip) {
                tooltip.append('<div class="mytooltip-backing ' + tooltipClasses.backing + '">')
            }
            methods.hide(tooltip, options);
            $("body").append(tooltip);
            methods.setPosition(tooltip, data)
        },
        getHtmlTemplate: function(string, options) {
            try {
                var selector = string.trim();
                if ($(selector).length && !~string.indexOf("<")) {
                    return $(selector).html()
                }
                return false
            } catch (err) {
                if (methods.stringToBoolean(options.debug)) {
                    methods.error("Attention! " + err)
                }
                return false
            }
        },
        resetLastShow: function() {
            tooltipLastShowId = false
        },
        stringToBoolean: function(string) {
            if (typeof string === "boolean") return string;
            return string === "true"
        },
        show: function(tooltip, data) {
            var options = data.options;
            var duration = parseInt(options.animateDuration);
            tooltip.fadeIn({
                queue: false,
                duration: duration
            });
            switch (options.direction) {
                case "top":
                    tooltip.animate({
                        top: parseInt(tooltip.css("top")) + options.animateOffsetPx
                    }, duration);
                    break;
                case "right":
                    tooltip.animate({
                        left: parseInt(tooltip.css("left")) - options.animateOffsetPx
                    }, duration);
                    break;
                case "bottom":
                    tooltip.animate({
                        top: parseInt(tooltip.css("top")) - options.animateOffsetPx
                    }, duration);
                    break;
                case "left":
                    tooltip.animate({
                        left: parseInt(tooltip.css("left")) + options.animateOffsetPx
                    }, duration);
                    break;
                default:
                    if (methods.stringToBoolean(options.debug)) {
                        methods.error("Direction: " + options.direction + " not found!")
                    }
                    return false
            }
            setTimeout(function() {
                methods.callEvents(data.current, eventsNames.showComplete);
                if (options.hideTime) {
                    methods.hideTimer(tooltip, options)
                }
            }, options.animateDuration)
        },
        hideTimer: function(tooltip, options) {
            var delay = parseInt(options.hideTime);
            if (!delay || delay < 0) delay = 0;
            setTimeout(function() {
                if (tooltip.is(":visible")) {
                    methods.hide(tooltip, options)
                }
            }, delay)
        },
        hide: function(tooltip, options) {
            var duration;
            var item = $("." + tooltipClasses.item);
            var id = item.data("mytooltip-id");
            if (!methods.isEmptyObjectProperty(id)) return;
            if (options) {
                duration = options.animateDuration
            } else if (id !== undefined) {
                duration = tooltipsStorage[+id].options.animateDuration
            }
            var base = $("." + tooltipClasses.base + "[data-mytooltip-id='" + id + "']");
            methods.callEvents(base, eventsNames.hideBefore);
            item.stop().fadeOut(duration, function() {
                methods.remove(tooltip, id, base)
            })
        },
        remove: function(tooltip, id, base) {
            if (tooltip) {
                $("." + tooltipClasses.item).each(function() {
                    if (tooltip[0] != $(this)[0]) {
                        $(this).remove()
                    }
                })
            } else {
                $("." + tooltipClasses.item).remove()
            }
            if (tooltipsStorage[id].options.disposable) {
                methods.destroy({
                    id: id
                })
            }
            methods.callEvents(base, eventsNames.hideComplete)
        },
        setPosition: function(tooltip, data) {
            var current = $(data.current);
            var position = current.offset();
            var options = data.options;
            var image = tooltip.find("img");
            var animateOffsetPx = options.animateOffsetPx ? parseInt(options.animateOffsetPx) : 0;
            var backing = tooltip.find(".mytooltip-backing");
            var sizeBacking = 0;
            var sizeElement = {
                height: current.outerHeight(),
                width: current.outerWidth()
            };
            var sizeTooltip = {};
            if (image.length > 0) {
                image.load(function() {
                    setSizeTooltip()
                })
            } else {
                setSizeTooltip()
            }

            function setSizeTooltip() {
                sizeTooltip.height = tooltip.outerHeight();
                sizeTooltip.width = tooltip.outerWidth();
                callSwith()
            }

            function callSwith() {
                switch (options.direction) {
                    case "top":
                        tooltip.css({
                            left: position.left + sizeElement.width / 2 - sizeTooltip.width / 2,
                            top: position.top - sizeTooltip.height - options.offset - animateOffsetPx
                        });
                        sizeBacking = position.top - parseInt(tooltip.css("top")) - sizeTooltip.height - animateOffsetPx;
                        backing.css({
                            height: sizeBacking,
                            bottom: -sizeBacking,
                            left: 0
                        });
                        break;
                    case "right":
                        tooltip.css({
                            left: position.left + sizeElement.width + options.offset + animateOffsetPx,
                            top: position.top - sizeTooltip.height / 2 + sizeElement.height / 2
                        });
                        sizeBacking = parseInt(tooltip.css("left")) - position.left - sizeElement.width - animateOffsetPx;
                        backing.css({
                            height: sizeTooltip.height,
                            width: sizeBacking,
                            top: 0,
                            left: -sizeBacking
                        });
                        break;
                    case "bottom":
                        var sizeHeight = sizeElement.height;
                        if (options.border === "top") {
                            sizeHeight = 0
                        }
                        tooltip.css({
                            left: position.left + sizeElement.width / 2 - sizeTooltip.width / 2,
                            top: position.top + sizeHeight + options.offset + animateOffsetPx
                        });
                        sizeBacking = parseInt(tooltip.css("top")) - position.top - sizeElement.height - animateOffsetPx;
                        backing.css({
                            height: sizeBacking,
                            top: -sizeBacking,
                            left: 0
                        });
                        break;
                    case "left":
                        tooltip.css({
                            left: position.left - sizeTooltip.width - options.offset - animateOffsetPx,
                            top: position.top - sizeTooltip.height / 2 + sizeElement.height / 2
                        });
                        sizeBacking = position.left - parseInt(tooltip.css("left")) - sizeTooltip.width - animateOffsetPx;
                        backing.css({
                            height: sizeTooltip.height,
                            width: sizeBacking,
                            top: 0,
                            right: -sizeBacking
                        });
                        break;
                    default:
                        if (methods.stringToBoolean(options.debug)) {
                            methods.error("Direction: " + options.direction + " not found!")
                        }
                        return false
                }
                methods.show(tooltip, data)
            }
        },
        setEvents: function(data) {
            var action = data.options.action;
            var current = data.current;
            var options = data.options;
            switch (action) {
                case "click":
                    current.on(action, function(event) {
                        if (!methods.isEmptyObjectProperty(data.id)) return;
                        event.preventDefault();
                        methods.create(data)
                    });
                    break;
                case "hover":
                case "focus":
                    if (!methods.isEmptyObjectProperty(data.id)) return;
                    var actionGet;
                    var actionLose;
                    if (action === "hover") {
                        actionGet = "mouseenter";
                        actionLose = "mouseleave"
                    } else if (action === "focus") {
                        actionGet = "focus";
                        actionLose = "blur"
                    }
                    current.on(actionGet, function(event) {
                        if (!$(event.relatedTarget).is("." + tooltipClasses.item + "," + "." + tooltipClasses.backing)) {
                            methods.create(data)
                        }
                    });
                    current.on(actionLose, function(event) {
                        methods.resetLastShow();
                        if (!options.hoverTooltip || !methods.stringToBoolean(options.hoverTooltip)) {
                            methods.hide()
                        } else if (!$(event.relatedTarget).is("." + tooltipClasses.item + "," + "." + tooltipClasses.backing)) {
                            methods.hide()
                        }
                    });
                    break;
                default:
                    if (methods.stringToBoolean(options.debug)) {
                        methods.error("Action: " + options.action + " not found!")
                    }
                    return false
            }
        },
        getAttrOptions: function(current) {
            var defaultOptions = this.getDefaultOptions();
            var dataOptions = {};
            for (var option in defaultOptions) {
                var symbolArray = option.split("");
                var currentAttrName = "";
                symbolArray.forEach(function(item) {
                    var itemToLowerCase = item.toLocaleLowerCase();
                    if (item !== itemToLowerCase) {
                        currentAttrName += "-"
                    }
                    currentAttrName += itemToLowerCase
                });
                var dataAttrValue = $(current).attr("data-mytooltip-" + currentAttrName);
                if (dataAttrValue !== undefined) {
                    dataOptions[option] = dataAttrValue
                }
            }
            return dataOptions
        },
        getDefaultOptions: function() {
            return {
                direction: "top",
                offset: 10,
                border: "bottom",
                customClass: "",
                content: "",
                dinamicContent: false,
                action: "hover",
                theme: "default",
                ignoreClass: "js-mytooltip-ignore",
                showArrow: true,
                disposable: false,
                fromTitle: false,
                cursorHelp: false,
                hideTime: false,
                hoverTooltip: true,
                animateOffsetPx: 15,
                animateDuration: 200,
                debug: true
            }
        },
        callEvents: function(current, event) {
            $(current).trigger(event)
        },
        isEmptyObjectProperty: function(id) {
            return tooltipsStorage[id] !== undefined
        },
        call: function(params) {
            var current = $(params.selector);
            var id = current.data("mytooltip-id");
            if (id >= 0) {
                methods.create(tooltipsStorage[id])
            } else {
                methods.error("Method Call: ID not found!")
            }
        },
        update: function(params) {
            $(this).myTooltip(tooltipsSettingsStorage[params.selector])
        },
        updateContent: function(params) {
            $(this).attr("data-mytooltip-content", params.args[1])
        },
        destroy: function(params) {
            var $self;
            var id = params.id;
            if (id !== undefined) {
                $self = $("." + tooltipClasses.base + '[data-mytooltip-id="' + id + '"]');
                delete tooltipsStorage[id];
                removeData($self)
            } else {
                $self = $(this);
                for (var block in tooltipsStorage) {
                    if (tooltipsStorage.hasOwnProperty(block)) {
                        if ($self.data("mytooltip-id") === $(tooltipsStorage[block].current).data("mytooltip-id")) {
                            delete tooltipsStorage[block];
                            removeData($self)
                        }
                    }
                }
            }

            function removeData(self) {
                self.removeClass(tooltipClasses.base);
                var attributes = $.extend({}, self.get(0).attributes);
                $.each(attributes, function(i, attr) {
                    var name = attr.name;
                    if (~name.indexOf("data-mytooltip")) {
                        self.removeAttr(name)
                    }
                })
            }
        },
        error: function(message) {
            console.error(message)
        }
    };
    $.fn.myTooltip = function(method) {
        var args = arguments;
        var selector = this.selector;
        if ($(this).length === 0) {
            methods.error("Element: " + selector + " not found!");
            return
        }
        return this.each(function() {
            if (methods[method]) {
                return methods[method].apply(this, [{
                    args: args,
                    selector: selector
                }])
            } else if (typeof method === "object" || !method) {
                tooltipsSettingsStorage[selector] = args[0];
                return methods.init.apply(this, args)
            } else {
                methods.error("Method " + method + " not found!")
            }
        })
    }
})(jQuery);
(function(factory) {
    if (typeof define === "function" && define.amd) {
        define(["jquery"], factory)
    } else if (typeof exports === "object") {
        factory(require("jquery"))
    } else {
        factory(jQuery)
    }
})(function($) {
    var ua = navigator.userAgent,
        iPhone = /iphone/i.test(ua),
        chrome = /chrome/i.test(ua),
        android = /android/i.test(ua),
        caretTimeoutId;
    $.mask = {
        definitions: {
            9: "[0-9]",
            a: "[A-Za-z]",
            "*": "[A-Za-z0-9]"
        },
        autoclear: true,
        dataName: "rawMaskFn",
        placeholder: "_"
    };
    $.fn.extend({
        caret: function(begin, end) {
            var range;
            if (this.length === 0 || this.is(":hidden") || this.get(0) !== document.activeElement) {
                return
            }
            if (typeof begin == "number") {
                end = typeof end === "number" ? end : begin;
                return this.each(function() {
                    if (this.setSelectionRange) {
                        this.setSelectionRange(begin, end)
                    } else if (this.createTextRange) {
                        range = this.createTextRange();
                        range.collapse(true);
                        range.moveEnd("character", end);
                        range.moveStart("character", begin);
                        range.select()
                    }
                })
            } else {
                if (this[0].setSelectionRange) {
                    begin = this[0].selectionStart;
                    end = this[0].selectionEnd
                } else if (document.selection && document.selection.createRange) {
                    range = document.selection.createRange();
                    begin = 0 - range.duplicate().moveStart("character", -1e5);
                    end = begin + range.text.length
                }
                return {
                    begin: begin,
                    end: end
                }
            }
        },
        unmask: function() {
            return this.trigger("unmask")
        },
        mask: function(mask, settings) {
            var input, defs, tests, partialPosition, firstNonMaskPos, lastRequiredNonMaskPos, len, oldVal;
            if (!mask && this.length > 0) {
                input = $(this[0]);
                var fn = input.data($.mask.dataName);
                return fn ? fn() : undefined
            }
            settings = $.extend({
                autoclear: $.mask.autoclear,
                placeholder: $.mask.placeholder,
                completed: null
            }, settings);
            defs = $.mask.definitions;
            tests = [];
            partialPosition = len = mask.length;
            firstNonMaskPos = null;
            mask = String(mask);
            $.each(mask.split(""), function(i, c) {
                if (c == "?") {
                    len--;
                    partialPosition = i
                } else if (defs[c]) {
                    tests.push(new RegExp(defs[c]));
                    if (firstNonMaskPos === null) {
                        firstNonMaskPos = tests.length - 1
                    }
                    if (i < partialPosition) {
                        lastRequiredNonMaskPos = tests.length - 1
                    }
                } else {
                    tests.push(null)
                }
            });
            return this.trigger("unmask").each(function() {
                var input = $(this),
                    buffer = $.map(mask.split(""), function(c, i) {
                        if (c != "?") {
                            return defs[c] ? getPlaceholder(i) : c
                        }
                    }),
                    defaultBuffer = buffer.join(""),
                    focusText = input.val();

                function tryFireCompleted() {
                    if (!settings.completed) {
                        return
                    }
                    for (var i = firstNonMaskPos; i <= lastRequiredNonMaskPos; i++) {
                        if (tests[i] && buffer[i] === getPlaceholder(i)) {
                            return
                        }
                    }
                    settings.completed.call(input)
                }

                function getPlaceholder(i) {
                    if (i < settings.placeholder.length) return settings.placeholder.charAt(i);
                    return settings.placeholder.charAt(0)
                }

                function seekNext(pos) {
                    while (++pos < len && !tests[pos]);
                    return pos
                }

                function seekPrev(pos) {
                    while (--pos >= 0 && !tests[pos]);
                    return pos
                }

                function shiftL(begin, end) {
                    var i, j;
                    if (begin < 0) {
                        return
                    }
                    for (i = begin, j = seekNext(end); i < len; i++) {
                        if (tests[i]) {
                            if (j < len && tests[i].test(buffer[j])) {
                                buffer[i] = buffer[j];
                                buffer[j] = getPlaceholder(j)
                            } else {
                                break
                            }
                            j = seekNext(j)
                        }
                    }
                    writeBuffer();
                    input.caret(Math.max(firstNonMaskPos, begin))
                }

                function shiftR(pos) {
                    var i, c, j, t;
                    for (i = pos, c = getPlaceholder(pos); i < len; i++) {
                        if (tests[i]) {
                            j = seekNext(i);
                            t = buffer[i];
                            buffer[i] = c;
                            if (j < len && tests[j].test(t)) {
                                c = t
                            } else {
                                break
                            }
                        }
                    }
                }

                function androidInputEvent(e) {
                    var curVal = input.val();
                    var pos = input.caret();
                    if (oldVal && oldVal.length && oldVal.length > curVal.length) {
                        checkVal(true);
                        while (pos.begin > 0 && !tests[pos.begin - 1]) pos.begin--;
                        if (pos.begin === 0) {
                            while (pos.begin < firstNonMaskPos && !tests[pos.begin]) pos.begin++
                        }
                        input.caret(pos.begin, pos.begin)
                    } else {
                        var pos2 = checkVal(true);
                        var lastEnteredValue = curVal.charAt(pos.begin);
                        if (pos.begin < len) {
                            if (!tests[pos.begin]) {
                                pos.begin++;
                                if (tests[pos.begin].test(lastEnteredValue)) {
                                    pos.begin++
                                }
                            } else {
                                if (tests[pos.begin].test(lastEnteredValue)) {
                                    pos.begin++
                                }
                            }
                        }
                        input.caret(pos.begin, pos.begin)
                    }
                    tryFireCompleted()
                }

                function blurEvent(e) {
                    checkVal();
                    if (input.val() != focusText) input.change()
                }

                function keydownEvent(e) {
                    if (input.prop("readonly")) {
                        return
                    }
                    var k = e.which || e.keyCode,
                        pos, begin, end;
                    oldVal = input.val();
                    if (k === 8 || k === 46 || iPhone && k === 127) {
                        pos = input.caret();
                        begin = pos.begin;
                        end = pos.end;
                        if (end - begin === 0) {
                            begin = k !== 46 ? seekPrev(begin) : end = seekNext(begin - 1);
                            end = k === 46 ? seekNext(end) : end
                        }
                        clearBuffer(begin, end);
                        shiftL(begin, end - 1);
                        e.preventDefault()
                    } else if (k === 13) {
                        blurEvent.call(this, e)
                    } else if (k === 27) {
                        input.val(focusText);
                        input.caret(0, checkVal());
                        e.preventDefault()
                    }
                }

                function keypressEvent(e) {
                    if (input.prop("readonly")) {
                        return
                    }
                    var k = e.which || e.keyCode,
                        pos = input.caret(),
                        p, c, next;
                    if (e.ctrlKey || e.altKey || e.metaKey || k < 32) {
                        return
                    } else if (k && k !== 13) {
                        if (pos.end - pos.begin !== 0) {
                            clearBuffer(pos.begin, pos.end);
                            shiftL(pos.begin, pos.end - 1)
                        }
                        p = seekNext(pos.begin - 1);
                        if (p < len) {
                            c = String.fromCharCode(k);
                            if (tests[p].test(c)) {
                                shiftR(p);
                                buffer[p] = c;
                                writeBuffer();
                                next = seekNext(p);
                                if (android) {
                                    var proxy = function() {
                                        $.proxy($.fn.caret, input, next)()
                                    };
                                    setTimeout(proxy, 0)
                                } else {
                                    input.caret(next)
                                }
                                if (pos.begin <= lastRequiredNonMaskPos) {
                                    tryFireCompleted()
                                }
                            }
                        }
                        e.preventDefault()
                    }
                }

                function clearBuffer(start, end) {
                    var i;
                    for (i = start; i < end && i < len; i++) {
                        if (tests[i]) {
                            buffer[i] = getPlaceholder(i)
                        }
                    }
                }

                function writeBuffer() {
                    input.val(buffer.join(""))
                }

                function checkVal(allow) {
                    var test = input.val(),
                        lastMatch = -1,
                        i, c, pos;
                    for (i = 0, pos = 0; i < len; i++) {
                        if (tests[i]) {
                            buffer[i] = getPlaceholder(i);
                            while (pos++ < test.length) {
                                c = test.charAt(pos - 1);
                                if (tests[i].test(c)) {
                                    buffer[i] = c;
                                    lastMatch = i;
                                    break
                                }
                            }
                            if (pos > test.length) {
                                clearBuffer(i + 1, len);
                                break
                            }
                        } else {
                            if (buffer[i] === test.charAt(pos)) {
                                pos++
                            }
                            if (i < partialPosition) {
                                lastMatch = i
                            }
                        }
                    }
                    if (allow) {
                        writeBuffer()
                    } else if (lastMatch + 1 < partialPosition) {
                        if (settings.autoclear || buffer.join("") === defaultBuffer) {
                            if (input.val()) input.val("");
                            clearBuffer(0, len)
                        } else {
                            writeBuffer()
                        }
                    } else {
                        writeBuffer();
                        input.val(input.val().substring(0, lastMatch + 1))
                    }
                    return partialPosition ? i : firstNonMaskPos
                }
                input.data($.mask.dataName, function() {
                    return $.map(buffer, function(c, i) {
                        return tests[i] && c != getPlaceholder(i) ? c : null
                    }).join("")
                });
                input.one("unmask", function() {
                    input.off(".mask").removeData($.mask.dataName)
                }).on("focus.mask", function() {
                    if (input.prop("readonly")) {
                        return
                    }
                    clearTimeout(caretTimeoutId);
                    var pos;
                    focusText = input.val();
                    pos = checkVal();
                    caretTimeoutId = setTimeout(function() {
                        if (input.get(0) !== document.activeElement) {
                            return
                        }
                        writeBuffer();
                        if (pos == mask.replace("?", "").length) {
                            input.caret(0, pos)
                        } else {
                            input.caret(pos)
                        }
                    }, 10)
                }).on("blur.mask", blurEvent).on("keydown.mask", keydownEvent).on("keypress.mask", keypressEvent).on("input.mask paste.mask", function() {
                    if (input.prop("readonly")) {
                        return
                    }
                    setTimeout(function() {
                        var pos = checkVal(true);
                        input.caret(pos);
                        tryFireCompleted()
                    }, 0)
                });
                if (chrome && android) {
                    input.off("input.mask").on("input.mask", androidInputEvent)
                }
                checkVal()
            })
        }
    })
});
(function($) {
    "use struct";
    var stickyBlocks = {};
    var countId = 0;
    var classes = {
        fixed: "sticky-block--fixed",
        absolute: "sticky-block--absolute",
        hidden: "sticky-block--hidden",
        show: "sticky-block--show"
    };
    var methods = {
        init: function(options) {
            if ($(this).length === 0) {
                methods.error("Element: " + $(this).selector + " not found!");
                return false
            }
            var self = $(this);
            var defaults = methods.createDefaults(self);
            var currentOptions = $.extend(true, {}, defaults, options);
            var defaultShow = currentOptions.defaultShow != null ? currentOptions.defaultShow : self.is(":visible");
            var currentWrapper = $('<div class="sticky-block--wrapper ' + currentOptions.wrapperClass + '"></div>');
            self.wrap(currentWrapper);
            self.attr("style", "-webkit-transform: translate3d(0,0,0);");
            if (defaultShow) {
                var currentClone = $('<div class="sticky-block--clone sticky-block--hidden"></div>');
                self.parent().after(currentClone)
            }
            if ($(currentOptions.parent).length > 0) {
                $(currentOptions.parent).css("position", "relative")
            }
            if (currentOptions.end.element === null) {
                currentOptions.end.element = $("body");
                currentOptions.end.border = "bottom"
            }
            stickyBlocks[countId] = {
                current: self,
                clone: currentClone,
                wrapper: self.parent(),
                options: currentOptions,
                data: null,
                dataInit: false,
                defaultShow: defaultShow,
                status: null
            };
            stickyBlocks[countId].data = methods.setData(stickyBlocks[countId]);
            methods.updatePosition(stickyBlocks[countId]);
            if (!$(window).data("sticky-block-events")) {
                methods.setEvents();
                $(window).data("sticky-block-events", true)
            }
            if (!self.data("sticky-block-id")) {
                self.data("sticky-block-id", countId++)
            }
            return this
        },
        createDefaults: function(self) {
            return {
                start: {
                    element: self,
                    border: "top",
                    offset: 0
                },
                end: {
                    element: null,
                    border: "top",
                    offset: 0
                },
                top: 0,
                parent: null,
                cache: false,
                animate: false,
                wrapperClass: "",
                returnToInitialState: null
            }
        },
        setEvents: function() {
            $(window).on("scroll resize", function() {
                updateDataBlocks()
            });

            function updateDataBlocks() {
                for (var block in stickyBlocks) {
                    if (stickyBlocks.hasOwnProperty(block)) {
                        methods.updatePosition(stickyBlocks[block]);
                        stickyBlocks[block].data = methods.updateData(stickyBlocks[block])
                    }
                }
            }
        },
        setData: function(block) {
            var current = block.current;
            var options = block.options;
            var data = block.data;
            if (block.dataInit) {
                $(block.clone).height(data.height);
                if (block.wrapper.is("." + classes.fixed + "," + "." + classes.absolute) && current === options.start.element) {
                    data.width = current.outerWidth();
                    data.height = current.outerHeight(true);
                    return data
                }
            }
            block.dataInit = true;
            var currentData = {
                width: current.outerWidth(),
                height: current.outerHeight(true),
                startPosition: 0,
                endPosition: 0,
                offsetParent: 0
            };
            var points = ["start", "end"];
            for (var i = 0; i < points.length; i++) {
                var point = points[i];
                if (options[point].border === "top") {
                    currentData[point + "Position"] = options[point].element.offset().top
                } else if (options[point].border === "bottom") {
                    currentData[point + "Position"] = options[point].element.offset().top + options[point].element.outerHeight()
                } else {
                    methods.error("Invalid value: " + options[point].border + '! Field "border" requires value - "top" or "bottom"');
                    return false
                }
            }
            if ($(options.parent).length > 0) {
                currentData.offsetParent = $(options.parent).offset().top
            }
            return currentData
        },
        updatePosition: function(block) {
            var options = block.options;
            var data = block.data;
            var wrapper = $(block.wrapper);
            var scrollTop = window.pageYOffset;
            var limit = data.endPosition - data.height - options.end.offset + parseInt($(block.current).css("margin-bottom"));
            var showCurrentBlock = true;
            var showCloneBlock = true;
            if (typeof options.returnToInitialState === "function" && options.returnToInitialState()) {
                setInitialState();
                methods.toogleCloneBlock(block, showCloneBlock);
                return this
            }
            if (data.endPosition - data.startPosition - options.start.offset - options.end.offset < data.height) {
                return this
            }
            if (scrollTop >= limit - options.top) {
                wrapper.css({
                    top: limit - data.offsetParent
                }).addClass(classes.absolute).removeClass(classes.fixed);
                methods.callEvents(block, "sticky-block-end")
            } else if (scrollTop >= data.startPosition + options.start.offset) {
                wrapper.css({
                    top: options.top
                });
                wrapper.addClass(classes.fixed).removeClass(classes.absolute);
                methods.callEvents(block, "sticky-block-start")
            } else {
                setInitialState()
            }
            methods.toogleCloneBlock(block, showCloneBlock);
            methods.toogleCurrentBlock(block, showCurrentBlock);

            function setInitialState() {
                wrapper.removeClass(classes.fixed + " " + classes.absolute);
                showCloneBlock = false;
                showCurrentBlock = false;
                methods.callEvents(block, "sticky-block-default")
            }
            return this
        },
        updateData: function(block) {
            if (block.options.cache === true) return block.data;
            return this.setData(block)
        },
        callEvents: function(block, event) {
            var current = $(block.current);
            if (block.status != event) {
                $(current).trigger(event);
                block.status = event
            }
            return this
        },
        toogleCurrentBlock: function(block, show) {
            var current = $(block.current);
            if (!block.defaultShow && !current.is(":visible")) {
                current.css("display", "block")
            }
            var wrapper = $(block.wrapper);
            var animate = false;
            if (show) {
                wrapper.addClass(classes.show).removeClass(classes.hidden);
                animate = true
            } else if (show === false && block.defaultShow === false) {
                wrapper.addClass(classes.hidden).removeClass(classes.show)
            }
            methods.animate(block, animate)
        },
        toogleCloneBlock: function(block, show) {
            var clone = $(block.clone);
            if (show) {
                clone.addClass(classes.show).removeClass(classes.hidden)
            } else {
                clone.addClass(classes.hidden).removeClass(classes.show)
            }
        },
        animate: function(block, add) {
            var options = block.options;
            if (!options.animate) return this;
            var wrapper = $(block.wrapper);
            var effect = options.animate.split(" ")[0];
            if (add) {
                wrapper.addClass(effect + " animated")
            } else {
                wrapper.removeClass(effect)
            }
            return this
        },
        destroy: function() {
            for (var block in stickyBlocks) {
                if (stickyBlocks.hasOwnProperty(block)) {
                    if ($(this).data("sticky-block-id") === $(stickyBlocks[block].current).data("sticky-block-id")) {
                        delete stickyBlocks[block]
                    }
                }
            }
        },
        error: function(message) {
            console.error(message)
        }
    };
    (function() {
        var stickyBlockStyle = "";
        stickyBlockStyle += "<style>";
        stickyBlockStyle += ".sticky-block--fixed {position: fixed;}";
        stickyBlockStyle += ".sticky-block--absolute {position: absolute;}";
        stickyBlockStyle += ".sticky-block--hidden {display: none;}";
        stickyBlockStyle += ".sticky-block--show {display: block;}";
        stickyBlockStyle += "</style>";
        $(stickyBlockStyle).appendTo(document.head)
    })();
    $.fn.stickyBlock = function(method) {
        if (methods[method]) {
            return methods[method].apply(this, [].slice.call(arguments, 1))
        } else if (typeof method === "object" || !method) {
            return methods.init.apply(this, arguments)
        } else {
            methods.error("Method " + method + " not found!")
        }
    }
})(jQuery);
(function(factory) {
    if (typeof define === "function" && define.amd) {
        define(["jquery"], factory)
    } else if (typeof exports === "object") {
        factory(require("jquery"))
    } else {
        factory(jQuery)
    }
})(function($) {
    var ua = navigator.userAgent,
        iPhone = /iphone/i.test(ua),
        chrome = /chrome/i.test(ua),
        android = /android/i.test(ua),
        caretTimeoutId;
    $.mask = {
        definitions: {
            9: "[0-9]",
            a: "[A-Za-z]",
            "*": "[A-Za-z0-9]"
        },
        autoclear: true,
        dataName: "rawMaskFn",
        placeholder: "_"
    };
    $.fn.extend({
        caret: function(begin, end) {
            var range;
            if (this.length === 0 || this.is(":hidden") || this.get(0) !== document.activeElement) {
                return
            }
            if (typeof begin == "number") {
                end = typeof end === "number" ? end : begin;
                return this.each(function() {
                    if (this.setSelectionRange) {
                        this.setSelectionRange(begin, end)
                    } else if (this.createTextRange) {
                        range = this.createTextRange();
                        range.collapse(true);
                        range.moveEnd("character", end);
                        range.moveStart("character", begin);
                        range.select()
                    }
                })
            } else {
                if (this[0].setSelectionRange) {
                    begin = this[0].selectionStart;
                    end = this[0].selectionEnd
                } else if (document.selection && document.selection.createRange) {
                    range = document.selection.createRange();
                    begin = 0 - range.duplicate().moveStart("character", -1e5);
                    end = begin + range.text.length
                }
                return {
                    begin: begin,
                    end: end
                }
            }
        },
        unmask: function() {
            return this.trigger("unmask")
        },
        mask: function(mask, settings) {
            var input, defs, tests, partialPosition, firstNonMaskPos, lastRequiredNonMaskPos, len, oldVal;
            if (!mask && this.length > 0) {
                input = $(this[0]);
                var fn = input.data($.mask.dataName);
                return fn ? fn() : undefined
            }
            settings = $.extend({
                autoclear: $.mask.autoclear,
                placeholder: $.mask.placeholder,
                completed: null
            }, settings);
            defs = $.mask.definitions;
            tests = [];
            partialPosition = len = mask.length;
            firstNonMaskPos = null;
            mask = String(mask);
            $.each(mask.split(""), function(i, c) {
                if (c == "?") {
                    len--;
                    partialPosition = i
                } else if (defs[c]) {
                    tests.push(new RegExp(defs[c]));
                    if (firstNonMaskPos === null) {
                        firstNonMaskPos = tests.length - 1
                    }
                    if (i < partialPosition) {
                        lastRequiredNonMaskPos = tests.length - 1
                    }
                } else {
                    tests.push(null)
                }
            });
            return this.trigger("unmask").each(function() {
                var input = $(this),
                    buffer = $.map(mask.split(""), function(c, i) {
                        if (c != "?") {
                            return defs[c] ? getPlaceholder(i) : c
                        }
                    }),
                    defaultBuffer = buffer.join(""),
                    focusText = input.val();

                function tryFireCompleted() {
                    if (!settings.completed) {
                        return
                    }
                    for (var i = firstNonMaskPos; i <= lastRequiredNonMaskPos; i++) {
                        if (tests[i] && buffer[i] === getPlaceholder(i)) {
                            return
                        }
                    }
                    settings.completed.call(input)
                }

                function getPlaceholder(i) {
                    if (i < settings.placeholder.length) return settings.placeholder.charAt(i);
                    return settings.placeholder.charAt(0)
                }

                function seekNext(pos) {
                    while (++pos < len && !tests[pos]);
                    return pos
                }

                function seekPrev(pos) {
                    while (--pos >= 0 && !tests[pos]);
                    return pos
                }

                function shiftL(begin, end) {
                    var i, j;
                    if (begin < 0) {
                        return
                    }
                    for (i = begin, j = seekNext(end); i < len; i++) {
                        if (tests[i]) {
                            if (j < len && tests[i].test(buffer[j])) {
                                buffer[i] = buffer[j];
                                buffer[j] = getPlaceholder(j)
                            } else {
                                break
                            }
                            j = seekNext(j)
                        }
                    }
                    writeBuffer();
                    input.caret(Math.max(firstNonMaskPos, begin))
                }

                function shiftR(pos) {
                    var i, c, j, t;
                    for (i = pos, c = getPlaceholder(pos); i < len; i++) {
                        if (tests[i]) {
                            j = seekNext(i);
                            t = buffer[i];
                            buffer[i] = c;
                            if (j < len && tests[j].test(t)) {
                                c = t
                            } else {
                                break
                            }
                        }
                    }
                }

                function androidInputEvent(e) {
                    var curVal = input.val();
                    var pos = input.caret();
                    if (oldVal && oldVal.length && oldVal.length > curVal.length) {
                        checkVal(true);
                        while (pos.begin > 0 && !tests[pos.begin - 1]) pos.begin--;
                        if (pos.begin === 0) {
                            while (pos.begin < firstNonMaskPos && !tests[pos.begin]) pos.begin++
                        }
                        input.caret(pos.begin, pos.begin)
                    } else {
                        var pos2 = checkVal(true);
                        var lastEnteredValue = curVal.charAt(pos.begin);
                        if (pos.begin < len) {
                            if (!tests[pos.begin]) {
                                pos.begin++;
                                if (tests[pos.begin].test(lastEnteredValue)) {
                                    pos.begin++
                                }
                            } else {
                                if (tests[pos.begin].test(lastEnteredValue)) {
                                    pos.begin++
                                }
                            }
                        }
                        input.caret(pos.begin, pos.begin)
                    }
                    tryFireCompleted()
                }

                function blurEvent(e) {
                    checkVal();
                    if (input.val() != focusText) input.change()
                }

                function keydownEvent(e) {
                    if (input.prop("readonly")) {
                        return
                    }
                    var k = e.which || e.keyCode,
                        pos, begin, end;
                    oldVal = input.val();
                    if (k === 8 || k === 46 || iPhone && k === 127) {
                        pos = input.caret();
                        begin = pos.begin;
                        end = pos.end;
                        if (end - begin === 0) {
                            begin = k !== 46 ? seekPrev(begin) : end = seekNext(begin - 1);
                            end = k === 46 ? seekNext(end) : end
                        }
                        clearBuffer(begin, end);
                        shiftL(begin, end - 1);
                        e.preventDefault()
                    } else if (k === 13) {
                        blurEvent.call(this, e)
                    } else if (k === 27) {
                        input.val(focusText);
                        input.caret(0, checkVal());
                        e.preventDefault()
                    }
                }

                function keypressEvent(e) {
                    if (input.prop("readonly")) {
                        return
                    }
                    var k = e.which || e.keyCode,
                        pos = input.caret(),
                        p, c, next;
                    if (e.ctrlKey || e.altKey || e.metaKey || k < 32) {
                        return
                    } else if (k && k !== 13) {
                        if (pos.end - pos.begin !== 0) {
                            clearBuffer(pos.begin, pos.end);
                            shiftL(pos.begin, pos.end - 1)
                        }
                        p = seekNext(pos.begin - 1);
                        if (p < len) {
                            c = String.fromCharCode(k);
                            if (tests[p].test(c)) {
                                shiftR(p);
                                buffer[p] = c;
                                writeBuffer();
                                next = seekNext(p);
                                if (android) {
                                    var proxy = function() {
                                        $.proxy($.fn.caret, input, next)()
                                    };
                                    setTimeout(proxy, 0)
                                } else {
                                    input.caret(next)
                                }
                                if (pos.begin <= lastRequiredNonMaskPos) {
                                    tryFireCompleted()
                                }
                            }
                        }
                        e.preventDefault()
                    }
                }

                function clearBuffer(start, end) {
                    var i;
                    for (i = start; i < end && i < len; i++) {
                        if (tests[i]) {
                            buffer[i] = getPlaceholder(i)
                        }
                    }
                }

                function writeBuffer() {
                    input.val(buffer.join(""))
                }

                function checkVal(allow) {
                    var test = input.val(),
                        lastMatch = -1,
                        i, c, pos;
                    for (i = 0, pos = 0; i < len; i++) {
                        if (tests[i]) {
                            buffer[i] = getPlaceholder(i);
                            while (pos++ < test.length) {
                                c = test.charAt(pos - 1);
                                if (tests[i].test(c)) {
                                    buffer[i] = c;
                                    lastMatch = i;
                                    break
                                }
                            }
                            if (pos > test.length) {
                                clearBuffer(i + 1, len);
                                break
                            }
                        } else {
                            if (buffer[i] === test.charAt(pos)) {
                                pos++
                            }
                            if (i < partialPosition) {
                                lastMatch = i
                            }
                        }
                    }
                    if (allow) {
                        writeBuffer()
                    } else if (lastMatch + 1 < partialPosition) {
                        if (settings.autoclear || buffer.join("") === defaultBuffer) {
                            if (input.val()) input.val("");
                            clearBuffer(0, len)
                        } else {
                            writeBuffer()
                        }
                    } else {
                        writeBuffer();
                        input.val(input.val().substring(0, lastMatch + 1))
                    }
                    return partialPosition ? i : firstNonMaskPos
                }
                input.data($.mask.dataName, function() {
                    return $.map(buffer, function(c, i) {
                        return tests[i] && c != getPlaceholder(i) ? c : null
                    }).join("")
                });
                input.one("unmask", function() {
                    input.off(".mask").removeData($.mask.dataName)
                }).on("focus.mask", function() {
                    if (input.prop("readonly")) {
                        return
                    }
                    clearTimeout(caretTimeoutId);
                    var pos;
                    focusText = input.val();
                    pos = checkVal();
                    caretTimeoutId = setTimeout(function() {
                        if (input.get(0) !== document.activeElement) {
                            return
                        }
                        writeBuffer();
                        if (pos == mask.replace("?", "").length) {
                            input.caret(0, pos)
                        } else {
                            input.caret(pos)
                        }
                    }, 10)
                }).on("blur.mask", blurEvent).on("keydown.mask", keydownEvent).on("keypress.mask", keypressEvent).on("input.mask paste.mask", function() {
                    if (input.prop("readonly")) {
                        return
                    }
                    setTimeout(function() {
                        var pos = checkVal(true);
                        input.caret(pos);
                        tryFireCompleted()
                    }, 0)
                });
                if (chrome && android) {
                    input.off("input.mask").on("input.mask", androidInputEvent)
                }
                checkVal()
            })
        }
    })
});
(function(window, document, $, undefined) {
    "use strict";
    var H = $("html"),
        W = $(window),
        D = $(document),
        F = $.fancybox = function() {
            F.open.apply(this, arguments)
        },
        IE = navigator.userAgent.match(/msie/i),
        didUpdate = null,
        isTouch = document.createTouch !== undefined,
        isQuery = function(obj) {
            return obj && obj.hasOwnProperty && obj instanceof $
        },
        isString = function(str) {
            return str && $.type(str) === "string"
        },
        isPercentage = function(str) {
            return isString(str) && str.indexOf("%") > 0
        },
        isScrollable = function(el) {
            return el && !(el.style.overflow && el.style.overflow === "hidden") && (el.clientWidth && el.scrollWidth > el.clientWidth || el.clientHeight && el.scrollHeight > el.clientHeight)
        },
        getScalar = function(orig, dim) {
            var value = parseInt(orig, 10) || 0;
            if (dim && isPercentage(orig)) {
                value = F.getViewport()[dim] / 100 * value
            }
            return Math.ceil(value)
        },
        getValue = function(value, dim) {
            return getScalar(value, dim) + "px"
        };
    $.extend(F, {
        version: "2.1.5",
        defaults: {
            padding: 15,
            margin: 20,
            width: 800,
            height: 600,
            minWidth: 100,
            minHeight: 100,
            maxWidth: 9999,
            maxHeight: 9999,
            pixelRatio: 1,
            autoSize: true,
            autoHeight: false,
            autoWidth: false,
            autoResize: true,
            autoCenter: !isTouch,
            fitToView: true,
            aspectRatio: false,
            topRatio: .5,
            leftRatio: .5,
            scrolling: "auto",
            wrapCSS: "",
            arrows: true,
            closeBtn: true,
            closeClick: false,
            nextClick: false,
            mouseWheel: true,
            autoPlay: false,
            playSpeed: 3e3,
            preload: 3,
            modal: false,
            loop: true,
            ajax: {
                dataType: "html",
                headers: {
                    "X-fancyBox": true
                }
            },
            iframe: {
                scrolling: "auto",
                preload: true
            },
            swf: {
                wmode: "transparent",
                allowfullscreen: "true",
                allowscriptaccess: "always"
            },
            keys: {
                next: {
                    13: "left",
                    34: "up",
                    39: "left",
                    40: "up"
                },
                prev: {
                    8: "right",
                    33: "down",
                    37: "right",
                    38: "down"
                },
                close: [27],
                play: [32],
                toggle: [70]
            },
            direction: {
                next: "left",
                prev: "right"
            },
            scrollOutside: true,
            index: 0,
            type: null,
            href: null,
            content: null,
            title: null,
            tpl: {
                wrap: '<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',
                image: '<img class="fancybox-image" src="{href}" alt="" />',
                iframe: '<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen' + (IE ? ' allowtransparency="true"' : "") + "></iframe>",
                error: '<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',
                closeBtn: '<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',
                next: '<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',
                prev: '<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>',
                loading: '<div id="fancybox-loading"><div></div></div>'
            },
            openEffect: "fade",
            openSpeed: 250,
            openEasing: "swing",
            openOpacity: true,
            openMethod: "zoomIn",
            closeEffect: "fade",
            closeSpeed: 250,
            closeEasing: "swing",
            closeOpacity: true,
            closeMethod: "zoomOut",
            nextEffect: "elastic",
            nextSpeed: 250,
            nextEasing: "swing",
            nextMethod: "changeIn",
            prevEffect: "elastic",
            prevSpeed: 250,
            prevEasing: "swing",
            prevMethod: "changeOut",
            helpers: {
                overlay: true,
                title: true
            },
            onCancel: $.noop,
            beforeLoad: $.noop,
            afterLoad: $.noop,
            beforeShow: $.noop,
            afterShow: $.noop,
            beforeChange: $.noop,
            beforeClose: $.noop,
            afterClose: $.noop
        },
        group: {},
        opts: {},
        previous: null,
        coming: null,
        current: null,
        isActive: false,
        isOpen: false,
        isOpened: false,
        wrap: null,
        skin: null,
        outer: null,
        inner: null,
        player: {
            timer: null,
            isActive: false
        },
        ajaxLoad: null,
        imgPreload: null,
        transitions: {},
        helpers: {},
        open: function(group, opts) {
            if (!group) {
                return
            }
            if (!$.isPlainObject(opts)) {
                opts = {}
            }
            if (false === F.close(true)) {
                return
            }
            if (!$.isArray(group)) {
                group = isQuery(group) ? $(group).get() : [group]
            }
            $.each(group, function(i, element) {
                var obj = {},
                    href, title, content, type, rez, hrefParts, selector;
                if ($.type(element) === "object") {
                    if (element.nodeType) {
                        element = $(element)
                    }
                    if (isQuery(element)) {
                        obj = {
                            href: element.data("fancybox-href") || element.attr("href"),
                            title: $("<div/>").text(element.data("fancybox-title") || element.attr("title") || "").html(),
                            isDom: true,
                            element: element
                        };
                        if ($.metadata) {
                            $.extend(true, obj, element.metadata())
                        }
                    } else {
                        obj = element
                    }
                }
                href = opts.href || obj.href || (isString(element) ? element : null);
                title = opts.title !== undefined ? opts.title : obj.title || "";
                content = opts.content || obj.content;
                type = content ? "html" : opts.type || obj.type;
                if (!type && obj.isDom) {
                    type = element.data("fancybox-type");
                    if (!type) {
                        rez = element.prop("class").match(/fancybox\.(\w+)/);
                        type = rez ? rez[1] : null
                    }
                }
                if (isString(href)) {
                    if (!type) {
                        if (F.isImage(href)) {
                            type = "image"
                        } else if (F.isSWF(href)) {
                            type = "swf"
                        } else if (href.charAt(0) === "#") {
                            type = "inline"
                        } else if (isString(element)) {
                            type = "html";
                            content = element
                        }
                    }
                    if (type === "ajax") {
                        hrefParts = href.split(/\s+/, 2);
                        href = hrefParts.shift();
                        selector = hrefParts.shift()
                    }
                }
                if (!content) {
                    if (type === "inline") {
                        if (href) {
                            content = $(isString(href) ? href.replace(/.*(?=#[^\s]+$)/, "") : href)
                        } else if (obj.isDom) {
                            content = element
                        }
                    } else if (type === "html") {
                        content = href
                    } else if (!type && !href && obj.isDom) {
                        type = "inline";
                        content = element
                    }
                }
                $.extend(obj, {
                    href: href,
                    type: type,
                    content: content,
                    title: title,
                    selector: selector
                });
                group[i] = obj
            });
            F.opts = $.extend(true, {}, F.defaults, opts);
            if (opts.keys !== undefined) {
                F.opts.keys = opts.keys ? $.extend({}, F.defaults.keys, opts.keys) : false
            }
            F.group = group;
            return F._start(F.opts.index)
        },
        cancel: function() {
            var coming = F.coming;
            if (coming && false === F.trigger("onCancel")) {
                return
            }
            F.hideLoading();
            if (!coming) {
                return
            }
            if (F.ajaxLoad) {
                F.ajaxLoad.abort()
            }
            F.ajaxLoad = null;
            if (F.imgPreload) {
                F.imgPreload.onload = F.imgPreload.onerror = null
            }
            if (coming.wrap) {
                coming.wrap.stop(true, true).trigger("onReset").remove()
            }
            F.coming = null;
            if (!F.current) {
                F._afterZoomOut(coming)
            }
        },
        close: function(event) {
            F.cancel();
            if (false === F.trigger("beforeClose")) {
                return
            }
            F.unbindEvents();
            if (!F.isActive) {
                return
            }
            if (!F.isOpen || event === true) {
                $(".fancybox-wrap").stop(true).trigger("onReset").remove();
                F._afterZoomOut()
            } else {
                F.isOpen = F.isOpened = false;
                F.isClosing = true;
                $(".fancybox-item, .fancybox-nav").remove();
                F.wrap.stop(true, true).removeClass("fancybox-opened");
                F.transitions[F.current.closeMethod]()
            }
        },
        play: function(action) {
            var clear = function() {
                    clearTimeout(F.player.timer)
                },
                set = function() {
                    clear();
                    if (F.current && F.player.isActive) {
                        F.player.timer = setTimeout(F.next, F.current.playSpeed)
                    }
                },
                stop = function() {
                    clear();
                    D.unbind(".player");
                    F.player.isActive = false;
                    F.trigger("onPlayEnd")
                },
                start = function() {
                    if (F.current && (F.current.loop || F.current.index < F.group.length - 1)) {
                        F.player.isActive = true;
                        D.bind({
                            "onCancel.player beforeClose.player": stop,
                            "onUpdate.player": set,
                            "beforeLoad.player": clear
                        });
                        set();
                        F.trigger("onPlayStart")
                    }
                };
            if (action === true || !F.player.isActive && action !== false) {
                start()
            } else {
                stop()
            }
        },
        next: function(direction) {
            var current = F.current;
            if (current) {
                if (!isString(direction)) {
                    direction = current.direction.next
                }
                F.jumpto(current.index + 1, direction, "next")
            }
        },
        prev: function(direction) {
            var current = F.current;
            if (current) {
                if (!isString(direction)) {
                    direction = current.direction.prev
                }
                F.jumpto(current.index - 1, direction, "prev")
            }
        },
        jumpto: function(index, direction, router) {
            var current = F.current;
            if (!current) {
                return
            }
            index = getScalar(index);
            F.direction = direction || current.direction[index >= current.index ? "next" : "prev"];
            F.router = router || "jumpto";
            if (current.loop) {
                if (index < 0) {
                    index = current.group.length + index % current.group.length
                }
                index = index % current.group.length
            }
            if (current.group[index] !== undefined) {
                F.cancel();
                F._start(index)
            }
        },
        reposition: function(e, onlyAbsolute) {
            var current = F.current,
                wrap = current ? current.wrap : null,
                pos;
            if (wrap) {
                pos = F._getPosition(onlyAbsolute);
                if (e && e.type === "scroll") {
                    delete pos.position;
                    wrap.stop(true, true).animate(pos, 200)
                } else {
                    wrap.css(pos);
                    current.pos = $.extend({}, current.dim, pos)
                }
            }
        },
        update: function(e) {
            var type = e && e.originalEvent && e.originalEvent.type,
                anyway = !type || type === "orientationchange";
            if (anyway) {
                clearTimeout(didUpdate);
                didUpdate = null
            }
            if (!F.isOpen || didUpdate) {
                return
            }
            didUpdate = setTimeout(function() {
                var current = F.current;
                if (!current || F.isClosing) {
                    return
                }
                F.wrap.removeClass("fancybox-tmp");
                if (anyway || type === "load" || type === "resize" && current.autoResize) {
                    F._setDimension()
                }
                if (!(type === "scroll" && current.canShrink)) {
                    F.reposition(e)
                }
                F.trigger("onUpdate");
                didUpdate = null
            }, anyway && !isTouch ? 0 : 300)
        },
        toggle: function(action) {
            if (F.isOpen) {
                F.current.fitToView = $.type(action) === "boolean" ? action : !F.current.fitToView;
                if (isTouch) {
                    F.wrap.removeAttr("style").addClass("fancybox-tmp");
                    F.trigger("onUpdate")
                }
                F.update()
            }
        },
        hideLoading: function() {
            D.unbind(".loading");
            $("#fancybox-loading").remove()
        },
        showLoading: function() {
            var el, viewport;
            F.hideLoading();
            el = $(F.opts.tpl.loading).click(F.cancel).appendTo("body");
            D.bind("keydown.loading", function(e) {
                if ((e.which || e.keyCode) === 27) {
                    e.preventDefault();
                    F.cancel()
                }
            });
            if (!F.defaults.fixed) {
                viewport = F.getViewport();
                el.css({
                    position: "absolute",
                    top: viewport.h * .5 + viewport.y,
                    left: viewport.w * .5 + viewport.x
                })
            }
            F.trigger("onLoading")
        },
        getViewport: function() {
            var locked = F.current && F.current.locked || false,
                rez = {
                    x: W.scrollLeft(),
                    y: W.scrollTop()
                };
            if (locked && locked.length) {
                rez.w = locked[0].clientWidth;
                rez.h = locked[0].clientHeight
            } else {
                rez.w = isTouch && window.innerWidth ? window.innerWidth : W.width();
                rez.h = isTouch && window.innerHeight ? window.innerHeight : W.height()
            }
            return rez
        },
        unbindEvents: function() {
            if (F.wrap && isQuery(F.wrap)) {
                F.wrap.unbind(".fb")
            }
            D.unbind(".fb");
            W.unbind(".fb")
        },
        bindEvents: function() {
            var current = F.current,
                keys;
            if (!current) {
                return
            }
            W.bind("orientationchange.fb" + (isTouch ? "" : " resize.fb") + (current.autoCenter && !current.locked ? " scroll.fb" : ""), F.update);
            keys = current.keys;
            if (keys) {
                D.bind("keydown.fb", function(e) {
                    var code = e.which || e.keyCode,
                        target = e.target || e.srcElement;
                    if (code === 27 && F.coming) {
                        return false
                    }
                    if (!e.ctrlKey && !e.altKey && !e.shiftKey && !e.metaKey && !(target && (target.type || $(target).is("[contenteditable]")))) {
                        $.each(keys, function(i, val) {
                            if (current.group.length > 1 && val[code] !== undefined) {
                                F[i](val[code]);
                                e.preventDefault();
                                return false
                            }
                            if ($.inArray(code, val) > -1) {
                                F[i]();
                                e.preventDefault();
                                return false
                            }
                        })
                    }
                })
            }
            if ($.fn.mousewheel && current.mouseWheel) {
                F.wrap.bind("mousewheel.fb", function(e, delta, deltaX, deltaY) {
                    var target = e.target || null,
                        parent = $(target),
                        canScroll = false;
                    while (parent.length) {
                        if (canScroll || parent.is(".fancybox-skin") || parent.is(".fancybox-wrap")) {
                            break
                        }
                        canScroll = isScrollable(parent[0]);
                        parent = $(parent).parent()
                    }
                    if (delta !== 0 && !canScroll) {
                        if (F.group.length > 1 && !current.canShrink) {
                            if (deltaY > 0 || deltaX > 0) {
                                F.prev(deltaY > 0 ? "down" : "left")
                            } else if (deltaY < 0 || deltaX < 0) {
                                F.next(deltaY < 0 ? "up" : "right")
                            }
                            e.preventDefault()
                        }
                    }
                })
            }
        },
        trigger: function(event, o) {
            var ret, obj = o || F.coming || F.current;
            if (obj) {
                if ($.isFunction(obj[event])) {
                    ret = obj[event].apply(obj, Array.prototype.slice.call(arguments, 1))
                }
                if (ret === false) {
                    return false
                }
                if (obj.helpers) {
                    $.each(obj.helpers, function(helper, opts) {
                        if (opts && F.helpers[helper] && $.isFunction(F.helpers[helper][event])) {
                            F.helpers[helper][event]($.extend(true, {}, F.helpers[helper].defaults, opts), obj)
                        }
                    })
                }
            }
            D.trigger(event)
        },
        isImage: function(str) {
            return isString(str) && str.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)
        },
        isSWF: function(str) {
            return isString(str) && str.match(/\.(swf)((\?|#).*)?$/i)
        },
        _start: function(index) {
            var coming = {},
                obj, href, type, margin, padding;
            index = getScalar(index);
            obj = F.group[index] || null;
            if (!obj) {
                return false
            }
            coming = $.extend(true, {}, F.opts, obj);
            margin = coming.margin;
            padding = coming.padding;
            if ($.type(margin) === "number") {
                coming.margin = [margin, margin, margin, margin]
            }
            if ($.type(padding) === "number") {
                coming.padding = [padding, padding, padding, padding]
            }
            if (coming.modal) {
                $.extend(true, coming, {
                    closeBtn: false,
                    closeClick: false,
                    nextClick: false,
                    arrows: false,
                    mouseWheel: false,
                    keys: null,
                    helpers: {
                        overlay: {
                            closeClick: false
                        }
                    }
                })
            }
            if (coming.autoSize) {
                coming.autoWidth = coming.autoHeight = true
            }
            if (coming.width === "auto") {
                coming.autoWidth = true
            }
            if (coming.height === "auto") {
                coming.autoHeight = true
            }
            coming.group = F.group;
            coming.index = index;
            F.coming = coming;
            if (false === F.trigger("beforeLoad")) {
                F.coming = null;
                return
            }
            type = coming.type;
            href = coming.href;
            if (!type) {
                F.coming = null;
                if (F.current && F.router && F.router !== "jumpto") {
                    F.current.index = index;
                    return F[F.router](F.direction)
                }
                return false
            }
            F.isActive = true;
            if (type === "image" || type === "swf") {
                coming.autoHeight = coming.autoWidth = false;
                coming.scrolling = "visible"
            }
            if (type === "image") {
                coming.aspectRatio = true
            }
            if (type === "iframe" && isTouch) {
                coming.scrolling = "scroll"
            }
            coming.wrap = $(coming.tpl.wrap).addClass("fancybox-" + (isTouch ? "mobile" : "desktop") + " fancybox-type-" + type + " fancybox-tmp " + coming.wrapCSS).appendTo(coming.parent || "body");
            $.extend(coming, {
                skin: $(".fancybox-skin", coming.wrap),
                outer: $(".fancybox-outer", coming.wrap),
                inner: $(".fancybox-inner", coming.wrap)
            });
            $.each(["Top", "Right", "Bottom", "Left"], function(i, v) {
                coming.skin.css("padding" + v, getValue(coming.padding[i]))
            });
            F.trigger("onReady");
            if (type === "inline" || type === "html") {
                if (!coming.content || !coming.content.length) {
                    return F._error("content")
                }
            } else if (!href) {
                return F._error("href")
            }
            if (type === "image") {
                F._loadImage()
            } else if (type === "ajax") {
                F._loadAjax()
            } else if (type === "iframe") {
                F._loadIframe()
            } else {
                F._afterLoad()
            }
        },
        _error: function(type) {
            $.extend(F.coming, {
                type: "html",
                autoWidth: true,
                autoHeight: true,
                minWidth: 0,
                minHeight: 0,
                scrolling: "no",
                hasError: type,
                content: F.coming.tpl.error
            });
            F._afterLoad()
        },
        _loadImage: function() {
            var img = F.imgPreload = new Image;
            img.onload = function() {
                this.onload = this.onerror = null;
                F.coming.width = this.width / F.opts.pixelRatio;
                F.coming.height = this.height / F.opts.pixelRatio;
                F._afterLoad()
            };
            img.onerror = function() {
                this.onload = this.onerror = null;
                F._error("image")
            };
            img.src = F.coming.href;
            if (img.complete !== true) {
                F.showLoading()
            }
        },
        _loadAjax: function() {
            var coming = F.coming;
            F.showLoading();
            F.ajaxLoad = $.ajax($.extend({}, coming.ajax, {
                url: coming.href,
                error: function(jqXHR, textStatus) {
                    if (F.coming && textStatus !== "abort") {
                        F._error("ajax", jqXHR)
                    } else {
                        F.hideLoading()
                    }
                },
                success: function(data, textStatus) {
                    if (textStatus === "success") {
                        coming.content = data;
                        F._afterLoad()
                    }
                }
            }))
        },
        _loadIframe: function() {
            var coming = F.coming,
                iframe = $(coming.tpl.iframe.replace(/\{rnd\}/g, (new Date).getTime())).attr("scrolling", isTouch ? "auto" : coming.iframe.scrolling).attr("src", coming.href);
            $(coming.wrap).bind("onReset", function() {
                try {
                    $(this).find("iframe").hide().attr("src", "//about:blank").end().empty()
                } catch (e) {}
            });
            if (coming.iframe.preload) {
                F.showLoading();
                iframe.one("load", function() {
                    $(this).data("ready", 1);
                    if (!isTouch) {
                        $(this).bind("load.fb", F.update)
                    }
                    $(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show();
                    F._afterLoad()
                })
            }
            coming.content = iframe.appendTo(coming.inner);
            if (!coming.iframe.preload) {
                F._afterLoad()
            }
        },
        _preloadImages: function() {
            var group = F.group,
                current = F.current,
                len = group.length,
                cnt = current.preload ? Math.min(current.preload, len - 1) : 0,
                item, i;
            for (i = 1; i <= cnt; i += 1) {
                item = group[(current.index + i) % len];
                if (item.type === "image" && item.href) {
                    (new Image).src = item.href
                }
            }
        },
        _afterLoad: function() {
            var coming = F.coming,
                previous = F.current,
                placeholder = "fancybox-placeholder",
                current, content, type, scrolling, href, embed;
            F.hideLoading();
            if (!coming || F.isActive === false) {
                return
            }
            if (false === F.trigger("afterLoad", coming, previous)) {
                coming.wrap.stop(true).trigger("onReset").remove();
                F.coming = null;
                return
            }
            if (previous) {
                F.trigger("beforeChange", previous);
                previous.wrap.stop(true).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()
            }
            F.unbindEvents();
            current = coming;
            content = coming.content;
            type = coming.type;
            scrolling = coming.scrolling;
            $.extend(F, {
                wrap: current.wrap,
                skin: current.skin,
                outer: current.outer,
                inner: current.inner,
                current: current,
                previous: previous
            });
            href = current.href;
            switch (type) {
                case "inline":
                case "ajax":
                case "html":
                    if (current.selector) {
                        content = $("<div>").html(content).find(current.selector)
                    } else if (isQuery(content)) {
                        if (!content.data(placeholder)) {
                            content.data(placeholder, $('<div class="' + placeholder + '"></div>').insertAfter(content).hide())
                        }
                        content = content.show().detach();
                        current.wrap.bind("onReset", function() {
                            if ($(this).find(content).length) {
                                content.hide().replaceAll(content.data(placeholder)).data(placeholder, false)
                            }
                        })
                    }
                    break;
                case "image":
                    content = current.tpl.image.replace(/\{href\}/g, href);
                    break;
                case "swf":
                    content = '<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="' + href + '"></param>';
                    embed = "";
                    $.each(current.swf, function(name, val) {
                        content += '<param name="' + name + '" value="' + val + '"></param>';
                        embed += " " + name + '="' + val + '"'
                    });
                    content += '<embed src="' + href + '" type="application/x-shockwave-flash" width="100%" height="100%"' + embed + "></embed></object>";
                    break
            }
            if (!(isQuery(content) && content.parent().is(current.inner))) {
                current.inner.append(content)
            }
            F.trigger("beforeShow");
            current.inner.css("overflow", scrolling === "yes" ? "scroll" : scrolling === "no" ? "hidden" : scrolling);
            F._setDimension();
            F.reposition();
            F.isOpen = false;
            F.coming = null;
            F.bindEvents();
            if (!F.isOpened) {
                $(".fancybox-wrap").not(current.wrap).stop(true).trigger("onReset").remove()
            } else if (previous.prevMethod) {
                F.transitions[previous.prevMethod]()
            }
            F.transitions[F.isOpened ? current.nextMethod : current.openMethod]();
            F._preloadImages()
        },
        _setDimension: function() {
            var viewport = F.getViewport(),
                steps = 0,
                canShrink = false,
                canExpand = false,
                wrap = F.wrap,
                skin = F.skin,
                inner = F.inner,
                current = F.current,
                width = current.width,
                height = current.height,
                minWidth = current.minWidth,
                minHeight = current.minHeight,
                maxWidth = current.maxWidth,
                maxHeight = current.maxHeight,
                scrolling = current.scrolling,
                scrollOut = current.scrollOutside ? current.scrollbarWidth : 0,
                margin = current.margin,
                wMargin = getScalar(margin[1] + margin[3]),
                hMargin = getScalar(margin[0] + margin[2]),
                wPadding, hPadding, wSpace, hSpace, origWidth, origHeight, origMaxWidth, origMaxHeight, ratio, width_, height_, maxWidth_, maxHeight_, iframe, body;
            wrap.add(skin).add(inner).width("auto").height("auto").removeClass("fancybox-tmp");
            wPadding = getScalar(skin.outerWidth(true) - skin.width());
            hPadding = getScalar(skin.outerHeight(true) - skin.height());
            wSpace = wMargin + wPadding;
            hSpace = hMargin + hPadding;
            origWidth = isPercentage(width) ? (viewport.w - wSpace) * getScalar(width) / 100 : width;
            origHeight = isPercentage(height) ? (viewport.h - hSpace) * getScalar(height) / 100 : height;
            if (current.type === "iframe") {
                iframe = current.content;
                if (current.autoHeight && iframe.data("ready") === 1) {
                    try {
                        if (iframe[0].contentWindow.document.location) {
                            inner.width(origWidth).height(9999);
                            body = iframe.contents().find("body");
                            if (scrollOut) {
                                body.css("overflow-x", "hidden")
                            }
                            origHeight = body.outerHeight(true)
                        }
                    } catch (e) {}
                }
            } else if (current.autoWidth || current.autoHeight) {
                inner.addClass("fancybox-tmp");
                if (!current.autoWidth) {
                    inner.width(origWidth)
                }
                if (!current.autoHeight) {
                    inner.height(origHeight)
                }
                if (current.autoWidth) {
                    origWidth = inner.width()
                }
                if (current.autoHeight) {
                    origHeight = inner.height()
                }
                inner.removeClass("fancybox-tmp")
            }
            width = getScalar(origWidth);
            height = getScalar(origHeight);
            ratio = origWidth / origHeight;
            minWidth = getScalar(isPercentage(minWidth) ? getScalar(minWidth, "w") - wSpace : minWidth);
            maxWidth = getScalar(isPercentage(maxWidth) ? getScalar(maxWidth, "w") - wSpace : maxWidth);
            minHeight = getScalar(isPercentage(minHeight) ? getScalar(minHeight, "h") - hSpace : minHeight);
            maxHeight = getScalar(isPercentage(maxHeight) ? getScalar(maxHeight, "h") - hSpace : maxHeight);
            origMaxWidth = maxWidth;
            origMaxHeight = maxHeight;
            if (current.fitToView) {
                maxWidth = Math.min(viewport.w - wSpace, maxWidth);
                maxHeight = Math.min(viewport.h - hSpace, maxHeight)
            }
            maxWidth_ = viewport.w - wMargin;
            maxHeight_ = viewport.h - hMargin;
            if (current.aspectRatio) {
                if (width > maxWidth) {
                    width = maxWidth;
                    height = getScalar(width / ratio)
                }
                if (height > maxHeight) {
                    height = maxHeight;
                    width = getScalar(height * ratio)
                }
                if (width < minWidth) {
                    width = minWidth;
                    height = getScalar(width / ratio)
                }
                if (height < minHeight) {
                    height = minHeight;
                    width = getScalar(height * ratio)
                }
            } else {
                width = Math.max(minWidth, Math.min(width, maxWidth));
                if (current.autoHeight && current.type !== "iframe") {
                    inner.width(width);
                    height = inner.height()
                }
                height = Math.max(minHeight, Math.min(height, maxHeight))
            }
            if (current.fitToView) {
                inner.width(width).height(height);
                wrap.width(width + wPadding);
                width_ = wrap.width();
                height_ = wrap.height();
                if (current.aspectRatio) {
                    while ((width_ > maxWidth_ || height_ > maxHeight_) && width > minWidth && height > minHeight) {
                        if (steps++ > 19) {
                            break
                        }
                        height = Math.max(minHeight, Math.min(maxHeight, height - 10));
                        width = getScalar(height * ratio);
                        if (width < minWidth) {
                            width = minWidth;
                            height = getScalar(width / ratio)
                        }
                        if (width > maxWidth) {
                            width = maxWidth;
                            height = getScalar(width / ratio)
                        }
                        inner.width(width).height(height);
                        wrap.width(width + wPadding);
                        width_ = wrap.width();
                        height_ = wrap.height()
                    }
                } else {
                    width = Math.max(minWidth, Math.min(width, width - (width_ - maxWidth_)));
                    height = Math.max(minHeight, Math.min(height, height - (height_ - maxHeight_)))
                }
            }
            if (scrollOut && scrolling === "auto" && height < origHeight && width + wPadding + scrollOut < maxWidth_) {
                width += scrollOut
            }
            inner.width(width).height(height);
            wrap.width(width + wPadding);
            width_ = wrap.width();
            height_ = wrap.height();
            canShrink = (width_ > maxWidth_ || height_ > maxHeight_) && width > minWidth && height > minHeight;
            canExpand = current.aspectRatio ? width < origMaxWidth && height < origMaxHeight && width < origWidth && height < origHeight : (width < origMaxWidth || height < origMaxHeight) && (width < origWidth || height < origHeight);
            $.extend(current, {
                dim: {
                    width: getValue(width_),
                    height: getValue(height_)
                },
                origWidth: origWidth,
                origHeight: origHeight,
                canShrink: canShrink,
                canExpand: canExpand,
                wPadding: wPadding,
                hPadding: hPadding,
                wrapSpace: height_ - skin.outerHeight(true),
                skinSpace: skin.height() - height
            });
            if (!iframe && current.autoHeight && height > minHeight && height < maxHeight && !canExpand) {
                inner.height("auto")
            }
        },
        _getPosition: function(onlyAbsolute) {
            var current = F.current,
                viewport = F.getViewport(),
                margin = current.margin,
                width = F.wrap.width() + margin[1] + margin[3],
                height = F.wrap.height() + margin[0] + margin[2],
                rez = {
                    position: "absolute",
                    top: margin[0],
                    left: margin[3]
                };
            if (current.autoCenter && current.fixed && !onlyAbsolute && height <= viewport.h && width <= viewport.w) {
                rez.position = "fixed"
            } else if (!current.locked) {
                rez.top += viewport.y;
                rez.left += viewport.x
            }
            rez.top = getValue(Math.max(rez.top, rez.top + (viewport.h - height) * current.topRatio));
            rez.left = getValue(Math.max(rez.left, rez.left + (viewport.w - width) * current.leftRatio));
            return rez
        },
        _afterZoomIn: function() {
            var current = F.current;
            if (!current) {
                return
            }
            F.isOpen = F.isOpened = true;
            F.wrap.css("overflow", "visible").addClass("fancybox-opened").hide().show(0);
            F.update();
            if (current.closeClick || current.nextClick && F.group.length > 1) {
                F.inner.css("cursor", "pointer").bind("click.fb", function(e) {
                    if (!$(e.target).is("a") && !$(e.target).parent().is("a")) {
                        e.preventDefault();
                        F[current.closeClick ? "close" : "next"]()
                    }
                })
            }
            if (current.closeBtn) {
                $(current.tpl.closeBtn).appendTo(F.skin).bind("click.fb", function(e) {
                    e.preventDefault();
                    F.close()
                })
            }
            if (current.arrows && F.group.length > 1) {
                if (current.loop || current.index > 0) {
                    $(current.tpl.prev).appendTo(F.outer).bind("click.fb", F.prev)
                }
                if (current.loop || current.index < F.group.length - 1) {
                    $(current.tpl.next).appendTo(F.outer).bind("click.fb", F.next)
                }
            }
            F.trigger("afterShow");
            if (!current.loop && current.index === current.group.length - 1) {
                F.play(false)
            } else if (F.opts.autoPlay && !F.player.isActive) {
                F.opts.autoPlay = false;
                F.play(true)
            }
        },
        _afterZoomOut: function(obj) {
            obj = obj || F.current;
            $(".fancybox-wrap").trigger("onReset").remove();
            $.extend(F, {
                group: {},
                opts: {},
                router: false,
                current: null,
                isActive: false,
                isOpened: false,
                isOpen: false,
                isClosing: false,
                wrap: null,
                skin: null,
                outer: null,
                inner: null
            });
            F.trigger("afterClose", obj)
        }
    });
    F.transitions = {
        getOrigPosition: function() {
            var current = F.current,
                element = current.element,
                orig = current.orig,
                pos = {},
                width = 50,
                height = 50,
                hPadding = current.hPadding,
                wPadding = current.wPadding,
                viewport = F.getViewport();
            if (!orig && current.isDom && element.is(":visible")) {
                orig = element.find("img:first");
                if (!orig.length) {
                    orig = element
                }
            }
            if (isQuery(orig)) {
                pos = orig.offset();
                if (orig.is("img")) {
                    width = orig.outerWidth();
                    height = orig.outerHeight()
                }
            } else {
                pos.top = viewport.y + (viewport.h - height) * current.topRatio;
                pos.left = viewport.x + (viewport.w - width) * current.leftRatio
            }
            if (F.wrap.css("position") === "fixed" || current.locked) {
                pos.top -= viewport.y;
                pos.left -= viewport.x
            }
            pos = {
                top: getValue(pos.top - hPadding * current.topRatio),
                left: getValue(pos.left - wPadding * current.leftRatio),
                width: getValue(width + wPadding),
                height: getValue(height + hPadding)
            };
            return pos
        },
        step: function(now, fx) {
            var ratio, padding, value, prop = fx.prop,
                current = F.current,
                wrapSpace = current.wrapSpace,
                skinSpace = current.skinSpace;
            if (prop === "width" || prop === "height") {
                ratio = fx.end === fx.start ? 1 : (now - fx.start) / (fx.end - fx.start);
                if (F.isClosing) {
                    ratio = 1 - ratio
                }
                padding = prop === "width" ? current.wPadding : current.hPadding;
                value = now - padding;
                F.skin[prop](getScalar(prop === "width" ? value : value - wrapSpace * ratio));
                F.inner[prop](getScalar(prop === "width" ? value : value - wrapSpace * ratio - skinSpace * ratio))
            }
        },
        zoomIn: function() {
            var current = F.current,
                startPos = current.pos,
                effect = current.openEffect,
                elastic = effect === "elastic",
                endPos = $.extend({
                    opacity: 1
                }, startPos);
            delete endPos.position;
            if (elastic) {
                startPos = this.getOrigPosition();
                if (current.openOpacity) {
                    startPos.opacity = .1
                }
            } else if (effect === "fade") {
                startPos.opacity = .1
            }
            F.wrap.css(startPos).animate(endPos, {
                duration: effect === "none" ? 0 : current.openSpeed,
                easing: current.openEasing,
                step: elastic ? this.step : null,
                complete: F._afterZoomIn
            })
        },
        zoomOut: function() {
            var current = F.current,
                effect = current.closeEffect,
                elastic = effect === "elastic",
                endPos = {
                    opacity: .1
                };
            if (elastic) {
                endPos = this.getOrigPosition();
                if (current.closeOpacity) {
                    endPos.opacity = .1
                }
            }
            F.wrap.animate(endPos, {
                duration: effect === "none" ? 0 : current.closeSpeed,
                easing: current.closeEasing,
                step: elastic ? this.step : null,
                complete: F._afterZoomOut
            })
        },
        changeIn: function() {
            var current = F.current,
                effect = current.nextEffect,
                startPos = current.pos,
                endPos = {
                    opacity: 1
                },
                direction = F.direction,
                distance = 200,
                field;
            startPos.opacity = .1;
            if (effect === "elastic") {
                field = direction === "down" || direction === "up" ? "top" : "left";
                if (direction === "down" || direction === "right") {
                    startPos[field] = getValue(getScalar(startPos[field]) - distance);
                    endPos[field] = "+=" + distance + "px"
                } else {
                    startPos[field] = getValue(getScalar(startPos[field]) + distance);
                    endPos[field] = "-=" + distance + "px"
                }
            }
            if (effect === "none") {
                F._afterZoomIn()
            } else {
                F.wrap.css(startPos).animate(endPos, {
                    duration: current.nextSpeed,
                    easing: current.nextEasing,
                    complete: F._afterZoomIn
                })
            }
        },
        changeOut: function() {
            var previous = F.previous,
                effect = previous.prevEffect,
                endPos = {
                    opacity: .1
                },
                direction = F.direction,
                distance = 200;
            if (effect === "elastic") {
                endPos[direction === "down" || direction === "up" ? "top" : "left"] = (direction === "up" || direction === "left" ? "-" : "+") + "=" + distance + "px"
            }
            previous.wrap.animate(endPos, {
                duration: effect === "none" ? 0 : previous.prevSpeed,
                easing: previous.prevEasing,
                complete: function() {
                    $(this).trigger("onReset").remove()
                }
            })
        }
    };
    F.helpers.overlay = {
        defaults: {
            closeClick: true,
            speedOut: 200,
            showEarly: true,
            css: {},
            locked: !isTouch,
            fixed: true
        },
        overlay: null,
        fixed: false,
        el: $("html"),
        create: function(opts) {
            var parent;
            opts = $.extend({}, this.defaults, opts);
            if (this.overlay) {
                this.close()
            }
            parent = F.coming ? F.coming.parent : opts.parent;
            this.overlay = $('<div class="fancybox-overlay"></div>').appendTo(parent && parent.length ? parent : "body");
            this.fixed = false;
            if (opts.fixed && F.defaults.fixed) {
                this.overlay.addClass("fancybox-overlay-fixed");
                this.fixed = true
            }
        },
        open: function(opts) {
            var that = this;
            opts = $.extend({}, this.defaults, opts);
            if (this.overlay) {
                this.overlay.unbind(".overlay").width("auto").height("auto")
            } else {
                this.create(opts)
            }
            if (!this.fixed) {
                W.bind("resize.overlay", $.proxy(this.update, this));
                this.update()
            }
            if (opts.closeClick) {
                this.overlay.bind("click.overlay", function(e) {
                    if ($(e.target).hasClass("fancybox-overlay")) {
                        if (F.isActive) {
                            F.close()
                        } else {
                            that.close()
                        }
                        return false
                    }
                })
            }
            this.overlay.css(opts.css).show()
        },
        close: function() {
            W.unbind("resize.overlay");
            if (this.el.hasClass("fancybox-lock")) {
                $(".fancybox-margin").removeClass("fancybox-margin");
                this.el.removeClass("fancybox-lock");
                W.scrollTop(this.scrollV).scrollLeft(this.scrollH)
            }
            $(".fancybox-overlay").remove().hide();
            $.extend(this, {
                overlay: null,
                fixed: false
            })
        },
        update: function() {
            var width = "100%",
                offsetWidth;
            this.overlay.width(width).height("100%");
            if (IE) {
                offsetWidth = Math.max(document.documentElement.offsetWidth, document.body.offsetWidth);
                if (D.width() > offsetWidth) {
                    width = D.width()
                }
            } else if (D.width() > W.width()) {
                width = D.width()
            }
            this.overlay.width(width).height(D.height())
        },
        onReady: function(opts, obj) {
            var overlay = this.overlay;
            $(".fancybox-overlay").stop(true, true);
            if (!overlay) {
                this.create(opts)
            }
            if (opts.locked && this.fixed && obj.fixed) {
                obj.locked = this.overlay.append(obj.wrap);
                obj.fixed = false
            }
            if (opts.showEarly === true) {
                this.beforeShow.apply(this, arguments)
            }
        },
        beforeShow: function(opts, obj) {
            if (obj.locked && !this.el.hasClass("fancybox-lock")) {
                if (this.fixPosition !== false) {
                    $("*").filter(function() {
                        return $(this).css("position") === "fixed" && !$(this).hasClass("fancybox-overlay") && !$(this).hasClass("fancybox-wrap")
                    }).addClass("fancybox-margin")
                }
                this.el.addClass("fancybox-margin");
                this.scrollV = W.scrollTop();
                this.scrollH = W.scrollLeft();
                this.el.addClass("fancybox-lock");
                W.scrollTop(this.scrollV).scrollLeft(this.scrollH)
            }
            this.open(opts)
        },
        onUpdate: function() {
            if (!this.fixed) {
                this.update()
            }
        },
        afterClose: function(opts) {
            if (this.overlay && !F.coming) {
                this.overlay.fadeOut(opts.speedOut, $.proxy(this.close, this))
            }
        }
    };
    F.helpers.title = {
        defaults: {
            type: "float",
            position: "bottom"
        },
        beforeShow: function(opts) {
            var current = F.current,
                text = current.title,
                type = opts.type,
                title, target;
            if ($.isFunction(text)) {
                text = text.call(current.element, current)
            }
            if (!isString(text) || $.trim(text) === "") {
                return
            }
            title = $('<div class="fancybox-title fancybox-title-' + type + '-wrap">' + text + "</div>");
            switch (type) {
                case "inside":
                    target = F.skin;
                    break;
                case "outside":
                    target = F.wrap;
                    break;
                case "over":
                    target = F.inner;
                    break;
                default:
                    target = F.skin;
                    title.appendTo("body");
                    if (IE) {
                        title.width(title.width())
                    }
                    title.wrapInner('<span class="child"></span>');
                    F.current.margin[2] += Math.abs(getScalar(title.css("margin-bottom")));
                    break
            }
            title[opts.position === "top" ? "prependTo" : "appendTo"](target)
        }
    };
    $.fn.fancybox = function(options) {
        var index, that = $(this),
            selector = this.selector || "",
            run = function(e) {
                var what = $(this).blur(),
                    idx = index,
                    relType, relVal;
                if (!(e.ctrlKey || e.altKey || e.shiftKey || e.metaKey) && !what.is(".fancybox-wrap")) {
                    relType = options.groupAttr || "data-fancybox-group";
                    relVal = what.attr(relType);
                    if (!relVal) {
                        relType = "rel";
                        relVal = what.get(0)[relType]
                    }
                    if (relVal && relVal !== "" && relVal !== "nofollow") {
                        what = selector.length ? $(selector) : that;
                        what = what.filter("[" + relType + '="' + relVal + '"]');
                        idx = what.index(this)
                    }
                    options.index = idx;
                    if (F.open(what, options) !== false) {
                        e.preventDefault()
                    }
                }
            };
        options = options || {};
        index = options.index || 0;
        if (!selector || options.live === false) {
            that.unbind("click.fb-start").bind("click.fb-start", run)
        } else {
            D.undelegate(selector, "click.fb-start").delegate(selector + ":not('.fancybox-item, .fancybox-nav')", "click.fb-start", run)
        }
        this.filter("[data-fancybox-start=1]").trigger("click");
        return this
    };
    D.ready(function() {
        var w1, w2;
        if ($.scrollbarWidth === undefined) {
            $.scrollbarWidth = function() {
                var parent = $('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),
                    child = parent.children(),
                    width = child.innerWidth() - child.height(99).innerWidth();
                parent.remove();
                return width
            }
        }
        if ($.support.fixedPosition === undefined) {
            $.support.fixedPosition = function() {
                var elem = $('<div style="position:fixed;top:20px;"></div>').appendTo("body"),
                    fixed = elem[0].offsetTop === 20 || elem[0].offsetTop === 15;
                elem.remove();
                return fixed
            }()
        }
        $.extend(F.defaults, {
            scrollbarWidth: $.scrollbarWidth(),
            fixed: $.support.fixedPosition,
            parent: $("body")
        });
        w1 = $(window).width();
        H.addClass("fancybox-lock-test");
        w2 = $(window).width();
        H.removeClass("fancybox-lock-test");
        $("<style type='text/css'>.fancybox-margin{margin-right:" + (w2 - w1) + "px;}</style>").appendTo("head")
    })
})(window, document, jQuery);
! function(t, e) {
    "use strict";
    "function" == typeof define && define.amd ? define("jquery-bridget/jquery-bridget", ["jquery"], function(i) {
        e(t, i)
    }) : "object" == typeof module && module.exports ? module.exports = e(t, require("jquery")) : t.jQueryBridget = e(t, t.jQuery)
}(window, function(t, e) {
    "use strict";

    function i(i, r, a) {
        function h(t, e, n) {
            var o, r = "$()." + i + '("' + e + '")';
            return t.each(function(t, h) {
                var u = a.data(h, i);
                if (!u) return void s(i + " not initialized. Cannot call methods, i.e. " + r);
                var d = u[e];
                if (!d || "_" == e.charAt(0)) return void s(r + " is not a valid method");
                var c = d.apply(u, n);
                o = void 0 === o ? c : o
            }), void 0 !== o ? o : t
        }

        function u(t, e) {
            t.each(function(t, n) {
                var o = a.data(n, i);
                o ? (o.option(e), o._init()) : (o = new r(n, e), a.data(n, i, o))
            })
        }
        a = a || e || t.jQuery, a && (r.prototype.option || (r.prototype.option = function(t) {
            a.isPlainObject(t) && (this.options = a.extend(!0, this.options, t))
        }), a.fn[i] = function(t) {
            if ("string" == typeof t) {
                var e = o.call(arguments, 1);
                return h(this, t, e)
            }
            return u(this, t), this
        }, n(a))
    }

    function n(t) {
        !t || t && t.bridget || (t.bridget = i)
    }
    var o = Array.prototype.slice,
        r = t.console,
        s = "undefined" == typeof r ? function() {} : function(t) {
            r.error(t)
        };
    return n(e || t.jQuery), i
}),
function(t, e) {
    "function" == typeof define && define.amd ? define("ev-emitter/ev-emitter", e) : "object" == typeof module && module.exports ? module.exports = e() : t.EvEmitter = e()
}(this, function() {
    function t() {}
    var e = t.prototype;
    return e.on = function(t, e) {
        if (t && e) {
            var i = this._events = this._events || {},
                n = i[t] = i[t] || [];
            return -1 == n.indexOf(e) && n.push(e), this
        }
    }, e.once = function(t, e) {
        if (t && e) {
            this.on(t, e);
            var i = this._onceEvents = this._onceEvents || {},
                n = i[t] = i[t] || [];
            return n[e] = !0, this
        }
    }, e.off = function(t, e) {
        var i = this._events && this._events[t];
        if (i && i.length) {
            var n = i.indexOf(e);
            return -1 != n && i.splice(n, 1), this
        }
    }, e.emitEvent = function(t, e) {
        var i = this._events && this._events[t];
        if (i && i.length) {
            var n = 0,
                o = i[n];
            e = e || [];
            for (var r = this._onceEvents && this._onceEvents[t]; o;) {
                var s = r && r[o];
                s && (this.off(t, o), delete r[o]), o.apply(this, e), n += s ? 0 : 1, o = i[n]
            }
            return this
        }
    }, t
}),
function(t, e) {
    "use strict";
    "function" == typeof define && define.amd ? define("get-size/get-size", [], function() {
        return e()
    }) : "object" == typeof module && module.exports ? module.exports = e() : t.getSize = e()
}(window, function() {
    "use strict";

    function t(t) {
        var e = parseFloat(t),
            i = -1 == t.indexOf("%") && !isNaN(e);
        return i && e
    }

    function e() {}

    function i() {
        for (var t = {
                width: 0,
                height: 0,
                innerWidth: 0,
                innerHeight: 0,
                outerWidth: 0,
                outerHeight: 0
            }, e = 0; u > e; e++) {
            var i = h[e];
            t[i] = 0
        }
        return t
    }

    function n(t) {
        var e = getComputedStyle(t);
        return e || a("Style returned " + e + ". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"), e
    }

    function o() {
        if (!d) {
            d = !0;
            var e = document.createElement("div");
            e.style.width = "200px", e.style.padding = "1px 2px 3px 4px", e.style.borderStyle = "solid", e.style.borderWidth = "1px 2px 3px 4px", e.style.boxSizing = "border-box";
            var i = document.body || document.documentElement;
            i.appendChild(e);
            var o = n(e);
            r.isBoxSizeOuter = s = 200 == t(o.width), i.removeChild(e)
        }
    }

    function r(e) {
        if (o(), "string" == typeof e && (e = document.querySelector(e)), e && "object" == typeof e && e.nodeType) {
            var r = n(e);
            if ("none" == r.display) return i();
            var a = {};
            a.width = e.offsetWidth, a.height = e.offsetHeight;
            for (var d = a.isBorderBox = "border-box" == r.boxSizing, c = 0; u > c; c++) {
                var l = h[c],
                    f = r[l],
                    m = parseFloat(f);
                a[l] = isNaN(m) ? 0 : m
            }
            var p = a.paddingLeft + a.paddingRight,
                g = a.paddingTop + a.paddingBottom,
                y = a.marginLeft + a.marginRight,
                v = a.marginTop + a.marginBottom,
                _ = a.borderLeftWidth + a.borderRightWidth,
                E = a.borderTopWidth + a.borderBottomWidth,
                z = d && s,
                b = t(r.width);
            b !== !1 && (a.width = b + (z ? 0 : p + _));
            var x = t(r.height);
            return x !== !1 && (a.height = x + (z ? 0 : g + E)), a.innerWidth = a.width - (p + _), a.innerHeight = a.height - (g + E), a.outerWidth = a.width + y, a.outerHeight = a.height + v, a
        }
    }
    var s, a = "undefined" == typeof console ? e : function(t) {
            console.error(t)
        },
        h = ["paddingLeft", "paddingRight", "paddingTop", "paddingBottom", "marginLeft", "marginRight", "marginTop", "marginBottom", "borderLeftWidth", "borderRightWidth", "borderTopWidth", "borderBottomWidth"],
        u = h.length,
        d = !1;
    return r
}),
function(t, e) {
    "use strict";
    "function" == typeof define && define.amd ? define("matches-selector/matches-selector", e) : "object" == typeof module && module.exports ? module.exports = e() : t.matchesSelector = e()
}(window, function() {
    "use strict";
    var t = function() {
        var t = Element.prototype;
        if (t.matches) return "matches";
        if (t.matchesSelector) return "matchesSelector";
        for (var e = ["webkit", "moz", "ms", "o"], i = 0; i < e.length; i++) {
            var n = e[i],
                o = n + "MatchesSelector";
            if (t[o]) return o
        }
    }();
    return function(e, i) {
        return e[t](i)
    }
}),
function(t, e) {
    "use strict";
    "function" == typeof define && define.amd ? define("fizzy-ui-utils/utils", ["matches-selector/matches-selector"], function(i) {
        return e(t, i)
    }) : "object" == typeof module && module.exports ? module.exports = e(t, require("desandro-matches-selector")) : t.fizzyUIUtils = e(t, t.matchesSelector)
}(window, function(t, e) {
    var i = {};
    i.extend = function(t, e) {
        for (var i in e) t[i] = e[i];
        return t
    }, i.modulo = function(t, e) {
        return (t % e + e) % e
    }, i.makeArray = function(t) {
        var e = [];
        if (Array.isArray(t)) e = t;
        else if (t && "number" == typeof t.length)
            for (var i = 0; i < t.length; i++) e.push(t[i]);
        else e.push(t);
        return e
    }, i.removeFrom = function(t, e) {
        var i = t.indexOf(e); - 1 != i && t.splice(i, 1)
    }, i.getParent = function(t, i) {
        for (; t != document.body;)
            if (t = t.parentNode, e(t, i)) return t
    }, i.getQueryElement = function(t) {
        return "string" == typeof t ? document.querySelector(t) : t
    }, i.handleEvent = function(t) {
        var e = "on" + t.type;
        this[e] && this[e](t)
    }, i.filterFindElements = function(t, n) {
        t = i.makeArray(t);
        var o = [];
        return t.forEach(function(t) {
            if (t instanceof HTMLElement) {
                if (!n) return void o.push(t);
                e(t, n) && o.push(t);
                for (var i = t.querySelectorAll(n), r = 0; r < i.length; r++) o.push(i[r])
            }
        }), o
    }, i.debounceMethod = function(t, e, i) {
        var n = t.prototype[e],
            o = e + "Timeout";
        t.prototype[e] = function() {
            var t = this[o];
            t && clearTimeout(t);
            var e = arguments,
                r = this;
            this[o] = setTimeout(function() {
                n.apply(r, e), delete r[o]
            }, i || 100)
        }
    }, i.docReady = function(t) {
        "complete" == document.readyState ? t() : document.addEventListener("DOMContentLoaded", t)
    }, i.toDashed = function(t) {
        return t.replace(/(.)([A-Z])/g, function(t, e, i) {
            return e + "-" + i
        }).toLowerCase()
    };
    var n = t.console;
    return i.htmlInit = function(e, o) {
        i.docReady(function() {
            var r = i.toDashed(o),
                s = "data-" + r,
                a = document.querySelectorAll("[" + s + "]"),
                h = document.querySelectorAll(".js-" + r),
                u = i.makeArray(a).concat(i.makeArray(h)),
                d = s + "-options",
                c = t.jQuery;
            u.forEach(function(t) {
                var i, r = t.getAttribute(s) || t.getAttribute(d);
                try {
                    i = r && JSON.parse(r)
                } catch (a) {
                    return void(n && n.error("Error parsing " + s + " on " + t.className + ": " + a))
                }
                var h = new e(t, i);
                c && c.data(t, o, h)
            })
        })
    }, i
}),
function(t, e) {
    "function" == typeof define && define.amd ? define("outlayer/item", ["ev-emitter/ev-emitter", "get-size/get-size"], function(i, n) {
        return e(t, i, n)
    }) : "object" == typeof module && module.exports ? module.exports = e(t, require("ev-emitter"), require("get-size")) : (t.Outlayer = {}, t.Outlayer.Item = e(t, t.EvEmitter, t.getSize))
}(window, function(t, e, i) {
    "use strict";

    function n(t) {
        for (var e in t) return !1;
        return e = null, !0
    }

    function o(t, e) {
        t && (this.element = t, this.layout = e, this.position = {
            x: 0,
            y: 0
        }, this._create())
    }

    function r(t) {
        return t.replace(/([A-Z])/g, function(t) {
            return "-" + t.toLowerCase()
        })
    }
    var s = document.documentElement.style,
        a = "string" == typeof s.transition ? "transition" : "WebkitTransition",
        h = "string" == typeof s.transform ? "transform" : "WebkitTransform",
        u = {
            WebkitTransition: "webkitTransitionEnd",
            transition: "transitionend"
        }[a],
        d = [h, a, a + "Duration", a + "Property"],
        c = o.prototype = Object.create(e.prototype);
    c.constructor = o, c._create = function() {
        this._transn = {
            ingProperties: {},
            clean: {},
            onEnd: {}
        }, this.css({
            position: "absolute"
        })
    }, c.handleEvent = function(t) {
        var e = "on" + t.type;
        this[e] && this[e](t)
    }, c.getSize = function() {
        this.size = i(this.element)
    }, c.css = function(t) {
        var e = this.element.style;
        for (var i in t) {
            var n = d[i] || i;
            e[n] = t[i]
        }
    }, c.getPosition = function() {
        var t = getComputedStyle(this.element),
            e = this.layout._getOption("originLeft"),
            i = this.layout._getOption("originTop"),
            n = t[e ? "left" : "right"],
            o = t[i ? "top" : "bottom"],
            r = this.layout.size,
            s = -1 != n.indexOf("%") ? parseFloat(n) / 100 * r.width : parseInt(n, 10),
            a = -1 != o.indexOf("%") ? parseFloat(o) / 100 * r.height : parseInt(o, 10);
        s = isNaN(s) ? 0 : s, a = isNaN(a) ? 0 : a, s -= e ? r.paddingLeft : r.paddingRight, a -= i ? r.paddingTop : r.paddingBottom, this.position.x = s, this.position.y = a
    }, c.layoutPosition = function() {
        var t = this.layout.size,
            e = {},
            i = this.layout._getOption("originLeft"),
            n = this.layout._getOption("originTop"),
            o = i ? "paddingLeft" : "paddingRight",
            r = i ? "left" : "right",
            s = i ? "right" : "left",
            a = this.position.x + t[o];
        e[r] = this.getXValue(a), e[s] = "";
        var h = n ? "paddingTop" : "paddingBottom",
            u = n ? "top" : "bottom",
            d = n ? "bottom" : "top",
            c = this.position.y + t[h];
        e[u] = this.getYValue(c), e[d] = "", this.css(e), this.emitEvent("layout", [this])
    }, c.getXValue = function(t) {
        var e = this.layout._getOption("horizontal");
        return this.layout.options.percentPosition && !e ? t / this.layout.size.width * 100 + "%" : t + "px"
    }, c.getYValue = function(t) {
        var e = this.layout._getOption("horizontal");
        return this.layout.options.percentPosition && e ? t / this.layout.size.height * 100 + "%" : t + "px"
    }, c._transitionTo = function(t, e) {
        this.getPosition();
        var i = this.position.x,
            n = this.position.y,
            o = parseInt(t, 10),
            r = parseInt(e, 10),
            s = o === this.position.x && r === this.position.y;
        if (this.setPosition(t, e), s && !this.isTransitioning) return void this.layoutPosition();
        var a = t - i,
            h = e - n,
            u = {};
        u.transform = this.getTranslate(a, h), this.transition({
            to: u,
            onTransitionEnd: {
                transform: this.layoutPosition
            },
            isCleaning: !0
        })
    }, c.getTranslate = function(t, e) {
        var i = this.layout._getOption("originLeft"),
            n = this.layout._getOption("originTop");
        return t = i ? t : -t, e = n ? e : -e, "translate3d(" + t + "px, " + e + "px, 0)"
    }, c.goTo = function(t, e) {
        this.setPosition(t, e), this.layoutPosition()
    }, c.moveTo = c._transitionTo, c.setPosition = function(t, e) {
        this.position.x = parseInt(t, 10), this.position.y = parseInt(e, 10)
    }, c._nonTransition = function(t) {
        this.css(t.to), t.isCleaning && this._removeStyles(t.to);
        for (var e in t.onTransitionEnd) t.onTransitionEnd[e].call(this)
    }, c._transition = function(t) {
        if (!parseFloat(this.layout.options.transitionDuration)) return void this._nonTransition(t);
        var e = this._transn;
        for (var i in t.onTransitionEnd) e.onEnd[i] = t.onTransitionEnd[i];
        for (i in t.to) e.ingProperties[i] = !0, t.isCleaning && (e.clean[i] = !0);
        if (t.from) {
            this.css(t.from);
            var n = this.element.offsetHeight;
            n = null
        }
        this.enableTransition(t.to), this.css(t.to), this.isTransitioning = !0
    };
    var l = "opacity," + r(d.transform || "transform");
    c.enableTransition = function() {
        this.isTransitioning || (this.css({
            transitionProperty: l,
            transitionDuration: this.layout.options.transitionDuration
        }), this.element.addEventListener(u, this, !1))
    }, c.transition = o.prototype[a ? "_transition" : "_nonTransition"], c.onwebkitTransitionEnd = function(t) {
        this.ontransitionend(t)
    }, c.onotransitionend = function(t) {
        this.ontransitionend(t)
    };
    var f = {
        "-webkit-transform": "transform"
    };
    c.ontransitionend = function(t) {
        if (t.target === this.element) {
            var e = this._transn,
                i = f[t.propertyName] || t.propertyName;
            if (delete e.ingProperties[i], n(e.ingProperties) && this.disableTransition(), i in e.clean && (this.element.style[t.propertyName] = "", delete e.clean[i]), i in e.onEnd) {
                var o = e.onEnd[i];
                o.call(this), delete e.onEnd[i]
            }
            this.emitEvent("transitionEnd", [this])
        }
    }, c.disableTransition = function() {
        this.removeTransitionStyles(), this.element.removeEventListener(u, this, !1), this.isTransitioning = !1
    }, c._removeStyles = function(t) {
        var e = {};
        for (var i in t) e[i] = "";
        this.css(e)
    };
    var m = {
        transitionProperty: "",
        transitionDuration: ""
    };
    return c.removeTransitionStyles = function() {
        this.css(m)
    }, c.removeElem = function() {
        this.element.parentNode.removeChild(this.element), this.css({
            display: ""
        }), this.emitEvent("remove", [this])
    }, c.remove = function() {
        return a && parseFloat(this.layout.options.transitionDuration) ? (this.once("transitionEnd", function() {
            this.removeElem()
        }), void this.hide()) : void this.removeElem()
    }, c.reveal = function() {
        delete this.isHidden, this.css({
            display: ""
        });
        var t = this.layout.options,
            e = {},
            i = this.getHideRevealTransitionEndProperty("visibleStyle");
        e[i] = this.onRevealTransitionEnd, this.transition({
            from: t.hiddenStyle,
            to: t.visibleStyle,
            isCleaning: !0,
            onTransitionEnd: e
        })
    }, c.onRevealTransitionEnd = function() {
        this.isHidden || this.emitEvent("reveal")
    }, c.getHideRevealTransitionEndProperty = function(t) {
        var e = this.layout.options[t];
        if (e.opacity) return "opacity";
        for (var i in e) return i
    }, c.hide = function() {
        this.isHidden = !0, this.css({
            display: ""
        });
        var t = this.layout.options,
            e = {},
            i = this.getHideRevealTransitionEndProperty("hiddenStyle");
        e[i] = this.onHideTransitionEnd, this.transition({
            from: t.visibleStyle,
            to: t.hiddenStyle,
            isCleaning: !0,
            onTransitionEnd: e
        })
    }, c.onHideTransitionEnd = function() {
        this.isHidden && (this.css({
            display: "none"
        }), this.emitEvent("hide"))
    }, c.destroy = function() {
        this.css({
            position: "",
            left: "",
            right: "",
            top: "",
            bottom: "",
            transition: "",
            transform: ""
        })
    }, o
}),
function(t, e) {
    "use strict";
    "function" == typeof define && define.amd ? define("outlayer/outlayer", ["ev-emitter/ev-emitter", "get-size/get-size", "fizzy-ui-utils/utils", "./item"], function(i, n, o, r) {
        return e(t, i, n, o, r)
    }) : "object" == typeof module && module.exports ? module.exports = e(t, require("ev-emitter"), require("get-size"), require("fizzy-ui-utils"), require("./item")) : t.Outlayer = e(t, t.EvEmitter, t.getSize, t.fizzyUIUtils, t.Outlayer.Item)
}(window, function(t, e, i, n, o) {
    "use strict";

    function r(t, e) {
        var i = n.getQueryElement(t);
        if (!i) return void(a && a.error("Bad element for " + this.constructor.namespace + ": " + (i || t)));
        this.element = i, h && (this.$element = h(this.element)), this.options = n.extend({}, this.constructor.defaults), this.option(e);
        var o = ++d;
        this.element.outlayerGUID = o, c[o] = this, this._create();
        var r = this._getOption("initLayout");
        r && this.layout()
    }

    function s(t) {
        function e() {
            t.apply(this, arguments)
        }
        return e.prototype = Object.create(t.prototype), e.prototype.constructor = e, e
    }
    var a = t.console,
        h = t.jQuery,
        u = function() {},
        d = 0,
        c = {};
    r.namespace = "outlayer", r.Item = o, r.defaults = {
        containerStyle: {
            position: "relative"
        },
        initLayout: !0,
        originLeft: !0,
        originTop: !0,
        resize: !0,
        resizeContainer: !0,
        transitionDuration: "0.4s",
        hiddenStyle: {
            opacity: 0,
            transform: "scale(0.001)"
        },
        visibleStyle: {
            opacity: 1,
            transform: "scale(1)"
        }
    };
    var l = r.prototype;
    return n.extend(l, e.prototype), l.option = function(t) {
        n.extend(this.options, t)
    }, l._getOption = function(t) {
        var e = this.constructor.compatOptions[t];
        return e && void 0 !== this.options[e] ? this.options[e] : this.options[t]
    }, r.compatOptions = {
        initLayout: "isInitLayout",
        horizontal: "isHorizontal",
        layoutInstant: "isLayoutInstant",
        originLeft: "isOriginLeft",
        originTop: "isOriginTop",
        resize: "isResizeBound",
        resizeContainer: "isResizingContainer"
    }, l._create = function() {
        this.reloadItems(), this.stamps = [], this.stamp(this.options.stamp), n.extend(this.element.style, this.options.containerStyle);
        var t = this._getOption("resize");
        t && this.bindResize()
    }, l.reloadItems = function() {
        this.items = this._itemize(this.element.children)
    }, l._itemize = function(t) {
        for (var e = this._filterFindItemElements(t), i = this.constructor.Item, n = [], o = 0; o < e.length; o++) {
            var r = e[o],
                s = new i(r, this);
            n.push(s)
        }
        return n
    }, l._filterFindItemElements = function(t) {
        return n.filterFindElements(t, this.options.itemSelector)
    }, l.getItemElements = function() {
        return this.items.map(function(t) {
            return t.element
        })
    }, l.layout = function() {
        this._resetLayout(), this._manageStamps();
        var t = this._getOption("layoutInstant"),
            e = void 0 !== t ? t : !this._isLayoutInited;
        this.layoutItems(this.items, e), this._isLayoutInited = !0
    }, l._init = l.layout, l._resetLayout = function() {
        this.getSize()
    }, l.getSize = function() {
        this.size = i(this.element)
    }, l._getMeasurement = function(t, e) {
        var n, o = this.options[t];
        o ? ("string" == typeof o ? n = this.element.querySelector(o) : o instanceof HTMLElement && (n = o), this[t] = n ? i(n)[e] : o) : this[t] = 0
    }, l.layoutItems = function(t, e) {
        t = this._getItemsForLayout(t), this._layoutItems(t, e), this._postLayout()
    }, l._getItemsForLayout = function(t) {
        return t.filter(function(t) {
            return !t.isIgnored
        })
    }, l._layoutItems = function(t, e) {
        if (this._emitCompleteOnItems("layout", t), t && t.length) {
            var i = [];
            t.forEach(function(t) {
                var n = this._getItemLayoutPosition(t);
                n.item = t, n.isInstant = e || t.isLayoutInstant, i.push(n)
            }, this), this._processLayoutQueue(i)
        }
    }, l._getItemLayoutPosition = function() {
        return {
            x: 0,
            y: 0
        }
    }, l._processLayoutQueue = function(t) {
        t.forEach(function(t) {
            this._positionItem(t.item, t.x, t.y, t.isInstant)
        }, this)
    }, l._positionItem = function(t, e, i, n) {
        n ? t.goTo(e, i) : t.moveTo(e, i)
    }, l._postLayout = function() {
        this.resizeContainer()
    }, l.resizeContainer = function() {
        var t = this._getOption("resizeContainer");
        if (t) {
            var e = this._getContainerSize();
            e && (this._setContainerMeasure(e.width, !0), this._setContainerMeasure(e.height, !1))
        }
    }, l._getContainerSize = u, l._setContainerMeasure = function(t, e) {
        if (void 0 !== t) {
            var i = this.size;
            i.isBorderBox && (t += e ? i.paddingLeft + i.paddingRight + i.borderLeftWidth + i.borderRightWidth : i.paddingBottom + i.paddingTop + i.borderTopWidth + i.borderBottomWidth), t = Math.max(t, 0), this.element.style[e ? "width" : "height"] = t + "px"
        }
    }, l._emitCompleteOnItems = function(t, e) {
        function i() {
            o.dispatchEvent(t + "Complete", null, [e])
        }

        function n() {
            s++, s == r && i()
        }
        var o = this,
            r = e.length;
        if (!e || !r) return void i();
        var s = 0;
        e.forEach(function(e) {
            e.once(t, n)
        })
    }, l.dispatchEvent = function(t, e, i) {
        var n = e ? [e].concat(i) : i;
        if (this.emitEvent(t, n), h)
            if (this.$element = this.$element || h(this.element), e) {
                var o = h.Event(e);
                o.type = t, this.$element.trigger(o, i)
            } else this.$element.trigger(t, i)
    }, l.ignore = function(t) {
        var e = this.getItem(t);
        e && (e.isIgnored = !0)
    }, l.unignore = function(t) {
        var e = this.getItem(t);
        e && delete e.isIgnored
    }, l.stamp = function(t) {
        t = this._find(t), t && (this.stamps = this.stamps.concat(t), t.forEach(this.ignore, this))
    }, l.unstamp = function(t) {
        t = this._find(t), t && t.forEach(function(t) {
            n.removeFrom(this.stamps, t), this.unignore(t)
        }, this)
    }, l._find = function(t) {
        return t ? ("string" == typeof t && (t = this.element.querySelectorAll(t)), t = n.makeArray(t)) : void 0
    }, l._manageStamps = function() {
        this.stamps && this.stamps.length && (this._getBoundingRect(), this.stamps.forEach(this._manageStamp, this))
    }, l._getBoundingRect = function() {
        var t = this.element.getBoundingClientRect(),
            e = this.size;
        this._boundingRect = {
            left: t.left + e.paddingLeft + e.borderLeftWidth,
            top: t.top + e.paddingTop + e.borderTopWidth,
            right: t.right - (e.paddingRight + e.borderRightWidth),
            bottom: t.bottom - (e.paddingBottom + e.borderBottomWidth)
        }
    }, l._manageStamp = u, l._getElementOffset = function(t) {
        var e = t.getBoundingClientRect(),
            n = this._boundingRect,
            o = i(t),
            r = {
                left: e.left - n.left - o.marginLeft,
                top: e.top - n.top - o.marginTop,
                right: n.right - e.right - o.marginRight,
                bottom: n.bottom - e.bottom - o.marginBottom
            };
        return r
    }, l.handleEvent = n.handleEvent, l.bindResize = function() {
        t.addEventListener("resize", this), this.isResizeBound = !0
    }, l.unbindResize = function() {
        t.removeEventListener("resize", this), this.isResizeBound = !1
    }, l.onresize = function() {
        this.resize()
    }, n.debounceMethod(r, "onresize", 100), l.resize = function() {
        this.isResizeBound && this.needsResizeLayout() && this.layout()
    }, l.needsResizeLayout = function() {
        var t = i(this.element),
            e = this.size && t;
        return e && t.innerWidth !== this.size.innerWidth
    }, l.addItems = function(t) {
        var e = this._itemize(t);
        return e.length && (this.items = this.items.concat(e)), e
    }, l.appended = function(t) {
        var e = this.addItems(t);
        e.length && (this.layoutItems(e, !0), this.reveal(e))
    }, l.prepended = function(t) {
        var e = this._itemize(t);
        if (e.length) {
            var i = this.items.slice(0);
            this.items = e.concat(i), this._resetLayout(), this._manageStamps(), this.layoutItems(e, !0), this.reveal(e), this.layoutItems(i)
        }
    }, l.reveal = function(t) {
        this._emitCompleteOnItems("reveal", t), t && t.length && t.forEach(function(t) {
            t.reveal()
        })
    }, l.hide = function(t) {
        this._emitCompleteOnItems("hide", t), t && t.length && t.forEach(function(t) {
            t.hide()
        })
    }, l.revealItemElements = function(t) {
        var e = this.getItems(t);
        this.reveal(e)
    }, l.hideItemElements = function(t) {
        var e = this.getItems(t);
        this.hide(e)
    }, l.getItem = function(t) {
        for (var e = 0; e < this.items.length; e++) {
            var i = this.items[e];
            if (i.element == t) return i
        }
    }, l.getItems = function(t) {
        t = n.makeArray(t);
        var e = [];
        return t.forEach(function(t) {
            var i = this.getItem(t);
            i && e.push(i)
        }, this), e
    }, l.remove = function(t) {
        var e = this.getItems(t);
        this._emitCompleteOnItems("remove", e), e && e.length && e.forEach(function(t) {
            t.remove(), n.removeFrom(this.items, t)
        }, this)
    }, l.destroy = function() {
        var t = this.element.style;
        t.height = "", t.position = "", t.width = "", this.items.forEach(function(t) {
            t.destroy()
        }), this.unbindResize();
        var e = this.element.outlayerGUID;
        delete c[e], delete this.element.outlayerGUID, h && h.removeData(this.element, this.constructor.namespace)
    }, r.data = function(t) {
        t = n.getQueryElement(t);
        var e = t && t.outlayerGUID;
        return e && c[e]
    }, r.create = function(t, e) {
        var i = s(r);
        return i.defaults = n.extend({}, r.defaults), n.extend(i.defaults, e), i.compatOptions = n.extend({}, r.compatOptions), i.namespace = t, i.data = r.data, i.Item = s(o), n.htmlInit(i, t), h && h.bridget && h.bridget(t, i), i
    }, r.Item = o, r
}),
function(t, e) {
    "function" == typeof define && define.amd ? define(["outlayer/outlayer", "get-size/get-size"], e) : "object" == typeof module && module.exports ? module.exports = e(require("outlayer"), require("get-size")) : t.Masonry = e(t.Outlayer, t.getSize)
}(window, function(t, e) {
    var i = t.create("masonry");
    return i.compatOptions.fitWidth = "isFitWidth", i.prototype._resetLayout = function() {
        this.getSize(), this._getMeasurement("columnWidth", "outerWidth"), this._getMeasurement("gutter", "outerWidth"), this.measureColumns(), this.colYs = [];
        for (var t = 0; t < this.cols; t++) this.colYs.push(0);
        this.maxY = 0
    }, i.prototype.measureColumns = function() {
        if (this.getContainerWidth(), !this.columnWidth) {
            var t = this.items[0],
                i = t && t.element;
            this.columnWidth = i && e(i).outerWidth || this.containerWidth
        }
        var n = this.columnWidth += this.gutter,
            o = this.containerWidth + this.gutter,
            r = o / n,
            s = n - o % n,
            a = s && 1 > s ? "round" : "floor";
        r = Math[a](r), this.cols = Math.max(r, 1)
    }, i.prototype.getContainerWidth = function() {
        var t = this._getOption("fitWidth"),
            i = t ? this.element.parentNode : this.element,
            n = e(i);
        this.containerWidth = n && n.innerWidth
    }, i.prototype._getItemLayoutPosition = function(t) {
        t.getSize();
        var e = t.size.outerWidth % this.columnWidth,
            i = e && 1 > e ? "round" : "ceil",
            n = Math[i](t.size.outerWidth / this.columnWidth);
        n = Math.min(n, this.cols);
        for (var o = this._getColGroup(n), r = Math.min.apply(Math, o), s = o.indexOf(r), a = {
                x: this.columnWidth * s,
                y: r
            }, h = r + t.size.outerHeight, u = this.cols + 1 - o.length, d = 0; u > d; d++) this.colYs[s + d] = h;
        return a
    }, i.prototype._getColGroup = function(t) {
        if (2 > t) return this.colYs;
        for (var e = [], i = this.cols + 1 - t, n = 0; i > n; n++) {
            var o = this.colYs.slice(n, n + t);
            e[n] = Math.max.apply(Math, o)
        }
        return e
    }, i.prototype._manageStamp = function(t) {
        var i = e(t),
            n = this._getElementOffset(t),
            o = this._getOption("originLeft"),
            r = o ? n.left : n.right,
            s = r + i.outerWidth,
            a = Math.floor(r / this.columnWidth);
        a = Math.max(0, a);
        var h = Math.floor(s / this.columnWidth);
        h -= s % this.columnWidth ? 0 : 1, h = Math.min(this.cols - 1, h);
        for (var u = this._getOption("originTop"), d = (u ? n.top : n.bottom) + i.outerHeight, c = a; h >= c; c++) this.colYs[c] = Math.max(d, this.colYs[c])
    }, i.prototype._getContainerSize = function() {
        this.maxY = Math.max.apply(Math, this.colYs);
        var t = {
            height: this.maxY
        };
        return this._getOption("fitWidth") && (t.width = this._getContainerFitWidth()), t
    }, i.prototype._getContainerFitWidth = function() {
        for (var t = 0, e = this.cols; --e && 0 === this.colYs[e];) t++;
        return (this.cols - t) * this.columnWidth - this.gutter
    }, i.prototype.needsResizeLayout = function() {
        var t = this.containerWidth;
        return this.getContainerWidth(), t != this.containerWidth
    }, i
});
(function($) {
    $.fn.iframeTracker = function(handler) {
        var target = this.get();
        if (handler === null || handler === false) {
            $.iframeTracker.untrack(target)
        } else if (typeof handler == "object") {
            $.iframeTracker.track(target, handler)
        } else {
            throw new Error("Wrong handler type (must be an object, or null|false to untrack)")
        }
    };
    $.iframeTracker = {
        focusRetriever: null,
        focusRetrieved: false,
        handlersList: [],
        isIE8AndOlder: false,
        init: function() {
            try {
                if ($.browser.msie == true && $.browser.version < 9) {
                    this.isIE8AndOlder = true
                }
            } catch (ex) {
                try {
                    var matches = navigator.userAgent.match(/(msie) ([\w.]+)/i);
                    if (matches[2] < 9) {
                        this.isIE8AndOlder = true
                    }
                } catch (ex2) {}
            }
            $(window).focus();
            $(window).blur(function(e) {
                $.iframeTracker.windowLoseFocus(e)
            });
            $("body").append('<div style="position:fixed; top:0; left:0; overflow:hidden;"><input style="position:absolute; left:-300px;" type="text" value="" id="focus_retriever" readonly="true" /></div>');
            this.focusRetriever = $("#focus_retriever");
            this.focusRetrieved = false;
            $(document).mousemove(function(e) {
                if (document.activeElement && document.activeElement.tagName == "IFRAME") {
                    $.iframeTracker.focusRetriever.focus();
                    $.iframeTracker.focusRetrieved = true
                }
            });
            if (this.isIE8AndOlder) {
                this.focusRetriever.blur(function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                    $.iframeTracker.windowLoseFocus(e)
                });
                $("body").click(function(e) {
                    $(window).focus()
                });
                $("form").click(function(e) {
                    e.stopPropagation()
                });
                try {
                    $("body").on("click", "form", function(e) {
                        e.stopPropagation()
                    })
                } catch (ex) {
                    console.log("[iframeTracker] Please update jQuery to 1.7 or newer. (exception: " + ex.message + ")")
                }
            }
        },
        track: function(target, handler) {
            handler.target = target;
            $.iframeTracker.handlersList.push(handler);
            $(target).bind("mouseover", {
                handler: handler
            }, $.iframeTracker.mouseoverListener).bind("mouseout", {
                handler: handler
            }, $.iframeTracker.mouseoutListener)
        },
        untrack: function(target) {
            if (typeof Array.prototype.filter != "function") {
                console.log("Your browser doesn't support Array filter, untrack disabled");
                return
            }
            $(target).each(function(index) {
                $(this).unbind("mouseover", $.iframeTracker.mouseoverListener).unbind("mouseout", $.iframeTracker.mouseoutListener)
            });
            var nullFilter = function(value) {
                return value === null ? false : true
            };
            for (var i in this.handlersList) {
                for (var j in this.handlersList[i].target) {
                    if ($.inArray(this.handlersList[i].target[j], target) !== -1) {
                        this.handlersList[i].target[j] = null
                    }
                }
                this.handlersList[i].target = this.handlersList[i].target.filter(nullFilter);
                if (this.handlersList[i].target.length == 0) {
                    this.handlersList[i] = null
                }
            }
            this.handlersList = this.handlersList.filter(nullFilter)
        },
        mouseoverListener: function(e) {
            e.data.handler.over = true;
            try {
                e.data.handler.overCallback(this)
            } catch (ex) {}
        },
        mouseoutListener: function(e) {
            e.data.handler.over = false;
            $.iframeTracker.focusRetriever.focus();
            try {
                e.data.handler.outCallback(this)
            } catch (ex) {}
        },
        windowLoseFocus: function(event) {
            for (var i in this.handlersList) {
                if (this.handlersList[i].over == true) {
                    try {
                        this.handlersList[i].blurCallback()
                    } catch (ex) {}
                }
            }
        }
    };
    $(document).ready(function() {
        $.iframeTracker.init()
    })
})(jQuery);
"use strict";
Function.prototype.debounce = function(ms) {
    var timer = 0;
    var callback = this;
    return function() {
        clearTimeout(timer);
        timer = setTimeout(callback, ms)
    }
};
"use strict";
if (window.App == null) {
    window.App = {}
}
App.getClass = function(obj) {
    return {}.toString.call(obj).slice(8, -1)
};
"use strict";
if (window.App == null) {
    window.App = {}
}
App.removeClass = function(element, rmClass) {
    var classes = element.className.split(" ");
    for (var i = 0; i < classes.length; i++) {
        if (classes[i] === rmClass) {
            classes.splice(i, 1);
            i--
        }
    }
    element.className = classes.join(" ")
};
"use strict";
if (window.App == null) {
    window.App = {}
}
App.hasClass = function(element, hClass) {
    var classes = element.className.split(" ");
    for (var i = 0; i < classes.length; i++) {
        if (classes[i] === hClass) {
            return true
        }
    }
};
"use strict";
if (window.App == null) {
    window.App = {}
}
App.error = function(data) {
    output();

    function output() {
        var from = data.from || "Not From";
        var message = data.message || "Not message";
        console.error("Function: " + from + ";" + " Message: " + message)
    }
};
"use strict";
if (window.App == null) {
    window.App = {}
}

function Alert() {
    var storage = [];
    this._frozen = false;
    this.push = function(data) {
        if (this._frozen) {
            return this
        }
        var constructorClass = App.getClass(data);
        if (constructorClass === "Object") {
            storage.push(data)
        } else if (constructorClass === "Array") {
            data.forEach(function(current) {
                storage.push(current)
            })
        } else {
            App.error({
                from: "Alert",
                message: constructorClass + " ??? N??N?N????!"
            })
        }
        return this
    };
    this.call = function() {
        if (storage.length > 0) {
            make(storage[0])
        }

        function make(storageData) {
            var type = storageData.type;
            var message = storageData.message || "??????????????????";
            var duration = storageData.duration || 3e3;
            var types = ["success", "info", "danger", "warning"];
            if (types.indexOf(storageData.type) < 0) type = "info";
            var $wrapper = $(".wrapper-alert").empty();
            var $alert = $('<div class="flipInX animated alert alert-' + type + ' ">' + message + "</div>");
            $wrapper.append($alert);
            setTimeout(function() {
                $alert.removeClass("animated").fadeOut(500, function() {
                    $alert.remove();
                    storage.shift();
                    if (storage.length > 0) {
                        make(storage[0])
                    }
                })
            }, duration)
        }
        return this
    };
    this.frozenStream = function(time) {
        this._frozen = true;
        if (time) {
            setTimeout(function() {
                this._frozen = false
            }.bind(this), time)
        }
    };
    this.getStorage = function() {
        return storage
    };
    this.clearStorage = function() {
        storage = [];
        return this
    }
}
App.alert = new Alert;
"use strict";
if (window.App == null) {
    window.App = {}
}
App.sideMenu = function(where) {
    var statusCreate = false;
    var $collectionTitle = $(".content-static-page").find("h2, h3");
    var $sideMenuWrapper = $('<div class="block-side-menu js-block-side-menu"></div>');
    $collectionTitle.each(function(index) {
        var $self = $(this);
        var tagName = $self[0].tagName.toLowerCase();
        var text = $self.text();
        if (!text || !tagName) return;
        var $sideMenuItem = $('<a class="js-scroll-navigation side-menu__item side-menu__type-' + tagName + '" href="#title-marker-' + index + '">' + text + "</a>");
        $self.attr("id", "title-marker-" + index);
        $sideMenuWrapper.append($sideMenuItem)
    });
    if (where.length > 0) {
        $sideMenuWrapper.prependTo(where).animate({
            opacity: 1
        }, 600);
        statusCreate = true
    }
    return statusCreate
};
"use strict";
if (window.App == null) {
    window.App = {}
}

function LocalStorage() {
    this.set = function(property, value) {
        value = value || {};
        var valueJSON = JSON.stringify(value);
        localStorage.setItem(property, valueJSON)
    };
    this.get = function(property) {
        var object = localStorage.getItem(property);
        return object == null ? null : JSON.parse(object)
    };
    this.remove = function(property) {
        localStorage.removeItem(property)
    }
}
App.localStorage = new LocalStorage;
"use strict";
if (window.App == null) {
    window.App = {}
}
App.Tabs = function(container) {
    var controls = container.querySelectorAll(".js-tab-control");
    var contents = container.querySelectorAll(".js-tab-content");
    container.addEventListener("click", function(event) {
        var target = event.target;
        while (target != container) {
            if (App.hasClass(target, "js-tab-control")) {
                var id = target.getAttribute("data-tabs-control-id");
                event.preventDefault();
                if (id == null) {
                    return
                }
                toggleVisibleContent(id);
                toggleActiveTabs(target)
            }
            target = target.parentNode
        }
    });

    function toggleVisibleContent(id) {
        var currendId;
        var i;
        for (i = 0; i < contents.length; i++) {
            currendId = contents[i].getAttribute("data-tabs-content-id");
            App.removeClass(contents[i], "active");
            if (currendId == id) {
                contents[i].className += " active "
            }
        }
    }

    function toggleActiveTabs(target) {
        for (var i = 0; i < controls.length; i++) {
            App.removeClass(controls[i], "active")
        }
        $(target).addClass("active")
    }
};
"use strict";
if (window.App == null) {
    window.App = {}
}

function Metric() {}
Metric.prototype.send = function(parameters) {
    if (!parameters.service) {
        console.error("?Y?N????NN service ??? ??????N ?NNN? ??N?N?NN??!");
        return
    }
    this._serviceController("send", parameters)
};
Metric.prototype._serviceController = function(type, parameters) {
    var service = parameters.service;
    switch (service) {
        case "ga":
            this._googleAnalytics(type, parameters);
            break;
        case "ya":
            this._yandex(type, parameters);
            break;
        default:
            console.error(service + " ??? ?????????N???????NN?N?!")
    }
};
Metric.prototype._googleAnalytics = function(type, parameters) {
    console.log(parameters);
    if (parameters.type === "social") {
        ga(type, {
            hitType: parameters.type,
            socialNetwork: parameters.category,
            socialAction: parameters.action,
            socialTarget: parameters.url
        })
    } else if (parameters.type === "pageview") {
        ga(type, parameters.type, parameters.virtual)
    } else {
        ga(type, {
            hitType: parameters.type,
            eventCategory: parameters.category,
            eventAction: parameters.action,
            eventLabel: parameters.url
        })
    }
};
Metric.prototype._yandex = function() {
    console.warn("Yandex Metric empty!")
};
App.Metric = new Metric;
"use strict";
if (window.App == null) {
    window.App = {}
}
App.Cookies = {
    set: function(name, value, days, path) {
        if (days) {
            var date = new Date;
            date.setTime(date.getTime() + days * 24 * 60 * 60 * 1e3);
            var expires = "; expires=" + date
        } else var expires = "";
        var dir = path || "/";
        document.cookie = name + "=" + value + expires + "; path=" + dir
    },
    get: function(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(";");
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == " ") c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length)
        }
        return null
    },
    delete: function(name) {
        this.set(name, "", -1)
    },
    isEnable: function() {
        var enabledCookie = false;
        this.set("is_enabled_cookie", "on", 1, "/");
        if (this.get("is_enabled_cookie")) {
            enabledCookie = true
        }
        this.delete("is_enabled_cookie");
        return enabledCookie
    }
};
"use strict";
var _createClass = function() {
    function defineProperties(target, props) {
        for (var i = 0; i < props.length; i++) {
            var descriptor = props[i];
            descriptor.enumerable = descriptor.enumerable || false;
            descriptor.configurable = true;
            if ("value" in descriptor) descriptor.writable = true;
            Object.defineProperty(target, descriptor.key, descriptor)
        }
    }
    return function(Constructor, protoProps, staticProps) {
        if (protoProps) defineProperties(Constructor.prototype, protoProps);
        if (staticProps) defineProperties(Constructor, staticProps);
        return Constructor
    }
}();

function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function")
    }
}
var CountDown = function() {
    function CountDown(options) {
        _classCallCheck(this, CountDown);
        this.minutes = options.minutes;
        this.seconds = options.seconds;
        this.timeIsOver = options.timeIsOver;
        this.renderElement
    }
    _createClass(CountDown, [{
        key: "render",
        value: function render(element) {
            if (element) {
                this.renderElement = element;
                this._renderHTML()
            }
            return this
        }
    }, {
        key: "start",
        value: function start() {
            this._tick();
            return this
        }
    }, {
        key: "_renderHTML",
        value: function _renderHTML() {
            var minutes = this.minutes;
            var seconds = this.seconds;
            if (this.minutes < 10) {
                minutes = "0" + this.minutes;
            }
            if (this.seconds < 10) {
                seconds = "0" + this.seconds
            }
            var result = minutes + ":" + seconds;
            this.renderElement.innerHTML = result
        }
    }, {
        key: "_tick",
        value: function _tick() {
            var _this = this;
            this.seconds--;
            if (this.seconds < 0) {
                this.seconds = 59;
                this.minutes--
            }
            if (this.minutes >= 0 && this.seconds >= 0) {
                setTimeout(function() {
                    _this._renderHTML();
                    _this._tick()
                }, 1e3)
            } else {
                if (typeof _this.timeIsOver === "function") {
                    _this.timeIsOver()
                }
            }
        }
    }]);
    return CountDown
}();
"use strict";
if (window.App == null) {
    window.App = {}
}
App.isMobile = {
    Android: function() {
        return navigator.userAgent.match(/Android/i)
    },
    BlackBerry: function() {
        return navigator.userAgent.match(/BlackBerry/i)
    },
    iOS: function() {
        return navigator.userAgent.match(/iPhone|iPad|iPod/i)
    },
    Opera: function() {
        return navigator.userAgent.match(/Opera Mini/i)
    },
    Windows: function() {
        return navigator.userAgent.match(/IEMobile/i) || navigator.userAgent.match(/WPDesktop/i)
    },
    any: function() {
        return isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows()
    }
};
"use strict";
(function() {
    if (window.App == null) {
        window.App = {}
    }

    function MobileMenu(container, buttonToggle) {
        if (!container || !buttonToggle) {
            console.error("class MobileMenu -> container or buttonToggle not found!");
            return
        }
        var menu = this;
        var durationDefault = 400;
        var header = $(".header");
        menu.overlay = null;
        menu.isOpen = false;
        menu.nowActive = false;
        menu.container = container;
        createOverlay();
        menu.overlay.on("click", function() {
            hide()
        });
        buttonToggle.on("click", function() {
            if (menu.nowActive) {
                return
            }
            if (menu.isOpen === false) {
                show()
            } else {
                hide()
            }
            menu.isOpen = menu.isOpen === false ? true : false
        });

        function createOverlay() {
            menu.overlay = $("<div>");
            menu.overlay.addClass("mobile-menu-overlay");
            $("body").append(menu.overlay)
        }

        function show() {
            menu.nowActive = true;
            menu.container.slideDown(durationDefault);
            buttonToggle.addClass("is-open");
            header.addClass("is-open-menu");
            menu.overlay.fadeIn(durationDefault, function() {
                menu.nowActive = false
            })
        }

        function hide(duration) {
            var d = duration || durationDefault;
            menu.nowActive = true;
            menu.container.slideUp(d, function() {
                buttonToggle.removeClass("is-open");
                menu.overlay.fadeOut(d, function() {
                    header.removeClass("is-open-menu");
                    menu.nowActive = false
                })
            })
        }
        return {
            getIsOpen: function() {
                return menu.isOpen
            },
            hideMenu: function(duration) {
                hide(duration);
                menu.isOpen = false
            }
        }
    }
    window.App.MobileMenu = MobileMenu
})();
"use strict";
if (window.App == null) {
    window.App = {}
}
App.detectWindowSize = function(size) {
    if (window.innerWidth < size) {
        return true
    }
};
"use strict";
if (window.App == null) {
    window.App = {}
}
App.Ui = {
    mobileAreaBottom: {
        container: null,
        isShow: false,
        footer: null,
        init: function(container) {
            this.container = container;
            this.footer = $(".footer")
        },
        show: function() {
            this.container.animate({
                bottom: 0
            }, 400, function() {
                this.isShow = true;
                var padding = this.container.innerHeight() + "px";
                this.footer.css("padding-bottom", padding)
            }.bind(this))
        },
        hide: function() {
            this.footer.css("padding-bottom", "0");
            this.container.css("bottom", "-150px");
            this.isShow = false
        }
    },
    backToTop: {
        button: null,
        isVisible: false,
        lastScrollTop: 0,
        init: function(button) {
            this.button = button;
            this._setEvents()
        },
        _setEvents: function() {
            var self = this;
            self.button.on("click", function(event) {
                event.preventDefault();
                $("html, body").animate({
                    scrollTop: 0
                }, 400, function() {
                    self.hide()
                })
            });
            $(document).on("scroll", onScroll);

            function onScroll() {
                var top = $(window).scrollTop();
                if (self.lastScrollTop > top && !self.isVisible && top > 1e3) {
                    self.show()
                } else if ((top < 1e3 || self.lastScrollTop < top) && self.isVisible) {
                    self.hide()
                }
                self.lastScrollTop = top
            }
        },
        show: function() {
            this.button.removeClass("hidden");
            this.button.addClass("show");
            this.isVisible = true
        },
        hide: function() {
            this.button.removeClass("show");
            this.button.addClass("hidden");
            this.isVisible = false
        }
    }
};
"use strict";
if (window.App == null) {
    window.App = {}
}(function() {
    function DinamicLoadingImages(image, sizes, successCallback) {
        this.image = image;
        this.sizes = sizes;
        this.successCallback = successCallback;
        this._selectedSize = "";
        this._setEvents();
        this._choiceSize()
    }
    DinamicLoadingImages.prototype._choiceSize = function() {
        var sizes = this.sizes;
        var windowWidth = window.innerWidth;
        var defaultSize = true;
        var choiceSuccess = false;
        var size;
        for (size in sizes) {
            if (sizes.hasOwnProperty(size)) {
                if (size >= windowWidth) {
                    defaultSize = false;
                    if (size !== this._selectedSize) {
                        choiceSuccess = true;
                        this._selectedSize = size
                    }
                    break
                }
            }
        }
        if (defaultSize && this._selectedSize !== "default") {
            this._selectedSize = "default";
            choiceSuccess = true
        }
        if (choiceSuccess && this._selectedSize in sizes) {
            this._setSrc(sizes[this._selectedSize])
        }
        return this
    };
    DinamicLoadingImages.prototype._setEvents = function() {
        window.addEventListener("resize", this._choiceSize.bind(this));
        return this
    };
    DinamicLoadingImages.prototype._setSrc = function(value) {
        var self = this;
        this.image.attr("src", value);
        this.image.load(function() {
            $(this).fadeIn(0, function() {
                $(this).css("display", "block")
            });
            if (typeof self.successCallback === "function") {
                self.successCallback(self.image, self._selectedSize)
            }
        });
        return this
    };
    App.DinamicLoadingImages = DinamicLoadingImages
})();
"use strict";
if (window.App == null) {
    window.App = {}
}(function() {
    function DinamicBehavoirSlider(slider, options, optionsSize) {
        if (!slider || !options || !optionsSize) {
            console.error("Error create instance for class DinamicBehavoirSlider!");
            return false
        }
        this.slider = slider;
        this.options = options;
        this.optionsSize = optionsSize;
        this.init = false;
        this.instanceSlider = null;
        this._selectedSize = null;
        this._setEvents();
        this._choiceSize()
    }
    DinamicBehavoirSlider.prototype.create = function() {
        if (!this.init) {
            this.instanceSlider = this.slider.bxSlider(this.options);
            this.init = true;
            this.show();
            return this
        }
        this.reload();
        return this
    };
    DinamicBehavoirSlider.prototype.reload = function() {
        if (this.init && this.instanceSlider) {
            this.instanceSlider.reloadSlider(this.options);
            this.show()
        }
        return this
    };
    DinamicBehavoirSlider.prototype.updateOptions = function(newOptions) {
        for (var option in newOptions) {
            if (newOptions.hasOwnProperty(option)) {
                if (option === "slides") {
                    this.options.minSlides = this.options.maxSlides = newOptions[option];
                    continue
                }
                this.options[option] = newOptions[option]
            }
        }
        if (this.init) {
            this.reload()
        }
        return this
    };
    DinamicBehavoirSlider.prototype._setEvents = function() {
        window.addEventListener("resize", this._choiceSize.bind(this).debounce(100));
        return this
    };
    DinamicBehavoirSlider.prototype._choiceSize = function() {
        var optionsSize = this.optionsSize;
        var windowWidth = window.innerWidth;
        var defaultSize = true;
        var choiceSuccess = false;
        var size, sizeValue;
        for (size in optionsSize) {
            if (optionsSize.hasOwnProperty(size)) {
                sizeValue = optionsSize[size];
                if (size >= windowWidth) {
                    defaultSize = false;
                    if (size !== this._selectedSize) {
                        choiceSuccess = true;
                        this._selectedSize = size
                    }
                    break
                }
            }
        }
        if (defaultSize && this._selectedSize !== "default") {
            this._selectedSize = "default";
            choiceSuccess = true
        }
        if (choiceSuccess && this._selectedSize in optionsSize) {
            this.updateOptions(optionsSize[this._selectedSize])
        }
        return this
    };
    DinamicBehavoirSlider.prototype.show = function() {
        this.slider.animate({
            opacity: 1
        }, 200);
        return this
    };
    App.DinamicBehavoirSlider = DinamicBehavoirSlider
})();
"use strict";
if (window.App == null) {
    window.App = {}
}(function() {
    function SlideBlock(container) {
        this.animationDuration = 200;
        this.isOpen = false;
        this.container = container;
        this.title = container.find(".js-slide-block-title");
        this.content = container.find(".js-slide-block-content");
        if (this.container.length === 0) {
            console.error("Container length is 0!");
            return
        } else if (this.title.length === 0) {
            console.error("title must be a child of the container or has class - js-slide-block-title");
            return
        } else if (this.content.length === 0) {
            console.error("content must be a child of the container or has class - js-slide-block-content");
            return
        }
        this._setEvents()
    }
    SlideBlock.prototype.toggle = function() {
        this.content.stop().slideToggle(this.animationDuration);
        this.isOpen = this.isOpen ? false : true;
        this.container.toggleClass("is-open")
    };
    SlideBlock.prototype._setEvents = function() {
        this.title.on("click", function() {
            this.toggle()
        }.bind(this))
    };
    App.SlideBlock = SlideBlock
})();
"use strict";
if (window.App == null) {
    window.App = {}
}(function() {
    var position = $(window).scrollTop();
    App.getDirectionScroll = function() {
        var scroll = $(window).scrollTop();
        var result = scroll < position ? "top" : "bottom";
        position = scroll;
        return result
    }
})();
(function() {
    "use strict";

    function t(t) {
        return "function" == typeof t || "object" == typeof t && null !== t
    }

    function e(t) {
        return "function" == typeof t
    }

    function n(t) {
        W = t
    }

    function r(t) {
        H = t
    }

    function o() {
        return function() {
            process.nextTick(a)
        }
    }

    function i() {
        return function() {
            U(a)
        }
    }

    function s() {
        var t = 0,
            e = new Q(a),
            n = document.createTextNode("");
        return e.observe(n, {
                characterData: !0
            }),
            function() {
                n.data = t = ++t % 2
            }
    }

    function u() {
        var t = new MessageChannel;
        return t.port1.onmessage = a,
            function() {
                t.port2.postMessage(0)
            }
    }

    function c() {
        return function() {
            setTimeout(a, 1)
        }
    }

    function a() {
        for (var t = 0; G > t; t += 2) {
            var e = X[t],
                n = X[t + 1];
            e(n), X[t] = void 0, X[t + 1] = void 0
        }
        G = 0
    }

    function f() {
        try {
            var t = require,
                e = t("vertx");
            return U = e.runOnLoop || e.runOnContext, i()
        } catch (n) {
            return c()
        }
    }

    function l(t, e) {
        var n = this,
            r = n._state;
        if (r === et && !t || r === nt && !e) return this;
        var o = new this.constructor(p),
            i = n._result;
        if (r) {
            var s = arguments[r - 1];
            H(function() {
                C(r, o, s, i)
            })
        } else j(n, o, t, e);
        return o
    }

    function h(t) {
        var e = this;
        if (t && "object" == typeof t && t.constructor === e) return t;
        var n = new e(p);
        return g(n, t), n
    }

    function p() {}

    function _() {
        return new TypeError("You cannot resolve a promise with itself")
    }

    function d() {
        return new TypeError("A promises callback cannot return that same promise.")
    }

    function v(t) {
        try {
            return t.then
        } catch (e) {
            return rt.error = e, rt
        }
    }

    function y(t, e, n, r) {
        try {
            t.call(e, n, r)
        } catch (o) {
            return o
        }
    }

    function m(t, e, n) {
        H(function(t) {
            var r = !1,
                o = y(n, e, function(n) {
                    r || (r = !0, e !== n ? g(t, n) : E(t, n))
                }, function(e) {
                    r || (r = !0, S(t, e))
                }, "Settle: " + (t._label || " unknown promise"));
            !r && o && (r = !0, S(t, o))
        }, t)
    }

    function w(t, e) {
        e._state === et ? E(t, e._result) : e._state === nt ? S(t, e._result) : j(e, void 0, function(e) {
            g(t, e)
        }, function(e) {
            S(t, e)
        })
    }

    function b(t, n, r) {
        n.constructor === t.constructor && r === Z && constructor.resolve === $ ? w(t, n) : r === rt ? S(t, rt.error) : void 0 === r ? E(t, n) : e(r) ? m(t, n, r) : E(t, n)
    }

    function g(e, n) {
        e === n ? S(e, _()) : t(n) ? b(e, n, v(n)) : E(e, n)
    }

    function A(t) {
        t._onerror && t._onerror(t._result), T(t)
    }

    function E(t, e) {
        t._state === tt && (t._result = e, t._state = et, 0 !== t._subscribers.length && H(T, t))
    }

    function S(t, e) {
        t._state === tt && (t._state = nt, t._result = e, H(A, t))
    }

    function j(t, e, n, r) {
        var o = t._subscribers,
            i = o.length;
        t._onerror = null, o[i] = e, o[i + et] = n, o[i + nt] = r, 0 === i && t._state && H(T, t)
    }

    function T(t) {
        var e = t._subscribers,
            n = t._state;
        if (0 !== e.length) {
            for (var r, o, i = t._result, s = 0; s < e.length; s += 3) r = e[s], o = e[s + n], r ? C(n, r, o, i) : o(i);
            t._subscribers.length = 0
        }
    }

    function P() {
        this.error = null
    }

    function x(t, e) {
        try {
            return t(e)
        } catch (n) {
            return ot.error = n, ot
        }
    }

    function C(t, n, r, o) {
        var i, s, u, c, a = e(r);
        if (a) {
            if (i = x(r, o), i === ot ? (c = !0, s = i.error, i = null) : u = !0, n === i) return void S(n, d())
        } else i = o, u = !0;
        n._state !== tt || (a && u ? g(n, i) : c ? S(n, s) : t === et ? E(n, i) : t === nt && S(n, i))
    }

    function M(t, e) {
        try {
            e(function(e) {
                g(t, e)
            }, function(e) {
                S(t, e)
            })
        } catch (n) {
            S(t, n)
        }
    }

    function O(t) {
        return new ft(this, t).promise
    }

    function k(t) {
        function e(t) {
            g(o, t)
        }

        function n(t) {
            S(o, t)
        }
        var r = this,
            o = new r(p);
        if (!B(t)) return S(o, new TypeError("You must pass an array to race.")), o;
        for (var i = t.length, s = 0; o._state === tt && i > s; s++) j(r.resolve(t[s]), void 0, e, n);
        return o
    }

    function Y(t) {
        var e = this,
            n = new e(p);
        return S(n, t), n
    }

    function q() {
        throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")
    }

    function F() {
        throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")
    }

    function D(t) {
        this._id = ct++, this._state = void 0, this._result = void 0, this._subscribers = [], p !== t && ("function" != typeof t && q(), this instanceof D ? M(this, t) : F())
    }

    function K(t, e) {
        this._instanceConstructor = t, this.promise = new t(p), Array.isArray(e) ? (this._input = e, this.length = e.length, this._remaining = e.length, this._result = new Array(this.length), 0 === this.length ? E(this.promise, this._result) : (this.length = this.length || 0, this._enumerate(), 0 === this._remaining && E(this.promise, this._result))) : S(this.promise, this._validationError())
    }

    function L() {
        var t;
        if ("undefined" != typeof global) t = global;
        else if ("undefined" != typeof self) t = self;
        else try {
            t = Function("return this")()
        } catch (e) {
            throw new Error("polyfill failed because global object is unavailable in this environment")
        }
        var n = t.Promise;
        (!n || "[object Promise]" !== Object.prototype.toString.call(n.resolve()) || n.cast) && (t.Promise = at)
    }
    var N;
    N = Array.isArray ? Array.isArray : function(t) {
        return "[object Array]" === Object.prototype.toString.call(t)
    };
    var U, W, z, B = N,
        G = 0,
        H = function(t, e) {
            X[G] = t, X[G + 1] = e, G += 2, 2 === G && (W ? W(a) : z())
        },
        I = "undefined" != typeof window ? window : void 0,
        J = I || {},
        Q = J.MutationObserver || J.WebKitMutationObserver,
        R = "undefined" == typeof self && "undefined" != typeof process && "[object process]" === {}.toString.call(process),
        V = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel,
        X = new Array(1e3);
    z = R ? o() : Q ? s() : V ? u() : void 0 === I && "function" == typeof require ? f() : c();
    var Z = l,
        $ = h,
        tt = void 0,
        et = 1,
        nt = 2,
        rt = new P,
        ot = new P,
        it = O,
        st = k,
        ut = Y,
        ct = 0,
        at = D;
    D.all = it, D.race = st, D.resolve = $, D.reject = ut, D._setScheduler = n, D._setAsap = r, D._asap = H, D.prototype = {
        constructor: D,
        then: Z,
        catch: function(t) {
            return this.then(null, t)
        }
    };
    var ft = K;
    K.prototype._validationError = function() {
        return new Error("Array Methods must be provided an Array")
    }, K.prototype._enumerate = function() {
        for (var t = this.length, e = this._input, n = 0; this._state === tt && t > n; n++) this._eachEntry(e[n], n)
    }, K.prototype._eachEntry = function(t, e) {
        var n = this._instanceConstructor,
            r = n.resolve;
        if (r === $) {
            var o = v(t);
            if (o === Z && t._state !== tt) this._settledAt(t._state, e, t._result);
            else if ("function" != typeof o) this._remaining--, this._result[e] = t;
            else if (n === at) {
                var i = new n(p);
                b(i, t, o), this._willSettleAt(i, e)
            } else this._willSettleAt(new n(function(e) {
                e(t)
            }), e)
        } else this._willSettleAt(r(t), e)
    }, K.prototype._settledAt = function(t, e, n) {
        var r = this.promise;
        r._state === tt && (this._remaining--, t === nt ? S(r, n) : this._result[e] = n), 0 === this._remaining && E(r, this._result)
    }, K.prototype._willSettleAt = function(t, e) {
        var n = this;
        j(t, void 0, function(t) {
            n._settledAt(et, e, t)
        }, function(t) {
            n._settledAt(nt, e, t)
        })
    };
    var lt = L,
        ht = {
            Promise: at,
            polyfill: lt
        };
    "function" == typeof define && define.amd ? define(function() {
        return ht
    }) : "undefined" != typeof module && module.exports ? module.exports = ht : "undefined" != typeof this && (this.ES6Promise = ht), lt()
}).call(this);
(function(context) {
    "use strict";
    context.SocialCounters = function(options) {
        this.options = utils.extend({}, [defaultOptions, options]);
        if (this.options.services && this.options.services.length > 0) {
            this._begin()
        }
    };
    SocialCounters.prototype._begin = function() {
        var self = this;
        var id = this.options.id;
        if (id in initIds) {
            return
        }
        initIds[id] = true;
        var socialBlock = document.querySelector("#" + this.options.id);
        this.options.services.forEach(function(service) {
            if (service in services) {
                self._getCounter(service).then(function(count) {
                    count = counterRules(count, self.options.showZeros, self.options.outputCountCallback);
                    if (!(count == 0 || count == "")) {
                        var socialElement = socialBlock.querySelector(".b-share-btn__" + service),
                            countElement = document.createElement("span");
                        countElement.innerHTML = count;
                        countElement.className = "b-share-counter";
                        socialElement.appendChild(countElement)
                    }
                    return count
                })
            }
        })
    };
    SocialCounters.prototype._getCounter = function(serviceName) {
        var url = this.options.url;
        var cacheValue = counterControl.caching[url];
        if (cacheValue != null) {
            return Promise.resolve(cacheValue)
        }
        var service = services[serviceName];
        return counterControl.get(service, url).then(function(count) {
            counterControl.caching[url] = count;
            return count
        })
    };
    context.SocialButtons = function(options) {
        this.options = utils.extend({}, [defaultOptions, options]);
        this._shareOptions = this._createShareOptions();
        this._storageButtons = {};
        this._lastShareUrl = "";
        this._renderComponents = this._createRenderComponents();
        this._containerDOM = document.createElement("div");
        this._containerDOM.className = "container-social-buttons";
        if (this.options.services && this.options.services.length > 0) {
            this._begin()
        }
    };
    SocialButtons.prototype._begin = function() {
        var self = this;
        var length = this.options.services.length;
        var quantity = 0;
        var id = this.options.id;
        if (id in initIds) {
            return
        }
        initIds[id] = true;
        this.options.services.forEach(function(service) {
            if (service in services) {
                self._createHTML(services[service]).then(function(button) {
                    self._storageButtons[service] = button;
                    quantity++;
                    if (quantity === length) {
                        self._renderHTML()
                    }
                })
            }
        })
    };
    SocialButtons.prototype._createHTML = function(service) {
        var self = this;
        var currentHelpers = self.options.helpers[service.name];
        var customClass = currentHelpers.customClass || "";
        var button = utils.createElement("div", "b-social-button b-social-button--" + service.name + " b-social-button--" + self.options.theme + " " + customClass, {
            title: currentHelpers.title
        });
        var size = self._getButtonsSize(this.options.buttonSize);
        if (size) {
            button.style.fontSize = size + "px"
        }
        var components = utils.createElement("div", "social-button__components");
        button.appendChild(components);
        if (self._renderComponents.icon === true) {
            var icon = utils.createElement("div", "social-button__icon");
            components.appendChild(icon)
        }
        if (self._renderComponents.text === true) {
            var text = utils.createElement("div", "social-button__text");
            text.innerHTML = currentHelpers.text;
            components.appendChild(text)
        }
        button.addEventListener("click", function() {
            self._openPopup(service);
            self._countIncrement(button, {
                name: service.name,
                url: self._lastShareUrl
            })
        });
        if (self.options.counter && service.getCountUrl != null && self._renderComponents.count) {
            var countElement = utils.createElement("div", "social-button__count");
            return self._getCounter(service).then(function(count) {
                countElement.setAttribute("data-count", count);
                count = counterRules(count, self.options.showZeros, self.options.outputCountCallback);
                if (count === "") {
                    countElement.className += " social-button__count--empty"
                }
                countElement.innerHTML = count;
                components.appendChild(countElement);
                return button
            })
        }
        return Promise.resolve(button)
    };
    SocialButtons.prototype._renderHTML = function() {
        var self = this;
        var whereToInsert = document.querySelector("#" + this.options.id);
        if (whereToInsert) {
            this.options.services.forEach(function(service) {
                if (service in self._storageButtons) {
                    var button = self._storageButtons[service];
                    self._containerDOM.appendChild(button)
                }
            });
            whereToInsert.appendChild(this._containerDOM);
            var callbackCreate = self.options.callbacks.create;
            if (typeof callbackCreate === "function") {
                callbackCreate({
                    self: whereToInsert,
                    options: self.options
                })
            }
        } else {
            console.error("#" + this.options.id, "not found!")
        }
    };
    SocialButtons.prototype._getButtonsSize = function(size) {
        switch (size) {
            case "small":
                size = 22;
                break;
            case "middle":
                size = 28;
                break;
            case "large":
                size = 34;
                break;
            default:
                var parseSize = parseFloat(size);
                if (!isNaN(parseSize)) {
                    size = parseSize
                }
        }
        return size
    };
    SocialButtons.prototype._getCounter = function(service) {
        var url = this.options.url;
        var cacheValue = counterControl.caching[url];
        if (cacheValue != null) {
            return Promise.resolve(cacheValue)
        }
        return counterControl.get(service, url).then(function(count) {
            counterControl.caching[url] = count;
            return count
        })
    };
    SocialButtons.prototype._parseTemplate = function(template, objectCallback) {
        if (!template) {
            return ""
        }
        var pattern = /{{[^{{]+}}/gi;
        return template.replace(pattern, function(foundString) {
            foundString = foundString.replace(/\s+/g, "");
            var property = foundString.split("").filter(function(current, index, array) {
                if (index > 1 && array.length - 2 > index) {
                    return true
                }
            }).join("");
            if (property in objectCallback) {
                return encodeURIComponent(objectCallback[property])
            } else {
                return ""
            }
        })
    };
    SocialButtons.prototype._openPopup = function(service) {
        var url = this._parseTemplate(service.shareUrl, this._shareOptions);
        this._lastShareUrl = url;
        window.open(url, "share", "toolbar=0,status=0,scrollbars=0,width=600,height=450")
    };
    SocialButtons.prototype._countIncrement = function(button, service) {
        var countElement = button.querySelector(".social-button__count");
        var count;
        if (countElement != null) {
            count = countElement.getAttribute("data-count");
            count++;
            if (!isNaN(count)) {
                countElement.setAttribute("data-count", count);
                var outCountCallback = this.options.outputCountCallback;
                if (typeof outCountCallback === "function") {
                    count = outCountCallback(count)
                }
                countElement.innerHTML = count;
                var callbackShare = this.options.callbacks.share;
                if (typeof callbackShare === "function") {
                    callbackShare({
                        self: button,
                        service: service
                    })
                }
            }
        }
    };
    SocialButtons.prototype._createRenderComponents = function() {
        var components = {
            icon: false,
            text: false,
            count: false
        };
        for (var component in components) {
            if (components.hasOwnProperty(component)) {
                if (this.options.components.indexOf(component) >= 0) {
                    components[component] = true
                }
            }
        }
        return components
    };
    SocialButtons.prototype._createShareOptions = function() {
        var OG = {
            url: document.querySelector('[property="og:url"]'),
            title: document.querySelector('[property="og:title"]'),
            description: document.querySelector('[property="og:description"]'),
            image: document.querySelector('[property="og:image"]')
        };
        for (var meta in OG) {
            if (OG.hasOwnProperty(meta)) {
                if (OG[meta]) {
                    OG[meta] = OG[meta].getAttribute("content")
                }
            }
        }
        return {
            url: this.options.url || OG.url || window.location.href,
            title: this.options.title || OG.title || document.title,
            description: this.options.description || OG.description || "",
            image: this.options.image || OG.image || ""
        }
    };
    var defaultOptions = {
        components: ["icon", "text", "count"],
        theme: "default",
        callbacks: {
            create: null,
            share: null
        },
        outputCountCallback: null,
        helpers: {
            vkontakte: {
                text: "? ?N?N??????NN?",
                title: "? ?N?N??????NN? ?? ???????N???N?",
                customClass: ""
            },
            facebook: {
                text: "?Y????????NN?N?N?",
                title: "?Y????????NN?N?N? ?? Facebook",
                customClass: ""
            },
            googleplus: {
                text: "?N?? ????N?N?N?????",
                title: "?N?? ????N?N?N????? Google Plus",
                customClass: ""
            },
            odnoklassniki: {
                text: "???????N??NN?",
                title: "???????N??NN? ?? ?z??????????N?N????????N",
                customClass: ""
            },
            moimir: {
                text: "?Y????????NN?N?N?",
                title: "?Y????????NN?N?N? N?N?N??????? ?? ?????? ????N",
                customClass: ""
            },
            twitter: {
                text: "? ?N????N",
                title: "???????N??NN? ?? Twitter",
                customClass: ""
            },
            lj: {
                text: "???????N??NN?",
                title: "? ?????N?N??NN? ??????N?N? ?? LiveJournal",
                customClass: ""
            },
            linkedin: {
                text: "?Y????????NN?N?N?",
                title: "?Y????????NN?N?N? ?? Linkedin",
                customClass: ""
            }
        }
    };
    var protocol = location.protocol === "https:" ? "https" : "http";
    var services = {
        vkontakte: {
            name: "vkontakte",
            promises: [],
            shareUrl: protocol + "://vk.com/share.php?url={{ url }}&title={{ title }}&description={{ description }}&image={{ image }}",
            getCountUrl: protocol + "://vk.com/share.php?act=count&url=",
            counter: function(url, promise) {
                var request = new RequestManager;
                var index = this.promises.length;
                request.create(this.getCountUrl + url + "&index=" + index);
                this.promises.push(promise);
                if (!context.VK) {
                    context.VK = {}
                }
                window.VK.Share = {
                    count: function(index, count) {
                        services.vkontakte.promises[index].resolve(count)
                    }
                }
            }
        },
        facebook: {
            name: "facebook",
            shareUrl: protocol + "://www.facebook.com/sharer.php?u={{ url }}&title={{ title }}&description={{ description }}&image={{ image }}",
            getCountUrl: protocol + "://graph.facebook.com/?id=",
            counter: function(url, promise) {
                var request = new RequestManager;
                request.create(this.getCountUrl + url).then(function(data) {
                    var count = 0;
                    if (data.share != null && data.share.share_count != null) {
                        count = data.share.share_count
                    }
                    promise.resolve(count)
                })
            }
        },
        googleplus: {
            name: "googleplus",
            shareUrl: protocol + "://plus.google.com/share?url={{ url }}",
            getCountUrl: protocol + "://share.yandex.ru/gpp.xml?url=",
            counter: function(url, promise) {
                var request = new RequestManager;
                request.create(this.getCountUrl + url).then(function(count) {
                    if (count == null) {
                        count = 0
                    }
                    promise.resolve(count)
                })
            }
        },
        odnoklassniki: {
            name: "odnoklassniki",
            promises: [],
            shareUrl: protocol + "://www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1&st._surl={{ url }}&st.comments={{ title }}",
            getCountUrl: protocol + "://connect.ok.ru/dk?st.cmd=extLike&ref=",
            counter: function(url, promise) {
                var request = new RequestManager;
                var index = this.promises.length;
                request.create(this.getCountUrl + url + "&uid=" + index);
                this.promises.push(promise);
                if (!context.ODKL) {
                    context.ODKL = {}
                }
                context.ODKL.updateCount = function(index, count) {
                    services.odnoklassniki.promises[index].resolve(count)
                }
            }
        },
        moimir: {
            name: "moimir",
            shareUrl: protocol + "://connect.mail.ru/share?url={{ url }}&title={{ title }}&description={{ description  }}",
            getCountUrl: protocol + "://appsmail.ru/share/count/",
            counter: function(url, promise) {
                var position = url.indexOf("//");
                url = url.slice(position + 2);
                var request = new RequestManager;
                request.create(this.getCountUrl + url).then(function(data) {
                    var count = data.share_mm;
                    if (count == null) {
                        count = 0
                    }
                    promise.resolve(count)
                })
            }
        },
        twitter: {
            name: "twitter",
            shareUrl: protocol + "://twitter.com/share?={{ url }}&text={{ description }}",
            getCountUrl: null,
            counter: function(url, promise) {
                promise.resolve(0)
            }
        }
    };
    var initIds = {};
    var counterControl = {
        caching: {},
        get: function(service, url) {
            var defer = utils.deferred();
            service.counter(url, defer);
            return defer.promise
        }
    };

    function counterRules(count, showZeros, outputCountCallback) {
        if (!count && !showZeros) {
            count = ""
        }
        if (typeof outputCountCallback === "function") {
            count = outputCountCallback(parseInt(count))
        }
        return count
    }

    function RequestManager() {
        this.uniqueName = null;
        this.script = null;
        this.data = null
    }
    RequestManager.prototype.create = function(src) {
        var self = this;
        var defer = utils.deferred();
        var separator = src.indexOf("?") > 0 ? "&" : "?";
        this.uniqueName = "f_" + String(Math.random()).slice(2);
        this.script = document.createElement("script");
        this.script.src = src + separator + "callback=" + this.uniqueName;
        document.head.appendChild(this.script);
        context[this.uniqueName] = function(data) {
            self.data = data
        };
        self.script.onload = function() {
            self.remove();
            defer.resolve(self.data)
        };
        return defer.promise
    };
    RequestManager.prototype.remove = function() {
        delete context[this.uniqueName];
        this.script.parentNode.removeChild(this.script)
    };
    var utils = {
        deferred: function() {
            var result = {};
            result.promise = new Promise(function(resolve, reject) {
                result.resolve = resolve;
                result.reject = reject
            });
            return result
        },
        extend: function(target, objects) {
            for (var object in objects) {
                if (objects.hasOwnProperty(object)) {
                    recursiveMerge(target, objects[object])
                }
            }

            function recursiveMerge(target, object) {
                for (var property in object) {
                    if (object.hasOwnProperty(property)) {
                        var current = object[property];
                        if (utils.getConstructor(current) === "Object") {
                            if (!target[property]) {
                                target[property] = {}
                            }
                            recursiveMerge(target[property], current)
                        } else {
                            target[property] = current
                        }
                    }
                }
            }
            return target
        },
        createElement: function(element, className, attrs) {
            var newElement = document.createElement(element);
            if (className) {
                newElement.className = className
            }
            if (attrs) {
                for (var attr in attrs) {
                    if (attrs.hasOwnProperty(attr)) {
                        var value = attrs[attr];
                        newElement.setAttribute(attr, value)
                    }
                }
            }
            return newElement
        },
        getConstructor: function(object) {
            return Object.prototype.toString.call(object).slice(8, -1)
        }
    }
})(window);

function declOfNum(number, titles) {
    cases = [2, 0, 1, 1, 1, 2];
    return number + " " + titles[number % 100 > 4 && number % 100 < 20 ? 2 : cases[number % 10 < 5 ? number % 10 : 5]]
}

function formatNumber(number, decimals, dec_point, thousands_sep) {
    number = (number + "").replace(/[^0-9+\-Ee.]/g, "");
    var n = !isFinite(+number) ? 0 : +number,
        s, prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),
        sep = typeof thousands_sep === "undefined" ? "," : thousands_sep,
        dec = typeof dec_point === "undefined" ? "." : dec_point,
        toFixedFix = function(n, prec) {
            var k = Math.pow(10, prec);
            return "" + Math.round(n * k) / k
        };
    s = (prec ? toFixedFix(n, prec) : "" + Math.round(n)).split(".");
    if (s[0].length > 3) {
        s[0] = s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, sep)
    }
    if ((s[1] || "").length < prec) {
        s[1] = s[1] || "";
        s[1] += [prec - s[1].length + 1].join("0")
    }
    return s.join(dec)
}

function getUrlPartsByUrl(url) {
    var parser = document.createElement("a");
    parser.href = url;
    return parser.pathname + parser.hash
}

function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return "";
    return decodeURIComponent(results[2].replace(/\+/g, " "))
}

function getCookie(name) {
    var matches = document.cookie.match(new RegExp("(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, "\\$1") + "=([^;]*)"));
    return matches ? decodeURIComponent(matches[1]) : undefined
}

function hasCookie(name) {
    return document.cookie.match(new RegExp("(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, "\\$1") + "=([^;]*)")) !== null
}

function setCookie(name, value, options, encode) {
    options = options || {};
    var expires = options.expires;
    if (typeof expires == "number" && expires) {
        var d = new Date;
        d.setTime(d.getTime() + expires * 1e3);
        expires = options.expires = d
    }
    if (expires && expires.toUTCString) {
        options.expires = expires.toUTCString()
    }
    if (encode) {
        value = encodeURIComponent(value)
    }
    var updatedCookie = name + "=" + value;
    for (var propName in options) {
        updatedCookie += "; " + propName;
        var propValue = options[propName];
        if (propValue !== true) {
            updatedCookie += "=" + propValue
        }
    }
    document.cookie = updatedCookie
}

function deleteCookie(name) {
    setCookie(name, "", {
        expires: -1
    })
}

function getResponseContentType(responseObject) {
    var headers = responseObject.getAllResponseHeaders(),
        headersArray = headers.split("\n");
    var headersObject = {};
    headersArray.map(function(value) {
        var pair = value.split(": ");
        headersObject[pair[0]] = pair[1]
    });
    var ct;
    if ("content-type" in headersObject) {
        ct = headersObject["content-type"]
    } else if ("Content-Type" in headersObject) {
        ct = headersObject["Content-Type"]
    }
    return ct
}

function processAjaxValidationResult(stringResult) {
    var resultObj = JSON.parse(stringResult),
        $form = $(document).find("form[name=authuserform]").eq(0),
        $errorBox = $form.find(".text-error"),
        errors = [];
    if ($form) {
        $form.find(".util-form-error").removeClass("util-form-error");
        for (var key in resultObj) {
            var $element = $form.find("#" + key).eq(0);
            errors.push(resultObj[key]);
            if ($element) {
                $element.addClass("util-form-error")
            }
        }
        if (errors) {
            var errorsBoxContent = errors.join("<br />");
            $errorBox.html(errorsBoxContent).show()
        } else {
            $errorBox.html("").hide()
        }
    }
}(function(w) {
    w.AjaxManager = {};
    AjaxManager.loadAuthWindow = function($el, opts) {
        $("html").addClass("remodal_lock");
        $("body").addClass("remodal_lock remodal_active").css("padding-right: 15px;");
        var o = {
                redirect: null,
                data: {},
                open: true,
                options: {}
            },
            url = null,
            method = "GET";
        if ($el && typeof $el == "object") {
            if ($el.is("form")) {
                o.data = $el.serializeArray();
                url = $el.attr("action");
                method = "POST"
            } else {
                url = $el.attr("href")
            }
        } else {
            url = opts.action ? opts.action : "/auth/index/"
        }
        if (typeof opts === "object" && opts !== {}) {
            for (var attrname in opts) {
                if (attrname && o.hasOwnProperty(attrname)) {
                    o[attrname] = opts[attrname]
                }
            }
            if (typeof opts.options != "undefined" && typeof opts.options.redirect != "undefined") {
                o.data.redirect = opts.options.redirect;
                delete o.options.redirect
            }
        }
        if (o.options !== {}) {
            o.data["options"] = o.options
        }
        if (url) {
            var mainPopup = $(".modal-ajax-window"),
                mainPopupWrap = mainPopup.find(".remodal-content-wrap").eq(0);
            $.ajax({
                type: method,
                dataType: "html",
                url: url,
                data: o.data,
                success: function(response, textStatus, jqXHR) {
                    var contentType = getResponseContentType(jqXHR);
                    if (contentType.indexOf("text/html") > -1) {
                        mainPopup.fadeOut(300, function() {
                            mainPopupWrap.html(response);
                            placeholderLabelInit();
                            $(document).find(".js-phone-mask").mask("+7 (999) 999-99-99");
                            if (mainPopup.hasClass("remodal-is-closed") && o.open) {
                                mainPopup.remodal().open()
                            }
                            mainPopup.fadeIn(300)
                        })
                    } else if (contentType.indexOf("application/json") > -1) {
                        processAjaxValidationResult(response)
                    }
                }
            })
        }
    }
})(window);
$(document).on("closed", ".modal-ajax-window", function(e) {
    AjaxManager.loadAuthWindow(null, {
        open: false
    })
});
$(document).on("click", ".send-code-again", function(e) {
    e.preventDefault();
    var $self = $(this);
    var type = $self.data("type");
    if ($self.hasClass("disabled")) {
        return false
    }
    $.ajax({
        type: "post",
        dataType: "json",
        url: $(this).attr("href"),
        success: function(response) {
            if ("tooLate" in response && response.tooLate) {
                App.alert.push([{
                    type: "warning",
                    message: "?N ??????N? ?????N?N??NN? ?????? ??????N??N???? N???N????? N?N?? 300 N????N?????"
                }]).call()
            }
            if (response.success) {
                window.initCountDownRegistration();
                var message = "";
                if (type == "phone") {
                    message = "?s???? ??NN?????"
                } else if (type == "email") {
                    message = "?Y??N?N????? ??N??N?????????"
                }
                App.alert.push([{
                    type: "info",
                    message: message
                }]).call()
            }
        }
    })
});
$(document).on("click", ".auth-link", function(e) {
    var href = window.location.href.split("#")[0];
    var data = {
        redirect: href
    };
    $.ajax({
        type: "post",
        dataType: "json",
        url: "/helper/session/",
        data: {
            data: JSON.stringify(data)
        }
    })
});

function isDisabled(el) {
    return $(el).hasClass("disabled")
}
var checkAccessLock = false;

function checkAccess(e) {
    if (!checkAccessLock) {
        checkAccessLock = true;
        setTimeout(function() {
            checkAccessLock = false
        }, 150);
        if (isUserSuspended) {
            e.preventDefault();
            e.stopPropagation();
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        if (isUserGuest || !isUserComplete) {
            e.preventDefault();
            e.stopPropagation();
            var redirect = window.location.href.split("#")[0];
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/access/",
                options: {
                    reload: 0,
                    redirect: redirect
                }
            });
            return
        }
    }
}
$(document).on("click", ".removal-wrap", function(e) {
    e.stopPropagation()
});
$(document).on("click", ".auth-window_trigger", function(e) {
    e.preventDefault();
    if (!$(this).hasClass("invalid")) AjaxManager.loadAuthWindow($(this))
});
$(document).on("submit", ".auth-window_form_trigger", function(e) {
    e.preventDefault();
    AjaxManager.loadAuthWindow($(this))
});
$(document).on("click", ".reload_on-click", function(e) {
    e.preventDefault();
    var href = window.location.href.split("?")[0];
    href = href.split("#")[0];
    window.location.href = href
});
$(document).on("click", ".b-control-likes:not(.isAuthor) .control-likes__select", function(e) {
    e.preventDefault();
    if (isUserSuspended) {
        AjaxManager.loadAuthWindow(null, {
            redirect: location.href,
            action: "/auth/suspended/",
            options: {
                reload: 0
            }
        });
        return
    }
    var $like = $(this);
    if (isUserGuest) {
        AjaxManager.loadAuthWindow(null, {
            redirect: window.location.pathname,
            action: "/auth/index/"
        });
        return
    }
    $.ajax({
        type: "post",
        dataType: "json",
        url: this.href,
        success: function(data) {
            if (data.success) {
                var $count = $like.siblings(".control-likes__count");
                var val = parseInt($count.html());
                var newValue;
                var $container = $like.parents(".b-discussion-item");
                if ($like.siblings(".liked").length > 0) {
                    newValue = data.increment ? val + 2 : val - 2
                } else if ($like.hasClass(".liked")) {
                    newValue = data.increment ? --val : ++val
                } else {
                    newValue = data.increment ? ++val : --val
                }
                if ($like.hasClass("control-likes__dislike")) {
                    $like.siblings(".control-likes__like").removeClass("liked")
                } else {
                    $like.siblings(".control-likes__dislike").removeClass("liked")
                }
                if (newValue == 0) {
                    $count.removeClass("control-likes__count--type-negative control-likes__count--type-positive");
                    $container.removeClass("b-discussion-item--negative")
                } else if (newValue > 0) {
                    $container.removeClass("b-discussion-item--negative");
                    $count.removeClass("control-likes__count--type-negative");
                    $count.addClass("control-likes__count--type-positive")
                } else if (newValue < 0) {
                    $container.addClass("b-discussion-item--negative");
                    $count.removeClass("control-likes__count--type-positive");
                    $count.addClass("control-likes__count--type-negative")
                }
                $count.html(newValue);
                $like.toggleClass("liked")
            }
        }
    })
});
$(document).on("click", ".likes:not(.isAuthor)", function(e) {
    e.preventDefault();
    if (isUserSuspended) {
        AjaxManager.loadAuthWindow(null, {
            redirect: location.href,
            action: "/auth/suspended/",
            options: {
                reload: 0
            }
        });
        return
    }
    var $like = $(this);
    if (isUserGuest) {
        AjaxManager.loadAuthWindow(null, {
            action: "/auth/index/",
            redirect: window.location.pathname
        });
        return
    }
    $.ajax({
        type: "post",
        dataType: "json",
        url: this.href,
        success: function(data) {
            if (data.success) {
                var $count;
                if ($like.hasClass("select")) {
                    $count = $like.siblings(".count")
                } else {
                    $count = $like.find(".count")
                }
                var val = parseInt($count.html());
                var newValue;
                if ($like.hasClass("select")) {
                    var $container = $like.parents(".a-comment__item");
                    if ($like.siblings(".liked").length > 0) {
                        newValue = data.increment ? val + 2 : val - 2
                    } else if ($like.hasClass(".liked")) {
                        newValue = data.increment ? --val : ++val
                    } else {
                        newValue = data.increment ? ++val : --val
                    }
                    if ($like.has(".icon-like-bottom").length > 0) {
                        $like.siblings(".likes").has(".icon-like-top").removeClass("liked")
                    } else {
                        $like.siblings(".likes").has(".icon-like-bottom").removeClass("liked")
                    }
                    if (newValue == 0) {
                        $count.removeClass("count-type-positive count-type-negative");
                        $container.removeClass("negative")
                    } else if (newValue > 0) {
                        $container.removeClass("negative");
                        $count.removeClass("count-type-negative");
                        $count.addClass("count-type-positive")
                    } else if (newValue < 0) {
                        $container.addClass("negative");
                        $count.removeClass("count-type-positive");
                        $count.addClass("count-type-negative")
                    }
                } else {
                    newValue = data.increment ? ++val : --val
                }
                $count.html(newValue);
                $like.toggleClass("liked")
            }
        }
    })
});
$(document).ready(function() {
    $(".js-more-load").click(function(e) {
        e.preventDefault();
        var $moreLink = $(this),
            url = $moreLink.attr("href"),
            offset = $moreLink.attr("data-offset"),
            eid = $moreLink.data("eid"),
            selector = $moreLink.data("selector"),
            shouldAppend = $moreLink.data("append-to-selector"),
            count = $moreLink.data("count");
        if ($moreLink.attr("use") == "1") {
            return false
        }
        $moreLink.attr("use", "1");
        var data = {
            offset: offset,
            eid: eid
        };
        $.ajax({
            type: "get",
            dataType: "json",
            url: url,
            data: data,
            success: function(response) {
                if (response.data && response.offset) {
                    var $selector = selector ? $(selector) : $moreLink;
                    for (var i = 0; i < response.data.length; i++) {
                        if (shouldAppend) {
                            $(response.data[i]).appendTo($selector)
                        } else {
                            $(response.data[i]).insertBefore($selector)
                        }
                    }
                    $moreLink.attr("data-offset", response.offset)
                }
                if (!response.more || count > 0 && count <= response.offset) {
                    $moreLink.hide()
                }
                $moreLink.attr("use", "0")
            }
        });
        return false
    });
    $(".subscribe-btn").click(function(e) {
        e.preventDefault();
        var $self = $(this);
        if (isUserGuest) {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/index/",
                redirect: window.location.pathname
            });
            return
        }
        var type = $self.data("type");
        var eid = $self.data("eid");
        var action = $self.hasClass("is-subscribed") ? "unsubscribe" : "subscribe";
        var $all = $(document).find(".subscribe-btn[data-type=" + type + "][data-eid=" + eid + "]");
        $.ajax({
            type: "get",
            dataType: "json",
            url: "/" + action + "/" + type + "/" + eid + "/",
            success: function(response) {
                if (response.success) {
                    if (action == "subscribe") {
                        $self.addClass("is-subscribed");
                        $all.find(".action-profile-button-inner").html("?Y????????N???N?N?");
                        manageSubscribersBox(true)
                    } else {
                        $self.removeClass("is-subscribed");
                        $all.find(".action-profile-button-inner").html("?Y????????N??NN?N?N?");
                        manageSubscribersBox(false)
                    }
                }
            }
        })
    });

    function manageSubscribersBox(increment) {
        var $box = $(".profile-stats__subscribers-box"),
            $currentCount = $box.find(".profile-stats__count"),
            $currentCountLabel = $box.find(".profile-stats__text"),
            currentCountContent = $currentCount.html(),
            currentCount = +currentCountContent.replace(" ", "");
        if (increment) {
            currentCount++
        } else {
            currentCount--;
            if (currentCount <= 0) {
                currentCount = 0
            }
        }
        var newCountText = formatNumber(currentCount, 0, "", " "),
            newLabelText = declOfNum(currentCount, ["??????????N?N????", "??????????N?N????a", "??????????N?N????????"]).split(" ")[1];
        $currentCount.html(newCountText);
        $currentCountLabel.html(newLabelText);
        if (currentCount <= 0) {
            $box.hide()
        } else {
            $box.show()
        }
    }
    var storageName = "supportTextStorage",
        supportTextStorage = App.localStorage.get(storageName);
    if (supportTextStorage == null) {
        App.localStorage.set(storageName, {});
        supportTextStorage = {}
    } else {
        $("#petitionsupportform-body").val(supportTextStorage["supportText"]);
        if (typeof supportTextStorage["support-action"] != "undefined") {
            var action = supportTextStorage["support-action"];
            delete supportTextStorage["support-action"];
            supportTextStorage["submitted"] = true;
            App.localStorage.set(storageName, supportTextStorage);
            $(".petition__support-form").find(btnClass).eq(0).click()
        }
    }
    $(".petition__support-form").unbind("submit").bind("submit", function(e) {
        if (isUserSuspended) {
            e.preventDefault();
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        var $bodyTextField = $("#petitionsupportform-body");
        if ($bodyTextField.val().length > 65535) {
            App.alert.push({
                type: "info",
                message: "??N?? N??????N?????? N????N??????? ????????????"
            }).call();
            return
        }
        if (!isUserComplete) {
            checkAccess(e)
        }
        if (isUserGuest) {
            e.preventDefault();
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/index/",
                redirect: window.location.pathname
            })
        }
    });
    $(document).on("click", ".check-access", function(e) {
        var $self = $(this);
        if (isUserGuest) {
            e.preventDefault();
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/index/",
                redirect: window.location.pathname
            })
        }
    });
    var $activity_comment_reply_form = $("#activity-comment-reply-form");
    var $activity_comment_reply = $("#activity-comment-reply");
    $(".js-activity-comment-reply").click(function() {
        var $this = $(this);
        $this.unbind("click");
        var html = $activity_comment_reply_form.html();
        html = html.replace(/\{USERNAME\}/g, $this.data("username"));
        var $html = $(html);
        var $form = $("form", $html);
        var $button = $("button[type=submit]", $form);
        $form.submit(function() {
            $button.attr("disabled", "disabled");
            var body = $("textarea", $form).val();
            var addresseeInComment = body.split(",", 2)[0],
                addresseeName = $this.data("username");
            if (addresseeInComment.toLowerCase() == addresseeName.toLowerCase()) {
                body = body.replace(addresseeName, "<to>" + addresseeName + "</to>")
            }
            var data = {
                "CommentForm[parent_id]": $this.data("id"),
                "CommentForm[eid]": $this.data("eid"),
                "CommentForm[type]": $this.data("type"),
                "CommentForm[body]": body
            };
            $.post($form.attr("action"), data, function(json) {
                if (json["success"]) {
                    var comment = $activity_comment_reply.html();
                    comment = comment.replace(/\{COMMENTBODY\}/, body);
                    $html.remove();
                    $(comment).insertAfter($this)
                }
            }, "json");
            return false
        });
        $html.insertAfter($this);
        return false
    });
    $("#send-message_button").click(function(e) {
        e.preventDefault();
        if (isUserSuspended) {
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        var $form = $(this).parents("form"),
            $messageBody = $form.find("textarea");
        if (!$messageBody.val()) {
            App.alert.push({
                type: "danger",
                message: "?N ??? ??????N? ??N??N????N?NN? ??N?N?NN? N??????N?????N?"
            }).call();
            return
        }
        if ($messageBody.val().length > 65535) {
            App.alert.push({
                type: "info",
                message: "??N?? N??????N?????? N????N??????? ????????????"
            }).call();
            return
        }
        var data = $form.serializeArray();
        $.ajax({
            type: "post",
            dataType: "json",
            url: $form.attr("action"),
            data: data,
            success: function(response) {
                if (response.success) {
                    $("[data-remodal-id=write-message]").remodal().close();
                    $form.find("textarea").val("")
                }
            }
        })
    });
    $(document).on("click", "#dialog_send-message_button", function(e) {
        e.preventDefault();
        var $form = $(this).parents("form"),
            $messageBody = $form.find("textarea");
        if (!$messageBody.val()) {
            App.alert.push({
                type: "danger",
                message: "?N ??? ??????N? ??N??N????N?NN? ??N?N?NN? N??????N?????N?"
            }).call();
            return
        }
        if ($messageBody.val().length > 65535) {
            App.alert.push({
                type: "info",
                message: "??N?? N??????N?????? N????N??????? ????????????"
            }).call();
            return
        }
        var data = $form.serializeArray(),
            toUserId = $form.data("user_id"),
            $messageList = $(".dialog__message-list"),
            $lastMessage = $(".a-comment__item.user-message__item").last();
        if (isUserSuspended && toUserId != adminId) {
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        data.push({
            name: "returnResult",
            value: true
        });
        $.ajax({
            type: "post",
            dataType: "json",
            url: "/user/sendmessage/" + toUserId + "/",
            data: data,
            success: function(response) {
                if (response.success) {
                    $form.find("textarea").val("");
                    if ($lastMessage.length > 0) {
                        $lastMessage.after(response.message)
                    } else {
                        $messageList.find(".mCSB_inside").eq(0).append(response.message)
                    }
                    $("#service__message-d .custom-scroll").mCustomScrollbar("scrollTo", "bottom", {
                        scrollInertia: 100
                    })
                }
            }
        })
    });
    $(document).on("click", ".js-item-curators", function(e) {
        e.preventDefault();
        var $applyBtn = $(this);
        if ($applyBtn.hasClass("disabled")) {
            return false
        }
        if (isUserSuspended) {
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        $.ajax({
            type: "post",
            dataType: "json",
            url: $applyBtn.attr("href"),
            success: function(response) {
                if (response.success) {
                    if ($applyBtn.hasClass("js-item-curators_organization")) {
                        $applyBtn.addClass("disabled").html("??N?????? ??N??N????????")
                    } else {
                        $applyBtn.parents(".container-widget").one().hide()
                    }
                }
            }
        })
    });
    $(document).on("click", ".ajax-button", function(e) {
        e.preventDefault();
        $.ajax({
            type: "post",
            dataType: "json",
            url: $(this).attr("href")
        })
    });
    $("#user-settings__submit").click(function(e) {
        var $form = $("#user-settings__form");
        var subscribeList = $form.serializeArray().filter(function(item) {
            return item.name == "User[subscribeList][]"
        });
        if (subscribeList.length == 0) {
            $form.find("input[type=checkbox][value=0]").attr("checked", "checked")
        }
        $form.submit()
    });
    var actionParam = getParameterByName("action", false);
    if (actionParam) {
        var $remodalWindow = $(document).find(".modal-ajax-window").eq(0);
        $remodalWindow.find(".remodal-content-wrap").html("");
        if (actionParam == "password_change") {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/password/email/"
            })
        } else if (actionParam == "register") {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/register/account/"
            })
        } else if (actionParam == "verify") {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/verify/account/"
            })
        } else if (actionParam == "confirmation") {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/confirmation/"
            })
        } else if (actionParam == "welcome-email") {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/welcome/email/"
            })
        }
    }
});
(function($) {
    function formatRepo(repo) {
        if (repo.loading) return repo.text;
        return repo.title
    }

    function formatRepoSelection(repo) {
        if (repo.text) return repo.text;
        return repo.title
    }

    function toTitleCase(string) {
        return string.replace(/[A-z??-N?]\S*/g, function(txt) {
            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()
        })
    }
    $(document).ajaxComplete(function(event, xhr, settings) {
        var url = xhr.getResponseHeader("X-Redirect");
        if (url) {
            window.location = url
        }
    });
    $(function() {
        document.createElement("header");
        document.createElement("nav");
        document.createElement("section");
        document.createElement("article");
        document.createElement("aside");
        document.createElement("footer");
        var slider = $(".slider__helper").bxSlider({
            slideWidth: 378,
            minSlides: 1,
            maxSlides: 1,
            moveSlides: 1,
            pager: false,
            slideMargin: 15,
            onSlideAfter: function(currentSlideNumber, totalSlideQty, currentSlideHtmlObject) {
                $(".slide-active").removeClass("slide-active");
                $(".slider__helper>.slide:not(.bx-clone)").eq(currentSlideHtmlObject).addClass("slide-active")
            },
            onSliderLoad: function() {
                $(".slider__helper>.slide:not(.bx-clone)").eq(0).addClass("slide-active");
                var slide = $(".slider__helper>.slide");
                if (!slide.has(".slide-overlay").length) {
                    $(".slider__helper>.slide").append('<div class="slide-overlay"></div>')
                }
            }
        });
        $(".petition__mutual-support-fast_button").click(function(e) {
            e.preventDefault();
            if (isUserSuspended) {
                AjaxManager.loadAuthWindow(null, {
                    redirect: location.href,
                    action: "/auth/suspended/",
                    options: {
                        reload: 0
                    }
                });
                return
            }
            var $self = $(this),
                pid = $self.parents(".slide").attr("data-pid"),
                isSupporting = $self.data("is-supporting"),
                $container = $("#sidebar__helper"),
                $remodalConteiner = $("[data-remodal-id=helper]");
            $.ajax({
                type: "post",
                dataType: "json",
                url: "/petition/mutualsupport/",
                data: {
                    pid: pid,
                    isSupporting: isSupporting
                },
                success: function(response) {
                    if (response.success) {
                        $("[data-pid=" + pid + "]:not(.bx-clone)").remove();
                        if (slider.getSlideCount() - 1 == 0) {
                            $container.slideUp(300, function() {
                                slider.destroySlider()
                            })
                        } else {
                            slider.reloadSlider();
                            $container.find("h2").html(declOfNum(slider.getSlideCount(), ["????????? ??N?????????????", "??????NN ??N??????????????", "??????NN ??N??????????????"]) + "<br> ?? ?????????????? ?????????N????");
                            var nextPid = $(".slide-active").attr("data-pid");
                            $remodalConteiner.attr("data-pid", nextPid)
                        }
                    }
                }
            })
        });
        $(document).on("closed", "[data-remodal-id=helper]", function(e) {
            var $remodalConteiner = $("[data-remodal-id=helper]"),
                count = $remodalConteiner.data("count");
            $remodalConteiner.attr("data-offset", "0");
            $remodalConteiner.find("#mutual-petition__cont").html("");
            $("[data-remodal-id=helper] .count").html("??????????N? ?????????N????: 1 ??? " + +count)
        });
        $(".petition__mutual-support_button").click(function(e) {
            e.preventDefault();
            if (isUserSuspended) {
                AjaxManager.loadAuthWindow(null, {
                    redirect: location.href,
                    action: "/auth/suspended/",
                    options: {
                        reload: 0
                    }
                });
                return
            }
            var $self = $(this),
                $container = $("#mutual-petition__cont"),
                $sliderContainer = $("#sidebar__helper"),
                pid = $self.parents(".modal-helper").attr("data-pid"),
                currentOffset = $self.parents(".modal-helper").attr("data-offset"),
                count = $self.parents(".modal-helper").attr("data-count");
            if ($("body").has("#loading-image").length == 0) {
                $("body").append($('<img id="loading-image" src="/img/loading.gif"/>'))
            }
            var $loadingImage = $("#loading-image");
            if ($self.hasClass("mutual-support__prev-petition") || $self.hasClass("mutual-support__next-petition")) {
                var newOffset = $self.hasClass("mutual-support__next-petition") ? +currentOffset + 1 : +currentOffset - 1;
                if (newOffset < 0 || newOffset == count) {
                    return
                }
                $loadingImage.show();
                $container.html("");
                $self.parents(".modal-helper").attr("data-offset", newOffset);
                $.ajax({
                    type: "post",
                    dataType: "json",
                    url: "/petition/mutualsupport/",
                    data: {
                        pid: pid,
                        offset: newOffset
                    },
                    success: function(response) {
                        if (response.success) {
                            $loadingImage.hide();
                            $self.parents(".modal-helper").attr("data-pid", response.nextPetitionId);
                            $container.html(response.nextPetitionsToSupport);
                            $("[data-remodal-id=helper] .count").html("??????????N? ?????????N????: " + (+newOffset + 1) + " ??? " + +count)
                        }
                    }
                })
            } else {
                var isSupporting = $self.data("is-supporting");
                $loadingImage.show();
                $container.html("");
                $.ajax({
                    type: "post",
                    dataType: "json",
                    url: "/petition/mutualsupport/",
                    data: {
                        pid: pid,
                        isSupporting: isSupporting,
                        offset: currentOffset
                    },
                    success: function(response) {
                        if (response.success) {
                            $self.parents(".modal-helper").attr("data-pid", response.nextPetitionId);
                            $container.html(response.nextPetitionsToSupport);
                            $("[data-pid=" + pid + "]:not(.bx-clone)").remove();
                            if (slider.getSlideCount() - 1 == 0) {
                                $sliderContainer.slideUp(300, function() {
                                    slider.destroySlider()
                                })
                            } else {
                                slider.reloadSlider();
                                $sliderContainer.find("h2").html(declOfNum(slider.getSlideCount(), ["????????? ??N?????????????", "??????NN ??N??????????????", "??????NN ??N??????????????"]) + "<br> ?? ?????????????? ?????????N????")
                            }
                            if (!response.nextPetitionId) {
                                $loadingImage.hide();
                                $("[data-remodal-id=helper]").remodal().close()
                            }
                            $self.parents(".modal-helper").attr("data-count", --count);
                            count = $self.parents(".modal-helper").attr("data-count");
                            $("[data-remodal-id=helper] .count").html("??????????N? ?????????N????: " + (+currentOffset + 1) + " ??? " + +count)
                        }
                        $loadingImage.hide()
                    }
                })
            }
        });
        setTimeout(function() {
            var remodal = $(".remodal");
            remodal.each(function() {
                var data = $(this).data("remodal-full");
                if (data) {
                    $(this).parent(".remodal-wrapper").addClass("remodal-wrapper-full")
                }
            })
        }, 0);
        $(".js-select-basic:not(.js-select-basic[data-type])").select2({
            language: {
                noResults: function() {
                    return "????N????? ??? ????????????"
                },
                searching: function() {
                    return "?Y????N???a"
                }
            }
        }).on("select2:select", function(e) {
            if ($(this).hasClass("js-select-label-placeholder")) {
                selectLabelVisibleChange($(this), "show")
            }
        }).on("select2:unselect", function(e) {
            if ($(this).hasClass("js-select-label-placeholder")) {
                selectLabelVisibleChange($(this), "hide")
            }
        });
        setTimeout(function() {
            var $selectLabelPlaceholder = $(".js-select-label-placeholder");
            $selectLabelPlaceholder.each(function() {
                var labelPlaceholderText = $(this).attr("data-placeholder");
                $(this).next(".select2").find(".selection").append('<span class="placeholder-label">' + labelPlaceholderText + "</span>");
                var isSelected = false;
                var paddingTop = 20;
                if ($(this).hasClass("js-basic-multiple")) {
                    isSelected = getCountSelected($(this));
                    paddingTop = isSelected ? 27 : 20;
                    $(this).next(".select2").css({
                        paddingTop: paddingTop
                    })
                } else {
                    isSelected = $(this).find("option:selected").text()
                }
                var state = isSelected ? "show" : "hide";
                selectLabelVisibleChange($(this), state)
            })
        }, 100);

        function selectLabelVisibleChange(element, state) {
            var opacity = state === "show" ? 1 : 0;
            element.next(".select2").find(".placeholder-label").animate({
                opacity: opacity
            }, 200)
        }

        function getCountSelected(element) {
            return element.next(".select2").find(".select2-selection__choice").length
        }
        $(".js-basic-multiple").on("select2:unselect", function(e) {
            $(this).find("option[value=" + e.params.data.id + "]").remove();
            if ($(this).hasClass("js-select-label-placeholder")) {
                var $self = $(this);
                setTimeout(function() {
                    if (getCountSelected($self) === 0) {
                        selectLabelVisibleChange($self, "hide");
                        $self.next(".select2").css({
                            paddingTop: 20
                        })
                    }
                }, 10)
            }
        }).on("select2:selecting", function(e) {
            if ($(this).hasClass("js-select-opacity")) {
                selectLabelVisibleChange($(this), "show");
                var $select2DivStructure = $(this).next(".select2");
                var $select2SearchInline = $select2DivStructure.find(".select2-search--inline");
                $select2SearchInline.css({
                    opacity: 0
                });
                setTimeout(function() {
                    $select2SearchInline.css({
                        opacity: 1
                    })
                }.bind(this), 200);
                $(this).next(".select2").css({
                    paddingTop: 27
                })
            }
        });
        var $selectAddressees = $(".js-basic-multiple[data-type=addressees]"),
            $selectTags = $(".js-basic-multiple[data-type=tags]"),
            $selectRegion = $(".js-select-basic[data-type=cities]");
        $selectAddressees.select2({
            tags: true,
            tokenSeparators: [","],
            createTag: function(addressee) {
                return {
                    id: addressee.term,
                    text: addressee.term,
                    isNew: true
                }
            },
            ajax: {
                url: "/addressee/loadaddressees/",
                dataType: "json",
                delay: 250,
                data: function(params) {
                    return {
                        q: params.term,
                        page: params.page
                    }
                },
                processResults: function(data, page) {
                    return {
                        results: data.items
                    }
                },
                transport: function(params, success, failure) {
                    var $request = $.ajax(params);
                    $request.then(success);
                    $request.fail(failure);
                    return $request
                },
                cache: true
            },
            AllowClear: true,
            minimumInputLength: 3,
            templateResult: formatRepo,
            templateSelection: formatRepoSelection,
            escapeMarkup: function(markup) {
                return markup
            },
            language: {
                noResults: function() {
                    return "????N????? ??? ????????????"
                },
                searching: function() {
                    return "?Y????N???a"
                }
            }
        }).on("select2:select", function(e) {
            var title = e.params.data.text ? e.params.data.text : e.params.data.title ? e.params.data.title : false;
            if (!title) {
                return
            }
            if (!isAddresseeTitleAvailable(title)) {
                return
            }
            if (e.params.data.isNew) {
                $(this).find('[value="' + e.params.data.id + '"]').replaceWith('<option selected value="' + e.params.data.id + '">' + title + "</option>")
            }
        });
        $selectTags.select2({
            tags: true,
            tokenSeparators: [",", "#"],
            createTag: function(tag) {
                return {
                    id: tag.term,
                    text: tag.term,
                    isNew: true
                }
            },
            ajax: {
                url: "/tag/loadtags/",
                dataType: "json",
                delay: 250,
                data: function(params) {
                    return {
                        q: params.term,
                        page: params.page
                    }
                },
                processResults: function(data) {
                    return {
                        results: data.items
                    }
                },
                transport: function(params, success, failure) {
                    var $request = $.ajax(params);
                    $request.then(success);
                    $request.fail(failure);
                    return $request
                },
                cache: true
            },
            AllowClear: true,
            minimumInputLength: 3,
            templateResult: formatRepo,
            templateSelection: formatRepoSelection,
            escapeMarkup: function(markup) {
                return markup
            },
            language: {
                noResults: function() {
                    return "????N????? ??? ????????????"
                },
                searching: function() {
                    return "?Y????N???a"
                }
            }
        }).on("select2:select", function(e) {
            createFixedTooltipClass();
            setPlaceholderForInput($(this).next(".select2").find(".select2-search__field"), "??????N?? N???");
            var title = e.params.data.text ? e.params.data.text : e.params.data.title ? e.params.data.title : false;
            if (!title) {
                return
            }
            if (!isTagTitleAvailable(title)) {
                return
            }
            if (e.params.data.isNew) {
                $(this).find('[value="' + e.params.data.id + '"]').replaceWith('<option selected value="' + e.params.data.id + '">' + title + "</option>")
            }
        }).on("select2:unselect", function(e) {
            createFixedTooltipClass();
            setPlaceholderForInput($(this).next(".select2").find(".select2-search__field"), "??????N?? N???")
        });
        callCreateFixedTooltipClass();
        setTimeout(function() {
            var $searchFieldTag = $(".js-container-tags").find(".select2-search__field");
            setPlaceholderForInput($searchFieldTag, "??????N?? N???");
            $searchFieldTag.attr("maxlength", "25")
        }, 100);
        $selectRegion.select2({
            tags: true,
            createTag: function(addressee) {
                return {
                    id: addressee.term,
                    text: addressee.term,
                    isNew: true
                }
            },
            templateSelection: function(repo) {
                var title = repo.text ? repo.text : repo.title;
                if (repo.isNew) {
                    title = toTitleCase(title)
                }
                return title
            },
            language: {
                noResults: function() {
                    return "????N????? ??? ????????????"
                },
                searching: function() {
                    return "?Y????N???a"
                }
            }
        }).on("select2:select", function(e) {
            if (e.params.data.isNew) {
                $(this).find('[value="' + e.params.data.id + '"]').replaceWith('<option selected value="' + e.params.data.id + '">' + e.params.data.text + "</option>")
            }
            if ($(this).hasClass("js-select-label-placeholder")) {
                selectLabelVisibleChange($(this), "show")
            }
        }).on("select2:unselect", function(e) {
            if ($(this).hasClass("js-select-label-placeholder")) {
                selectLabelVisibleChange($(this), "hide")
            }
        });

        function isAddresseeTitleAvailable(title) {
            var available = true;
            $.ajax({
                type: "get",
                dataType: "json",
                url: "/addressee/validate/",
                data: {
                    title: title
                },
                success: function(response) {
                    if (response.success) {
                        available = response.available;
                        if (!available) {
                            $selectAddressees.find('option[value="' + title + '"]').remove();
                            $selectAddressees.siblings(".select2").eq(0).find('li[title="' + title + '"]').remove();
                            App.alert.push({
                                type: "danger",
                                message: "????????????????? ??????????NN? ????????????? ???N?N??N?"
                            }).call()
                        }
                    }
                }
            });
            return available
        }

        function isTagTitleAvailable(title) {
            var available = true;
            $.ajax({
                type: "get",
                dataType: "json",
                url: "/tag/validate/",
                data: {
                    title: title
                },
                success: function(response) {
                    if (response.success) {
                        available = response.available;
                        if (!available) {
                            $selectTags.find('option[value="' + title + '"]').remove();
                            $selectTags.siblings(".select2").eq(0).find('li[title="' + title + '"]').remove();
                            App.alert.push({
                                type: "danger",
                                message: "????????????????? ??????????NN? ???????N?? NN???"
                            }).call()
                        }
                    }
                }
            });
            return available
        }
        if ($(".main__head-float").length) {
            menuPosition(".main__head-float")
        }
        var navigationFloat = $(".js-navigation-float");
        if (navigationFloat.length) {
            menuPosition(navigationFloat, $(".container-navigation-panel"), "b-navigation-fixed");
            $(window).scrollTop($(window).scrollTop() + 1)
        }
        var lastId, menuItems = $(".main__head-float").add(".js-navigation-float").find("a").not(".js-default-link, .b-share__link");
        noScrollAction = false, sidebarCol = $("#sidebar__collection").length > 0 ? true : false, scrollItems = menuItems.map(function(item) {
            var item = $($(this).attr("href"));
            if (item.length) {
                return item
            }
        });
        menuItems.click(function(event) {
            if ($(menuItems).closest("ul").hasClass("nav-tabs") || noScrollAction || $(this).hasClass("js-disabled")) {
                return false
            }
            event.preventDefault();
            $(menuItems).parent("li").removeClass("active");
            var mode = navigationFloat.attr("data-height") || 52;
            if ($(this).parent("li").index() == 0 && navigationFloat.data("height") == null) {
                mode = 47
            }
            var href = $(this).attr("href"),
                offsetTop = href === "#" ? 0 : $(href).offset().top - mode;
            noScrollAction = true;
            $("html, body").stop().animate({
                scrollTop: offsetTop
            }, {
                duration: 300,
                complete: function() {
                    menuItems.parent().removeClass("active").end().filter('[href="' + href + '"]').parent().addClass("active");
                    lastId = href.slice(1);
                    setTimeout(function() {
                        noScrollAction = false
                    }, 150)
                }
            });
            $(this).parent("li").addClass("active")
        });
        $(document).on("click", ".respond_comment__link", function() {
            var $respondBtn = $(this),
                $respondToComment = $respondBtn.parents(".a-comment__item").eq(0),
                $respondToCommentAuthorName = $respondToComment.find(".name"),
                $commentForm = $("#pevent__comment-from"),
                $commentFormTitle = $commentForm.find(".a-comment__item-respond-title"),
                $commentFormTitleComment = $commentFormTitle.find(".respond-title__comment"),
                $commentFormTitleUser = $commentFormTitle.find(".respond-title__user"),
                $commentClearBtn = $(".pevent__comment-from-clear"),
                $commentFormBody = $("#commentform-body"),
                respondToCommentAuthorName = $respondToCommentAuthorName.html().split(" ", 2)[0],
                respondToCommentId = $respondBtn.attr("data-eid");
            $commentFormTitleComment.attr("href", "#a-comment__" + respondToCommentId);
            $commentFormTitleUser.html($respondToCommentAuthorName.html());
            $commentFormTitleUser.attr("href", $respondToCommentAuthorName.attr("href"));
            if (respondToCommentAuthorName && $commentForm.attr("data-respond-to") == "") {
                $commentFormBody.val(respondToCommentAuthorName + ", " + $commentFormBody.val())
            } else if ($commentForm.attr("data-respond-to") != respondToCommentId) {
                var clearedVal = $commentFormBody.val().split(", ", 2)[1];
                $commentFormBody.val(respondToCommentAuthorName + ", " + clearedVal)
            }
            $commentForm.attr("data-respond-to", respondToCommentId);
            $commentFormTitle.show();
            $commentClearBtn.show();
            var href = $respondBtn.attr("href"),
                offsetTop = href === "#" ? 0 : $(href).offset().top;
            $("html, body").stop().animate({
                scrollTop: offsetTop
            }, {
                duration: 300
            })
        });
        $(document).on("click", ".discussion-item__reply", function() {
            var $respondBtn = $(this),
                $commentForm = $("#pevent__comment-from"),
                $commentClearBtn = $(".pevent__comment-form_clear"),
                respondToCommentId = $respondBtn.attr("data-eid");
            $commentForm.attr("data-respond-to", respondToCommentId);
            $commentClearBtn.show();
            var href = $respondBtn.attr("href"),
                offsetTop = href === "#" ? 0 : $(href).offset().top;
            $("html, body").stop().animate({
                scrollTop: offsetTop
            }, {
                duration: 300
            })
        });
        $(document).on("click", ".animate-scroll", function() {
            var $self = $(this);
            var href = $self.attr("href"),
                offsetTop = href === "#" ? 0 : $(href).offset().top;
            $("html, body").stop().animate({
                scrollTop: offsetTop
            }, {
                duration: 300
            })
        });
        $(".complete-company").click(function() {
            var $createPeventWindow = $("[data-remodal-id=create-pevent]");
            $createPeventWindow.find("#tab2").click()
        });
        $(document).on("click", ".pevent__comment-from-clear", function(e) {
            e.preventDefault();
            var $clearBtn = $(this),
                $commentForm = $("#pevent__comment-from"),
                $commentFormTitle = $commentForm.find(".a-comment__item-respond-title"),
                $commentFormTitleComment = $commentFormTitle.find(".respond-title__comment"),
                $commentFormTitleUser = $commentFormTitle.find(".respond-title__user"),
                $commentFormBody = $("#commentform-body");
            $commentForm.attr("data-respond-to", "");
            $commentFormTitleComment.attr("href", "");
            $commentFormTitleUser.attr("href", "");
            $commentFormTitleUser.html("");
            $commentFormTitle.hide();
            $commentFormBody.val("");
            $clearBtn.hide();
            var href = $clearBtn.attr("href"),
                offsetTop = href === "#" ? 0 : $(href).offset().top;
            $("html, body").stop().animate({
                scrollTop: offsetTop
            }, {
                duration: 300
            })
        });
        $(document).on("click", ".pevent__comment-form_clear", function(e) {
            e.preventDefault();
            var $clearBtn = $(this),
                $commentForm = $("#pevent__comment-from"),
                $commentFormBody = $("#commentform-body");
            $commentForm.attr("data-respond-to", "");
            $commentFormBody.val("");
            $clearBtn.hide()
        });
        $(window).scroll(function() {
            var menuHeadFloatOld = $(".main__head-float");
            var navigationFloat = $(".js-navigation-float");
            if (menuHeadFloatOld.length > 0) {
                menuPosition(menuHeadFloatOld, $("#row-main__head"), "m-fixed")
            } else if (navigationFloat.length > 0) {
                menuPosition(navigationFloat, $(".container-navigation-panel"), "b-navigation-fixed")
            }
            if (!noScrollAction) {
                if ($(menuItems).closest("ul").hasClass("nav-tabs")) return false;
                var fromTop = $(this).scrollTop() + 52;
                var cur = scrollItems.map(function() {
                    if ($(this).offset().top < fromTop) return this
                });
                cur = cur[cur.length - 1];
                var id = cur && cur.length ? cur[0].id : "";
                if (lastId !== id) {
                    lastId = id;
                    navigationFloat.find("li").removeClass("active");
                    menuItems.filter('[href="#' + id + '"]').parent("li").addClass("active")
                }
            }
        });

        function menuPosition(menu, parent, toggleClass) {
            var scroll = $(window).scrollTop();
            if (!parent) {
                return false
            }
            var parent = parent.offset().top;
            if (scroll > parent) {
                $(menu).addClass(toggleClass)
            } else {
                $(menu).removeClass(toggleClass)
            }
        }
        var retinaImgs = $(".img-retina-ready");
        if (window.devicePixelRatio >= 2) {
            $(retinaImgs).each(function() {
                var retinaSrc = $(this).data("retina-src");
                if (retinaSrc) {
                    $(this).attr("src", retinaSrc)
                }
            })
        }
        var mainFilterObject = {
            filterBlocks: $(".main__filter-block"),
            filterList: $(".main__filter-list"),
            fade: function(self) {
                $(".main__filter-block").stop().fadeOut(200);
                $(".main__filter-link").not(self).removeClass("open");
                $(self).toggleClass("open");
                var block = $(self).next(".main__filter-block");
                $(block).stop().fadeToggle(200)
            },
            close: function(target) {
                if ($(target).closest(".main__filter-link").length == 0 && $(target).closest(".main__filter-field").length == 0 && ($(target).closest(".no-close").length == 0 || $(target).closest(".no-close-cancel").length)) {
                    $(".main__filter-block").fadeOut(200);
                    $(".main__filter-link").removeClass("open");
                    $(".main__filter-list").find(".no-close").removeClass("no-close-cancel")
                }
            },
            select: function(self) {
                if ($(self).hasClass("no-selected")) return;
                $(self).closest(".main__filter-list").find("a").removeClass("active");
                var text = $(self).find(".text").text();
                var day = $(self).find(".text").data("day");
                var createDate = $(self).closest("#create__date").length > 0 ? true : false;
                if (createDate) {
                    $(self).addClass("active");
                    var item = $(self).closest(".main__filter-item").find(".main__filter-link .text");
                    var dText = $(self).attr("data-day");
                    item.attr("data-day", day).text(dText + " ???????")
                } else {
                    $(self).addClass("active").closest(".main__filter-item").find(".main__filter-link .text").text(text)
                }
            },
            search: function(self) {
                var value = $(self).val();
                var data = [{
                    "?z???N?N??": [{
                        id: 1,
                        name: "??????NN????N? ?????N?NN?"
                    }, {
                        id: 2,
                        name: "???N?N????N????N? ?????N?NN?"
                    }]
                }, {
                    "???N?????": [{
                        id: 3,
                        name: "???N?N????"
                    }, {
                        id: 4,
                        name: "???N???N??"
                    }, {
                        id: 5,
                        name: "???NNN???"
                    }, {
                        id: 6,
                        name: "???NNN???"
                    }]
                }];
                this.remove(self);
                var list = $('<ul class="main__filter-list">');
                for (var i = 0; i < data.length; i++) {
                    var items = data[i];
                    for (var key in items) {
                        if (items.hasOwnProperty(key)) {
                            for (var j = 0; j < items[key].length; j++) {
                                var type;
                                if (j == 0) {
                                    type = '<span class="type-local">' + key + "</span>"
                                } else {
                                    type = ""
                                }
                                $(list).append('<li><a href="#">' + type + '<span class="text">' + items[key][j].name + "</span>" + "</a></li>")
                            }
                        }
                    }
                }
                $(".main__filter-field").after(list)
            },
            remove: function(self) {
                var list = $(self).closest(".main__filter-block").find(".main__filter-list");
                if (list) {
                    $(list).remove()
                }
            },
            clear: function(self) {
                $(self).val("");
                this.remove(self)
            }
        };
        $(document).on("click", "#link-params", function() {
            $(this).toggleClass("active");
            $("#main__filter").slideToggle(200);
            var text = $(this).hasClass("active") ? "?????N??N?NN? ???N????NNN" : "?Y???????NN? ???N????NNN";
            $(this).text(text)
        });
        $(document).on("click", ".main__filter-link", function(event) {
            event.preventDefault();
            mainFilterObject.fade(this)
        });
        $(document).on("click", ".main__filter-list a", function(event) {
            mainFilterObject.select(this)
        });
        $("body").on("click", function(event) {
            mainFilterObject.close(event.target)
        });
        $(document).on("keyup", ".main__filter-input", function() {
            if ($(this).val()) {
                $(this).closest(".main__filter-field").addClass("no-empty").find(".main__filter-clear").addClass("active")
            } else {
                $(this).closest(".main__filter-field").removeClass("no-empty").find(".main__filter-clear").removeClass("active")
            }
            if ($(this).val().length >= 3) {
                mainFilterObject.search(this)
            } else {
                mainFilterObject.remove(this)
            }
        });
        $(document).on("click", ".main__filter-clear", function(event) {
            event.preventDefault();
            if ($(this).hasClass("active")) {
                $(this).removeClass("active");
                $(this).closest(".main__filter-field").removeClass("no-empty");
                mainFilterObject.clear($(this).prev(".main__filter-input"))
            }
        });
        $(".petition-pbar-inner[data-progress-width]").each(function() {
            var width = $(this).data("progress-width");
            $(this).animate({
                width: width
            }, 600, function() {
                var next = $(this).next(".petition__item-pbar-inner-agin");
                if (next.length) {
                    var nextWidth = $(next).data("progress-width");
                    $(next).css({
                        left: width,
                        marginLeft: "-1px"
                    });
                    $(next).animate({
                        width: nextWidth
                    }, 600)
                }
            })
        });
        $(".disabled:not(.button-social-public--profile)").click(function() {
            return false
        });
        $(".box-close").on("click", function() {
            var parent = $(this).parent(".helper_box");
            var self = this;
            $(parent).fadeOut(200, function() {
                if ($(self).hasClass("box-remove")) {
                    $(parent).remove()
                }
            })
        });
        $(".border-focus-child").on("focus", function() {
            $(this).closest("div, span").addClass("border-focus-parent")
        });
        $(".border-focus-child").on("focusout", function() {
            $(this).closest("div, span").removeClass("border-focus-parent")
        });
        $(".nav-tabs a").click(function(event) {
            event.preventDefault();
            var tabs = $(this).closest(".nav-tabs");
            var click_id = $(this).attr("id");
            if (click_id != $(".nav-tabs a.active").attr("id")) {
                if (tabs.hasClass("nav-tabs-main")) {
                    $(".nav-tabs li").removeClass("active");
                    $(this).parent("li").addClass("active")
                } else {
                    $(".nav-tabs a").removeClass("active");
                    $(this).addClass("active")
                }
                $(".content-tab").removeClass("active");
                $("#content-" + click_id).addClass("active")
            }
        });
        $(".radio-choice").on("click", function() {
            var parent = $(this).parent(".radio-choice-wrap");
            $(parent).find(".radio-choice").removeClass("active");
            $(this).addClass("active")
        });
        $(".icon-remove").on("click", function() {
            var data = $(this).data("id-remove");
            if (data) {
                $(data).slideUp(300);
                if (data == "#main-p__info") {
                    setCookie("info-block__hide-status", "off")
                }
            }
        });
        var $howDoesItWorkBlock = $("#main-p__info");
        if ($howDoesItWorkBlock.is(":visible") && getCookie("info-block__hide-status") != "off") {
            var currentStatus = 0;
            if (hasCookie("info-block__hide-status")) {
                currentStatus = getCookie("info-block__hide-status")
            }
            if (currentStatus == 2) {
                setCookie("info-block__hide-status", "off")
            } else {
                setCookie("info-block__hide-status", ++currentStatus)
            }
        }
        $(".create__date-number").on("keyup", function(e) {
            var value = $(this).val();
            var a = $(this).closest("a");
            $(a).attr("data-day", value);
            if (value != "") {
                $(a).addClass("no-close-cancel")
            } else {
                $(a).removeClass("no-close-cancel")
            }
        });
        $("#video__play-button").on("click", function(e) {
            e.preventDefault();
            setTimeout(function() {
                $("#pevent__image, #petition__image, #upload_preview-image, #video__play-button").hide(0);
                $("#upload_preview-video").show(0)
            }, 100);
            var video = $("#petition__video");
            var src = $(video).attr("src") + "&autoplay=1";
            $(video).attr("src", src)
        });
        var accordWrapper = $(".accordion__wrapper");
        $(".accordion__head", accordWrapper).on("click", function() {
            var item = $(this).parent(".accordion__item");
            var collection = accordWrapper.find(".accordion__content");
            collection.removeClass("last-active");
            item.find(".accordion__content").addClass("last-active");
            collection.not(".last-active").stop().slideUp(400);
            item.find(".accordion__content").stop().slideToggle(300)
        });
        $(".js-show-info-block").on("click", function(event) {
            event.preventDefault();
            var block = $(".js-container-main-info");
            var offsetTop = null;
            block.slideDown(400, function() {
                offsetTop = block.offset().top;
                $("html, body").stop().animate({
                    scrollTop: offsetTop
                }, 400)
            })
        });
        $(document).on("click", ".user-message__item a", function(e) {
            e.stopPropagation()
        });
        $(document).on("click", ".user-message__item", function(e) {
            e.preventDefault();
            var $self = $(this);
            $self.toggleClass("a-comment__item-active")
        });
        $(document).on("click", "#messages__delete-selected", function(e) {
            e.preventDefault();
            var $self = $(this),
                url = $self.attr("href"),
                $selectedMessages = $(".user-message__item.a-comment__item-active"),
                messageIdArray = [],
                paramsArray = [];
            $selectedMessages.each(function() {
                messageIdArray.push($(this).data("id"))
            });
            if (!messageIdArray.length) {
                return
            }
            for (var i = 0; i < messageIdArray.length; i++) {
                paramsArray.push("ids[]=" + messageIdArray[i])
            }
            url += "?" + paramsArray.join("&");
            location.href = url
        });

        function callCreateFixedTooltipClass() {
            setTimeout(function() {
                createFixedTooltipClass()
            }, 100)
        }

        function setPlaceholderForInput(element, placeholder) {
            if (!element.attr("placeholder") && element.length > 0) {
                element.attr("placeholder", placeholder)
            }
        }
    })
})(jQuery);
$(document).on("click", ".outer-link-button", function(e) {
    e.preventDefault();
    var link = $(this).data("link");
    if (link) {
        window.location.href = link
    }
});
$(document).on("click", ".button-social-public--profile", function(e) {
    e.preventDefault();
    var $this = $(this),
        link = $(this).attr("href");
    if (!$this.hasClass("clicked")) {
        $this.addClass("clicked");
        $.ajax({
            type: "post",
            dataType: "json",
            url: link,
            success: function(response) {
                if (response.success) {
                    $this.toggleClass("disabled")
                }
            }
        })
    }
});
$(document).on("focus", ".petition__support-form textarea", function(e) {
    checkAccess(e)
});
$(document).on("click", ".petition-view__write-button", function(e) {
    e.preventDefault();
    checkAccess(e);
    var $self = $(this),
        $form = $self.closest(".petition__support-form").eq(0),
        actionUrl = $form.attr("action"),
        text = $form.find(".petition-view__write-area").eq(0).html(),
        $formBlock = $form.parents(".petition-view__write"),
        $container = $form.parents(".b-petition-view");
    $.ajax({
        type: "post",
        dataType: "json",
        data: {
            "PetitionSupportForm[body]": text
        },
        url: actionUrl,
        success: function(response) {
            if (response.success) {
                $formBlock.hide();
                $container.append(response.support)
            }
        }
    })
});
var _masonryOptions, gMobileMenu;
var bxSliderStorage = {};
$(document).ready(function() {
    $(".js-phone-mask").mask("+7(999) 999-9999");
    var $defaultTooltip = $(".js-mytooltip");
    if ($defaultTooltip.length > 0) {
        $defaultTooltip.myTooltip({
            offset: 15,
            direction: "bottom",
            dinamicContent: true,
            theme: "light"
        })
    }
    var $fancybox = $(".js-fancybox");
    if ($fancybox.length > 0) {
        $fancybox.fancybox({
            helpers: {
                overlay: {
                    css: {
                        background: "rgba(12, 32, 46, 0.7)"
                    }
                }
            }
        })
    }
    var containerGrid = $(".js-masonry-grid");
    _masonryOptions = {
        gutter: 0,
        itemSelector: ".js-masonry-item",
        transitionDuration: 0
    };
    if (containerGrid.length > 0) {
        containerGrid.masonry(_masonryOptions)
    }
    $(".js-slider-create-petition").bxSlider({
        mode: "fade",
        adaptiveHeight: true,
        pager: false,
        auto: true,
        autoDelay: 5e3
    });
    var tabs = document.querySelectorAll(".js-tabs-container");
    for (var i = 0; i < tabs.length; i++) {
        new App.Tabs(tabs[i])
    }
    $(".js-slide-block-container").each(function() {
        new App.SlideBlock($(this))
    });
    gMobileMenu = new App.MobileMenu($(".js-mobile-menu-list"), $(".js-mobile-menu-action-toggle"));
    initDynamicImages();
    window.initCountDownRegistration = function() {
        var container = document.querySelector(".b-login-popup-count-down");
        container.style.display = "inline-block";
        var timerMinutes = 5;
        var timerSeconds = 0;
        var timePassedValueInSeconds = container.getAttribute("data-time-passed");
        if (timePassedValueInSeconds) {
            var allTimeInSeconds = timerMinutes * 60 + timerSeconds;
            var timeLeft = allTimeInSeconds - timePassedValueInSeconds;
            timerMinutes = Math.floor(timeLeft / 60);
            timerSeconds = timeLeft % 60
        }
        var timeIsOverElements = $(".js-time-is-over-count");
        if (timeIsOverElements.length > 0) {
            timeIsOverElements.addClass("disabled")
        }
        var countDownRegistration = new CountDown({
            minutes: timerMinutes,
            seconds: timerSeconds,
            timeIsOver: function() {
                if (container) {
                    container.style.display = "none";
                    container.setAttribute("data-time-passed", "0")
                }
                if (timeIsOverElements.length > 0) {
                    timeIsOverElements.removeClass("disabled")
                }
            }
        });
        countDownRegistration.render(document.querySelector(".js-count-down-popup-registration"));
        countDownRegistration.start()
    }
});
$(window).load(function() {
    var containerGrid = $(".js-masonry-grid");
    if (containerGrid.length > 0) {
        containerGrid.masonry(_masonryOptions)
    }
    $(".js-animate-number").each(function() {
        var endValue = $(this).data("num");
        animateNumber($(this), endValue)
    });
    var $floatWidgetCreate = $(".js-float-widget-create");
    var $sidebar = $(".js-sidebar-create");
    if ($floatWidgetCreate.length > 0) {
        $floatWidgetCreate.stickyBlock({
            top: 20,
            parent: $sidebar,
            start: {
                element: $sidebar,
                offset: -20
            },
            end: {
                element: $("#main"),
                offset: 50,
                border: "bottom"
            },
            defaultShow: true,
            returnToInitialState: function() {
                return App.detectWindowSize(1024)
            }
        });
        $(window).resize(function() {
            setSizeFloatElement($floatWidgetCreate, $sidebar)
        });
        setSizeFloatElement($floatWidgetCreate, $sidebar)
    }
    var $floatWidgetPetition = $(".js-float-widget-petition");
    var endPopularBottom = $(".container-popular-bottom");
    if ($floatWidgetPetition.length > 0 && endPopularBottom.length > 0) {
        var floatWidgetPetitionTop = 20;
        var sidebar = $("#sidebar");
        if ($(".main__head-float").length > 0) {
            floatWidgetPetitionTop = 71
        } else if ($(".container-navigation-panel").length > 0) {
            floatWidgetPetitionTop = 67
        }
        $floatWidgetPetition.stickyBlock({
            top: floatWidgetPetitionTop,
            parent: sidebar,
            animate: "fadeInDown",
            start: {
                element: $(".js-last-sidebar-widget"),
                offset: 0,
                border: "bottom"
            },
            end: {
                element: endPopularBottom,
                offset: 60
            },
            defaultShow: true,
            returnToInitialState: function() {
                return App.detectWindowSize(1024)
            }
        });
        $(window).resize(function() {
            setSizeFloatElement($floatWidgetPetition, sidebar)
        });
        setSizeFloatElement($floatWidgetPetition, sidebar)
    }
    if ($("body").data("view-type") === "side-menu") {
        var $sidebarStatic = $(".js-sidebar-static");
        var statusCreate = App.sideMenu($sidebarStatic);
        if (statusCreate) {
            var $floatWidget = $(".js-block-side-menu");
            var $startElement = $(".last-sidebar-widget");
            var startOptions;
            var animateOptions = false;
            if ($startElement.length > 0) {
                animateOptions = "fadeInDown";
                startOptions = {
                    element: $startElement,
                    border: "bottom",
                    offset: 20
                }
            } else {
                startOptions = {
                    offset: -20
                }
            }
            if ($floatWidget.length > 0) {
                $floatWidget.stickyBlock({
                    top: 20,
                    parent: $sidebarStatic,
                    animate: animateOptions,
                    start: startOptions,
                    end: {
                        element: $("#main"),
                        offset: 70,
                        border: "bottom"
                    },
                    returnToInitialState: function() {
                        return App.detectWindowSize(1024)
                    }
                });
                detectHashUrl();
                $(window).resize(function() {
                    setSizeFloatElement($floatWidget, $sidebarStatic)
                });
                setSizeFloatElement($floatWidget, $sidebarStatic)
            }
        }
    }
    var sliderFavourites = $(".js-slider-favourites");
    sliderFavourites.bxSlider({
        pager: true,
        auto: true,
        adaptiveHeight: true,
        autoDelay: 7e3,
        onSliderLoad: function() {
            sliderFavourites.css("opacity", 1)
        }
    });
    var dinamicBehavoirSliderStorage = {};
    var dinamicBehavoirSliderOptions = {};
    dinamicBehavoirSliderOptions["optionsPaymentSlider"] = {
        pager: false,
        auto: false,
        minSlides: 3,
        maxSlides: 3,
        infiniteLoop: false,
        hideControlOnEnd: true,
        slideWidth: 85,
        slideMargin: 0
    };
    dinamicBehavoirSliderOptions["optionsResolvedSlider"] = {
        pager: false,
        auto: false,
        minSlides: 4,
        maxSlides: 4,
        slideWidth: 240,
        slideMargin: 20,
        infiniteLoop: true
    };
    var slidersCollection = $(".js-dinamic-behavoir-slider");
    slidersCollection.each(function(index, slider) {
        var $slider = $(slider);
        var optionsObject = dinamicBehavoirSliderOptions[$slider.data("options-object")];
        var optionsSize = $slider.data("options-size");
        var dinamicBehavoirSlider = new App.DinamicBehavoirSlider($slider, optionsObject, optionsSize);
        if ($slider.data("create-page-ready")) {
            dinamicBehavoirSlider.create()
        }
        if ($slider.data("create-event")) {
            var sliderId = $slider.data("storage-id");
            if (sliderId) {
                dinamicBehavoirSliderStorage[sliderId] = dinamicBehavoirSlider
            }
        }
    })
});

function setSizeFloatElement(element, container) {
    if (element && container) {
        element.css("width", container.width())
    }
}
$(function() {
    var initScroll = false;
    var customSrollElement = $(".custom-scroll");
    var pageServiceMessage = $("body").hasClass("page-service-message");
    var setMaxHeigth = function(objectElements) {
        objectElements.topBar = objectElements.topBar || 0;
        objectElements.bottomBar = objectElements.bottomBar || 0;
        var maxHeigth = $(window).height() - objectElements.header - objectElements.topBar;
        if (objectElements.leftBlock) {
            objectElements.leftBlock.find(".custom-scroll").css({
                maxHeight: maxHeigth,
                height: maxHeigth
            })
        }
        if (objectElements.rightBlock) {
            objectElements.rightBlock.find(".custom-scroll").css({
                maxHeight: maxHeigth - objectElements.bottomBar,
                height: maxHeigth - objectElements.bottomBar
            });
            $(".send-message-form").css("opacity", 1)
        }
        if (!initScroll) {
            $(customSrollElement).each(function() {
                var $current = $(this);
                $current.mCustomScrollbar({
                    scrollInertia: 100,
                    callbacks: {
                        onTotalScroll: function() {
                            if ($(window).width() < 768 && $(window).height() < $(this).height()) {
                                $("body, html").animate({
                                    scrollTop: $(document).scrollTop() + 50
                                }, 100)
                            }
                        }
                    }
                });
                if ($current.hasClass("js-default-scroll-bottom")) {
                    $current.mCustomScrollbar("scrollTo", "bottom", {
                        scrollInertia: 0
                    })
                }
                initScroll = true
            })
        } else {
            customSrollElement.mCustomScrollbar("update")
        }
    };
    if (customSrollElement.length > 0) {
        if (pageServiceMessage) {
            var pageServiceMessageElements = {
                header: $(".header").outerHeight(),
                leftBlock: $("#service__message-m"),
                rightBlock: $("#service__message-d"),
                topBar: $("#service__message-m").find(".service__message-top").outerHeight(),
                bottomBar: $(".send-message-form").outerHeight()
            };
            setMaxHeigth(pageServiceMessageElements)
        } else {
            $(customSrollElement).mCustomScrollbar({
                scrollInertia: 100
            })
        }
    }
    $(window).resize(function() {
        if (pageServiceMessage && pageServiceMessageElements) {
            setMaxHeigth(pageServiceMessageElements)
        }
    })
});
"use strict";
window["alternativeYandexDirect"] = function(target) {
    var container = target.closest(".js-alternative-direct-container");
    if (container.length > 0) {
        container.remove()
    }
};
$(document).ready(function() {
    var sizeOfFixedHeaders = {
        default: 0
    };
    $(document).on("click", ".anchor_to_history", function() {
        window.history.pushState(null, "", $(this).attr("href"))
    });
    $(document).on("click", ".scroll-to-anchor", function(event) {
        event.preventDefault();
        elementScrolling($(this).attr("href"), false, 300)
    });
    window.detectHashUrl = function() {
        var currentUrl = window.location.href;
        if (currentUrl.indexOf("#") >= 0) {
            var hashUrl = currentUrl.slice(currentUrl.indexOf("#"));
            elementScrolling(hashUrl)
        }
    };
    window.elementScrolling = function(selector, onload, animateTime) {
        if (onload == undefined) {
            onload = true
        }
        if (animateTime == undefined) {
            animateTime = 1
        }
        var el = $(selector);
        if (el.length == 0) {
            return false
        } else if (el.length > 1) {
            el = el[0]
        }
        var positionTop = sizeOfFixedHeaders.default;
        for (var pageSelector in sizeOfFixedHeaders) {
            if (pageSelector != "default" && $(pageSelector).length > 0) {
                positionTop = sizeOfFixedHeaders[pageSelector]
            }
        }
        if (!el.parent().is(":visible")) {
            el.parent().css("display", "block")
        }
        var animate = function() {
            $("html, body").animate({
                scrollTop: el.offset().top - positionTop
            }, animateTime)
        };
        if (onload) {
            $(document).load(animate())
        } else {
            animate()
        }
        return false
    }
});
$(document).ready(function() {
    var currentHref = window.location.href;
    var tooltipEditorElements = [{
        selectors: ["#main__title .select2-search__field", ".js-mytooltip-editor-constant--address"],
        selectorTooltipContent: ".js-tooltip-adress-",
        customClass: "tooltip-editor-select2 tooltip-editor tooltip-address"
    }, {
        selectors: [".js-create-title", ".js-mytooltip-editor-constant--title"],
        selectorTooltipContent: ".js-tooltip-title-",
        customClass: "tooltip-editor tooltip-title"
    }, {
        selectors: [".redactor-editor", ".js-mytooltip-editor-constant--content"],
        selectorTooltipContent: ".js-tooltip-content-",
        customClass: "tooltip-editor-redactor tooltip-editor",
        customTags: {
            "data-mytooltip-border": "top"
        }
    }, {
        selectors: [".js-container-tags .select2-search__field"],
        selectorTooltipContent: ".js-tooltip-tags-",
        customClass: "tooltip-editor-select2 tooltip-editor tooltip-tags"
    }, {
        selectors: [".js-mytooltip-editor-constant--tags"],
        selectorTooltipContent: ".js-tooltip-tags-",
        customClass: "tooltip-editor-select2 tooltip-editor"
    }];
    $(".js-create-type").on("click", ".js-create-type-item", function() {
        var petitionType = $(this).data("type");
        createEditorTooltip(petitionType, tooltipEditorElements)
    })
});
var lastClicked = [];
$(document).on("click", function(event) {
    if (lastClicked.length >= 2) {
        lastClicked.shift()
    }
    lastClicked.push($(event.target))
});

function hideTooltip(self, currentLenght, maxLenght) {
    var tooltipId = self.data("mytooltip-id");
    if (currentLenght >= maxLenght && tooltipId != null) {
        $('.system-mytooltip--item[data-mytooltip-id="' + tooltipId + '"]').find(".js-mytooltip-close").click()
    }
}

function createEditorTooltip(petitionType, elements) {
    elements.forEach(function(item) {
        if (item.selectors.length > 0) {
            item.selectors.forEach(function(element) {
                var $element = $(element);
                if ($element.length === 0) {
                    console.error("Element " + element + " not found from DOM!");
                    return
                } else if ($element.hasClass("js-no-create-tooltip")) {
                    return
                }
                var dataAttrClass = $element.data("mytooltip-class");
                if (dataAttrClass == null) {
                    dataAttrClass = ""
                }
                item.customClass += " " + dataAttrClass;
                $element.attr("data-mytooltip-content", item.selectorTooltipContent + petitionType).attr("data-mytooltip-custom-class", item.customClass);
                var isTooltipConstant = $element.hasClass("js-mytooltip-editor-constant");
                if (!isTooltipConstant) {
                    $element.addClass("js-mytooltip-editor")
                } else {
                    $element.attr("data-mytooltip-custom-class", item.customClass + " mod-position--left")
                }
                if (item.customTags && Object.keys(item.customTags).length) {
                    for (var key in item.customTags) {
                        if (item.customTags.hasOwnProperty(key)) {
                            $element.attr(key, item.customTags[key])
                        }
                    }
                }
            })
        }
    });
    var tooltipOptions = {
        offset: 12,
        direction: "bottom",
        action: "click",
        dinamicContent: true,
        theme: "light",
        cancelExecution: function() {
            return App.detectWindowSize(1024)
        }
    };
    if ($(".js-mytooltip-editor").length > 0) {
        $(".js-mytooltip-editor").myTooltip(tooltipOptions).on("show-before", function() {
            if (App.detectWindowSize(1024)) {
                $("html").css("overflow", "hidden");
                $("body").css("padding-right", "15px")
            }
        }).on("hide-complete", function() {
            if (App.detectWindowSize(1024)) {
                $("html").css("overflow", "");
                $("body").css("padding-right", "")
            }
            var $self = lastClicked[0];
            if ($self.hasClass("js-mytooltip-editor")) {
                $self.myTooltip("destroy");
                if (lastClicked[1] && !lastClicked[1].hasClass("js-mytooltip-editor")) {
                    $self.focus();
                    var html = $self.html();
                    $self.html("");
                    try {
                        document.execCommand("insertHtml", false, html)
                    } catch (e) {
                        $self.html(html)
                    }
                }
            }
        })
    }
    if ($(".js-mytooltip-editor-constant").length > 0) {
        var tooltipOptionsConstant = $.extend(true, [], tooltipOptions);
        tooltipOptionsConstant.offset = 22;
        tooltipOptionsConstant.cancelExecution = null;
        $(".js-mytooltip-editor-constant").myTooltip(tooltipOptionsConstant).on("show-before", function() {
            if (App.detectWindowSize(1024)) {
                $("html").css("overflow", "hidden");
                $("body").css("padding-right", "15px")
            }
        }).on("hide-complete", function() {
            if (App.detectWindowSize(1024)) {
                $("html").css("overflow", "");
                $("body").css("padding-right", "")
            }
        })
    }
}

function showTooltipConstant(element) {
    element.closest(".js-create-container").find(".b-tooltip-info--create").css("display", "block").animate({
        opacity: 1,
        bottom: 10
    }, 200)
}

function createFixedTooltipClass() {
    var container = $(".js-container-tags");
    var height = container.outerHeight() - 39;
    $("body").find(".create-fixed-tooltip-style").remove();
    var createFixedTooltipStyle = "";
    createFixedTooltipStyle += '<style class="create-fixed-tooltip-style">';
    createFixedTooltipStyle += ".tooltip-editor-select2--fix  {margin-top: " + height + "px !important;}";
    createFixedTooltipStyle += "</style>";
    $(createFixedTooltipStyle).appendTo($("body"))
}
$(document).ready(function() {
    var createStorage = App.localStorage.get("createPetition");
    if (createStorage == null) {
        App.localStorage.set("createPetition", {});
        createStorage = {}
    }
    setTimeout(function() {
        setValueOfStorage(createStorage, function() {
            var progress = [];
            var $createTitle = $(".js-create-title");
            var createTitleText = $.trim($createTitle.text());
            if (createTitleText.length > 0 && createTitleText !== $createTitle.data("default-content")) {
                progress.push({
                    id: "#create__title",
                    isAbstract: false
                });
                $createTitle.addClass("js-no-create-tooltip")
            }
            var $createSum = $(".js-create-sum");
            $createSum.addClass("js-no-create-tooltip");
            var $createEditor = $(".redactor-editor");
            if ($createEditor.html() !== "<p>a</p>") {
                progress.push({
                    id: "#create__content-text",
                    isAbstract: false
                });
                showTooltipConstant($createEditor);
                $createEditor.addClass("js-no-create-tooltip")
            }
            var $select2 = $("#select-id-1, #select-id-2");
            $select2.each(function(index) {
                var choiceLenth = $(this).find(".select2-selection__choice").length;
                if (choiceLenth > 0) {
                    progress.push({
                        id: "#" + $($select2[index]).attr("id"),
                        isAbstract: false
                    });
                    var $select2Field = $($select2[index]).find(".select2-search__field");
                    $select2Field.addClass("js-no-create-tooltip")
                }
            });
            initProgressBar(progress)
        })
    }, 10);
    $(".js-create-title").on("keyup", function() {
        createStorage["title"] = $.trim($(this).text());
        pushValueInStorage(createStorage)
    });
    $(".js-create-sum").on("keyup", function() {
        createStorage["sum"] = $.trim($(this).text());
        pushValueInStorage(createStorage)
    });
    $(document).on("keyup", ".redactor-editor", function() {
        createStorage["content"] = $(this).html();
        pushValueInStorage(createStorage)
    });
    $(document).on("keydown", ".redactor-editor", function() {
        var redactor = $(this);
        setTimeout(function() {
            var className = redactor[0].className;
            if (className.indexOf("redactor-placeholder") >= 0) {
                createStorage["content"] = "";
                pushValueInStorage(createStorage)
            }
        }, 10)
    });
    $(document).on("click", ".redactor-toolbar a", function() {
        createStorage["content"] = $(this).closest(".redactor-toolbar").next(".redactor-editor").html();
        pushValueInStorage(createStorage)
    });
    $("#upload_preview-image img").on("load", function() {
        createStorage["image"] = $(this).attr("src");
        pushValueInStorage(createStorage)
    });
    var $select2 = $(".js-basic-multiple[data-type=tags], .js-basic-multiple[data-type=addressees]");
    $select2.on("change", function() {
        var type = $(this).data("type");
        createStorage[type] = {};
        $(this).next(".select2").find(".select2-selection__choice").each(function(index, current) {
            var title = $(current).attr("title");
            var id = title;
            var $option = $select2.find("option").filter(function(index, item) {
                return $(this).attr("title") === title
            });
            if ($option.val() && $option.val() !== title) {
                id = $option.val()
            }
            createStorage[type][title] = {
                id: id,
                title: title
            }
        });
        pushValueInStorage(createStorage)
    });

    function setValueOfStorage(object, callback) {
        for (var key in object) {
            if (object.hasOwnProperty(key)) {
                if (key === "title" && object[key].length > 0) {
                    $(".js-create-title").html(object[key]).parent("div").addClass("filled")
                } else if (key === "content" && object[key].length > 0) {
                    $(".redactor-editor").html(object[key])
                } else if (key === "image" && object[key].length > 0) {
                    var $previewImageCont = $("#upload_preview-image"),
                        $uploadPreview = $("#upload_preview"),
                        $uploadAddVideo = $(".upload_add-video"),
                        $uploadWindow = $("#upload_window");
                    $uploadWindow.hide();
                    $uploadAddVideo.hide();
                    $uploadPreview.show();
                    $uploadPreview.addClass("view_preview filled");
                    $previewImageCont.show();
                    $previewImageCont.find("img").attr("src", object[key])
                } else if (key === "images" && Object.keys(object[key]).length > 0) {
                    var idx = 1;
                    $(".js-loading-column").before($.map(object[key], function(file) {
                        return '<div class="grid-column-4 grid-column-small-6 grid-column-small-s-12 grid-left grid-padding-small js-grid-column">' + '<div class="loading-files__item js-rotate-wrapper" data-rotate-angle="0">' + '<div class="loading-files__image">' + '<img src="' + file.link + '" alt="' + file.fileName + '">' + "</div>" + '<div class="loading-files__controls">' + '<div class="loading-files__remove sprite-icons-file-remove js-image-remove" data-new="1" data-file-name="' + file.name + '" data-file-type="' + file.ext + '" data-file-id="' + file.id + '"></div>' + '<div class="b-image-rotate">' + '<div class="image-rotate__button image-rotate__button--left sprite-icons-rotate-left js-image-rotate" data-rotate-position="left"></div>' + '<div class="image-rotate__button image-rotate__button--right sprite-icons-rotate-right js-image-rotate" data-rotate-position="right">' + "</div>" + "</div>" + "</div>" + "</div>"
                    }))
                } else if ((key === "tags" || key === "addressees") && Object.keys(object[key]).length > 0) {
                    var ids = [];
                    $('.js-basic-multiple[data-type="' + key + '"]').append($.map(object[key], function(item) {
                        ids.push(item.id);
                        return $("<option>", {
                            val: item.id,
                            title: item.title
                        })
                    })).val(ids).trigger("change")
                }
            }
        }
        callback()
    }

    function pushValueInStorage(object) {
        App.localStorage.set("createPetition", object)
    }
});
$(document).ready(function() {
    $(document).on("change", ".js-checkbox-control-state", function() {
        var $self = $(this);
        var groupId = $self.data("control-state-group");
        var checked = $self.is(":checked");
        var $wrapper, $buttons;
        if (groupId != null) {
            $wrapper = $('.js-wrapper-control-group-state[data-control-state-group="' + groupId + '"]');
            $buttons = $wrapper.find(".js-button-control-state");
            checked ? $buttons.removeClass("invalid") : $buttons.addClass("invalid")
        }
    });
});
$(document).ready(function() {
    $(document).on("scroll", onScroll);
    $(document).on("click", ".js-scroll-navigation", function(event) {
        event.preventDefault();
        $(document).off("scroll", onScroll);
        $(this).parent().find(".js-scroll-navigation").each(function() {
            $(this).removeClass("active")
        });
        $(this).addClass("active");
        var hash = this.hash;
        $("html, body").stop().animate({
            scrollTop: $(hash).offset().top
        }, 500, "swing", function() {
            window.location.hash = hash;
            setTimeout(function() {
                $(document).on("scroll", onScroll)
            }, 100)
        })
    });

    function onScroll() {
        var scrollPos = $(document).scrollTop() + 1;
        $(".js-scroll-navigation").each(function() {
            var $self = $(this);
            var $refElement = $($self.attr("href"));
            if ($refElement.length === 0) {
                console.error($self.attr("href") + " not found in DOM");
                return
            }
            if (scrollPos >= $refElement.position().top) {
                $(".js-scroll-navigation").removeClass("active");
                $self.addClass("active")
            } else {
                $self.removeClass("active")
            }
        })
    }
});

function clipToBoard(button) {
    var $copyClipboardArea = $(".js-clipboard-area[data-clipboard-group='" + $(button).data("clipboard-group") + "']");
    if ($copyClipboardArea.length === 0) {
        App.error({
            from: "ClipToBoard",
            message: "??? ??????????? ?????N?NN? ???N? ????????N?????????N?!"
        });
        return false
    }
    button.on("click", function(event) {
        event.preventDefault();
        var message = $(this).data("message");
        copyClipToBoardAction(message)
    });

    function copyClipToBoardAction(message) {
        var flashMessage = "??N?N???? N?????????N???????? ?? ???N? ?N?N?N ?????????!";
        if (message) {
            flashMessage += "\n" + message
        }
        $copyClipboardArea.parent(".js-display-hide").show(0);
        $copyClipboardArea.select();
        try {
            if (App.isMobile.iOS()) {
                window.App.alert.frozenStream(3e3);
                copyToClipboardIOSMobile($copyClipboardArea.val())
            } else {
                document.execCommand("copy");
                var alert = new Alert;
                alert.clearStorage().push({
                    type: "info",
                    message: flashMessage
                }).call()
            }
        } catch (e) {
            copyToClipboardOldBrowser($copyClipboardArea.val())
        }
        $copyClipboardArea.parent(".js-display-hide").hide(0)
    }

    function copyToClipboardOldBrowser(value) {
        var copyCommandText = isMacOs() ? "Command-C" : "Ctrl+C";
        window.prompt("??N? ????????N?????????N? ????????N? N???N?N?????? ????????N?: " + copyCommandText, value)
    }

    function copyToClipboardIOSMobile(value) {
        window.prompt("??????????NN???N? N?N?N???N? ??N????????????N?NZ ??????: ", value)
    }

    function isMacOs() {
        return navigator.userAgent.indexOf("Mac") >= 0
    }
}
$(document).on("ready", function() {
    $(document).find(".js-clipboard-button").each(function() {
        clipToBoard($(this))
    });
    $(document).find(".js-mytooltip").on("show-complete", function() {
        var tooltipId = $(this).data("mytooltip-id");
        clipToBoard($(document).find("div[data-mytooltip-id=" + tooltipId + "] .js-clipboard-button"))
    })
});
(function() {
    window.placeholderLabelInit = function() {
        $(".js-placeholder-label").each(function() {
            var labelText = $(this).attr("placeholder");
            var isInit = $(this).attr("data-placeholder-init");
            if (!labelText || isInit) {
                return
            }
            var $label = $('<span class="placeholder-label">' + labelText + "</span>");
            $(this).closest(".js-placeholder-wrapper").append($label);
            $(this).attr("data-placeholder-init", "true");
            $(this).keyup(function() {
                toggleVisibleLabel($(this), $label)
            });
            $(this).blur(function() {
                toggleVisibleLabel($(this), $label)
            });
            toggleVisibleLabel($(this), $label)
        })
    };

    function toggleVisibleLabel(element, label) {
        var value = element.val();
        if (value) {
            label.stop().animate({
                opacity: 1
            }, 200)
        } else {
            label.stop().animate({
                opacity: 0
            }, 200)
        }
    }
})();
$(document).ready(function() {
    placeholderLabelInit()
});
$(document).ready(function() {
    var activeClass = "state-active";
    $(".js-search-bar-form").each(function() {
        var $self = $(this);
        $self.find(".js-search-bar-go").on("click", function() {
            var field = $self.find(".js-search-bar-field");
            if (!$self.hasClass(activeClass) && field.width() === 0) {
                $self.addClass(activeClass);
                field.stop().animate({
                    width: "100%"
                }, 300, function() {
                    $(this).focus()
                })
            } else {
                $self.submit()
            }
        });
        $self.find(".js-search-bar-close").on("click", function() {
            $self.find(".js-search-bar-field").stop().animate({
                width: 0
            }, 300, function() {
                $self.removeClass(activeClass)
            })
        })
    })
});
$(document).on("click", ".js-image-rotate", function(event) {
    event.preventDefault();
    var $parent = $(this).closest(".js-rotate-wrapper");
    var $img = $parent.find("img");
    var rotatePosition = $(this).data("rotate-position");
    var rotateAngle = Number($parent.attr("data-rotate-angle"));
    var currentAgle = rotatePosition === "right" ? 90 : -90;
    if (rotateAngle === 270 && rotatePosition === "right" || rotateAngle === -270 && rotatePosition === "left") {
        rotateAngle = 0
    } else {
        rotateAngle += currentAgle
    }
    $parent.attr("data-rotate-angle", rotateAngle);
    $img.css({
        transform: "rotate(" + rotateAngle + "deg)",
        "-webkit-transform": "rotate(" + rotateAngle + "deg)",
        "-moz-transform": "rotate(" + rotateAngle + "deg)",
        "-ms-transform": "rotate(" + rotateAngle + "deg)"
    })
});

function animateNumber(element, endValue) {
    var currentNumber = Number(element.text());
    var interval = setInterval(function() {
        if (endValue > currentNumber) {
            currentNumber++;
            element.text(currentNumber)
        } else {
            clearInterval(interval)
        }
    }, 15)
}
$(document).ready(function() {
    $(".js-iframe-tracker").iframeTracker({
        blurCallback: function(event) {
            var parameters = {
                type: this._type,
                category: this._network,
                action: this._action,
                url: this._virtualUrl || document.location.href
            };
            var services = this._services.split(" ");
            services.forEach(function(service) {
                parameters.service = service;
                App.Metric.send(parameters)
            })
        },
        overCallback: function(element) {
            if ($(element).hasClass("js-iframe-tracker")) {
                this._services = $(element).data("services");
                this._type = $(element).data("type");
                this._network = $(element).data("network");
                this._action = $(element).data("action");
                this._virtualUrl = $(element).data("virtual-url")
            } else {
                this._services = $(element).parents(".js-iframe-tracker").data("services");
                this._type = $(element).parents(".js-iframe-tracker").data("type");
                this._network = $(element).parents(".js-iframe-tracker").data("network");
                this._action = $(element).parents(".js-iframe-tracker").data("action");
                this._virtualUrl = $(element).parents(".js-iframe-tracker").data("virtual-url")
            }
        }
    })
});
(function() {
    $(document).ready(function() {
        if (!App.Cookies.isEnable()) {
            console.error("??N? ????NN???N?????? N????NN NN??N??NN?N? ?????????N???? cookie!");
            return
        }
        if (!App.Cookies.get("join_social_groups_popup")) {
            return;
            callPopup(1e4, "join-social-groups", function() {
                App.Cookies.set("join_social_groups_popup", "1", 7, "/");
                App.Metric.send({
                    service: "ga",
                    type: "pageview",
                    virtual: "OPEN_popup_social_groups"
                })
            })
        }
    });

    function callPopup(delay, id, callback) {
        setTimeout(function() {
            var popup = $('[data-remodal-id="' + id + '"]');
            if (popup && !allReadyHasPopupShow() && !gMobileMenu.getIsOpen() && !App.detectWindowSize(768)) {
                popup.remodal().open();
                $(".js-on-remodal-open").click();
                callback()
            }
        }, delay)
    }

    function allReadyHasPopupShow() {
        if ($(".remodal-overlay").is(":visible")) {
            return true
        }
    }
})();
$(document).ready(function() {
    $(document).on("click keyup", ".js-toggle-class", function(event) {
        var container = $(this).closest(".js-toggle-class-container");
        var type = $(this).data("event-type");
        var placeholder = $(this).data("emulate-placeholder");
        if (type === "keyup") {
            if ($(this).find("input").val().length > 0) {
                toogle(container, $(this))
            }
        } else {
            toogle(container, $(this))
        }
    });

    function toogle(container, self) {
        container.find(".js-toggle-class").removeClass("active");
        self.addClass("active")
    }
});

function isNumberKey(evt) {
    var charCode = evt.which ? evt.which : event.keyCode;
    if (charCode > 31 && (charCode < 48 || charCode > 57)) return false;
    return true
}(function() {
    $(document).ready(function() {
        $(".js-hide-mobile-menu").on("click", function() {
            gMobileMenu.hideMenu(100)
        })
    })
})();
$(document).ready(function() {
    var backToTop = App.Ui.backToTop;
    var button = $(".js-back-to-top");
    if (button.length === 0) {
        return
    }
    backToTop.init(button)
});
"use strict";
(function() {
    var positionDirection;
    $(window).load(function() {
        var slider = $(".js-bx-slider-position-direction");
        var images = slider.find(".petition-view__left");
        var direction = slider.find(".bx-controls-direction");
        positionDirection = function() {
            var imageHeight = 0;
            if (window.innerWidth > 600) {
                direction.css("top", "");
                return
            }
            var imageHeight = 0;
            images.each(function(index, image) {
                var currentHeigth = $(image).height();
                if (currentHeigth > imageHeight) {
                    imageHeight = currentHeigth
                }
            });
            direction.css({
                top: imageHeight / 2,
                opacity: 1
            })
        };
        positionDirection()
    });
    $(window).resize(function() {
        setTimeout(function() {
            if (typeof positionDirection === "function") {
                positionDirection()
            }
        }, 50)
    })
})();
"use strict";
document.addEventListener("DOMContentLoaded", function() {
    var mobileBottomArea = App.Ui.mobileAreaBottom;
    var container = $(".js-mobile-bottom-area");
    if (container.length === 0) {
        return
    }
    mobileBottomArea.init(container);
    if (App.detectWindowSize(1024) && !mobileBottomArea.isShow) {
        mobileBottomArea.show()
    }
    $(window).resize(function() {
        if (App.detectWindowSize(1024) && !mobileBottomArea.isShow) {
            mobileBottomArea.show()
        } else if (!App.detectWindowSize(1024) && mobileBottomArea.isShow) {
            mobileBottomArea.hide()
        }
    })
});
"use strict";
$(function() {
    var $subscribeButtons = $(".js-toggle-subscribe-text");
    $subscribeButtons.on("click", function(event) {
        event.preventDefault();
        var $self = $(this);
        var inner = $self.find(".action-profile-button-inner");
        $self.toggleClass("is-subscribed");
        var state = $self.attr("data-subscribe-state");
        if (state === "unsubscribed") {
            inner.text("?Y????????N???N?N?");
            $self.attr("data-subscribe-state", "subscribed")
        } else {
            inner.text("?Y????????N??NN?N?N?");
            $self.attr("data-subscribe-state", "unsubscribed")
        }
    });
    $subscribeButtons.on("mouseenter", function() {
        if ($(this).hasClass("is-subscribed")) {
            $(this).addClass("action-unsubscribed");
            $(this).find(".action-profile-button-inner").text("?zN????N??NN?N?N?")
        }
    });
    $subscribeButtons.on("mouseleave", function() {
        if ($(this).hasClass("is-subscribed")) {
            $(this).removeClass("action-unsubscribed");
            $(this).find(".action-profile-button-inner").text("?Y????????N???N?N?")
        }
    })
});
$(function() {
    $(".js-petition-view-write-area").on("focus", function() {
        $(this).closest(".js-petition-view-write").addClass("is-focused")
    });
    $(".js-petition-view-write-area").on("focusout", function() {
        var value = $.trim($(this).text());
        if (value.length === 0) {
            $(this).closest(".js-petition-view-write").removeClass("is-focused")
        }
    })
});
(function() {
    var lastWidth;

    function calculationWidthNavigation(menu) {
        var width = 0;
        if (menu && menu.length) {
            menu.find(".navigation-menu__item").each(function(item) {
                width += item.width(true)
            });
            if (lastWidth !== width) {
                menu.find(".navigation-menu__ul").css("width", width);
                lastWidth = width
            }
        }
    }

    function updateDataHeigth(menu) {
        menu.attr("data-height", menu.outerHeight())
    }
    $(document).on("ready", function() {
        updateDataHeigth($(".js-navigation-scroller"))
    });
    $(window).on("resize", function() {
        updateDataHeigth($(".js-navigation-scroller"))
    })
})();
(function() {
    var lastWidth;

    function calculationWidthNavigation(menu) {
        var width = 0;
        if (menu && menu.length) {
            menu.find(".navigation-menu__item").each(function(item) {
                width += item.width(true)
            });
            if (lastWidth !== width) {
                menu.find(".navigation-menu__ul").css("width", width);
                lastWidth = width
            }
        }
    }

    function updateDataHeigth(menu) {
        menu.attr("data-height", menu.outerHeight())
    }
    $(document).on("ready", function() {
        updateDataHeigth($(".js-navigation-scroller"))
    });
    $(window).on("resize", function() {
        updateDataHeigth($(".js-navigation-scroller"))
    })
})();
"use strict";
document.addEventListener("DOMContentLoaded", function() {});
"use strict";
document.addEventListener("DOMContentLoaded", function() {
    var shadowBlock = document.createElement("div");
    shadowBlock.innerHTML = "&nbsp;";
    shadowBlock.className = "adsbox";
    document.body.appendChild(shadowBlock);
    window.setTimeout(function() {
        if (shadowBlock.offsetHeight === 0) {
            document.body.classList.add("adblock-enabled")
        }
        shadowBlock.remove()
    }, 100)
});
"use strict";
(function() {
    $(document).ready(function() {
        $(".js-show-hidden-block").on("click", function(event) {
            event.preventDefault();
            var $this = $(this);
            var blockId = $this.attr("data-block-id");
            var hiddenThis = $this.attr("data-hidden-this");
            if (blockId) {
                $("#" + blockId).slideToggle(200)
            }
            if (hiddenThis) {
                $this.css("display", "none")
            }
        })
    })
})();

function initDynamicImages() {
    var dinamicImageN?ollection = $(document).find(".js-dinamic-loading-image:not(.js-dinamic-image-initialized)");
    dinamicImageN?ollection.each(function(index, image) {
        var $image = $(image);
        var sizes = $image.data("dinamic-sizes");
        new App.DinamicLoadingImages($image, sizes, function(image, size) {
            $image.addClass("js-dinamic-image-initialized")
        })
    })
}
"use strict";
$(document).ready(function() {
    if (!App.Cookies.isEnable()) {
        console.error("??N? ????NN???N?????? N????NN NN??N??NN?N? ?????????N???? cookie!");
        return
    }
    var DELAY = 3e4;
    var HOURS_IN_DAY = 24;
    var COOKIE_NAME_GROUP_SHOW = "floating_social_group_is_show";
    if (!App.Cookies.get(COOKIE_NAME_GROUP_SHOW) && !App.detectWindowSize(480)) {
        setTimeout(function() {
            show();
            var date = new Date;
            App.Cookies.set(COOKIE_NAME_GROUP_SHOW, "1", (HOURS_IN_DAY - (date.getHours() + date.getMinutes() / 60)) / HOURS_IN_DAY, "/")
        }, DELAY)
    }
    var $container = $(".js-floating-social-group");

    function show() {
        $(".js-on-floating-open").click();
        $container.css("display", "block").addClass("fadeInUp")
    }

    function hide(target) {
        $container.addClass("fadeOutDown");
        setTimeout(function() {
            $container.remove()
        }, 1e3)
    }
    $(".js-floating-close").on("click", function(event) {
        hide($(this))
    })
});
$(function() {
    var elementMaxLength = {
        create__title: 255,
        "create__content-text": 65535
    };
    var elementNames = {
        create__title: "???????????????",
        "create__content-text": "?????N?N ???N??N????"
    };
    var createForm = $("#petition__create-from");
    var petitionTypeInput = $("#petitionform-type");
    var elementsPlaceHolders = {
        create__title: "???????N???N? ???????????????",
        pevent__news_title: "??????????????? ????????N?N??",
        pevent__discussion_title: "?????? ???N?N?????????N?"
    };
    var createStorage = App.localStorage.get("createPetition");
    if (createStorage == null) {
        App.localStorage.set("createPetition", {});
        createStorage = {}
    }
    var fileStats = {
        images: typeof petitionImageCount != "undefined" ? petitionImageCount : "images" in createStorage && Object.keys(createStorage["images"]).length > 0 ? Object.keys(createStorage["images"]).length : 0
    };
    var fileLimits = {
        images: 6
    };
    var loadingFileBtn = $(".b-loading-file-button");
    checkUploadImageCount(fileStats, fileLimits);

    function pushValueInStorage(object) {
        App.localStorage.set("createPetition", object)
    }
    var imageFileTypes = ["image/png", "image/jpeg", "png", "jpeg", "jpg"];
    var fileFileTypes = ["image/png", "image/jpeg", "png", "jpeg", "jpg"];
    var acceptableFileTypes = imageFileTypes.concat(fileFileTypes);

    function in_array(needle, haystack, strict) {
        var found = false,
            key, strict = !!strict;
        for (key in haystack) {
            if (strict && haystack[key] === needle || !strict && haystack[key] == needle) {
                found = true;
                break
            }
        }
        return found
    }
    $(document).on("click", function(event) {
        if (!$(event.target).hasClass("box-close")) {
            setFilledType()
        }
        $(".page-create-petition").find(".arrow_box.helper_box:visible").remove()
    });
    $(document).on("keydown", function(event) {
        if (event.keyCode == 9) {
            setFilledType()
        }
    });
    $(".js-create-title").on("keydown", function(event) {
        if (event.keyCode == 13) return false
    });
    $(".doc__file-add").on("click", function(e) {
        var elementId = $(this).attr("id"),
            id = $(this).attr("data-id");
        if (isUserGuest && elementId == "add-files") {
            var authOpts = isUserGuest ? {
                step: "select",
                type: "create"
            } : {
                step: "select",
                type: "is-verified"
            };
            if (!checkAccess(e, null, authOpts, isUserGuest)) {
                return
            }
        }
        $(document).find(".doc__file-input[data-id=" + id + "]").click()
    });
    if (window.location.href.indexOf("/petition/update/") > 0) {
        var $createTitle = $(".js-create-title");
        var createTitleText = $.trim($createTitle.text());
        if (createTitleText.length > 0 && createTitleText !== $createTitle.data("default-content")) {
            $createTitle.parent("div").addClass("filled")
        }
    }
    $("#add-images, #edit-images").on("click", function(e) {
        var elementId = $(this).attr("id");
        if (isUserGuest && elementId == "add-images") {
            var authOpts = isUserGuest ? {
                step: "select",
                type: "create"
            } : {
                step: "select",
                type: "is-verified"
            };
            if (!checkAccess(e, null, authOpts, isUserGuest)) {
                return
            }
        }
        $("#media__file-input").click()
    });
    $("#create__date .main__filter-list").find("a").on("click", function() {
        var parent = $(this).closest("#create__date");
        var createdDate = parent.data("created");
        var days = $(this).attr("data-day");
        var rawResult = getRawDate(days, createdDate);
        $("#petition_deadline_input").val(getFormattedDateEndPetition(rawResult, true));
        var result = getFormattedDateEndPetition(rawResult, false);
        editProgressStatus(parent, true);
        $("#deadline-date").text("???? " + result)
    });
    $("#create__type .main__filter-list").find("a").on("click", function() {
        petitionTypeInput.val($(this).data("type"))
    });
    loadingFileBtn.on("click", function() {
        if (isUserGuest) {
            window.location.hash = "authorize";
            return false
        }
    });
    $(document).on("change", ".js-loading-file", function() {
        var fileInfo = getFileInfo($(this), 75),
            self = this,
            isPetition = true;
        if (fileInfo.err) {
            alert(fileInfo.err);
            return false
        }
        var checkResults = checkIfCanUpload(fileInfo);
        if (!checkResults.canUpload) {
            alert(checkResults.err);
            return false
        }
        if ($(this).hasClass("pevent-files")) {
            isPetition = false
        }
        if (fileInfo) {
            if (checkFileType(fileInfo.fileType, acceptableFileTypes)) {
                var petitionId = createForm.data("id") || 0;
                var data = new FormData;
                data.append("image", self.files[0]);
                data.append("uniq", self.form.uniq.value);
                if (in_array(fileInfo.fileType, imageFileTypes)) {
                    data.append("itype", 1)
                } else {
                    data.append("itype", 0)
                }
                $.ajax({
                    url: "/image/upload/petition/" + petitionId + "/",
                    type: "POST",
                    data: data,
                    contentType: false,
                    cache: false,
                    processData: false,
                    success: function(data) {
                        fileInfo["id"] = data.id;
                        fileInfo["link"] = data.url;
                        addDomFileInfo(self, fileInfo, isPetition)
                    }
                })
            } else {
                alert("?????????N?N?N????N?? N??N???N N?????! \n??????: " + fileInfo.fileType + " ??? N??N?N??????????!")
            }
        } else {
            alert("?zN??????? ??????????????N? N?????!")
        }
    });
    $(document).on("click", ".js-image-remove", function(event) {
        event.preventDefault();
        var self = this;
        var id = $(self).data("id");
        var fileType = $(self).data("file-type");
        var isNew = !!$(self).data("new");
        if (in_array(fileType, imageFileTypes)) {
            --fileStats.images
        }
        checkUploadImageCount(fileStats, fileLimits);
        var data = new FormData;
        data.append("id", id);
        if (isNew) {
            data.append("isTemp", isNew)
        }
        $.ajax({
            url: "/image/deletetmp/",
            type: "POST",
            data: data,
            contentType: false,
            cache: false,
            processData: false,
            success: function(data) {
                removeDomFileInfo(self)
            }
        })
    });
    $("#media__file-input").on("change", function() {
        var fileInfo = getFileInfo($(this), 75);
        var self = this;
        var data = new FormData;
        data.append("image", self.files[0]);
        data.append("uniq", self.form.uniq.value);
        data.append("itype", 2);
        var form = $(this).parents("form");
        var petitionId = form.data("id") || 0;
        var type = form.data("type") || "petition";
        if (fileInfo) {
            if (fileInfo.err) {
                alert(fileInfo.err);
                return false
            }
            if (checkFileType(fileInfo.fileType, imageFileTypes)) {
                readURL(self);
                setTimeout(function() {
                    if (objResol.width >= 800 && objResol.height >= 450) {
                        $.ajax({
                            url: "/image/uploadimgtmp/" + type + "/" + petitionId + "/",
                            type: "POST",
                            data: data,
                            contentType: false,
                            cache: false,
                            processData: false,
                            success: function(data) {
                                if (data.error) {
                                    var message = "";
                                    for (var prop in data.error.errors) {
                                        var errors = data.error.errors[prop];
                                        message += prop + ":\n";
                                        for (var i = 0; i < errors.length; i++) {
                                            message += errors[i];
                                            message += "\n"
                                        }
                                    }
                                    alert(message)
                                } else {
                                    objResol.target = data.url;
                                    objectMediaFiles.image = true;
                                    $("#upload_preview-image").find("img").attr("src", objResol.target)
                                }
                            }
                        });
                        if (objectMediaFiles.video == false) {
                            editProgressStatus("media", true, true)
                        } else {
                            editProgressStatus("media-two", true, true);
                            $("#upload_preview").find(".play").show()
                        }
                        $(".upload_editor").fadeOut(200);
                        $(".upload_add-video, #upload_preview-video").css("display", "none");
                        $("#upload_preview-image").css("display", "block");
                        $(self).closest(".create__media-file").css("display", "none");
                        $("#upload_preview").fadeIn(200).addClass("view_preview filled")
                    } else {
                        alert("????????????N???N?? N?????N: 800 ??? 450.\n??N? N?????N: " + objResol.width + " x " + objResol.height)
                    }
                }, 200)
            } else {
                alert("?????????N?N?N????N?? N??N???N N?????! \n??????: " + fileInfo.fileType + " ??? N??N?N????!")
            }
        } else {
            alert("?zN??????? ??????????????N? N?????!")
        }
        $(this).val("")
    });
    $("#upload_preview").find(".icon-edit-wrapper").on("click", function() {
        $(".upload_editor").fadeIn(200);
        $("#upload_preview").find(".play").hide(0);
        $("#upload_preview").removeClass("view_preview filled")
    });
    $(".close-editor").on("click", function() {
        $(this).closest(".upload_editor");
        $(".upload_editor").fadeOut(200);
        $("#upload_preview").addClass("view_preview filled")
    });
    $("#add-video, #edit-video").on("click", function(e) {
        var elementId = $(this).attr("id");
        if (isUserGuest) {
            window.location.hash = "authorize";
            return
        }
        var parent;
        if ($(this).attr("id") == "edit-video") {
            parent = $(this).closest("#upload_preview");
            $(parent).removeClass("view_preview filled")
        } else {
            parent = $(this).closest(".create__media-file");
            $(parent).css("display", "none")
        }
        $("#upload_preview").fadeIn(200);
        $(".upload_editor").fadeOut(200);
        $("#upload_preview-image, #upload_preview-video").css("display", "none");
        $(".upload_add-video").css("display", "block")
    });
    $(".close-upload-video").on("click", function() {
        if (objectMediaFiles.video) {
            $("#upload_preview-video").fadeIn(200);
            $("#upload_preview").addClass("view_preview filled")
        } else if (objectMediaFiles.image) {
            $("#upload_preview-image").fadeIn(200);
            $("#upload_preview").addClass("view_preview filled")
        } else {
            $(".create__media-file").css("display", "block");
            $("#upload_preview").css("display", "none").removeClass("view_preview filled")
        }
        $(".upload_add-video").css("display", "none")
    });
    $("#add-video-submit").on("click", function(event) {
        event.preventDefault();
        var url = $(this).closest(".js-upload-add-video").find("#add-video-input").val();
        if (isValidVideoUrl(url)) {
            addDomVideo("#upload_preview-video .video-wrap", url);
            objectMediaFiles.video = true;
            if (objectMediaFiles.image == false) {
                editProgressStatus("media", true, true)
            } else {
                editProgressStatus("media-two", true, true)
            }
            $(".upload_add-video, #upload_preview-image").css("display", "none");
            $("#upload_preview-video").fadeIn(200);
            $("#upload_preview").addClass("view_preview filled")
        } else {
            $(this).prev("#add-video-input").val("");
            alert("?N ???????? ??????N??N?? ???N?N? ?????????")
        }
    });
    $("#play").on("click", function(e) {
        e.preventDefault();
        $("#media-video")[0].src += "&autoplay=1"
    });
    $(".select2").each(function(index) {
        $(this).attr("id", "select-id-" + (index + 1))
    });
    $("#media__avatar-upload").on("change", function() {
        var fileInfo = getFileInfo($(this), 75),
            self = this,
            type = $(self).data("type"),
            userId = $(self).data("user_id"),
            data = new FormData;
        data.append("avatar", self.files[0]);
        if (fileInfo) {
            if (checkFileType(fileInfo.fileType, imageFileTypes)) {
                readURL(self);
                setTimeout(function() {
                    if (objResol.width >= 200 && objResol.height >= 200) {
                        $.ajax({
                            url: "/image/uploadavatar/" + type + "/" + userId + "/",
                            type: "POST",
                            data: data,
                            contentType: false,
                            cache: false,
                            processData: false,
                            success: function(data) {
                                if (data.error) {
                                    var message = "";
                                    for (var prop in data.error.errors) {
                                        var errors = data.error.errors[prop];
                                        message += prop + ":\n";
                                        for (var i = 0; i < errors.length; i++) {
                                            message += errors[i];
                                            message += "\n"
                                        }
                                    }
                                    alert(data.error)
                                } else {
                                    $(".user-avatar").attr("src", data.url)
                                }
                            }
                        })
                    } else {
                        alert("????????????N???N?? N?????N: 800 ??? 450.\n??N? N?????N: " + objResol.width + " x " + objResol.height)
                    }
                }, 200)
            } else {
                alert("?????????N?N?N????N?? N??N???N N?????! \n??????: " + fileInfo.fileType + " ??? N??N?N????!")
            }
        } else {
            alert("?zN??????? ??????????????N? N?????!")
        }
        $(this).val("")
    });
    var fileApi = window.File ? true : false;
    var lastFocus;
    var createProgressTotal = 0;
    var createProgressElements = {};
    var objResol = {};
    var objectMediaFiles = {
        video: false,
        image: false
    };
    var createPublic = $(".js-petition-publish");
    var sidebarCollection = $("#sidebar__collection");
    var quantityFiles = fileStats.images;
    var defaultSidebarText = "???? ????????? ?N????N ??N???N?N????????" + " ????N??N???N??N? ?? ???N??N????," + " N??? ??NN?? ?N???N?N  ???N??? N????N?N ?????N?? ?????????N???N? ?? ???????NN?N?N? N?N????N?.";
    var secondSidebarText = "<strong>" + "?YN????N?????N? ??????N??????NN, " + "</strong>" + "????N??NN? ??????N???N????NZN ???N??? ??N?????????N?. ?N?? ??????NN???N ???????N??? ?? ???N???? ???N??N????.";
    createProgressElements["#create__content-text"] = {
        status: false,
        point: 30
    };
    createProgressElements["#create__title"] = {
        status: false,
        point: 20
    };
    createProgressElements["#select-id-1"] = {
        status: false,
        point: 10
    };
    createProgressElements["#select-id-2"] = {
        status: false,
        point: 10
    };
    createProgressElements["#select-id-3"] = {
        status: false,
        point: 5
    };
    createProgressElements["#media"] = {
        status: false,
        point: 20
    };
    createProgressElements["#media-two"] = {
        status: false,
        point: 5
    };
    createProgressElements["#doc"] = {
        status: false,
        point: 5
    };
    createProgressElements["#create__date"] = {
        status: false,
        point: 5
    };
    if (quantityFiles > 0 && isCreate) {
        $(".doc__file-input, .doc__file-add").attr("data-file-id", quantityFiles + 1);
        setFileProgress()
    }
    if ("image" in createStorage && isCreate) {
        editProgressStatus("media", true, true)
    }
    if ("video" in createStorage) {
        editProgressStatus("media-two", true, true)
    }
    createPublic.click(function(e) {
        e.preventDefault();
        if (isUserSuspended) {
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        if (!isUserComplete) {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/access/",
                redirect: location.href
            });
            return
        }
        if (isUserGuest) {
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/index/",
                options: {
                    reload: 0
                }
            });
            return
        }
        if (!isDisabled(this)) {
            createPublic.addClass("disabled");
            var imageLoadBlock = $(".container-docs--create"),
                uploadedImages = imageLoadBlock.find(".loading-files__item"),
                imageRotationArr = {};
            if (uploadedImages.length > 0) {
                uploadedImages.each(function(idx, item) {
                    var imageName = $(item).find(".loading-files__image img").attr("src"),
                        imageRotationAngle = $(item).attr("data-rotate-angle");
                    imageRotationArr[imageName] = imageRotationAngle
                });
                $("#petitionform-imageRotationAngles").val(JSON.stringify(imageRotationArr))
            }
            $("#petitionform-title").val($("#create__title").html());
            $("#petitionform-body").val($("#create__content-text").html());
            $("#petitionform-video").val($("#add-video-input").val());
            var days = $("#create__date .main__filter-list").find("a.active").attr("data-day");
            if (days) {
                var parent = $("#create__date");
                var createdDate = parent.data("created");
                var rawResult = getRawDate(days, createdDate);
                $("#petition_deadline_input").val(getFormattedDateEndPetition(rawResult, true))
            }
            var $sum = $("#petitionform-sum");
            if ($sum && $sum.length > 0) {
                $sum.val($("#create__sum").html())
            }
            App.localStorage.remove("createPetition");
            createForm.submit()
        }
    });
    $(document).on("blur", "#create__title, #create__content-wrap .redactor-editor", function() {
        var $self, content;
        if ($(this).hasClass("redactor-editor")) {
            $self = $("#create__content-text");
            content = $self.val()
        } else {
            $self = $(this);
            content = $self.text()
        }
        var dataContent = $self.data("default-content");
        var status = false;
        if (!dataContent) dataContent = true;
        if (content.length >= 2 && dataContent != content) {
            status = true;
            var box = $self.closest(".box").find(".helper_box");
            if (box) {
                $(box).fadeIn(200)
            }
        }
        editProgressStatus($self.get(0), status)
    });
    $("select").on("select2:selecting", function(event) {
        var $options = $(this).find("option[data-select2-tag]");
        if ($options.length > 1) {
            $options[1].remove()
        }
    });
    $("select").on("select2:unselecting select2:selecting", function(event) {
        var select2 = $(this).next(".select2");
        var choice = $(select2).find(".select2-selection__choice");
        var choiceLength = choice.length;
        var status = false;
        if (event.type == "select2:selecting") {
            ++choiceLength
        } else {
            --choiceLength
        }
        if (choiceLength >= 1) {
            status = true
        }
        editProgressStatus(select2, status)
    });
    $(".petition__create-pevent-submit").on("click", function(e) {
        e.preventDefault();
        if (isUserSuspended) {
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        var formType = $(this).attr("id").split("-")[1];
        if (in_array(formType, ["news", "discussion", "termination"])) {
            var self = this,
                formTab = $(".content__tab-" + formType),
                titleValue = formType == "termination" ? formTab.find(".radio-choice.active .radio-text").eq(0).html() : formTab.find(".title").eq(0).html(),
                defaultTitleValue = formType == "termination" ? "" : formTab.find(".title").eq(0).data("default-content"),
                bodyValue = formTab.find(".create__content-text").eq(0).val(),
                data = new FormData,
                errorsCont = formTab.siblings(".text-error"),
                errors = [];
            if (titleValue == defaultTitleValue) {
                errors.push("????????N? ???????????????")
            }
            if (!bodyValue) {
                errors.push("????????N? N???N?N")
            }
            if (errors.length > 0) {
                errorsCont.html(errors.join("<br />"));
                return
            }
            if (isDisabled(this)) {
                return false
            } else {
                $(this).addClass("disabled")
            }
            var imageLoadBlock = $(".container-docs--create"),
                uploadedImages = imageLoadBlock.find(".loading-files__item"),
                imageRotationArr = {};
            if (uploadedImages.length > 0) {
                uploadedImages.each(function(idx, item) {
                    var imageName = $(item).find(".loading-files__image img").attr("src"),
                        imageRotationAngle = $(item).attr("data-rotate-angle");
                    imageRotationArr[imageName] = imageRotationAngle
                })
            }
            data.append("PeventForm[pid]", formTab.parents(".petition__create-pevent").data("pid"));
            data.append("PeventForm[type]", formType);
            data.append("PeventForm[imageRotationAngles]", JSON.stringify(imageRotationArr));
            data.append("uniq", self.form.uniq.value);
            if (formType == "news") {
                data.append("PeventForm[video]", $("#add-video-input").val())
            }
            data.append("PeventForm[title]", titleValue);
            data.append("PeventForm[body]", bodyValue);
        }
    });
    $("#commentform-body").on("focus", function(e) {
        if (isUserGuest) {
            e.preventDefault();
            $(this).blur();
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/index/",
                redirect: location.href
            })
        }
    });
    $(".pevent__comment-from-submit").click(function(e) {
        e.preventDefault();
        if (isUserSuspended) {
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        if (isUserGuest) {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/index/",
                redirect: location.href
            });
            return
        }
        var $submitBtn = $(this),
            $form = $submitBtn.parents("form"),
            $bodyTextField = $("#commentform-body"),
            $commentClearBtn = $(".pevent__comment-from-clear");
        if (!$bodyTextField.val()) {
            App.alert.push({
                type: "danger",
                message: "?N ??? ??????N? ??N??N????N?NN? ??N?N?NN? N??????N?????N?"
            }).call();
            return
        }
        if ($bodyTextField.val().length > 65535) {
            App.alert.push({
                type: "info",
                message: "??N?? N??????N?????? N????N??????? ????????????"
            }).call();
            return
        }
        if (!isDisabled($submitBtn)) {
            var commentText = $bodyTextField.val();
            if ($form.attr("data-respond-to")) {
                var addresseeInComment = commentText.split(",", 2)[0],
                    addresseeName = $(".respond-title__user").html().split(" ", 2)[0];
                if (addresseeInComment.toLowerCase() == addresseeName.toLowerCase()) {
                    commentText = commentText.replace(addresseeName, "<to>" + addresseeName + "</to>")
                }
            }
            var data = new FormData;
            data.append("CommentForm[body]", commentText);
            data.append("CommentForm[type]", "pevent");
            data.append("CommentForm[eid]", $form.attr("data-eid"));
            data.append("CommentForm[parent_id]", $form.attr("data-respond-to"));
            $bodyTextField.val("");
            $submitBtn.addClass("disabled");
            $.ajax({
                url: $form.attr("action"),
                type: "POST",
                data: data,
                contentType: false,
                cache: false,
                processData: false,
                dataType: "json",
                success: function(response) {
                    if (response.success) {
                        $submitBtn.removeClass("disabled");
                        $(".a-comment__list .empty-box").hide();
                        if (response.position.level == 0) {
                            $(".a-comment__list").prepend(response.comment)
                        } else {
                            $("#a-comment__" + response.position.root_id).after('<div class="comment-wrapper-level2">' + response.comment + "</div>");
                            $commentClearBtn.click()
                        }
                        var $counter = $(".block__row-info").find(".right");
                        var curValue = $counter.html().replace(/\D+/g, "");
                        $counter.html(declOfNum(++curValue, ["???????????N?N????", "???????????N?N??N?", "???????????N?N?????"]))
                    }
                }
            })
        }
    });
    $(".pevent__comment-form_submit").click(function(e) {
        e.preventDefault();
        if (isUserSuspended) {
            AjaxManager.loadAuthWindow(null, {
                redirect: location.href,
                action: "/auth/suspended/",
                options: {
                    reload: 0
                }
            });
            return
        }
        if (isUserGuest) {
            AjaxManager.loadAuthWindow(null, {
                action: "/auth/index/",
                redirect: location.href
            });
            return
        }
        var $submitBtn = $(this),
            $form = $submitBtn.parents("form"),
            $bodyTextField = $("#commentform-body"),
            $bodyTextFieldParent = $bodyTextField.parents(".form-group").eq(0),
            $commentClearBtn = $(".pevent__comment-form_clear");
        if (!$bodyTextField.val()) {
            App.alert.push({
                type: "danger",
                message: "?N ??? ??????N? ??N??N????N?NN? ??N?N?NN? N??????N?????N?"
            }).call();
            return
        }
        if ($bodyTextField.val().length > 65535) {
            App.alert.push({
                type: "info",
                message: "??N?? N??????N?????? N????N??????? ????????????"
            }).call();
            return
        }
        if (!$bodyTextFieldParent.hasClass("has-error") && !isDisabled($submitBtn)) {
            var commentText = $bodyTextField.val();
            var data = new FormData;
            data.append("CommentForm[body]", commentText);
            data.append("CommentForm[type]", "pevent");
            data.append("CommentForm[eid]", $form.attr("data-eid"));
            data.append("CommentForm[parent_id]", $form.attr("data-respond-to"));
            data.append("last-page", $form.attr("data-last-page"));
            data.append("comments-count", $form.attr("data-comments-count"));
            $bodyTextField.val("");
            $submitBtn.addClass("disabled");
            $.ajax({
                url: $form.attr("action"),
                type: "POST",
                data: data,
                contentType: false,
                cache: false,
                processData: false,
                dataType: "json",
                success: function(response) {
                    if (response.success) {
                        $submitBtn.removeClass("disabled");
                        $(".container-discussion-list .empty-box").hide();
                        if (response.position.new_page) {
                            location.href = response.position.redirectUrl
                        } else {
                            $commentClearBtn.click();
                            var $newCommentEl = $(response.comment),
                                $commentsContainer = $(".container-discussion-list");
                            if (response.position.level == 0) {
                                if ($commentsContainer.hasClass("empty")) {
                                    $commentsContainer.removeClass("empty")
                                }
                                $commentsContainer.append($newCommentEl)
                            } else {
                                var $commentTreeRootItem = $("#a-comment__" + response.position.root_id),
                                    $nextCommentTreeRootItem = $commentTreeRootItem.nextAll(".b-discussion-item:not(.b-discussion-item--level2)").eq(0);
                                $newCommentEl.addClass("b-discussion-item--level2");
                                if ($nextCommentTreeRootItem.length > 0) {
                                    $nextCommentTreeRootItem.before($newCommentEl)
                                } else {
                                    $commentsContainer.append($newCommentEl)
                                }
                            }
                            var offsetTop = $(document).find("#a-comment__" + response.position.id).offset().top;
                            $("html, body").stop().animate({
                                scrollTop: offsetTop
                            }, {
                                duration: 300
                            });
                            var $counter = $(".block__row-info").find(".right");
                            var curValue = $counter.html().replace(/\D+/g, "");
                            $counter.html(declOfNum(++curValue, ["???????????N?N????", "???????????N?N??N?", "???????????N?N?????"]))
                        }
                    }
                }
            })
        }
    });
    $("#create__title, #create__content-text, #pevent__news_title, #pevent__discussion_title").on("blur", function() {
        var $self = $(this),
            html = $self.html(),
            elementId = $self.attr("id"),
            isPetitionForm = true;
        if (html != elementsPlaceHolders[elementId]) {
            var data = {
                text: html
            };
            if ($self.data("notags")) {
                data.noTags = true
            }
            $.ajax({
                url: "/helper/cleartext/",
                type: "POST",
                data: data,
                dataType: "json",
                success: function(response) {
                    $self.html(response.result)
                }
            })
        }
        if ($self.hasClass("create__title")) {
            elementId = "create__title";
            isPetitionForm = false
        }
        var elementContent = $self.html();
        if ((elementId == "create__title" || elementId == "create__content-text") && elementContent.length > elementMaxLength[elementId]) {
            alert('????????? ?????N? "' + elementNames[elementId] + '" ??? ????????? ??N???NN??NN? ' + elementMaxLength[elementId] + " ??????????.\n" + "?N ????????: " + elementContent.length + " ??????????.");
            var cutContent = elementContent.substr(0, elementMaxLength[elementId]);
            $self.html(cutContent);
            if (isPetitionForm) {
                editProgressStatus(this, false)
            }
        }
    });
    $("[data-default-content]").on("focus focusout paste", function(event) {
        var data = $(this).data("default-content");
        var thisValue = $(this).text();
        thisValue = $.trim(thisValue);
        var parent = $(this).parent("div");
        if (event.type == "focus") {
            if (thisValue == data) $(this).html("");
            $(parent).removeClass("filled")
        } else if (event.type == "focusout") {
            if (thisValue == "") {
                $(this).text(data);
                $(parent).removeClass("filled")
            } else {
                $(parent).addClass("filled")
            }
        }
    });
    window.initProgressBar = function(els) {
        for (var i = 0; i < els.length; i++) {
            editProgressStatus(els[i].id, true, els[i].isAbstract)
        }
    };

    function editProgressStatus(element, status, abstractSelector) {
        if (!abstractSelector) {
            var id = $(element).attr("id")
        } else {
            id = element
        }
        id = "#" + id;
        var elObj = createProgressElements[id];
        if (elObj) {
            if (status != elObj.status) {
                elObj.status = status;
                if (status === true) {
                    createProgressTotal += elObj.point;
                    animateProgressBar(".js-progress-bar");
                    animateProgressNumber(".js-bar-num")
                } else {
                    createProgressTotal -= elObj.point;
                    animateProgressBar(".js-progress-bar");
                    animateProgressNumber(".js-bar-num")
                }
                var c = createProgressElements;
                var textContainer = $(".js-dinamic-b-text-info");
                if (c["#create__title"].status && c["#create__content-text"].status && c["#media"].status) {
                    $(createPublic).removeClass("disabled").addClass("active button-red");
                    textContainer.html(secondSidebarText)
                } else {
                    $(createPublic).removeClass("active button-red").addClass("disabled");
                    textContainer.html(defaultSidebarText)
                }
            }
        } else {
            console.error("????????N -" + id + " ??? ??????????!")
        }
    }

    function animateProgressBar(bar) {
        $(bar).stop().animate({
            width: createProgressTotal + "%"
        }, 400, function() {
            $(bar).attr("data-width", createProgressTotal)
        })
    }

    function animateProgressNumber(num) {
        $({
            someValue: +$(num).attr("data-num")
        }).animate({
            someValue: createProgressTotal
        }, {
            duration: 400,
            easing: "swing",
            step: function() {
                $(num).text(commaSeparateNumber(Math.round(this.someValue)))
            },
            complete: function() {
                $(num).attr("data-num", createProgressTotal);
                $(num).text(createProgressTotal)
            }
        });

        function commaSeparateNumber(val) {
            while (/(\d+)(\d{3})/.test(val.toString())) {
                val = val.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,")
            }
            return val
        }
    }

    function getRawDate(num, createdDate) {
        if (typeof createdDate != "undefined") {
            var dateObj = new Date(createdDate)
        } else {
            var dateObj = new Date
        }
        var date = dateObj,
            y = date.getFullYear(),
            M = date.getMonth(),
            d = date.getDate(),
            H = date.getHours(),
            m = date.getMinutes(),
            s = date.getSeconds();
        return new Date(y, M, d + +num, H, m, s)
    }
    window.getFormattedDateEndPetition = function(endPetitionDate, forInputValue) {
        var y = endPetitionDate.getFullYear(),
            d = endPetitionDate.getDate(),
            sm = getMonth(endPetitionDate.getMonth()),
            M = endPetitionDate.getMonth(),
            H = endPetitionDate.getHours(),
            m = endPetitionDate.getMinutes(),
            s = endPetitionDate.getSeconds();
        if (forInputValue) {
            return y + "-" + ++M + "-" + d + " " + H + ":" + m + ":" + s
        } else {
            return d + " " + sm + " " + y
        }
    };

    function setFilledType() {
        var select2Focus = $(":focus").closest(".select2");
        var select2LastFocus = $(lastFocus).closest(".select2");
        if (select2Focus) {
            $(select2Focus).removeClass("filled")
        }
        var elChoice = $(select2LastFocus).find(".select2-selection__choice");
        if (elChoice) {
            var len = elChoice.length
        }
        var idLast = $(select2LastFocus).attr("id");
        var idThis = $(select2Focus).attr("id");
        if (len && idLast != idThis) {
            $(select2LastFocus).addClass("filled")
        }
        lastFocus = $(":focus")
    }

    function getMonth(date) {
        var months = ["???????NN?", "????N??N?", "???NN?", "????N??N?", "???N?", "??NZ??N?", "??NZ?N?", "??????N?N?N?", "?????NN??NN?", "?z??NN??NN?", "????N??NN?", "??????NN?"];
        return months[date]
    }

    function getFileInfo(element, fileNameLengthMax) {
        var fileName, fileType;
        if (element[0].files[0]["size"] > 5 * 1024 * 1024) {
            return {
                err: "? ?????N N????? ??N???NN???N 5???"
            }
        }
        if (fileApi && element[0].files[0]) {
            fileName = element[0].files[0].name;
            fileType = element[0].files[0].type
        } else {
            fileName = element.val().split("\\");
            fileName = fileName[fileName.length - 1]
        }
        if (!fileName.length) {
            return false
        }
        if (!fileType) {
            fileType = fileName.split(".").pop()
        }
        if (fileName.length > fileNameLengthMax) {
            fileName = fileName.slice(0, fileNameLengthMax) + "..."
        }
        var fileTypePos = fileType.indexOf("/");
        fileType = fileType.slice(fileTypePos + 1);
        return {
            fileName: fileName,
            fileType: fileType
        }
    }

    function checkFileType(fileType, Allowedtypes) {
        for (var i = 0; i < Allowedtypes.length; i++) {
            if (fileType == Allowedtypes[i]) {
                return true
            }
        }
    }

    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader;
            var img = new Image;
            reader.onload = function(e) {
                var image = new Image;
                image.src = e.target.result;
                image.onload = function() {
                    objResol.width = this.width;
                    objResol.height = this.height
                };
                objResol.target = e.target.result
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function addDomFileInfo(self, data, saveToLocalStorage) {
        var $newElement = $('<div class="grid-column-4 grid-column-small-6 grid-column-small-s-12 grid-left grid-padding-small js-grid-column">' + '<div class="loading-files__item js-rotate-wrapper" data-rotate-angle="0">' + '<div class="loading-files__image">' + '<img src="' + data.link + '" alt="' + data.fileName + '">' + "</div>" + '<div class="loading-files__controls">' + '<div class="loading-files__remove sprite-icons-file-remove js-image-remove" data-file-name="' + data.fileName + '" data-file-type="' + data.fileType + '" data-new="1" data-file-id="' + data.id + '"></div>' + '<div class="b-image-rotate">' + '<div class="image-rotate__button image-rotate__button--left sprite-icons-rotate-left js-image-rotate" data-rotate-position="left"></div>' + '<div class="image-rotate__button image-rotate__button--right sprite-icons-rotate-right js-image-rotate" data-rotate-position="right">' + "</div>" + "</div>" + "</div>" + "</div>");
        var parent = self.closest(".js-loading-column");
        $(parent).before($newElement);
        if (in_array(data.fileType, imageFileTypes)) {
            ++fileStats.images;
            checkUploadImageCount(fileStats, fileLimits);
            quantityFiles++;
            if (saveToLocalStorage) {
                if (!("images" in createStorage)) {
                    createStorage["images"] = {}
                }
                var curFiles = createStorage["images"];
                curFiles[data.fileName] = {
                    id: data.id,
                    link: data.link,
                    name: data.fileName,
                    ext: data.fileType
                };
                createStorage["images"] = curFiles;
                pushValueInStorage(createStorage);
                setFileProgress()
            }
        }
    }

    function removeDomFileInfo(self) {
        $(self).closest(".js-grid-column").remove();
        quantityFiles--;
        var fileName = $(self).data("file-name");
        var curFiles = createStorage["images"];
        if (typeof curFiles != "indefined") {
            if (fileName in curFiles) {
                delete curFiles[fileName];
                createStorage["images"] = curFiles;
                pushValueInStorage(createStorage)
            }
            setFileProgress()
        }
    }

    function setFileProgress() {
        var status = false;
        if (quantityFiles > 0) {
            status = true
        }
        editProgressStatus("doc", status, true)
    }

    function isValidVideoUrl(url) {
        return null !== url.match(/(?:http(?:s)?:\/\/)?(?:www\.)?(?:m\.)?(?:youtu\.be\/|youtube\.com\/(?:(?:watch)?\?(?:.*&)?v(?:i)?=|(?:embed|v|vi|user)\/))([^\?&\"'>]+)/g)
    }

    function addDomVideo(wrapper, url) {
        var iframe = $('<iframe id="petition__video" width="auto" height="auto" src="#" frameborder="0" allowfullscreen></iframe>');
        var ids = url.split("=");
        if (ids.length <= 1) {
            ids = url.split("/")
        }
        var id = ids[ids.length - 1];
        var src = "https://www.youtube.com/embed/" + id + "?enablejsapi=1&showinfo=0&autohide=2&&controls=1";
        $(iframe).attr("src", src);
        $(wrapper).empty();
        $(wrapper).append(iframe)
    }

    function checkIfCanUpload(data) {
        var result = {
            canUpload: true,
            err: false
        };
        if (in_array(data.fileType, imageFileTypes)) {
            result.canUpload = fileLimits.images > fileStats.images;
            if (!result.canUpload) {
                result.err = "????????????????? ????NN????NN? ????N?N?? 6 N??N????N?N????"
            }
        }
        return result
    }

    function checkUploadImageCount(stats, limits) {
        if (stats.images >= limits.images) {
            loadingFileBtn.hide()
        } else {
            if (loadingFileBtn.is(":hidden")) {
                loadingFileBtn.show()
            }
        }
    }
});
$(document).ready(function() {
    function separatedBySpaceNumber(selector) {
        $(selector).each(function() {
            var count = $(this).text();
            var countResult = count.replace(/(\d{1,3}(?=(\d{3})+(?:\.\d|\b)))/g, "$1 ");
            $(this).text(countResult)
        })
    }
    separatedBySpaceNumber(".js-main-top-information .js-count");
    (function() {
        var rotateItems = [{
            text: "N?N??????N? ???N???N ??N???????",
            buttonColor: "#d1404a"
        }, {
            text: "N???????N???? ???N???N ??????N???N????",
            buttonColor: "#2090dc"
        }, {
            text: "N????N? N?N???N?N?? ??? ???????? ?????",
            buttonColor: "#27ae60"
        }];
        var rotateCurrentCount = 1;
        var rotateWrapper = $(".js-main-top-information");
        var rotateText = rotateWrapper.find(".js-fade-current-text");
        var rotateButton = rotateWrapper.find(".button-main");
        var rotateBg = rotateWrapper.find(".js-fade-current-background");

        function mainRotateSlider(userDuration) {
            $(rotateBg).each(function() {
                if ($(this).data("bg-id") == rotateCurrentCount) {
                    $(this).animate({
                        opacity: "1"
                    }, {
                        duration: userDuration,
                        complete: function() {
                            rotateText.animate({
                                opacity: 0
                            }, {
                                duration: 200,
                                complete: function() {
                                    $(this).text(rotateItems[rotateCurrentCount].text);
                                    $(this).animate({
                                        opacity: 1
                                    })
                                }
                            });
                            rotateButton.animate({
                                backgroundColor: "#" + rotateItems[rotateCurrentCount].buttonColor
                            }, {
                                duration: 200,
                                complete: function() {
                                    $(this).removeAttr("style").attr("data-color-type", rotateCurrentCount)
                                }
                            })
                        }
                    })
                } else {
                    $(this).animate({
                        opacity: "0"
                    }, userDuration)
                }
            });
            setTimeout(function() {
                rotateCurrentCount++;
                if (rotateCurrentCount == rotateItems.length) {
                    rotateCurrentCount = 0
                }
            }, userDuration + 300)
        }
        setTimeout(function go() {
            mainRotateSlider(800);
            if (rotateItems.length) setTimeout(go, 5e3)
        }, 5e3)
    })()
});
"use strict";
$(function() {
    var $floatWidget = $(".js-static-side-menu");
    var $sidebarStatic = $(".js-sidebar-static");
    if ($floatWidget.length > 0) {
        $floatWidget.stickyBlock({
            top: 20,
            parent: $sidebarStatic,
            start: {
                offset: -20
            },
            end: {
                element: $(".js-container-static"),
                offset: 65,
                border: "bottom"
            },
            returnToInitialState: function() {
                return App.detectWindowSize(1024)
            }
        });
        detectHashUrl();
        $(window).resize(function() {
            setSizeFloatElement($floatWidget, $sidebarStatic)
        });
        setSizeFloatElement($floatWidget, $sidebarStatic)
    }
});
"use strict";
$(window).load(function() {
    if (!$("body").hasClass("page-view-petition")) {
        return
    }
    var navigation = $(".js-navigation-float");
    var menu = $(".navigation-menu__ul");
    var group = $(".js-navigation-group");
    $(window).scroll(function() {
        var position = App.getDirectionScroll();
        if (navigation.hasClass("b-navigation-fixed") && window.innerWidth > 1024) {
            if (position === "top") {
                showMenu()
            } else if (position === "bottom") {
                hideMenu()
            }
        }
    });
    $(window).resize(function() {
        if (window.innerWidth < 1024) {
            showMenu("table")
        }
    });

    function showMenu(type) {
        type = type || "block";
        group.css("display", "none");
        menu.css("display", type);
        group.removeClass("state-show")
    }

    function hideMenu() {
        menu.css("display", "none");
        group.css("display", "block");
        setTimeout(function() {
            group.addClass("state-show")
        }, 0)
    }
});